(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{1104:function(e,t,o){"use strict";o.r(t);var r=o(111),n=o(128),d=o(53),l=o(1069),c=o(671),m=o(668),f=o(641),h=o(684),v=o(198),y=(o(13),o(6),o(40),o(44),o(243),o(197),o(54),o(694)),T=o(783),w=(o(697),o(689));Object(w.a)();var x=T.a.helper.debounce((function(e,t){var o=window.report.$refs.preview.hotInstance.getPlugin("filters");o.removeConditions(e),o.addCondition(e,"contains",[t.target.value]),o.filter()}),400),C=function(e){var div=document.createElement("div"),input=document.createElement("input");return div.className="filterHeader",function(input,e){input.addEventListener("keydown",(function(t){x(e,t)}))}(input,e),div.appendChild(input),div},_=function(e,t){-1===t.row&&"INPUT"===e.target.nodeName&&(e.stopImmediatePropagation(),this.deselectCell())},R={name:"Report",components:{HotTable:y.a},detailsRoot:"detailsRoot",data:function(){return{detailsRoot:"detailsRoot",form:{dateFrom:null,dateTo:null,itemType:null,requestType:null},itemType:[],requestType:[],loading:!1,showLoading:!1,loading1:!1,dialogPrevDoc:!1,KBType:null,prevTitle:"",params:{},itmTenant:[],itmTransName:[],itmTipeBc:[],editedIndex:-1,menu1:"",menu2:"",settings:{licenseKey:"non-commercial-and-evaluation",height:"70vh",afterGetColHeader:function(col,e){if("number"!=typeof col)return col;col>=0&&e.childElementCount<2&&e.appendChild(C(col));var t=e.parentNode,o=t.parentNode;o.childNodes.length,Array.prototype.indexOf.call(o.childNodes,t)},beforeOnCellMouseDown:_,manualColumnResize:!0,manualRowResize:!0,rowHeaders:!0,stretchH:"all",wordWrap:!1,filters:!0,autoRowSize:!1,autoColumnSize:!1,persistentState:!0,rowHeights:23}}},computed:{formTitle:function(){return-1===this.editedIndex?"Reservation Summary":2===this.editedIndex?"Find Document":"Edit Document"},btnTitle:function(){return-1===this.editedIndex?"Save":2===this.editedIndex?"Find":"Edit"}},created:function(){this.reportType()},methods:{reportType:function(){var e=this;window.report=this,this.$axios.get("/api/report/params").then((function(t){e.itemType=t.data.data.item_type,e.requestType=t.data.data.request_type})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})}))},clear:function(){this.form.tenant="",this.form.kb_type="",this.form.dateType="",this.form.firstDateType="",this.form.secondDateType="",this.form.numType="",this.form.firstNumType="",this.form.secondNumType=""},close:function(){this.dialogPrevDoc=!1},exportPrev:function(e){var t=this;this.loading1=!0;var o=this.form.itemType,r=this.form.requestType,n=this.form.dateFrom,d=this.form.dateTo;this.$axios.get("/api/report/export",{params:{itemType:o,requestType:r,dateFrom:n,dateTo:d},responseType:"arraybuffer"}).then((function(e){t.loading1=!1;var l=new Blob([e.data],{type:"application/vnd.ms-excel"}),c=window.URL.createObjectURL(l),link=document.createElement("a");link.href=window.URL.createObjectURL(l),link.download="Reservation "+o+" - "+r+" -"+n+" - "+d+".xlsx",document.body.appendChild(link),link.click(),setTimeout((function(){document.body.removeChild(link),window.URL.revokeObjectURL(c)}),100)})).catch((function(e){t.$swal({type:"error",title:"Error",text:e.response.data.message}),t.loading1=!1}))},preview:function(){var e=this;this.loading=!0,this.showLoading=!0;var t=this.form.itemType,o=this.form.requestType,r=this.form.dateFrom,n=this.form.dateTo;try{this.$axios.get("/api/report/preview",{params:{itemType:t,requestType:o,dateFrom:r,dateTo:n}}).then((function(t){e.loading=!1,e.showLoading=!1,e.updateSettingSummary(t.data.data.header),setTimeout((function(){e.$refs.preview.hotInstance.loadData(t.data.data.rows),e.showLoading=!1,e.loading=!1}),500)})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message}),e.loading=!1,e.showLoading=!1}))}catch(e){this.loading=!1,this.showLoading=!1}},updateSettingSummary:function(header){this.$refs.preview.hotInstance.updateSettings({colHeaders:header,licenseKey:"non-commercial-and-evaluation",fixedRowsBottom:1,manualColumnResize:!0,manualRowResize:!0,rowHeaders:!0,filters:!0,autoRowSize:!1,autoColumnSize:!1,persistentState:!0,rowHeights:23,colWidths:[100,100,100,100,100,150,100,100,80,80,100,100,130,100,100,100,100,100,100,100,100]})}}},E=o(61),component=Object(E.a)(R,(function(){var e=this,t=e._self._c;return t(m.a,[t(c.a,{attrs:{sm12:""}},[t(n.a,[t("form",[t(d.d,[t("span",{staticClass:"text-subtitle-2"},[e._v(e._s(e.formTitle))])]),e._v(" "),t(d.c,[t(m.a,{attrs:{wrap:""}},[t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(h.a,{attrs:{outlined:"",dense:"","hide-details":"auto","return-object":"",loading:e.loading,items:e.itemType,label:"Item Type"},model:{value:e.form.itemType,callback:function(t){e.$set(e.form,"itemType",t)},expression:"form.itemType"}})],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(h.a,{attrs:{outlined:"",dense:"","hide-details":"auto","return-object":"",loading:e.loading,items:e.requestType,label:"Request Type"},model:{value:e.form.requestType,callback:function(t){e.$set(e.form,"requestType",t)},expression:"form.requestType"}})],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(f.a,{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(o){var r=o.on,n=o.attrs;return[t(v.a,e._g(e._b({attrs:{outlined:"",dense:"","hide-details":"auto",label:"Date From","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.form.dateFrom,callback:function(t){e.$set(e.form,"dateFrom",t)},expression:"form.dateFrom"}},"v-text-field",n,!1),r))]}}]),model:{value:e.menu1,callback:function(t){e.menu1=t},expression:"menu1"}},[e._v(" "),t(l.a,{attrs:{"no-title":""},on:{input:function(t){e.menu1=!1}},model:{value:e.form.dateFrom,callback:function(t){e.$set(e.form,"dateFrom",t)},expression:"form.dateFrom"}})],1)],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(f.a,{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(o){var r=o.on,n=o.attrs;return[t(v.a,e._g(e._b({attrs:{outlined:"",dense:"","hide-details":"auto",label:"Date To","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.form.dateTo,callback:function(t){e.$set(e.form,"dateTo",t)},expression:"form.dateTo"}},"v-text-field",n,!1),r))]}}]),model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[e._v(" "),t(l.a,{attrs:{"no-title":""},on:{input:function(t){e.menu2=!1}},model:{value:e.form.dateTo,callback:function(t){e.$set(e.form,"dateTo",t)},expression:"form.dateTo"}})],1)],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(r.a,{attrs:{small:"",loading:e.loading,color:"green darken-1",dark:""},on:{click:function(t){return e.preview()}}},[e._v("Preview\n              ")])],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(r.a,{attrs:{small:"",loading:e.loading1,size:"mini",color:"blue darken-1",dark:""},on:{click:function(t){return e.exportPrev()}}},[e._v("\n                Export\n              ")])],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:""}},[t("div",{staticClass:"scroll-container-height"},[t("hot-table",{ref:"preview",attrs:{root:e.detailsRoot,settings:e.settings}})],1)])],1)],1)],1)])],1)],1)}),[],!1,null,null,null);t.default=component.exports},668:function(e,t,o){"use strict";o(304);var r=o(305);t.a=Object(r.a)("layout")},671:function(e,t,o){"use strict";o(304);var r=o(305);t.a=Object(r.a)("flex")},783:function(e,t,o){"use strict";o(426);var base=o(787),r=o(689),n=o(683),d=o(942);o(36);var l,c,m,f,h,v,y,T=o(770),w=o(769),x=o(665),C=o(715),data=o(732),_=o(792),R=o(727),E=o(685),k=o(673),O=o(677),object=o(664),j=o(700),F=o(728),S=o(666),L=o(691),$=o(693),P=o(724),N=o(725),D=o(723),I=o(731),U=o(1065);Object(r.a)(),v=base.a,(y="undefined"!=typeof window&&window.jQuery)&&(y.fn.handsontable=function(e){var output,t=this.first(),o=t.data("handsontable");if("string"!=typeof e){var r=e||{};return o?o.updateSettings(r):(o=new v.Core(t[0],r),t.data("handsontable",o),o.init()),t}if(o){if(void 0===o[e])throw new Error("Handsontable do not provide action: ".concat(e));for(var n,d=arguments.length,l=new Array(d>1?d-1:0),c=1;c<d;c++)l[c-1]=arguments[c];output=(n=o[e]).call.apply(n,[o].concat(l)),"destroy"===e&&t.removeData()}return output}),base.a.__GhostTable=T.a,base.a._getListenersCounter=n.b,base.a._getRegisteredMapsCounter=d.b,base.a.EventManager=n.a;var H=[x,C,data,_,R,E,k,O,object,j,F,w],z=[S,L];base.a.helper={},base.a.dom={},x.arrayEach(H,(function(e){x.arrayEach(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(base.a.helper[t]=e[t])}))})),x.arrayEach(z,(function(e){x.arrayEach(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(base.a.dom[t]=e[t])}))})),base.a.cellTypes=null!==(l=base.a.cellTypes)&&void 0!==l?l:{},x.arrayEach(Object(D.b)(),(function(e){base.a.cellTypes[e]=Object(D.a)(e)})),base.a.cellTypes.registerCellType=D.d,base.a.cellTypes.getCellType=D.a,base.a.editors=null!==(c=base.a.editors)&&void 0!==c?c:{},x.arrayEach(Object($.c)(),(function(e){base.a.editors["".concat(j.toUpperCaseFirst(e),"Editor")]=Object($.a)(e)})),base.a.editors.registerEditor=$.e,base.a.editors.getEditor=$.a,base.a.renderers=null!==(m=base.a.renderers)&&void 0!==m?m:{},x.arrayEach(Object(P.a)(),(function(e){var t=Object(P.b)(e);"base"===e&&(base.a.renderers.cellDecorator=t),base.a.renderers["".concat(j.toUpperCaseFirst(e),"Renderer")]=t})),base.a.renderers.registerRenderer=P.d,base.a.renderers.getRenderer=P.b,base.a.validators=null!==(f=base.a.validators)&&void 0!==f?f:{},x.arrayEach(Object(N.a)(),(function(e){base.a.validators["".concat(j.toUpperCaseFirst(e),"Validator")]=Object(N.b)(e)})),base.a.validators.registerValidator=N.d,base.a.validators.getValidator=N.b,base.a.plugins=null!==(h=base.a.plugins)&&void 0!==h?h:{},x.arrayEach(Object(I.b)(),(function(e){base.a.plugins[e]=Object(I.a)(e)})),base.a.plugins["".concat(j.toUpperCaseFirst(U.a.PLUGIN_KEY),"Plugin")]=U.a,base.a.plugins.registerPlugin=I.d,base.a.plugins.getPlugin=I.a;t.a=base.a}}]);