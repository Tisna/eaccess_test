(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{705:function(e,t,o){"use strict";o.r(t);o(55),o(17),o(27);var r={name:"MasterRole",data:function(){return{totalData:0,editedIndex:-1,loadNewBtn:!1,submitLoad:!1,dialogWindow:!1,statusProcessing:"insert",dialog:!1,dialogPermission:!1,message:!1,loading:!0,insertDivision:!0,insert:!0,loadingPermission:!0,allData:[],dataParent:[],itemApps:[],itemRole:[],department:{},form:{id:null,is_crud:"N",order_line:null,has_route:"N",has_child:"N",route_name:"N",icon:null,menu_name:null,parent_name:null,app_name:null,name:null,index:"Y",store:"",edits:"",erase:"",role:[]},defaultItem:{id:null,is_crud:"N",order_line:null,has_route:"N",has_child:"N",route_name:null,icon:null,menu_name:null,parent_name:null,app_name:null,name:null,index:"Y",store:"",edits:"",erase:"",role:[]},options:{},optionDivision:{},headers:[{text:"Name",value:"menu_name"},{text:"Parent Name",value:"parena_name"},{text:"App Name",value:"app_name"},{text:"Icon",value:"icon"},{text:"Route",value:"route_name"},{text:"Has Child",value:"has_child"},{text:"Has Route",value:"has_route"},{text:"Is CRUD",value:"is_crud"},{text:"Order Line",value:"order_line"},{text:"Index",value:"index",align:"center"},{text:"Store",value:"store",align:"center"},{text:"Edits",value:"edits",align:"center"},{text:"Erase",value:"erase",align:"center"},{text:"Action",value:"ACTIONS",align:"center"}]}},head:function(){return{title:"Master Permissions"}},computed:{formTitle:function(){return-1===this.editedIndex?"New":"Edit"}},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0}},mounted:function(){this.getDataFromApi(),this.getApps(),this.getRole()},methods:{getRole:function(){var e=this;this.$axios.get("/api/master/roles").then((function(t){e.itemRole=t.data.data.simple}))},getApps:function(){var e=this;this.$axios.get("/api/master/apps").then((function(t){e.itemApps=t.data.data.simple})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})}))},getDataFromApi:function(){var e=this;this.loading=!0;this.$axios.get("/api/master/permissions",{params:{options:this.options}}).then((function(t){e.loading=!1,e.allData=t.data.data.rows,e.totalData=t.data.data.total,e.dataParent=t.data.data.parent})).catch((function(t){e.loading=!1,e.$swal({type:"error",title:"Error",text:t.response.data.message})}))},newData:function(){this.dialog=!0,this.statusProcessing="insert",this.form=Object.assign({},this.defaultItem),this.message=!1},editItem:function(e){var t=this;this.editedIndex=this.allData.indexOf(e),this.form=Object.assign({},e),this.statusProcessing="update",this.$axios.get("/api/master/permissions/"+this.form.parent_id,{params:{menu_name:this.form.menu_name}}).then((function(e){setTimeout((function(){return t.form=Object.assign({},e.data.data.rows)}),150)})),this.dialog=!0,this.insert=!1},openDialogPermission:function(e){this.dialogPermission=!0,this.loadingPermission=!0,this.form=Object.assign({},e),this.getPermissionRole(e)},getPermissionRole:function(e){var t=this;this.$axios.get("/api/master/permission-role",{params:{role:e.name}}).then((function(e){t.$refs.childDetails.setDataToDetails(e.data.data.rows)})).finally((function(e){t.loadingPermission=!1}))},saveRolePermission:function(){var e=this;this.loadingPermission=!0;var details=this.$refs.childDetails.getAddData();this.$axios.post("/api/master/permission-role",{details:details,role:this.form.name}).then((function(t){e.$swal({icon:"success",title:"Success",text:t.data.message}),e.getPermissionRole(e.form)})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})})).finally((function(t){e.loadingPermission=!1}))},close:function(){var e=this;this.dialog=!1,this.statusProcessing="insert",setTimeout((function(){e.form=Object.assign({},e.defaultItem),e.editedIndex=-1}),300)},save:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",t=this,form=this.form,o=this.statusProcessing,data={form:form,status:o};"insert"===o?(this.store("post","/api/master/permissions",data,"insert",e),t.submitLoad=!1):"update"===o&&(this.store("put","/api/master/permissions/"+this.form.id,data,"update",e),t.submitLoad=!1)},store:function(e,t,data,o){var r=this,n=this;n.submitLoad=!0,this.$axios({method:e,url:t,data:data}).then((function(e){"Error"===e.data.status?(r.$swal({type:"error",title:"Error",text:e.data.message}),n.submitLoad=!1):(r.dialog=!1,r.message=e.data.message,setTimeout((function(){return r.message=!1}),8e3),r.getDataFromApi())})).catch((function(e){r.$swal({type:"error",title:"Error",text:e.response.data.message}),n.submitLoad=!1}))},changeCrud:function(e){"Y"===e?(this.form.index="Y",this.form.store="Y",this.form.edits="Y",this.form.erase="Y"):(this.form.index="",this.form.store="",this.form.edits="",this.form.erase="")}}},n=o(52),l=o(70),d=o.n(l),c=o(199),m=o(430),v=o(415),f=o(618),h=o(697),x=o(457),_=o(403),k=o(476),C=o(462),w=o(177),P=o(471),$=o(551),D=o(552),N=o(472),R=o(413),V=o(474),A=o(44),I=o(116),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-layout",[o("v-flex",{attrs:{sm12:""}},[o("v-toolbar",{attrs:{flat:"",color:"white",dense:""}},[o("v-toolbar-title",{staticClass:"hidden-xs-only"},[e._v("Master Permissions")]),e._v(" "),o("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),e._v(" "),o("v-spacer"),e._v(" "),o("v-btn",{attrs:{icon:"",color:"green",dark:""},on:{click:function(t){return e.newData()}}},[o("v-icon",[e._v("mdi-plus-circle")])],1),e._v(" "),o("v-btn",{attrs:{loading:e.loading,icon:""},on:{click:e.getDataFromApi}},[o("v-icon",[e._v("mdi-refresh")])],1)],1),e._v(" "),o("div",{staticClass:"mt-2"},[o("v-data-table",{staticClass:"elevation-1",attrs:{"mobile-breakpoint":0,headers:e.headers,items:e.allData,"items-per-page":20,options:e.options,"server-items-length":e.totalData,loading:e.loading,"footer-props":{"items-per-page-options":[20,50,100,-1]}},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"item.ACTIONS",fn:function(t){var r=t.item;return[o("v-icon",{staticClass:"mr-2",attrs:{small:"",color:"orange"},on:{click:function(t){return e.editItem(r)}}},[e._v("\n            mdi-pencil-circle\n          ")])]}}],null,!0)})],1)],1),e._v(" "),o("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[o("v-card",[o("v-card-title",[o("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),e._v(" "),o("v-card-text",[o("v-form",[o("v-layout",{attrs:{wrap:""}},[e.message?o("v-flex",{attrs:{xs12:""}},[o("div",{staticClass:"red darken-2 text-xs-center"},[o("span",{staticClass:"white--text"},[e._v(e._s(e.message))])])]):e._e(),e._v(" "),o("v-flex",{staticClass:"d-flex",attrs:{md12:""}},[o("v-layout",{attrs:{wrap:""}},[o("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[o("v-select",{attrs:{items:e.itemApps,label:"Apps Access",outlined:"",dense:"","item-text":"name","item-value":"name","hide-details":"auto"},model:{value:e.form.app_name,callback:function(t){e.$set(e.form,"app_name",t)},expression:"form.app_name"}})],1),e._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[o("v-select",{attrs:{items:e.itemRole,chips:"","deletable-chips":"","small-chips":"",label:"Role",multiple:"",outlined:"",dense:"","item-value":"id","item-text":"name","hide-details":"auto"},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}})],1),e._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[o("v-select",{attrs:{items:e.dataParent,label:"Parent Name",outlined:"",dense:"","hide-details":"auto"},model:{value:e.form.parent_name,callback:function(t){e.$set(e.form,"parent_name",t)},expression:"form.parent_name"}})],1),e._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Name",placeholder:"Name",outlined:"",dense:"","hide-details":"auto"},model:{value:e.form.menu_name,callback:function(t){e.$set(e.form,"menu_name",t)},expression:"form.menu_name"}})],1),e._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Icon",placeholder:"Icon",outlined:"",dense:"","hide-details":"auto"},model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}})],1),e._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Order Line",placeholder:"Order Line",outlined:"",dense:"","hide-details":"auto"},model:{value:e.form.order_line,callback:function(t){e.$set(e.form,"order_line",t)},expression:"form.order_line"}})],1),e._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[o("v-radio-group",{attrs:{row:"","hide-details":"auto",label:"Has Route"},model:{value:e.form.has_route,callback:function(t){e.$set(e.form,"has_route",t)},expression:"form.has_route"}},[o("v-radio",{attrs:{label:"Yes",value:"Y",color:"success"}}),e._v(" "),o("v-radio",{attrs:{label:"No",value:"N",color:"success"}})],1)],1),e._v(" "),"Y"===e.form.has_route?o("v-flex",{staticClass:"pa-1",attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Route Name",placeholder:"Route Name",outlined:"",dense:"","hide-details":"auto"},model:{value:e.form.route_name,callback:function(t){e.$set(e.form,"route_name",t)},expression:"form.route_name"}})],1):e._e(),e._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[o("v-radio-group",{attrs:{row:"","hide-details":"auto",label:"Has Child"},model:{value:e.form.has_child,callback:function(t){e.$set(e.form,"has_child",t)},expression:"form.has_child"}},[o("v-radio",{attrs:{label:"Yes",value:"Y",color:"success"}}),e._v(" "),o("v-radio",{attrs:{label:"No",value:"N",color:"success"}})],1)],1),e._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[o("v-radio-group",{attrs:{row:"","hide-details":"auto",label:"Is CRUD"},model:{value:e.form.is_crud,callback:function(t){e.$set(e.form,"is_crud",t)},expression:"form.is_crud"}},[o("v-radio",{attrs:{label:"Yes",value:"Y",color:"success"},on:{change:function(t){return e.changeCrud("Y")}}}),e._v(" "),o("v-radio",{attrs:{label:"No",value:"N",color:"success"},on:{change:function(t){return e.changeCrud("N")}}})],1)],1),e._v(" "),o("v-flex",{staticClass:"pa-1 d-flex",attrs:{xs12:""}},[o("span",{staticClass:"font-weight-medium"},[e._v("Ability")])]),e._v(" "),o("v-flex",{staticClass:"pa-1 d-flex",attrs:{xs12:""}},[o("v-checkbox",{attrs:{value:e.form.index,label:"Index",color:"success","hide-details":""},model:{value:e.form.index,callback:function(t){e.$set(e.form,"index",t)},expression:"form.index"}}),e._v(" "),o("v-checkbox",{attrs:{value:e.form.store,label:"Store",color:"success","hide-details":""},model:{value:e.form.store,callback:function(t){e.$set(e.form,"store",t)},expression:"form.store"}}),e._v(" "),o("v-checkbox",{attrs:{value:e.form.edits,label:"Edits",color:"success","hide-details":""},model:{value:e.form.edits,callback:function(t){e.$set(e.form,"edits",t)},expression:"form.edits"}}),e._v(" "),o("v-checkbox",{attrs:{value:e.form.erase,label:"Erase",color:"success","hide-details":""},model:{value:e.form.erase,callback:function(t){e.$set(e.form,"erase",t)},expression:"form.erase"}})],1)],1)],1)],1)],1)],1),e._v(" "),o("v-card-actions",[o("v-spacer"),e._v(" "),o("v-btn",{attrs:{color:"red darken-1",text:"",small:""},on:{click:function(t){e.dialog=!1}}},[e._v("\n          Close\n        ")]),e._v(" "),o("v-btn",{attrs:{color:"green darken-1",dark:"",small:"",loading:e.submitLoad},on:{click:function(t){return e.save()}}},[e._v("\n          Save\n        ")])],1)],1)],1),e._v(" "),o("v-dialog",{attrs:{persistent:"","max-width":"1000px"},model:{value:e.dialogPermission,callback:function(t){e.dialogPermission=t},expression:"dialogPermission"}},[o("v-card",{attrs:{loading:e.loadingPermission}},[o("v-card-title",[o("span",{staticClass:"font-weight-medium"},[e._v("Role Permission")])]),e._v(" "),o("v-card-text",[o("div",{staticClass:"scroll-container"},[o("LazyMasterPermissionList",{ref:"childDetails"})],1)]),e._v(" "),o("v-card-actions",[o("v-btn",{staticClass:"white--text",attrs:{small:"",color:"blue darken-1"},on:{click:function(t){return e.$refs.childDetails.addLine()}}},[o("v-icon",{attrs:{small:""}},[e._v("\n            mdi-plus\n          ")])],1),e._v(" "),o("v-spacer"),e._v(" "),o("v-btn",{attrs:{color:"red darken-1",dark:"",small:""},on:{click:function(t){e.dialogPermission=!1}}},[e._v("\n          close\n        ")]),e._v(" "),o("v-btn",{attrs:{color:"green darken-1",dark:"",small:"",loading:e.loadingPermission},on:{click:function(t){return e.saveRolePermission()}}},[e._v("\n          Save\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;d()(component,{VBtn:c.a,VCard:m.a,VCardActions:v.a,VCardText:v.b,VCardTitle:v.c,VCheckbox:f.a,VDataTable:h.a,VDialog:x.a,VDivider:_.a,VFlex:k.a,VForm:C.a,VIcon:w.a,VLayout:P.a,VRadio:$.a,VRadioGroup:D.a,VSelect:N.a,VSpacer:R.a,VTextField:V.a,VToolbar:A.a,VToolbarTitle:I.a})}}]);