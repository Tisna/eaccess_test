/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1008:function(t,e,n){"use strict";n.d(e,"b",(function(){return R})),n.d(e,"c",(function(){return k})),n.d(e,"a",(function(){return j}));n(244),n(85),n(33),n(48),n(656),n(657),n(11),n(62),n(6),n(26),n(419),n(420),n(130),n(74),n(239),n(40),n(44),n(55),n(56),n(34);var r=n(673),object=n(664),o=n(766),l=n(665),c={_hooksStorage:Object.create(null),addHook:function(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey:function(t){var e=this;Object(l.arrayEach)(this._hooksStorage[t]||[],(function(n){e.hot.removeHook(t,n)}))},clearHooks:function(){var t=this;Object(object.objectEach)(this._hooksStorage,(function(e,n){return t.removeHooksByKey(n)})),this._hooksStorage={}}};Object(object.defineGetter)(c,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var f=c,h=n(666);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function m(t,p){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},m(t,p)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=O(t);if(e){var o=O(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==d(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===d(o)?o:String(o)),n)}var r,o}function E(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var R=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),k="baseEditor",j=function(){function t(e){S(this,t),this.hot=e,this.instance=e,this.state=R.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return E(t,[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,col,e,td,n,r){this.TD=td,this.row=t,this.col=col,this.prop=e,this.originalValue=n,this.cellProperties=r,this.state=R.VIRGIN}},{key:"extend",value:function(){return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e)}(n,t);var e=w(n);function n(){return S(this,n),e.apply(this,arguments)}return E(n)}(this.constructor)}},{key:"saveValue",value:function(t,e){var n,o,l,c,f=this;if(e){var h=this.hot.getSelectedLast();n=Math.max(Math.min(h[0],h[2]),0),o=Math.max(Math.min(h[1],h[3]),0),l=Math.max(h[0],h[2]),c=Math.max(h[1],h[3])}else{var d=[this.row,this.col,null,null];n=d[0],o=d[1],l=d[2],c=d[3]}var v=this.hot.runHooks("modifyGetCellCoords",n,o);if(Array.isArray(v)){var m=y(v,2);n=m[0],o=m[1]}var w=this.hot.getShortcutManager().getContext("editor"),O={runOnlyIf:function(){return Object(r.isDefined)(f.hot.getSelected())},group:k};this.isInFullEditMode()&&w.addShortcuts([{keys:[["ArrowUp"]],callback:function(){f.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){f.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){f.hot.selection.transformStart(0,-1*f.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){f.hot.selection.transformStart(0,f.hot.getDirectionFactor())}}],O),this.hot.populateFromArray(n,o,t,l,c,"edit")}},{key:"beginEditing",value:function(t,e){if(this.state===R.VIRGIN){var n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),l=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,l)),this.state=R.EDITING,this.isInFullEditMode()){var c="string"==typeof t?t:Object(r.stringify)(this.originalValue);this.setValue(c)}this.open(e),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,e,n){var r,l=this;if(n){var c=this._closeCallback;this._closeCallback=function(t){c&&c(t),n(t),l.hot.view.render()}}if(!this.isWaiting()){var f=this.hot.getShortcutManager().getContext("editor");if(f.removeShortcutsByGroup(k),f.removeShortcutsByGroup(o.b),this.state!==R.VIRGIN){if(this.state===R.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();var h=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof h?String.prototype.trim.call(h||""):h]]:[[h]],this.state=R.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(t){l.state=R.FINISHED,l.discardEditor(t)})):(this.state=R.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){l._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=R.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){this.state===R.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=R.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=R.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===R.WAITING}},{key:"getEditedCellRect",value:function(){var t,e=this.getEditedCell();if(e){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,l=this.hot.rootWindow,c=Object(h.offset)(e),f=Object(h.outerWidth)(e),d=Object(h.offset)(this.hot.rootElement),y=Object(h.outerWidth)(this.hot.rootElement),v=r.topOverlay.holder,m=r.inlineStartOverlay.holder,w=v!==l?v.scrollTop:0,O=m!==l?m.scrollLeft:0,S=l.innerWidth-d.left-y,C=(null!==(t=r.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt).wtTable,E=C.name,R=["master","inline_start"].includes(E)?w:0,k=["master","top","bottom"].includes(E)?O:0,j=c.top===d.top?0:1,T=c.top-d.top-j-R,P=0;P=this.hot.isRtl()?l.innerWidth-c.left-f-S-1+k:c.left-d.left-1-k,["top","top_inline_start_corner"].includes(E)&&(T+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(E)&&(P+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var A=this.hot.hasColHeaders(),M=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),_=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),x=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(A&&M<=0||M===x)&&(T+=1),_<=0&&(P+=1);var I=o.rowsRenderCalculator.startPosition,N=o.columnsRenderCalculator.startPosition,H=Math.abs(r.inlineStartOverlay.getScrollPosition()),D=r.topOverlay.getScrollPosition(),L=Object(h.getScrollbarWidth)(this.hot.rootDocument),B=e.offsetTop+I-D,F=0;if(this.hot.isRtl()){var V=e.offsetLeft;F=V>=0?C.getWidth()-e.offsetLeft:Math.abs(V),F+=N-H-f}else F=e.offsetLeft+N-H;var W=Object(h.getComputedStyle)(this.TD,this.hot.rootWindow),U=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",z=parseInt(W[U],10)>0?0:1,G=parseInt(W.borderTopWidth,10)>0?0:1,Y=Object(h.outerWidth)(e)+z,X=Object(h.outerHeight)(e)+G,K=Object(h.hasVerticalScrollbar)(v)?L:0,$=Object(h.hasHorizontalScrollbar)(m)?L:0,Q=this.hot.view.maximumVisibleElementWidth(F)-K+z;return{top:T,start:P,height:X,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(B)-$+G,23),width:Y,maxWidth:Q}}}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),section="";return this.row<this.hot.getSettings().fixedRowsTop?section=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?section=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(section="inline-start"),section}}],[{key:"EDITOR_TYPE",get:function(){return"base"}}]),t}();Object(object.mixin)(j,f)},1059:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(1163),o=n(1060),l={CELL_TYPE:"text",editor:r.a,renderer:o.a}},1060:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(85);var r=n(1061),o=n(666),l=n(673);function c(t,e,n,col,c,f,h){r.a.apply(this,[t,e,n,col,c,f,h]);var d=f;if(!d&&h.placeholder&&(d=h.placeholder),d=Object(l.stringify)(d),h.trimWhitespace&&(d=d.trim()),h.rendererTemplate){Object(o.empty)(e);var y=t.rootDocument.createElement("TEMPLATE");y.setAttribute("bind","{{}}"),y.innerHTML=h.rendererTemplate,HTMLTemplateElement.decorate(y),y.model=t.getSourceDataAtRow(n),e.appendChild(y)}else Object(o.fastInnerText)(e,d)}c.RENDERER_TYPE="text"},1061:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(666);function o(t,e,n,col,o,l,c){var f=[],h=[];c.className&&Object(r.addClass)(e,c.className),c.readOnly&&f.push(c.readOnlyCellClassName),!1===c.valid&&c.invalidCellClassName?f.push(c.invalidCellClassName):h.push(c.invalidCellClassName),!1===c.wordWrap&&c.noWordWrapClassName&&f.push(c.noWordWrapClassName),!l&&c.placeholder&&f.push(c.placeholderCellClassName),Object(r.removeClass)(e,h),Object(r.addClass)(e,f)}o.RENDERER_TYPE="base"},1062:function(t,e,n){"use strict";n(239),n(6),n(40),n(307),n(44),n(656),n(657),n(11),n(62),n(26),n(74);var r=n(853);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,l=void 0,l=function(input,t){if("object"!==o(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===o(l)?l:String(l)),n)}var r,l}var c=new WeakMap,f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,l=e.itemSizeFn,f=e.overrideFn,h=e.calculationType,d=e.scrollbarHeight;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:l,overrideFn:f,calculationType:h,horizontalScrollbarHeight:d}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}var e,n,o;return e=t,o=[{key:"DEFAULT_HEIGHT",get:function(){return 23}}],(n=[{key:"calculate",value:function(){for(var e,n=0,o=!0,l=[],f=c.get(this),h=f.calculationType,d=f.overrideFn,y=f.rowHeightFn,v=f.scrollOffset,m=f.totalRows,w=f.viewportHeight,O=f.horizontalScrollbarHeight||0,i=0;i<m;i++)if(e=y(i),isNaN(e)&&(e=t.DEFAULT_HEIGHT),n<=v&&h!==r.a&&(this.startRow=i),n>=v&&n+(h===r.a?e:0)<=v+w-O&&(null===this.startRow&&(this.startRow=i),this.endRow=i),l.push(n),n+=e,h!==r.a&&(this.endRow=i),n>=v+w-O){o=!1;break}if(this.endRow===m-1&&o)for(this.startRow=this.endRow;this.startRow>0;){var S=l[this.endRow]+e-l[this.startRow-1];if((S<=w-O||h!==r.a)&&(this.startRow-=1),S>=w-O)break}h===r.b&&null!==this.startRow&&d&&d(this),this.startPosition=l[this.startRow],void 0===this.startPosition&&(this.startPosition=null),m<this.endRow&&(this.endRow=m-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}])&&l(e.prototype,n),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=f},1063:function(t,e,n){"use strict";n(239),n(6),n(40),n(307),n(44),n(656),n(657),n(11),n(62),n(26),n(74);var r=n(853);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,l=void 0,l=function(input,t){if("object"!==o(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===o(l)?l:String(l)),n)}var r,l}var c=new WeakMap,f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,l=e.itemSizeFn,f=e.overrideFn,h=e.calculationType,d=e.stretchMode,y=e.stretchingItemWidthFn,v=void 0===y?function(t){return t}:y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:o,columnWidthFn:l,overrideFn:f,calculationType:h,stretchingColumnWidthFn:v}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=d,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}var e,n,o;return e=t,o=[{key:"DEFAULT_WIDTH",get:function(){return 50}}],(n=[{key:"calculate",value:function(){for(var t,e=0,n=!0,o=[],l=c.get(this),f=l.calculationType,h=l.overrideFn,d=l.scrollOffset,y=l.totalColumns,v=l.viewportWidth,i=0;i<y;i++){t=this._getColumnWidth(i),e<=d&&f!==r.a&&(this.startColumn=i);var m=d>0?v+1:v;if(e>=d&&e+(f===r.a?t:0)<=d+m&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=i),this.endColumn=i),o.push(e),e+=t,f!==r.a&&(this.endColumn=i),e>=d+v){n=!1;break}}if(this.endColumn===y-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var w=o[this.endColumn]+t-o[this.startColumn-1];if((w<=v||f!==r.a)&&(this.startColumn-=1),w>v)break}f===r.b&&null!==this.startColumn&&h&&h(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),y<this.endColumn&&(this.endColumn=y-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){var e=t;this.totalTargetWidth=e;for(var n=c.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var l=this._getColumnWidth(i),f=n.stretchingColumnWidthFn(void 0,i);"number"==typeof f?e-=f:o+=l}var h=e-o;if("all"===this.stretch&&h>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var d=this._getColumnWidth(r-1),y=h+d;this.stretchLastWidth=y>=0?y:d}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,r=c.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[t]){var l=Math.round(e*this.stretchAllRatio),f=r.stretchingColumnWidthFn(l,t);this.stretchAllColumnsWidth[t]=void 0===f?l:isNaN(f)?this._getColumnWidth(t):f}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var i=0;i<this.stretchAllColumnsWidth.length;i++)n+=this.stretchAllColumnsWidth[i];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===c.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=c.get(this).columnWidthFn(e);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}])&&l(e.prototype,n),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=f},1064:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f}));n(34),n(165),n(64),n(94),n(55),n(115),n(422),n(669);var r=/^(\r\n|\n\r|\r|\n)/,o=/^[^\t\r\n]+/,l=/^\t/;function c(t){var e=[[""]];if(0===t.length)return e;for(var n,c=0,f=0;t.length>0&&n!==t.length;)if(n=t.length,t.match(l))t=t.replace(l,""),c+=1,e[f][c]="";else if(t.match(r))t=t.replace(r,""),c=0,e[f+=1]=[""];else{var h="";if(t.startsWith('"')){for(var d=0,y=!0;y;){var v=t.slice(0,1);'"'===v&&(d+=1),h+=v,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&d%2==0)&&(y=!1)}h=h.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(t){return new Array(Math.floor(t.length/2)).fill('"').join("")}))}else{var m=t.match(o);h=m?m[0]:"",t=t.slice(h.length)}e[f][c]=h}return e}function f(t){var e,n,r,o,l,c="";for(e=0,n=t.length;e<n;e+=1){for(o=t[e].length,r=0;r<o;r+=1)r>0&&(c+="\t"),"string"==typeof(l=t[e][r])?l.indexOf("\n")>-1?c+='"'.concat(l.replace(/"/g,'""'),'"'):c+=l:c+=null==l?"":l;e!==n-1&&(c+="\n")}return c}},1065:function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));n(239),n(242),n(6),n(40),n(44),n(307),n(12),n(36),n(115),n(669),n(196),n(793),n(656),n(657),n(11),n(62),n(26),n(74),n(55),n(33),n(56),n(34);var r=n(664),o=n(665),l=n(731),c=n(723),f=n(693),h=n(724),d=n(725);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function v(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function w(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==y(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===y(o)?o:String(o)),n)}var r,o}function O(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}var S=new Map([["plugin",l.c],["cell-type",c.c],["editor",f.d],["renderer",h.c],["validator",d.c]]),C=new WeakMap,E=[],R=null,k=new WeakSet,j=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),O(this,k),Object(r.defineGetter)(this,"hot",e,{writable:!1}),C.set(this,{hooks:{}}),R=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(t){return n.onUpdateSettings(t)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}var e,n,c;return e=t,c=[{key:"PLUGIN_KEY",get:function(){return"base"}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}],(n=[{key:"init",value:function(){var t=this;this.pluginName=this.hot.getPluginName(this);var e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){var r=[];if(n.forEach((function(t){var e=v(t.split(":"),2),n=e[0],o=e[1];if(!S.has(n))throw new Error('Unknown plugin dependency type "'.concat(n,'" was found.'));S.get(n)(o)||r.push(" - ".concat(o," (").concat(n,")"))})),r.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(r.join("\n"),"\n")].join("");E.push(o)}}if(R||(R=Object(l.b)()),R.indexOf("UndoRedo")>=0&&R.splice(R.indexOf("UndoRedo"),1),R.indexOf(this.pluginName)>=0&&R.splice(R.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){t.isEnabled&&t.isEnabled()&&t.enablePlugin()})),0===R.length){if(E.length>0){var c=["".concat(E.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(c)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,e){C.get(this).hooks[t]=C.get(this).hooks[t]||[];var n=C.get(this).hooks[t];this.hot.addHook(t,e),n.push(e),C.get(this).hooks[t]=n}},{key:"removeHooks",value:function(t){var e=this;Object(o.arrayEach)(C.get(this).hooks[t]||[],(function(n){e.hot.removeHook(t,n)}))}},{key:"clearHooks",value:function(){var t=this,e=C.get(this).hooks;Object(r.objectEach)(e,(function(e,n){return t.removeHooks(n)})),e.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){Object(o.arrayEach)(this.pluginsInitializedCallbacks,(function(t){return t()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(t){var e=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,k,T).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(r.objectEach)(this,(function(e,n){"hot"!==n&&(t[n]=null)})),delete this.t,delete this.hot}}])&&w(e.prototype,n),c&&w(e,c),Object.defineProperty(e,"prototype",{writable:!1}),t}();function T(t){if(!t)return!1;var e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(var i=0;i<e.length;i++)if(void 0!==t[e[i]])return!0;return!1}},1163:function(t,e,n){"use strict";n.d(e,"a",(function(){return M}));n(669),n(419),n(420),n(6),n(130),n(670),n(16),n(656),n(657),n(11),n(62),n(26),n(74),n(239),n(40),n(44),n(55),n(33),n(56),n(34);var r=n(1008),o=n(683),l=n(715),c=n(666),f=n(677),h=n(728);n(54);function d(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},body=document.body,text=document.createTextNode(""),span=document.createElement("SPAN"),n=function(element,t,e){element.addEventListener(t,e,!1)},r=function(element,t,e){element.removeEventListener(t,e,!1)},o=function(n){var r,o;n?/^[a-zA-Z \.,\\\/\|0-9]$/.test(n)||(n="."):n="",void 0!==text.textContent?text.textContent=t.value+n:text.data=t.value+n,span.style.position="absolute",span.style.fontSize=f(t).fontSize,span.style.fontFamily=f(t).fontFamily,span.style.whiteSpace="pre",body.appendChild(span),r=span.clientWidth+2,body.removeChild(span),t.style.height=e.minHeight+"px",e.minWidth>r?t.style.width=e.minWidth+"px":r>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=r+"px",o=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>o?t.style.height=e.minHeight+"px":e.maxHeight<o?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=o+"px"},l=function(){window.setTimeout(o,0)},c=function(r,c,f){t=r,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)e.minHeight=t.clientHeight;else{var r=parseInt(n.minHeight);isNaN(r)||(e.minHeight=r)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)e.maxHeight=t.clientHeight;else{var o=parseInt(n.maxHeight);isNaN(o)||(e.maxHeight=o)}if(n&&n.minWidth)if("inherit"==n.minWidth)e.minWidth=t.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(e.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)e.maxWidth=t.clientWidth;else{var c=parseInt(n.maxWidth);isNaN(c)||(e.maxWidth=c)}span.firstChild||(span.className="autoResize",span.style.display="inline-block",span.appendChild(text))}(c),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),f&&(n(t,"change",o),n(t,"cut",l),n(t,"paste",l),n(t,"drop",l),n(t,"keydown",l),n(t,"focus",o),n(t,"compositionstart",l),n(t,"compositionupdate",l),n(t,"compositionend",l)),o()};function f(element){return element.currentStyle||document.defaultView.getComputedStyle(element)}return{init:function(t,e,n){c(t,e,n)},unObserve:function(){r(t,"change",o),r(t,"cut",l),r(t,"paste",l),r(t,"drop",l),r(t,"keydown",l),r(t,"focus",o),r(t,"compositionstart",l),r(t,"compositionupdate",l),r(t,"compositionend",l)},resize:o}}var y=n(673),v=n(766);function m(t,e){for(var n=Object(c.getCaretPosition)(e),r=e.value.split("\n"),o=n,l=0,i=0;i<r.length;i++){var f=r[i];0!==i&&(l+=r[i-1].length+1);var h=l+f.length;if("home"===t?o=l:"end"===t&&(o=h),n<=h)break}Object(c.setCaretPosition)(e,o)}function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function O(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function C(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==w(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===w(o)?o:String(o)),n)}var r,o}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=T(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},E.apply(this,arguments)}function R(t,p){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},R(t,p)}function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=T(t);if(e){var o=T(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return j(t)}(this,n)}}function j(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}var P="ht_editor_hidden",A="textEditor",M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(M,t);var e,n,w,S=k(M);function M(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,M),(e=S.call(this,t)).eventManager=new o.a(j(e)),e.autoResize=d(),e.TEXTAREA=void 0,e.textareaStyle=void 0,e.TEXTAREA_PARENT=void 0,e.textareaParentStyle=void 0,e.layerClass=void 0,e.createElements(),e.bindEvents(),e.hot.addHookOnce("afterDestroy",(function(){return e.destroy()})),e}return e=M,n=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(t){this.TEXTAREA.value=t}},{key:"open",value:function(){var t=this;this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(e){return t.onAfterDocumentKeyDown(e)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(t,col,e,td,n,o){var c=this.state;if(E(T(M.prototype),"prepare",this).call(this,t,col,e,td,n,o),!o.readOnly){this.refreshDimensions(!0);var f=o.allowInvalid,h=o.fragmentSelection;f&&(this.TEXTAREA.value=""),c!==r.b.FINISHED&&this.hideEditableElement(),!h&&!Object(l.isMobileBrowser)()&&this.focus()}}},{key:"beginEditing",value:function(t,e){this.state===r.b.VIRGIN&&(this.TEXTAREA.value="",E(T(M.prototype),"beginEditing",this).call(this,t,e))}},{key:"focus",value:function(){this.TEXTAREA.select(),Object(c.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Object(c.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Object(c.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),Object(c.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&Object(c.removeClass)(this.TEXTAREA_PARENT,this.layerClass),Object(c.addClass)(this.TEXTAREA_PARENT,P),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Object(l.isIE)()||Object(l.isEdge)())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Object(c.removeClass)(this.TEXTAREA_PARENT,this.layerClass),Object(c.addClass)(this.TEXTAREA_PARENT,P)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var t=this.TEXTAREA_PARENT.childNodes,e=!1;Object(f.rangeEach)(t.length-1,(function(n){var r=t[n];if(Object(c.hasClass)(r,"handsontableEditor"))return e=!0,!1})),Object(c.hasClass)(this.TEXTAREA_PARENT,P)&&Object(c.removeClass)(this.TEXTAREA_PARENT,P),e?(this.layerClass="ht_editor_visible",Object(c.addClass)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Object(c.addClass)(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===r.b.EDITING||t)if(this.TD=this.getEditedCell(),this.TD){var e=this.getEditedCellRect(),n=e.top,o=e.start,l=e.width,f=e.maxWidth,h=e.height,d=e.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),this.showEditableElement();var y=Object(c.getComputedStyle)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=y.fontSize,this.TEXTAREA.style.fontFamily=y.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var v=Object(c.getComputedStyle)(this.TEXTAREA),m=parseInt(v.paddingLeft,10)+parseInt(v.paddingRight,10),w=parseInt(v.paddingTop,10)+parseInt(v.paddingBottom,10),O=l-m,S=h-w,C=f-m,E=d-w;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(O,C),minHeight:Math.min(S,E),maxWidth:C,maxHeight:E},!0)}else t||this.close()}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(t){return t.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(t){return t.stopPropagation()})),Object(l.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return t.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){t.refreshDimensions(),t.focus()})),this.addHook("afterRowResize",(function(){t.refreshDimensions(),t.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:function(){return Object(y.isDefined)(t.hot.getSelected())},group:A},r=function(){t.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"]],callback:function(e){var n=t.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var n=t.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(e){return!t.hot.selection.isMultiple()&&!e.altKey},relativeToGroup:v.a,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(){return!t.hot.selection.isMultiple()},relativeToGroup:v.a,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return r(),!1},relativeToGroup:v.a,position:"before"},{keys:[["PageUp"]],callback:function(){t.hot.selection.transformStart(-t.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){t.hot.selection.transformStart(t.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(e,n){m(O(n,1)[0],t.TEXTAREA)}},{keys:[["End"]],callback:function(e,n){m(O(n,1)[0],t.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout((function(){t.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout((function(){t.autoResize.resize()}),10)}}],n)}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(v.b),t.removeShortcutsByGroup(A),t.removeShortcutsByGroup(r.c)}},{key:"onAfterDocumentKeyDown",value:function(t){-1===[h.KEY_CODES.ARROW_UP,h.KEY_CODES.ARROW_RIGHT,h.KEY_CODES.ARROW_DOWN,h.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}],w=[{key:"EDITOR_TYPE",get:function(){return"text"}}],n&&C(e.prototype,n),w&&C(e,w),Object.defineProperty(e,"prototype",{writable:!1}),M}(r.a)},656:function(t,e,n){var r=n(334),o=n(431);r("toPrimitive"),o()},657:function(t,e,n){var r=n(42),o=n(58),l=n(933),c=n(35)("toPrimitive"),f=Date.prototype;r(f,c)||o(f,c,l)},664:function(t,e,n){"use strict";n.r(e),n.d(e,"duckSchema",(function(){return c})),n.d(e,"inherit",(function(){return f})),n.d(e,"extend",(function(){return h})),n.d(e,"deepExtend",(function(){return d})),n.d(e,"deepClone",(function(){return y})),n.d(e,"clone",(function(){return v})),n.d(e,"mixin",(function(){return m})),n.d(e,"isObjectEqual",(function(){return w})),n.d(e,"isObject",(function(){return O})),n.d(e,"defineGetter",(function(){return S})),n.d(e,"objectEach",(function(){return C})),n.d(e,"getProperty",(function(){return E})),n.d(e,"setProperty",(function(){return R})),n.d(e,"deepObjectSize",(function(){return k})),n.d(e,"createObjectPropListener",(function(){return j})),n.d(e,"hasOwnProperty",(function(){return T}));n(422),n(48),n(63),n(6),n(12),n(11),n(62),n(74),n(239),n(40),n(44),n(656),n(657),n(26);var r=n(665);function o(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(object){var t;return Array.isArray(object)?t=object.length?new Array(object.length).fill(null):[]:(t={},C(object,(function(e,n){"__children"!==n&&(e&&"object"===l(e)&&!Array.isArray(e)?t[n]=c(e):Array.isArray(e)?e.length&&"object"===l(e[0])&&!Array.isArray(e[0])?t[n]=[c(e[0])]:t[n]=[]:t[n]=null)}))),t}function f(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function h(t,e,n){var r=Array.isArray(n);return C(e,(function(e,o){(!1===r||n.includes(o))&&(t[o]=e)})),t}function d(t,e){C(e,(function(n,r){e[r]&&"object"===l(e[r])?(t[r]||(Array.isArray(e[r])?t[r]=[]:"[object Date]"===Object.prototype.toString.call(e[r])?t[r]=e[r]:t[r]={}),d(t[r],e[r])):t[r]=e[r]}))}function y(t){return"object"===l(t)?JSON.parse(JSON.stringify(t)):t}function v(object){var t={};return C(object,(function(e,n){t[n]=e})),t}function m(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(r.arrayEach)(n,(function(e){t.MIXINS.push(e.MIXIN_NAME),C(e,(function(e,n){if(void 0!==t.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"==typeof e)t.prototype[n]=e;else{Object.defineProperty(t.prototype,n,{get:(r=n,o=e,l="_".concat(r),function(){var t;return void 0===this[l]&&(this[l]=(t=o,(Array.isArray(t)||O(t))&&(t=y(t)),t)),this[l]}),set:function(t){var e="_".concat(t);return function(t){this[e]=t}}(n),configurable:!0})}var r,o,l}))})),t}function w(t,e){return JSON.stringify(t)===JSON.stringify(e)}function O(object){return"[object Object]"===Object.prototype.toString.call(object)}function S(object,t,e,n){n.value=e,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(object,t,n)}function C(object,t){for(var e in object)if((!object.hasOwnProperty||object.hasOwnProperty&&Object.prototype.hasOwnProperty.call(object,e))&&!1===t(object[e],e,object))break;return object}function E(object,t){var e=t.split("."),n=object;return C(e,(function(t){if(void 0===(n=n[t]))return n=void 0,!1})),n}function R(object,t,e){var n=t.split("."),r=object;n.forEach((function(t,o){o!==n.length-1?(T(r,t)||(r[t]={}),r=r[t]):r[t]=e}))}function k(object){if(!O(object))return 0;return function t(e){var n=0;return O(e)?C(e,(function(e,r){"__children"!==r&&(n+=t(e))})):n+=1,n}(object)}function j(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),l=(o(e={_touched:!1},r,t),o(e,"isTouched",(function(){return this._touched})),e);return Object.defineProperty(l,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),l}function T(object,t){return Object.prototype.hasOwnProperty.call(object,t)}},665:function(t,e,n){"use strict";n.r(e),n.d(e,"to2dArray",(function(){return r})),n.d(e,"extendArray",(function(){return o})),n.d(e,"pivot",(function(){return l})),n.d(e,"arrayReduce",(function(){return c})),n.d(e,"arrayFilter",(function(){return f})),n.d(e,"arrayMap",(function(){return h})),n.d(e,"arrayEach",(function(){return d})),n.d(e,"arraySum",(function(){return y})),n.d(e,"arrayMax",(function(){return v})),n.d(e,"arrayMin",(function(){return m})),n.d(e,"arrayAvg",(function(){return w})),n.d(e,"arrayFlatten",(function(){return O})),n.d(e,"arrayUnique",(function(){return S})),n.d(e,"getDifferenceOfArrays",(function(){return C})),n.d(e,"getIntersectionOfArrays",(function(){return E})),n.d(e,"getUnionOfArrays",(function(){return R})),n.d(e,"stringToArray",(function(){return k}));n(56),n(40),n(36),n(669),n(55),n(13),n(6),n(48),n(63),n(239),n(682),n(44),n(34),n(250);function r(t){for(var e=t.length,i=0;i<e;)t[i]=[t[i]],i+=1}function o(t,e){for(var n=e.length,i=0;i<n;)t.push(e[i]),i+=1}function l(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,r=t[0].length,i=0;i<n;i++)for(var o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function c(t,e,n,r){var o=-1,l=t,c=n;Array.isArray(t)||(l=Array.from(t));var f=l.length;for(r&&f&&(c=l[o+=1]),o+=1;o<f;)c=e(c,l[o],o,l),o+=1;return c}function f(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length,l=[],c=-1;n<o;){var f=r[n];e(f,n,r)&&(l[c+=1]=f),n+=1}return l}function h(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length,l=[],c=-1;n<o;){var f=r[n];l[c+=1]=e(f,n,r),n+=1}return l}function d(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length;n<o&&!1!==e(r[n],n,r);)n+=1;return t}function y(t){return c(t,(function(a,b){return a+b}),0)}function v(t){return c(t,(function(a,b){return a>b?a:b}),Array.isArray(t)?t[0]:void 0)}function m(t){return c(t,(function(a,b){return a<b?a:b}),Array.isArray(t)?t[0]:void 0)}function w(t){return t.length?y(t)/t.length:0}function O(t){return c(t,(function(t,e){return t.concat(Array.isArray(e)?O(e):e)}),[])}function S(t){var e=[];return d(t,(function(t){-1===e.indexOf(t)&&e.push(t)})),e}function C(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],l=r.slice(1),c=o;return d(l,(function(t){c=c.filter((function(e){return!t.includes(e)}))})),c}function E(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],l=r.slice(1),c=o;return d(l,(function(t){c=c.filter((function(e){return t.includes(e)}))})),c}function R(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],l=r.slice(1),c=new Set(o);return d(l,(function(t){d(t,(function(t){c.has(t)||c.add(t)}))})),Array.from(c)}function k(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}},666:function(t,e,n){"use strict";n.r(e),n.d(e,"getParent",(function(){return v})),n.d(e,"getFrameElement",(function(){return m})),n.d(e,"getParentWindow",(function(){return w})),n.d(e,"hasAccessToParentWindow",(function(){return O})),n.d(e,"closest",(function(){return S})),n.d(e,"closestDown",(function(){return C})),n.d(e,"isChildOf",(function(){return E})),n.d(e,"index",(function(){return R})),n.d(e,"overlayContainsElement",(function(){return k})),n.d(e,"hasClass",(function(){return A})),n.d(e,"addClass",(function(){return M})),n.d(e,"removeClass",(function(){return _})),n.d(e,"removeTextNodes",(function(){return x})),n.d(e,"empty",(function(){return I})),n.d(e,"HTML_CHARACTERS",(function(){return H})),n.d(e,"fastInnerHTML",(function(){return D})),n.d(e,"fastInnerText",(function(){return L})),n.d(e,"isVisible",(function(){return B})),n.d(e,"offset",(function(){return F})),n.d(e,"getWindowScrollTop",(function(){return V})),n.d(e,"getWindowScrollLeft",(function(){return W})),n.d(e,"getScrollTop",(function(){return U})),n.d(e,"getScrollLeft",(function(){return z})),n.d(e,"getScrollableElement",(function(){return G})),n.d(e,"getTrimmingContainer",(function(){return Y})),n.d(e,"getStyle",(function(){return X})),n.d(e,"matchesCSSRules",(function(){return K})),n.d(e,"getComputedStyle",(function(){return $})),n.d(e,"outerWidth",(function(){return Q})),n.d(e,"outerHeight",(function(){return J})),n.d(e,"innerHeight",(function(){return Z})),n.d(e,"innerWidth",(function(){return tt})),n.d(e,"addEvent",(function(){return et})),n.d(e,"removeEvent",(function(){return nt})),n.d(e,"getCaretPosition",(function(){return ot})),n.d(e,"getSelectionEndPosition",(function(){return it})),n.d(e,"getSelectionText",(function(){return at})),n.d(e,"clearTextSelection",(function(){return lt})),n.d(e,"setCaretPosition",(function(){return st})),n.d(e,"getScrollbarWidth",(function(){return ut})),n.d(e,"hasVerticalScrollbar",(function(){return ct})),n.d(e,"hasHorizontalScrollbar",(function(){return ft})),n.d(e,"setOverlayPosition",(function(){return ht})),n.d(e,"getCssTransform",(function(){return pt})),n.d(e,"resetCssTransform",(function(){return yt})),n.d(e,"isInput",(function(){return bt})),n.d(e,"isOutsideInput",(function(){return vt})),n.d(e,"selectElementIfAllowed",(function(){return mt})),n.d(e,"isDetached",(function(){return gt})),n.d(e,"observeVisibilityChangeOnce",(function(){return wt}));n(420),n(48),n(63),n(55),n(669),n(13),n(6),n(245),n(34),n(86),n(115),n(85),n(64),n(36),n(12),n(11),n(62),n(74),n(239),n(40),n(44),n(56),n(33);var r,o,l,c=n(727),f=n(715),h=n(700);function d(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function v(element){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=-1,n=null,r=element;null!==r;){if(e===t){n=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(e+=1,r=r.parentNode)}return n}function m(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function w(t){return m(t)&&t.parent}function O(t){return!!Object.getPrototypeOf(t.parent)}function S(element){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=Node,r=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,l=element;null!=l&&l!==e;){var c=l,f=c.nodeType,h=c.nodeName;if(f===r&&(t.includes(h)||t.includes(l)))return l;var d=l.host;l=d&&f===o?d:l.parentNode}return null}function C(element,t,e){for(var n=[],r=element;r&&(r=S(r,t,e))&&(!e||e.contains(r));)n.push(r),r=r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r.parentNode;var o=n.length;return o?n[o-1]:null}function E(t,e){var n=t.parentNode,r=[];for("string"==typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function R(element){var i=0,t=element;if(t.previousSibling)for(;t=t.previousSibling;)i+=1;return i}function k(t,element,e){var n=e.parentElement.querySelector(".ht_clone_".concat(t));return n?n.contains(element):null}function j(t){return t&&t.length?t.filter((function(t){return!!t})):[]}if(Object(c.isClassListSupported)()){var T=function(t){var element=t.createElement("div");return element.classList.add("test","test2"),element.classList.contains("test2")};r=function(element,t){return void 0!==element.classList&&"string"==typeof t&&""!==t&&element.classList.contains(t)},o=function(element,t){var e,n=element.ownerDocument,r=t;if("string"==typeof r&&(r=r.split(" ")),(r=j(r)).length>0)if(T(n))(e=element.classList).add.apply(e,d(r));else for(var o=0;r[o];)element.classList.add(r[o]),o+=1},l=function(element,t){var e,n=element.ownerDocument,r=t;if("string"==typeof r&&(r=r.split(" ")),(r=j(r)).length>0)if(T(n))(e=element.classList).remove.apply(e,d(r));else for(var o=0;r[o];)element.classList.remove(r[o]),o+=1}}else{var P=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};r=function(element,t){return void 0!==element.className&&P(t).test(element.className)},o=function(element,t){var e=element.className,n=t;if("string"==typeof n&&(n=n.split(" ")),n=j(n),""===e)e=n.join(" ");else for(var r=0;r<n.length;r++)n[r]&&!P(n[r]).test(e)&&(e+=" ".concat(n[r]));element.className=e},l=function(element,t){var e=0,n=element.className,r=t;for("string"==typeof r&&(r=r.split(" ")),r=j(r);r[e];)n=n.replace(P(r[e])," ").trim(),e+=1;element.className!==n&&(element.className=n)}}function A(element,t){return r(element,t)}function M(element,t){o(element,t)}function _(element,t){l(element,t)}function x(element){if(3===element.nodeType)element.parentNode.removeChild(element);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(element.nodeName)>-1)for(var t=element.childNodes,i=t.length-1;i>=0;i--)x(t[i])}function I(element){for(var t;t=element.lastChild;)element.removeChild(t)}var N,H=/(<(.*)>|&(.*);)/;function D(element,content){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];H.test(content)?element.innerHTML=t?Object(h.sanitize)(content):content:L(element,content)}function L(element,content){var t=element.firstChild;t&&3===t.nodeType&&null===t.nextSibling?c.isTextContentSupported?t.textContent=content:t.data=content:(I(element),element.appendChild(element.ownerDocument.createTextNode(content)))}function B(element){for(var t=element.ownerDocument.documentElement,e=element;e!==t;){if(null===e)return!1;if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(e.host){if(e.host.impl)return B(e.host.impl);if(e.host)return B(e.host);throw new Error("Lost in Web Components world")}return!1}if(e.style&&"none"===e.style.display)return!1;e=e.parentNode}return!0}function F(element){var t,e,n,r,o=element.ownerDocument,l=o.defaultView,f=o.documentElement,h=element;if(Object(c.hasCaptionProblem)()&&h.firstChild&&"CAPTION"===h.firstChild.nodeName)return{top:(r=h.getBoundingClientRect()).top+(l.pageYOffset||f.scrollTop)-(f.clientTop||0),left:r.left+(l.pageXOffset||f.scrollLeft)-(f.clientLeft||0)};for(t=h.offsetLeft,e=h.offsetTop,n=h;(h=h.offsetParent)&&h!==o.body;)t+=h.offsetLeft,e+=h.offsetTop,n=h;return n&&"fixed"===n.style.position&&(t+=l.pageXOffset||f.scrollLeft,e+=l.pageYOffset||f.scrollTop),{left:t,top:e}}function V(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollY;return void 0===e&&(e=t.document.documentElement.scrollTop),e}function W(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollX;return void 0===e&&(e=t.document.documentElement.scrollLeft),e}function U(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===t?V(t):element.scrollTop}function z(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===t?W(t):element.scrollLeft}function G(element){var t=element.ownerDocument,e=t?t.defaultView:void 0;t||(e=(t=element.document?element.document:element).defaultView);for(var n=["auto","scroll"],r=Object(c.isGetComputedStyleSupported)(),o=element.parentNode;o&&o.style&&t.body!==o;){var l=o.style,f=l.overflow,h=l.overflowX,d=l.overflowY;if([f,h,d].includes("scroll"))return o;if(r){var y=e.getComputedStyle(o);if(f=y.overflow,h=y.overflowX,d=y.overflowY,n.includes(f)||n.includes(h)||n.includes(d))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(d)||n.includes(f)))return o;if(o.clientWidth<=o.scrollWidth+1&&(n.includes(h)||n.includes(f)))return o;o=o.parentNode}return e}function Y(base){for(var t=base.ownerDocument,e=t.defaultView,n=base.parentNode;n&&n.style&&t.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;var r=$(n,e),o=["scroll","hidden","auto"],l=r.getPropertyValue("overflow"),c=r.getPropertyValue("overflow-y"),f=r.getPropertyValue("overflow-x");if(o.includes(l)||o.includes(c)||o.includes(f))return n;n=n.parentNode}return e}function X(element,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(element){if(element===e)return"width"===t?"".concat(e.innerWidth,"px"):"height"===t?"".concat(e.innerHeight,"px"):void 0;var n=element.style[t];if(""!==n&&void 0!==n)return n;var r=$(element,e);return""!==r[t]&&void 0!==r[t]?r[t]:void 0}}function K(element,t){var e=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&e&&(element.msMatchesSelector?n=element.msMatchesSelector(e):element.matches&&(n=element.matches(e))),n}function $(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element.currentStyle||t.getComputedStyle(element)}function Q(element){return element.offsetWidth}function J(element){return Object(c.hasCaptionProblem)()&&element.firstChild&&"CAPTION"===element.firstChild.nodeName?element.offsetHeight+element.firstChild.offsetHeight:element.offsetHeight}function Z(element){return element.clientHeight||element.innerHeight}function tt(element){return element.clientWidth||element.innerWidth}function et(element,t,e){element.addEventListener(t,e,!1)}function nt(element,t,e){element.removeEventListener(t,e,!1)}function ot(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var n=e.selection.createRange();if(null===n)return 0;var r=t.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function it(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var n=e.selection.createRange();return null===n?0:t.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function at(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,text="";return t.getSelection?text=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(text=e.selection.createRange().text),text}function lt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function st(element,t,e){if(void 0===e&&(e=t),element.setSelectionRange){element.focus();try{element.setSelectionRange(t,e)}catch(o){var n=element.parentNode,r=n.style.display;n.style.display="block",element.setSelectionRange(t,e),n.style.display=r}}}function ut(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===N&&(N=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);var r=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;return r===o&&(o=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-o}(t)),N}function ct(element){return element.offsetWidth!==element.clientWidth}function ft(element){return element.offsetHeight!==element.clientHeight}function ht(t,e,n){Object(f.isIE9)()?(t.style.top=n,t.style.left=e):Object(f.isSafari)()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(n,",0)"):t.style.transform="translate3d(".concat(e,",").concat(n,",0)")}function pt(element){var t;return element.style.transform&&""!==(t=element.style.transform)?["transform",t]:element.style["-webkit-transform"]&&""!==(t=element.style["-webkit-transform"])?["-webkit-transform",t]:-1}function yt(element){element.style.transform&&""!==element.style.transform?element.style.transform="":element.style["-webkit-transform"]&&""!==element.style["-webkit-transform"]&&(element.style["-webkit-transform"]="")}function bt(element){return element&&(["INPUT","SELECT","TEXTAREA"].indexOf(element.nodeName)>-1||"true"===element.contentEditable)}function vt(element){return bt(element)&&!1===element.hasAttribute("data-hot-input")}function mt(element){vt(element.ownerDocument.activeElement)||element.select()}function gt(element){return!element.parentNode}function wt(t,e){new IntersectionObserver((function(n,r){n.forEach((function(n){n.isIntersecting&&null!==t.offsetParent&&(e(),r.unobserve(t))}))}),{root:t.ownerDocument.body}).observe(t)}},667:function(t,e,n){"use strict";n.r(e),n.d(e,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return r})),n.d(e,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return l})),n.d(e,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return c})),n.d(e,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return f})),n.d(e,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return h})),n.d(e,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return d})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return y})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return v})),n.d(e,"CONTEXTMENU_ITEMS_UNDO",(function(){return m})),n.d(e,"CONTEXTMENU_ITEMS_REDO",(function(){return w})),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return O})),n.d(e,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return S})),n.d(e,"CONTEXTMENU_ITEMS_COPY",(function(){return C})),n.d(e,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS",(function(){return E})),n.d(e,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS",(function(){return R})),n.d(e,"CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY",(function(){return k})),n.d(e,"CONTEXTMENU_ITEMS_CUT",(function(){return j})),n.d(e,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return T})),n.d(e,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return P})),n.d(e,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return A})),n.d(e,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return M})),n.d(e,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return _})),n.d(e,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return x})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return I})),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return N})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return H})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return D})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return L})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return B})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return F})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return V})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return W})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return U})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS",(function(){return z})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return G})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return Y})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return X})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return K})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return $})),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return Q})),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return J})),n.d(e,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return Z})),n.d(e,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return tt})),n.d(e,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return et})),n.d(e,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return nt})),n.d(e,"FILTERS_NAMESPACE",(function(){return ot})),n.d(e,"FILTERS_CONDITIONS_NAMESPACE",(function(){return it})),n.d(e,"FILTERS_CONDITIONS_NONE",(function(){return at})),n.d(e,"FILTERS_CONDITIONS_EMPTY",(function(){return lt})),n.d(e,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return st})),n.d(e,"FILTERS_CONDITIONS_EQUAL",(function(){return ut})),n.d(e,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return ct})),n.d(e,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return ft})),n.d(e,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return ht})),n.d(e,"FILTERS_CONDITIONS_CONTAINS",(function(){return pt})),n.d(e,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return yt})),n.d(e,"FILTERS_CONDITIONS_BY_VALUE",(function(){return bt})),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return vt})),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return mt})),n.d(e,"FILTERS_CONDITIONS_LESS_THAN",(function(){return gt})),n.d(e,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return wt})),n.d(e,"FILTERS_CONDITIONS_BETWEEN",(function(){return Ot})),n.d(e,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return St})),n.d(e,"FILTERS_CONDITIONS_AFTER",(function(){return Ct})),n.d(e,"FILTERS_CONDITIONS_BEFORE",(function(){return Et})),n.d(e,"FILTERS_CONDITIONS_TODAY",(function(){return Rt})),n.d(e,"FILTERS_CONDITIONS_TOMORROW",(function(){return kt})),n.d(e,"FILTERS_CONDITIONS_YESTERDAY",(function(){return jt})),n.d(e,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return Tt})),n.d(e,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return Pt})),n.d(e,"FILTERS_LABELS_CONJUNCTION",(function(){return At})),n.d(e,"FILTERS_LABELS_DISJUNCTION",(function(){return Mt})),n.d(e,"FILTERS_VALUES_BLANK_CELLS",(function(){return _t})),n.d(e,"FILTERS_BUTTONS_SELECT_ALL",(function(){return xt})),n.d(e,"FILTERS_BUTTONS_CLEAR",(function(){return It})),n.d(e,"FILTERS_BUTTONS_OK",(function(){return Nt})),n.d(e,"FILTERS_BUTTONS_CANCEL",(function(){return Ht})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return Dt})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return Lt})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return Bt}));var r="ContextMenu:items",o=r,l="".concat(o,".noItems"),c="".concat(o,".insertRowAbove"),f="".concat(o,".insertRowBelow"),h="".concat(o,".insertColumnOnTheLeft"),d="".concat(o,".insertColumnOnTheRight"),y="".concat(o,".removeRow"),v="".concat(o,".removeColumn"),m="".concat(o,".undo"),w="".concat(o,".redo"),O="".concat(o,".readOnly"),S="".concat(o,".clearColumn"),C="".concat(o,".copy"),E="".concat(o,".copyWithHeaders"),R="".concat(o,".copyWithGroupHeaders"),k="".concat(o,".copyHeadersOnly"),j="".concat(o,".cut"),T="".concat(o,".freezeColumn"),P="".concat(o,".unfreezeColumn"),A="".concat(o,".mergeCells"),M="".concat(o,".unmergeCells"),_="".concat(o,".addComment"),x="".concat(o,".editComment"),I="".concat(o,".removeComment"),N="".concat(o,".readOnlyComment"),H="".concat(o,".align"),D="".concat(o,".align.left"),L="".concat(o,".align.center"),B="".concat(o,".align.right"),F="".concat(o,".align.justify"),V="".concat(o,".align.top"),W="".concat(o,".align.middle"),U="".concat(o,".align.bottom"),z="".concat(o,".borders"),G="".concat(o,".borders.top"),Y="".concat(o,".borders.right"),X="".concat(o,".borders.bottom"),K="".concat(o,".borders.left"),$="".concat(o,".borders.remove"),Q="".concat(o,".nestedHeaders.insertChildRow"),J="".concat(o,".nestedHeaders.detachFromParent"),Z="".concat(o,".hideColumn"),tt="".concat(o,".showColumn"),et="".concat(o,".hideRow"),nt="".concat(o,".showRow"),ot="Filters:",it="".concat(ot,"conditions"),at="".concat(it,".none"),lt="".concat(it,".isEmpty"),st="".concat(it,".isNotEmpty"),ut="".concat(it,".isEqualTo"),ct="".concat(it,".isNotEqualTo"),ft="".concat(it,".beginsWith"),ht="".concat(it,".endsWith"),pt="".concat(it,".contains"),yt="".concat(it,".doesNotContain"),bt="".concat(it,".byValue"),vt="".concat(it,".greaterThan"),mt="".concat(it,".greaterThanOrEqualTo"),gt="".concat(it,".lessThan"),wt="".concat(it,".lessThanOrEqualTo"),Ot="".concat(it,".isBetween"),St="".concat(it,".isNotBetween"),Ct="".concat(it,".after"),Et="".concat(it,".before"),Rt="".concat(it,".today"),kt="".concat(it,".tomorrow"),jt="".concat(it,".yesterday"),Tt="".concat(ot,"labels.filterByCondition"),Pt="".concat(ot,"labels.filterByValue"),At="".concat(ot,"labels.conjunction"),Mt="".concat(ot,"labels.disjunction"),_t="".concat(ot,"values.blankCells"),xt="".concat(ot,"buttons.selectAll"),It="".concat(ot,"buttons.clear"),Nt="".concat(ot,"buttons.ok"),Ht="".concat(ot,"buttons.cancel"),Dt="".concat(ot,"buttons.placeholder.search"),Lt="".concat(ot,"buttons.placeholder.value"),Bt="".concat(ot,"buttons.placeholder.secondValue")},669:function(t,e,n){"use strict";var r=n(7),o=n(203),l=n(333).indexOf,c=n(247),f=o([].indexOf),h=!!f&&1/f([1],1,-0)<0;r({target:"Array",proto:!0,forced:h||!c("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return h?f(this,t,e)||0:l(this,t,e)}})},670:function(t,e,n){var r=n(7),o=n(38),l=n(46),c=n(37),f=n(936),h=n(104),d=n(204);r({target:"Reflect",stat:!0},{get:function t(e,n){var r,y,v=arguments.length<3?e:arguments[2];return c(e)===v?e[n]:(r=h.f(e,n))?f(r)?r.value:void 0===r.get?void 0:o(r.get,v):l(y=d(e))?t(y,n,v):void 0}})},673:function(t,e,n){"use strict";n.r(e),n.d(e,"stringify",(function(){return w})),n.d(e,"isDefined",(function(){return O})),n.d(e,"isUndefined",(function(){return S})),n.d(e,"isEmpty",(function(){return C})),n.d(e,"isRegExp",(function(){return E})),n.d(e,"_injectProductInfo",(function(){return H}));n(55),n(244),n(6),n(86),n(934),n(34),n(64),n(662),n(11),n(62),n(74),n(239),n(40),n(44);var r,o,l,c,f,h,d=n(246),y=n(690);function v(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function w(t){var e;switch(m(t)){case"string":case"number":e="".concat(t);break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function O(t){return void 0!==t}function S(t){return void 0===t}function C(t){return null===t||""===t||S(t)}function E(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var R="length",k=function(t){return parseInt(t,16)},j=function(t){return parseInt(t,10)},T=function(t,s,e){return t.substr(s,e)},P=function(t){return t.codePointAt(0)-65},A=function(t){return"".concat(t).replace(/\-/g,"")},M=function(t){return k(T(A(t),k("12"),P("F")))/(k(T(A(t),P("B"),~~![][R]))||9)},_=function(){return"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},x=!1,I={invalid:function(){return Object(y.a)(r||(r=v(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return Object(y.a)(o||(o=v(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),e,n,e)},missing:function(){return Object(y.a)(l||(l=v(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},N={invalid:function(){return Object(y.a)(c||(c=v(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return Object(y.a)(f||(f=v(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),e,n,e)},missing:function(){return Object(y.a)(h||(h=v(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function H(t,element){var e,n=!C(t),r="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),o="12.3.1",l="invalid",c="invalid",f=function(t){var e=[][R],p=e;if(t[R]!==P("Z"))return!1;for(var n="",i="B<H4P+".split(""),r=P(i.shift());r;r=P(i.shift()||"A"))--r<""[R]?p|=(j("".concat(j(k(n)+(k(T(t,Math.abs(r),2))+[]).padStart(2,"0"))))%97||2)>>1:n=T(t,r,r?1===i[R]?9:8:6);return p===e}(t=A(t||""));if(n||r||f)if(f){var h=d("06/02/2023","DD/MM/YYYY"),y=Math.floor(h.toDate().getTime()/864e5),v=M(t);e=d(864e5*(v+1),"x").format("MMMM DD, YYYY"),y>v?(l="expired",c="expired"):(l="valid",c="valid")}else r?(l="non_commercial",c="valid"):(l="invalid",c="invalid");else l="missing",c="missing";(_()&&(l="valid",c="valid"),x||"valid"===l)||(I[l]({keyValidityDate:e,hotVersion:o})&&console["non_commercial"===l?"info":"warn"](I[l]({keyValidityDate:e,hotVersion:o})),x=!0);if("valid"!==c&&element.parentNode&&N[c]({keyValidityDate:e,hotVersion:o})){var m=document.createElement("div");m.className="hot-display-license-info",m.innerHTML=N[c]({keyValidityDate:e,hotVersion:o}),element.parentNode.insertBefore(m,element.nextSibling)}}},677:function(t,e,n){"use strict";n.r(e),n.d(e,"isNumeric",(function(){return c})),n.d(e,"isNumericLike",(function(){return f})),n.d(e,"rangeEach",(function(){return h})),n.d(e,"rangeEachReverse",(function(){return d})),n.d(e,"valueAccordingPercent",(function(){return y}));n(34),n(115),n(84),n(56),n(40),n(239),n(6),n(682),n(44),n(36),n(245),n(86),n(85),n(64),n(11),n(62),n(74),n(55),n(33);function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=l(t);if("number"===n)return!isNaN(t)&&isFinite(t);if("string"===n){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);var o=Array.from(new Set(["."].concat(r(e)))).map((function(t){return"\\".concat(t)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(o,")?\\d+((").concat(o,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}return"object"===n&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)}function f(t){return c(t,[","])}function h(t,e,n){var r=-1;for("function"==typeof e?(n=e,e=t):r=t-1;++r<=e&&!1!==n(r););}function d(t,e,n){var r=t+1;for("function"==typeof e&&(n=e,e=0);--r>=e&&!1!==n(r););}function y(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}},682:function(t,e,n){n(817)},683:function(t,e,n){"use strict";n.d(e,"b",(function(){return d}));n(196),n(656),n(657),n(11),n(62),n(6),n(26),n(74),n(239),n(40),n(44);var r=n(727),o=n(691);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}var f=0,h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}var e,n,l;return e=t,n=[{key:"addEventListener",value:function(element,t,e){var n=this,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function c(t){e.call(this,function(t){var e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Object(o.stopImmediatePropagation)(this)},t}(t))}return"boolean"==typeof l||Object(r.isPassiveEventSupported)()||(l=!1),this.context.eventListeners.push({element:element,event:t,callback:e,callbackProxy:c,options:l,eventManager:this}),element.addEventListener(t,c,l),f+=1,function(){n.removeEventListener(element,t,e)}}},{key:"removeEventListener",value:function(element,t,e){for(var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;o;)if(o-=1,(n=this.context.eventListeners[o]).event===t&&n.element===element){if(e&&e!==n.callback)continue;if(r&&n.eventManager!==this)continue;this.context.eventListeners.splice(o,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),f-=1}}},{key:"clearEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var e=this.context.eventListeners.length;e;){e-=1;var n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),f-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(element,t){var e=element.document,n=element;e||(n=(e=element.ownerDocument?element.ownerDocument:element).defaultView);var r,o={bubbles:!0,cancelable:"mousemove"!==t,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};e.createEvent?(r=e.createEvent("MouseEvents")).initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||e.body.parentNode):r=e.createEventObject(),element.dispatchEvent?element.dispatchEvent(r):element.fireEvent("on".concat(t),r)}}],n&&c(e.prototype,n),l&&c(e,l),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(){return f}e.a=h},685:function(t,e,n){"use strict";n.r(e),n.d(e,"isFunction",(function(){return l})),n.d(e,"throttle",(function(){return c})),n.d(e,"throttleAfterHits",(function(){return f})),n.d(e,"debounce",(function(){return h})),n.d(e,"pipe",(function(){return d})),n.d(e,"partial",(function(){return y})),n.d(e,"curry",(function(){return v})),n.d(e,"curryRight",(function(){return m})),n.d(e,"fastCall",(function(){return w}));n(54),n(55),n(36),n(765);var r=n(665),o=n(673);function l(t){return"function"==typeof t}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;return function(){for(var l=this,c=arguments.length,f=new Array(c),h=0;h<c;h++)f[h]=arguments[h];var d=Date.now(),y=!1;r.lastCallThrottled=!0,n||(n=d,y=!0);var v=e-(d-n);return y?(r.lastCallThrottled=!1,t.apply(this,f)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,t.apply(l,f),n=0,o=void 0}),v)),r}}function f(t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=c(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:200),r=e;function o(){for(var e=arguments.length,o=new Array(e),l=0;l<e;l++)o[l]=arguments[l];return r?(r-=1,t.apply(this,o)):n.apply(this,o)}return o.clearHits=function(){r=e},o}function h(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var o=this,l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return r&&clearTimeout(r),r=setTimeout((function(){e=t.apply(o,c)}),n),e}}function d(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e[0],l=e.slice(1);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Object(r.arrayReduce)(l,(function(t,e){return e(t)}),o.apply(this,e))}}function y(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(this,n.concat(r))}}function v(t){var e=t.length;return function n(r){return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var f=r.concat(l);return f.length>=e?t.apply(this,f):n(f)}}([])}function m(t){var e=t.length;return function n(r){return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var f=r.concat(l.reverse());return f.length>=e?t.apply(this,f):n(f)}}([])}function w(t,e,n,r,l,c,f,h){return Object(o.isDefined)(h)?t.call(e,n,r,l,c,f,h):Object(o.isDefined)(f)?t.call(e,n,r,l,c,f):Object(o.isDefined)(c)?t.call(e,n,r,l,c):Object(o.isDefined)(l)?t.call(e,n,r,l):Object(o.isDefined)(r)?t.call(e,n,r):Object(o.isDefined)(n)?t.call(e,n):t.call(e)}},688:function(t,e,n){"use strict";n(55),n(244),n(656),n(657),n(11),n(62),n(26),n(74),n(239),n(242),n(6),n(40),n(44),n(669),n(196);var r,o=n(665),l=n(664),c=n(700),f=n(695),h=n(690),d=n(685);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function v(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==y(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===y(o)?o:String(o)),n)}var r,o}var m,w,O=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],S=Object(h.a)(r||(m=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],(w=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])||(w=m.slice(0)),r=Object.freeze(Object.defineProperties(m,{raw:{value:Object.freeze(w)}})))),C=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),E=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),R=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.globalBucket=this.createEmptyBucket()}var e,n,r;return e=t,n=[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return Object(o.arrayEach)(O,(function(e){return t[e]=[]})),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))Object(o.arrayEach)(e,(function(e){return n.add(t,e,r)}));else{C.has(t)&&Object(f.b)(Object(c.substitute)(S,{hookName:t,removedInVersion:C.get(t)})),E.has(t)&&Object(f.b)(E.get(t));var l=this.getBucket(r);if(void 0===l[t]&&(this.register(t),l[t]=[]),e.skip=!1,-1===l[t].indexOf(e)){var h=!1;e.initialHook&&Object(o.arrayEach)(l[t],(function(n,i){if(n.initialHook)return l[t][i]=e,h=!0,!1})),h||l[t].push(e)}}return this}},{key:"once",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?Object(o.arrayEach)(e,(function(e){return n.once(t,e,r)})):(e.runOnce=!0,this.add(t,e,r))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[t]&&r[t].indexOf(e)>=0&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}},{key:"run",value:function(t,e,n,r,o,l,c,f){var h=this.globalBucket[e],y=h?h.length:0,v=0;if(y)for(;v<y;)if(h[v]&&!h[v].skip){var m=Object(d.fastCall)(h[v],t,n,r,o,l,c,f);void 0!==m&&(n=m),h[v]&&h[v].runOnce&&this.remove(e,h[v]),v+=1}else v+=1;var w=this.getBucket(t)[e],O=w?w.length:0,S=0;if(O)for(;S<O;)if(w[S]&&!w[S].skip){var C=Object(d.fastCall)(w[S],t,n,r,o,l,c,f);void 0!==C&&(n=C),w[S]&&w[S].runOnce&&this.remove(e,w[S],t),S+=1}else S+=1;return n}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(l.objectEach)(this.getBucket(t),(function(t,e,n){return n[e].length=0}))}},{key:"register",value:function(t){this.isRegistered(t)||O.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&O.splice(O.indexOf(t),1)}},{key:"isDeprecated",value:function(t){return E.has(t)||C.has(t)}},{key:"isRegistered",value:function(t){return O.indexOf(t)>=0}},{key:"getRegistered",value:function(){return O}}],r=[{key:"getSingleton",value:function(){return k}}],n&&v(e.prototype,n),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),k=new R;e.a=R},689:function(t,e,n){"use strict";n.d(e,"a",(function(){return wS}));n(239),n(6),n(40),n(307),n(44),n(669),n(309),n(102),n(34),n(64),n(13),n(656),n(657),n(11),n(62),n(26),n(419),n(420),n(130),n(670),n(16),n(74);var r=n(1163),o=n(666),l=n(691),c=n(664),f=n(766);function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==h(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===h(o)?o:String(o)),n)}var r,o}function y(){return y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=w(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},y.apply(this,arguments)}function v(t,p){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},v(t,p)}function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w(t);if(e){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}var O="handsontableEditor",S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(S,t);var e,n,r,h=m(S);function S(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,S),h.apply(this,arguments)}return e=S,r=[{key:"EDITOR_TYPE",get:function(){return"handsontable"}}],(n=[{key:"open",value:function(){y(w(S.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Object(o.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),y(w(S.prototype),"close",this).call(this)}},{key:"prepare",value:function(t,col,e,td,n,r){y(w(S.prototype),"prepare",this).call(this,t,col,e,td,n,r);var o=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(t,e){var n=this.getSourceData(e.row,e.col);void 0!==n&&o.setValue(n),o.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Object(c.extend)(l,r.handsontable),this.htOptions=l}},{key:"beginEditing",value:function(t,e){var n=this.hot.getSettings().onBeginEditing;n&&!1===n()||y(w(S.prototype),"beginEditing",this).call(this,t,e)}},{key:"createElements",value:function(){y(w(S.prototype),"createElements",this).call(this);var t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}},{key:"finishEditing",value:function(t,e,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var r=this.htEditor.getInstance().getValue();void 0!==r&&this.setValue(r)}y(w(S.prototype),"finishEditing",this).call(this,t,e,n)}},{key:"assignHooks",value:function(){var t=this;this.hot.addHook("afterDestroy",(function(){t.htEditor&&t.htEditor.destroy()}))}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager().getContext("editor");y(w(S.prototype),"registerShortcuts",this).call(this);var n={group:O,relativeToGroup:f.b,position:"before"},r=function(e,n){var r=t.htEditor.getInstance();if(void 0!==e&&(e<0||r.flipped&&e>r.countRows()-1?r.deselectCell():r.selectCell(e,0),r.getData().length))return n.preventDefault(),Object(l.stopImmediatePropagation)(n),t.hot.listen(),t.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:function(e){var n,o,l=t.htEditor.getInstance();return!l.getSelectedLast()&&l.flipped?n=l.countRows()-1:l.getSelectedLast()&&(l.flipped?(o=l.getSelectedLast()[0],n=Math.max(0,o-1)):n=(o=l.getSelectedLast()[0])-1),r(n,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(e){var n,o,l=t.htEditor.getInstance();if(l.getSelectedLast()||l.flipped){if(l.getSelectedLast())if(l.flipped)n=l.getSelectedLast()[0]+1;else if(!l.flipped){var c=l.countRows()-1;o=l.getSelectedLast()[0],n=Math.min(c,o+1)}}else n=0;return r(n,e)},preventDefault:!1}],n)}},{key:"unregisterShortcuts",value:function(){y(w(S.prototype),"unregisterShortcuts",this).call(this),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(O)}}])&&d(e.prototype,n),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),S}(r.a),C=n(665),E=n(673),R=n(700),k=n(728),j=n(1060);function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function P(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N(n.key),n)}}function A(){return A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=I(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},A.apply(this,arguments)}function M(t,p){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},M(t,p)}function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=I(t);if(e){var o=I(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===T(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return x(t)}(this,n)}}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}function N(t){var e=function(input,t){if("object"!==T(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===T(e)?e:String(e)}var H=new WeakMap,D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e)}(c,t);var e,n,r,l=_(c);function c(t){var e,n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),e=l.call(this,t),n=x(e),o=function(t,e,n){var r,o,i,l,c=[],f=[],h=t.length,d=e.length;if(0===h){for(i=0;i<d;i++)f.push(i);return f}for(i=0;i<d;i++){if(o=Object(R.stripTags)(Object(E.stringify)(e[i])),n)l=o.indexOf(t);else{var y=this.cellProperties.locale;l=o.toLocaleLowerCase(y).indexOf(t.toLocaleLowerCase(y))}-1!==l&&(r=o.length-l-h,c.push({baseIndex:i,index:l,charsLeft:r,value:o}))}for(c.sort((function(a,b){if(-1===b.index)return-1;if(-1===a.index)return 1;if(a.index<b.index)return-1;if(b.index<a.index)return 1;if(a.index===b.index){if(a.charsLeft<b.charsLeft)return-1;if(a.charsLeft>b.charsLeft)return 1}return 0})),i=0,d=c.length;i<d;i++)f.push(c[i].baseIndex);return f},(r=N(r="sortByRelevance"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,e.query=null,e.strippedChoices=[],e.rawChoices=[],H.set(x(e),{skipOne:!1,isMacOS:e.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),e}return e=c,r=[{key:"EDITOR_TYPE",get:function(){return"autocomplete"}}],(n=[{key:"getValue",value:function(){var t=this,e=this.rawChoices.find((function(e){return t.stripValueIfNeeded(e)===t.TEXTAREA.value}));return Object(E.isDefined)(e)?e:this.TEXTAREA.value}},{key:"createElements",value:function(){A(I(c.prototype),"createElements",this).call(this),Object(o.addClass)(this.htContainer,"autocompleteEditor"),Object(o.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var t=this,e=H.get(this);A(I(c.prototype),"open",this).call(this);var n=this.htEditor.getInstance(),r=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=Object(o.getScrollbarWidth)();0===l&&e.isMacOS&&(l+=15),this.addHook("beforeKeyDown",(function(e){return t.onBeforeKeyDown(e)})),n.updateSettings({colWidths:r?[Object(o.outerWidth)(this.TEXTAREA)-2]:void 0,width:r?Object(o.outerWidth)(this.TEXTAREA)+l:void 0,renderer:function(e,n,r,col,o,l,c){Object(j.a)(e,n,r,col,o,l,c);var f,h,d=t.cellProperties,y=d.filteringCaseSensitive,v=d.allowHtml,m=d.locale,w=t.query,O=Object(E.stringify)(l);O&&!v&&-1!==(f=!0===y?O.indexOf(w):O.toLocaleLowerCase(m).indexOf(w.toLocaleLowerCase(m)))&&(h=O.substr(f,w.length),O=O.replace(h,"<strong>".concat(h,"</strong>"))),n.innerHTML=O},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),A(I(c.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(t){A(I(c.prototype),"discardEditor",this).call(this,t),this.hot.view.render()}},{key:"queryChoices",value:function(t){var e=this,source=this.cellProperties.source;this.query=t,"function"==typeof source?source.call(this.cellProperties,t,(function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))})):Array.isArray(source)?(this.rawChoices=source,this.updateChoicesList(this.stripValuesIfNeeded(source))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(t){var e=Object(o.getCaretPosition)(this.TEXTAREA),n=Object(o.getSelectionEndPosition)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,c=null,f=null,h=t;r&&(c=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),h,this.cellProperties.filteringCaseSensitive));var d=Array.isArray(c)?c.length:0;if(!1===l)d&&(f=c[0]);else{for(var y=[],i=0,v=h.length;i<v&&!(r&&d<=i);i++)d?y.push(h[c[i]]):y.push(h[i]);f=0,h=y}this.strippedChoices=h,this.htEditor.loadData(Object(C.pivot)([h])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(f),this.hot.listen(),Object(o.setCaretPosition)(this.TEXTAREA,e,e===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var t=Object(o.getTrimmingContainer)(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(e||!e&&(n||"horizontal"===n))return!1;var r=Object(o.offset)(this.TEXTAREA),l=Object(o.outerHeight)(this.TEXTAREA),c=this.getDropdownHeight(),f=t.scrollTop,h=Object(o.outerHeight)(this.hot.view._wt.wtTable.THEAD),d=Object(o.offset)(t),y=r.top-d.top-h+f,v=t.scrollHeight-y-h-l,m=c>v&&y>v;return m?this.flipDropdown(c):this.unflipDropdown(),this.limitDropdownIfNeeded(m?y:v,c),m}},{key:"limitDropdownIfNeeded",value:function(t,e){if(e>t){var n,r=0,i=0,o=0;do{r+=o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=1}while(r<t);n=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+e-n,"px")),this.setDropdownHeight(r-o)}}},{key:"flipDropdown",value:function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="".concat(-t,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var t=this.htEditor.getColWidth(0)+Object(o.getScrollbarWidth)(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(t){this.htEditor.updateSettings({height:t})}},{key:"highlightBestMatchingChoice",value:function(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}},{key:"stripValueIfNeeded",value:function(t){return this.stripValuesIfNeeded([t])[0]}},{key:"stripValuesIfNeeded",value:function(t){var e=this.cellProperties.allowHtml,n=Object(C.arrayMap)(t,(function(t){return Object(E.stringify)(t)}));return Object(C.arrayMap)(n,(function(t){return e?t:Object(R.stripTags)(t)}))}},{key:"allowKeyEventPropagation",value:function(t){var e=this.htEditor.getSelectedRangeLast(),n=e?e.from.row:-1,r=!1;return t===k.KEY_CODES.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),t===k.KEY_CODES.ARROW_UP&&n>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(t){var e=this,n=H.get(this);if(n.skipOne=!1,Object(k.isPrintableChar)(t.keyCode)||t.keyCode===k.KEY_CODES.BACKSPACE||t.keyCode===k.KEY_CODES.DELETE||t.keyCode===k.KEY_CODES.INSERT){var r=10;if(t.keyCode===k.KEY_CODES.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value),n.skipOne=!0}),r)}}}])&&P(e.prototype,n),r&&P(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(S),L=n(1008);function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function F(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==B(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===B(o)?o:String(o)),n)}var r,o}function V(t,p){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},V(t,p)}function W(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=U(t);if(e){var o=U(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===B(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function U(t){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},U(t)}var z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V(t,e)}(c,t);var e,n,r,l=W(c);function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.apply(this,arguments)}return e=c,r=[{key:"EDITOR_TYPE",get:function(){return"checkbox"}}],(n=[{key:"beginEditing",value:function(t,e){if(e&&"mouseup"===e.type){var n=this.TD.querySelector('input[type="checkbox"]');Object(o.hasClass)(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}])&&F(e.prototype,n),r&&F(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(L.a),G=n(246),Y=n(947),X=n(683);function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function $(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==K(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===K(o)?o:String(o)),n)}var r,o}function Q(){return Q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=tt(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Q.apply(this,arguments)}function J(t,p){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},J(t,p)}function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=tt(t);if(e){var o=tt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===K(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function tt(t){return tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tt(t)}var et="date",nt="dateEditor",ot=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}(f,t);var e,n,r,l=Z(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=l.call(this,t)).defaultDateFormat="DD/MM/YYYY",e.isCellEdited=!1,e.parentDestroyed=!1,e.$datePicker=null,e}return e=f,n=[{key:"init",value:function(){var t=this;if("function"!=typeof G)throw new Error("You need to include moment.js to your project.");if("function"!=typeof Y)throw new Error("You need to include Pikaday to your project.");Q(tt(f.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){t.parentDestroyed=!0,t.destroyElements()}))}},{key:"createElements",value:function(){Q(tt(f.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Object(o.addClass)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new X.a(this).addEventListener(this.datePicker,"mousedown",(function(t){return t.stopPropagation()}))}},{key:"destroyElements",value:function(){var t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}},{key:"prepare",value:function(t,col,e,td,n,r){Q(tt(f.prototype),"prepare",this).call(this,t,col,e,td,n,r)}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.hot.getShortcutManager().getContext("editor");Q(tt(f.prototype),"open",this).call(this),this.showDatepicker(t),e.addShortcut({keys:[["Enter"]],callback:function(t){t.stopPropagation()},group:nt})}},{key:"close",value:function(){var t,e=this;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((function(){e.instance._refreshBorders()})),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(nt),Q(tt(f.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var n=this.originalValue;void 0!==n&&this.setValue(n)}Q(tt(f.prototype),"finishEditing",this).call(this,t,e)}},{key:"showDatepicker",value:function(t){var e,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),c=!!t&&Object(k.isFunctionKey)(t.keyCode);this.datePicker.style.display="block",this.$datePicker=new Y(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+Object(o.outerHeight)(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;f=this.hot.isRtl()?n.right-Object(o.outerWidth)(this.datePicker):n.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(e=this.originalValue,G(e,r,!0).isValid()&&this.$datePicker.setMoment(G(e,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),c||l||this.setValue("")):this.cellProperties.defaultDate?(e=this.cellProperties.defaultDate,G(e,r,!0).isValid()&&this.$datePicker.setMoment(G(e,r),!0),c||l||this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Object(c.deepExtend)(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=function(e){var n=e;isNaN(n.getTime())||(n=G(n).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(n),t.hideDatepicker(),r&&r()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1),o&&o()},n}}],r=[{key:"EDITOR_TYPE",get:function(){return et}}],n&&$(e.prototype,n),r&&$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(r.a),it=n(688);function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function lt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==at(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===at(o)?o:String(o)),n)}var r,o}function st(){return st="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=ft(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},st.apply(this,arguments)}function ut(t,p){return ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ut(t,p)}function ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ft(t);if(e){var o=ft(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===at(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function ft(t){return ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ft(t)}var ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ut(t,e)}(l,t);var e,n,r,o=ct(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return e=l,r=[{key:"EDITOR_TYPE",get:function(){return"dropdown"}}],(n=[{key:"prepare",value:function(t,col,e,td,n,r){st(ft(l.prototype),"prepare",this).call(this,t,col,e,td,n,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}])&&lt(e.prototype,n),r&&lt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(D);function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function yt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==pt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===pt(o)?o:String(o)),n)}var r,o}function bt(t,p){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},bt(t,p)}function vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=mt(t);if(e){var o=mt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function mt(t){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mt(t)}it.a.getSingleton().add("beforeValidate",(function(t,e,col){var n=this.getCellMeta(e,this.propToCol(col));n.editor===ht&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));var gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bt(t,e)}(l,t);var e,n,r,o=vt(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return e=l,r=[{key:"EDITOR_TYPE",get:function(){return"numeric"}}],(n=null)&&yt(e.prototype,n),r&&yt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(r.a);function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function Ot(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==wt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===wt(o)?o:String(o)),n)}var r,o}function St(){return St="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Rt(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},St.apply(this,arguments)}function Ct(t,p){return Ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ct(t,p)}function Et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Rt(t);if(e){var o=Rt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===wt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Rt(t){return Rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rt(t)}var kt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ct(t,e)}(c,t);var e,n,r,l=Et(c);function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.apply(this,arguments)}return e=c,r=[{key:"EDITOR_TYPE",get:function(){return"password"}}],(n=[{key:"createElements",value:function(){St(Rt(c.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Object(o.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}])&&Ot(e.prototype,n),r&&Ot(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(r.a);function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Tt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==jt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===jt(o)?o:String(o)),n)}var r,o}function Pt(){return Pt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=_t(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Pt.apply(this,arguments)}function At(t,p){return At=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},At(t,p)}function Mt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_t(t);if(e){var o=_t(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function _t(t){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_t(t)}var xt="ht_editor_visible",It="selectEditor",Nt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&At(t,e)}(f,t);var e,n,r,l=Mt(f);function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),l.apply(this,arguments)}return e=f,r=[{key:"EDITOR_TYPE",get:function(){return"select"}}],(n=[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Object(o.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(t){this.select.value=t}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Object(o.hasClass)(this.select,xt)&&Object(o.removeClass)(this.select,xt),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var t=this;this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return t.refreshDimensions()})),this.addHook("afterRowResize",(function(){return t.refreshDimensions()}))}},{key:"prepare",value:function(t,col,e,td,n,r){var l=this;Pt(_t(f.prototype),"prepare",this).call(this,t,col,e,td,n,r);var h,d=this.cellProperties.selectOptions;h="function"==typeof d?this.prepareOptions(d(this.row,this.col,this.prop)):this.prepareOptions(d),Object(o.empty)(this.select),Object(c.objectEach)(h,(function(t,e){var n=l.hot.rootDocument.createElement("OPTION");n.value=e,Object(o.fastInnerHTML)(n,t),l.select.appendChild(n)}))}},{key:"prepareOptions",value:function(t){var e={};if(Array.isArray(t))for(var i=0,n=t.length;i<n;i++)e[t[i]]=t[i];else"object"===jt(t)&&(e=t);return e}},{key:"refreshValue",value:function(){var t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===L.b.EDITING)if(this.TD=this.getEditedCell(),this.TD){var t=this.getEditedCellRect(),e=t.top,n=t.start,r=t.width,l=t.height,c=this.select.style;c.height="".concat(l,"px"),c.width="".concat(r,"px"),c.top="".concat(e,"px"),c[this.hot.isRtl()?"right":"left"]="".concat(n,"px"),c.margin="0px",Object(o.addClass)(this.select,xt)}else this.close()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager().getContext("editor"),n={group:It};!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var e=t.select.selectedIndex-1;e>=0&&(t.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var e=t.select.selectedIndex+1;e<=t.select.length-1&&(t.select[e].selected=!0)}}],n)}},{key:"unregisterShortcuts",value:function(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(It)}}])&&Tt(e.prototype,n),r&&Tt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(L.a);function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Dt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ht(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ht(o)?o:String(o)),n)}var r,o}function Lt(){return Lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Vt(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Lt.apply(this,arguments)}function Bt(t,p){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Bt(t,p)}function Ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Vt(t);if(e){var o=Vt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Vt(t){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vt(t)}var Wt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bt(t,e)}(l,t);var e,n,r,o=Ft(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return e=l,r=[{key:"EDITOR_TYPE",get:function(){return"time"}}],(n=[{key:"prepare",value:function(t,col,e,td,n,r){Lt(Vt(l.prototype),"prepare",this).call(this,t,col,e,td,n,r),this.TEXTAREA.dir="ltr"}}])&&Dt(e.prototype,n),r&&Dt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(r.a),Ut=n(693);var zt=n(1061);function Gt(t,e,n,col,r,l,c){zt.a.apply(this,[t,e,n,col,r,l,c]),Object(o.fastInnerHTML)(e,null==l?"":l,!1)}Gt.RENDERER_TYPE="html";function Yt(t,e,n,col,r,l,c){var f=t.rootDocument,h=c.allowHtml?Gt:j.a,d=f.createElement("DIV");if(d.className="htAutocompleteArrow",d.appendChild(f.createTextNode(String.fromCharCode(9660))),h.apply(this,[t,e,n,col,r,l,c]),e.firstChild||e.appendChild(f.createTextNode(String.fromCharCode(160))),e.insertBefore(d,e.firstChild),Object(o.addClass)(e,"htAutocomplete"),!t.acArrowListener){var y=new X.a(t);t.acArrowListener=function(r){Object(o.hasClass)(r.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,col),e)},y.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(function(){y.destroy()}))}}Yt.RENDERER_TYPE="autocomplete";n(48),n(63),n(86),n(54);var Xt=new WeakMap,Kt=new WeakMap,$t="htBadValue",qt="data-row",Qt="data-col",Jt="checkboxRenderer",Zt="checkbox";function te(t,e,n,col,r,l,c){var h=t.rootDocument;zt.a.apply(this,[t,e,n,col,r,l,c]),function(t){var e=Kt.get(t);if(!e){var n=t.rootElement;(e=new X.a(t)).addEventListener(n,"click",(function(e){return function(t,e){var n=t.target;if(!ee(n))return;if(!n.hasAttribute(qt)||!n.hasAttribute(Qt))return;var r=parseInt(n.getAttribute(qt),10),col=parseInt(n.getAttribute(Qt),10),o=e.getCellMeta(r,col);o.readOnly&&t.preventDefault()}(e,t)})),e.addEventListener(n,"mouseup",(function(e){return function(t,e){var n=t.target;if(!ee(n))return;if(!n.hasAttribute(qt)||!n.hasAttribute(Qt))return;setTimeout(e.listen,10)}(e,t)})),e.addEventListener(n,"change",(function(e){return function(t,e){var n=t.target;if(!ee(n))return;if(!n.hasAttribute(qt)||!n.hasAttribute(Qt))return;var r=parseInt(n.getAttribute(qt),10),col=parseInt(n.getAttribute(Qt),10),o=e.getCellMeta(r,col);if(!o.readOnly){var l=null;l=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,e.setDataAtCell(r,col,l)}}(e,t)})),Kt.set(t,e)}}(t);var d,y,input=function(t){var input=t.createElement("input");return input.className="htCheckboxRendererInput",input.type="checkbox",input.setAttribute("autocomplete","off"),input.setAttribute("tabindex","-1"),input.cloneNode(!1)}(h),v=c.label,m=!1;if(void 0===c.checkedTemplate&&(c.checkedTemplate=!0),void 0===c.uncheckedTemplate&&(c.uncheckedTemplate=!1),Object(o.empty)(e),l===c.checkedTemplate||Object(E.stringify)(l).toLocaleLowerCase(c.locale)===Object(E.stringify)(c.checkedTemplate).toLocaleLowerCase(c.locale)?input.checked=!0:l===c.uncheckedTemplate||Object(E.stringify)(l).toLocaleLowerCase(c.locale)===Object(E.stringify)(c.uncheckedTemplate).toLocaleLowerCase(c.locale)?input.checked=!1:Object(E.isEmpty)(l)?Object(o.addClass)(input,"noValue"):(input.style.display="none",Object(o.addClass)(input,$t),m=!0),input.setAttribute(qt,n),input.setAttribute(Qt,col),!m&&v){var w="";if(v.value)w="function"==typeof v.value?v.value.call(this,n,col,r,l):v.value;else if(v.property){var O=t.getDataAtRowProp(n,v.property);w=null!==O?O:""}var label=function(t,text,e){var label=t.createElement("label");return label.className="htCheckboxRendererLabel ".concat(e?"fullWidth":""),label.appendChild(t.createTextNode(text)),label.cloneNode(!0)}(h,w,!0!==v.separated);"before"===v.position?v.separated?(e.appendChild(label),e.appendChild(input)):(label.appendChild(input),input=label):v.position&&"after"!==v.position||(v.separated?(e.appendChild(input),e.appendChild(label)):(label.insertBefore(input,label.firstChild),input=label))}function S(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getSelectedRange();if(n)for(var r=0;r<n.length;r++){for(var o=n[r].getTopStartCorner(),l=o.row,c=o.col,f=n[r].getBottomEndCorner(),h=f.row,d=f.col,y=[],v=l;v<=h;v+=1)for(var m=c;m<=d;m+=1){var w=t.getCellMeta(v,m);if("checkbox"!==w.type)return;if(!0!==w.readOnly){void 0===w.checkedTemplate&&(w.checkedTemplate=!0),void 0===w.uncheckedTemplate&&(w.uncheckedTemplate=!1);var O=t.getDataAtCell(v,m);!1===e?[w.checkedTemplate,w.checkedTemplate.toString()].includes(O)?y.push([v,m,w.uncheckedTemplate]):[w.uncheckedTemplate,w.uncheckedTemplate.toString(),null,void 0].includes(O)&&y.push([v,m,w.checkedTemplate]):y.push([v,m,w.uncheckedTemplate])}}y.length>0&&t.setDataAtCell(y)}}function C(){var e=t.getSelectedRange();if(e){for(var n=0;n<e.length;n++)for(var r=e[n].getTopStartCorner(),o=e[n].getBottomEndCorner(),l=r.row;l<=o.row;l++)for(var c=r.col;c<=o.col;c++){var f=t.getCellMeta(l,c);if("checkbox"!==f.type)return!1;var h=t.getCell(l,c);if(null==h)return!0;if(h.querySelectorAll("input[type=checkbox]").length>0&&!f.readOnly)return!0}return!1}}(!v||v&&!v.separated)&&e.appendChild(input),m&&e.appendChild(h.createTextNode("#bad-value#")),Xt.has(t)||(Xt.set(t,!0),d=t.getShortcutManager().getContext("grid"),y={group:Jt},d.addShortcuts([{keys:[["space"]],callback:function(){return S(),!C()}},{keys:[["enter"]],callback:function(){return S(),!C()},runOnlyIf:function(){return t.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return S(!0),!C()},relativeToGroup:f.a,position:"before"}],y))}function ee(element){return"INPUT"===element.tagName&&"checkbox"===element.getAttribute("type")}it.a.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,n){var label=e.label,r=e.type,o=e.row,l=e.column,c=e.prop;if(r===Zt){if(label){var f=label.value,h=label.property,d=n;if(f)d="function"==typeof f?f(o,l,c,n):f;else if(h){var y=this.getDataAtRowProp(o,h);d=null!==y?y:n}t=d}return t}})),te.RENDERER_TYPE=Zt;n(115);var ne=n(948),re=n(677);function oe(t,e,n,col,r,o,l){var c=o;if(Object(re.isNumeric)(c)){var f=l.numericFormat,h=f&&f.culture||"-",d=f&&f.pattern,y=l.className||"",v=y.length?y.split(" "):[];if(void 0!==h&&!ne.languages()[h]){var m=h.replace("-",""),w=ne.allLanguages?ne.allLanguages[h]:ne[m];w&&ne.registerLanguage(w)}ne.setLanguage(h),c=ne(c).format(d||"0"),v.indexOf("htLeft")<0&&v.indexOf("htCenter")<0&&v.indexOf("htRight")<0&&v.indexOf("htJustify")<0&&v.push("htRight"),v.indexOf("htNumeric")<0&&v.push("htNumeric"),l.className=v.join(" "),e.dir="ltr"}Object(j.a)(t,e,n,col,r,c,l)}oe.RENDERER_TYPE="numeric";function ie(t,e,n,col,r,l,c){j.a.apply(this,[t,e,n,col,r,l,c]);var f=c.hashLength||e.innerHTML.length,h=c.hashSymbol||"*",d="";Object(re.rangeEach)(f-1,(function(){d+=h})),Object(o.fastInnerHTML)(e,d)}ie.RENDERER_TYPE="password";function ae(t,e,n,col,r,o,l){j.a.apply(this,[t,e,n,col,r,o,l]),e.dir="ltr"}ae.RENDERER_TYPE="time";var le=n(724);function se(t,e){var n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,ue(n,e)):ue(n,e)(this.source):e(!0)}function ue(t,e){var n=t;return function(source){for(var t=!1,s=0,r=source.length;s<r;s++)if(n===source[s]){t=!0;break}e(t)}}se.VALIDATOR_TYPE="autocomplete";n(240);var ce=n(792);function fe(t,e){var n=Object(Ut.b)(et,this.instance),r=t,o=!0;null==r&&(r="");var l=G(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),c=G(new Date(r)).isValid()||l;if(this.allowEmpty&&""===r&&(c=!0,l=!0),c||(o=!1),!c&&l&&(o=!0),c&&!l)if(!0===this.correctFormat){var f=function(t,e){var n,r=G(Object(ce.getNormalizedDate)(t)),o=G(t,e),l=t.search(/[A-z]/g)>-1;n=r.isValid()&&r.format("x")===o.format("x")||!o.isValid()||l?r:o;return n.format(e)}(r,this.dateFormat),h=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(h,d,f,"dateValidator"),o=!0}else o=!1;e(o)}fe.VALIDATOR_TYPE="date";function he(t,e){var n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&Object(re.isNumeric)(t))}he.VALIDATOR_TYPE="numeric";var de=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function pe(t,e){var n=this.timeFormat||"h:mm:ss a",r=!0,o=t;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var l=/^\d{1,2}$/.test(o);l&&(o+=":00");var c=G(o,de,!0).isValid()?G(o):G(o,n),f=c.isValid(),h=G(o,n,!0).isValid()&&!l;if(this.allowEmpty&&""===o&&(f=!0,h=!0),f||(r=!1),!f&&h&&(r=!0),f&&!h)if(!0===this.correctFormat){var d=c.format(n),y=this.instance.toVisualRow(this.row),v=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(y,v,d,"timeValidator"),r=!0}else r=!1;e(r)}pe.VALIDATOR_TYPE="time";var ye=n(725);var be={CELL_TYPE:"autocomplete",editor:D,renderer:Yt,validator:se},ve={CELL_TYPE:"checkbox",editor:z,renderer:te},me={CELL_TYPE:"date",editor:ot,renderer:Yt,validator:fe},ge={CELL_TYPE:"dropdown",editor:ht,renderer:Yt,validator:se},we={CELL_TYPE:"handsontable",editor:S,renderer:Yt},Oe={CELL_TYPE:"numeric",editor:gt,renderer:oe,validator:he,dataType:"number"},Se={CELL_TYPE:"password",editor:kt,renderer:ie,copyable:!1},Ce=n(1059),Ee={CELL_TYPE:"time",editor:Wt,renderer:ae,validator:pe},Re=n(723);n(55),n(56),n(682),n(33);var ke=n(1065),je=n(727),Te=n(770);n(242),n(14);function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Ae(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Me(n.key),n)}}function Me(t){var e=function(input,t){if("object"!==Pe(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Pe(e)?e:String(e)}var _e=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}var e,n,r;return e=t,r=[{key:"SAMPLE_COUNT",get:function(){return 3}}],(n=[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,e){return this.generateSamples("row",e,t)}},{key:"generateColumnSamples",value:function(t,e){return this.generateSamples("col",e,t)}},{key:"generateSamples",value:function(t,e,n){var r=this,o=new Map,l="number"==typeof n?{from:n,to:n}:n,c=l.from,f=l.to;return Object(re.rangeEach)(c,f,(function(n){var l=r.generateSample(t,e,n);o.set(n,l)})),o}},{key:"generateSample",value:function(t,e,n){var r=this;if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");var o=new Map,l="row"===t?"col":"row",f=[];return Object(re.rangeEach)(e.from,e.to,(function(e){var h,d="row"===t?r.dataFactory(n,e):r.dataFactory(e,n),y=d.value,v=d.bundleSeed,m="string"==typeof v&&v.length>0;h=m?v:Object(c.isObject)(y)?"".concat(Object.keys(y).length):Array.isArray(y)?"".concat(y.length):"".concat(Object(E.stringify)(y).length),o.has(h)||o.set(h,{needed:r.getSampleCount(),strings:[]});var w=o.get(h);w.needed&&(!(f.indexOf(y)>-1)||r.allowDuplicates||m)&&(w.strings.push(function(t,e,n){return(e=Me(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({value:y},l,e)),f.push(y),w.needed-=1)})),o}}])&&Ae(e.prototype,n),r&&Ae(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),xe=_e,Ie=n(1063),Ne=n(790);function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}function De(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Le(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Be(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==He(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===He(o)?o:String(o)),n)}var r,o}function Fe(){return Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=ze(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Fe.apply(this,arguments)}function Ve(t,p){return Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ve(t,p)}function We(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ze(t);if(e){var o=ze(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===He(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ue(t)}(this,n)}}function Ue(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ze(t){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ze(t)}it.a.getSingleton().register("modifyAutoColumnSizeSeed");var Ge="autoColumnSize",Ye=new WeakMap,Xe="autoColumnSize",Ke=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ve(t,e)}(l,t);var e,n,r,o=We(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),e=o.call(this,t),Ye.set(Ue(e),{cachedColumnHeaders:[]}),e.ghostTable=new Te.a(e.hot),e.samplesGenerator=new xe((function(t,n){var r=e.hot.getCellMeta(t,n),o="";r.spanned||(o=e.hot.getDataAtCell(t,n));var l="";return e.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=e.hot.runHooks("modifyAutoColumnSizeSeed",l,r,o)),{value:o,bundleSeed:l}})),e.firstCalculation=!0,e.inProgress=!1,e.measuredColumns=0,e.columnWidthsMap=new Ne.a,e.hot.columnIndexMapper.registerMap(Xe,e.columnWidthsMap),e.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)})),e}return e=l,n=[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings()[Ge]&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[Ge];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeChangeRender",(function(e){return t.onBeforeChange(e)})),this.addHook("afterFormulasValuesUpdate",(function(e){return t.onAfterFormulasValuesUpdate(e)})),this.addHook("beforeViewRender",(function(e){return t.onBeforeViewRender(e)})),this.addHook("modifyColWidth",(function(e,col){return t.getColumnWidth(col,e)})),this.addHook("afterInit",(function(){return t.onAfterInit()})),Fe(ze(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),Fe(ze(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this;Fe(ze(l.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)}))}},{key:"calculateVisibleColumnsWidth",value:function(){if(this.hot.countRows()){var t=this.hot.renderCall,e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==e&&-1!==n&&this.calculateColumnsWidth({from:e,to:n},void 0,t)}}},{key:"calculateColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof e?{from:e,to:e}:e,l="number"==typeof n?{from:n,to:n}:n;Object(re.rangeEach)(o.from,o.to,(function(e){var n=t.hot.toPhysicalColumn(e);if(null===n&&(n=e),r||null===t.columnWidthsMap.getValueAtIndex(n)&&!t.hot._getColWidthFromSettings(n)){var o=t.samplesGenerator.generateColumnSamples(e,l);Object(C.arrayEach)(o,(function(e){var n=De(e,2),r=n[0],o=n[1];return t.ghostTable.addColumn(r,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){t.ghostTable.getWidths((function(e,n){var r=t.hot.toPhysicalColumn(e);t.columnWidthsMap.setValueAtIndex(r,n)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0,r=this.hot.countCols()-1,o=null;this.inProgress=!0;var c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateColumnsWidth({from:0,to:c},e),this.firstCalculation=!1,n=c+1),n<r?function c(){if(!t.hot)return Object(je.cancelAnimationFrame)(o),void(t.inProgress=!1);t.calculateColumnsWidth({from:n,to:Math.min(n+l.CALCULATION_STEP,r)},e),(n=n+l.CALCULATION_STEP+1)<r?o=Object(je.requestAnimationFrame)(c):(Object(je.cancelAnimationFrame)(o),t.inProgress=!1,t.hot.view.adjustElementsSize())}():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings()[Ge],e=t&&Object(c.hasOwnProperty)(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&Object(c.hasOwnProperty)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=this.hot.getSettings()[Ge],e=l.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return Object(c.isObject)(t)&&(e=t.syncLimit,Object(R.isPercentValue)(e)?e=Object(re.valueAccordingPercent)(n,e):e>>=0),Math.min(e,n)}},{key:"getColumnWidth",value:function(t){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),e&&"number"==typeof n&&(n=Math.max(n,Ie.a.DEFAULT_WIDTH))),n}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){var e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){var n=t.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){var e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){var n=t.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),e=Ye.get(this).cachedColumnHeaders;return Object(C.arrayReduce)(t,(function(t,n,r){var o=e.length;return(o-1<r||e[r]!==n)&&t.push(r),o-1<r?e.push(n):e[r]=n,t}),[])}},{key:"clearCache",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?this.hot.batchExecution((function(){Object(C.arrayEach)(e,(function(e){t.columnWidthsMap.setValueAtIndex(e,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Object(C.arrayFilter)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(t){return null===t})).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){t.hot&&t.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(t){var e=this,n=Object(C.arrayMap)(t,(function(t){var n=De(t,2)[1];return e.hot.toPhysicalColumn(e.hot.propToCol(n))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(t,e,n){var r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}},{key:"onAfterInit",value:function(){Ye.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(t){var e=Object(C.arrayFilter)(t,(function(t){var e;return Object(E.isDefined)(null===(e=t.address)||void 0===e?void 0:e.col)})),n=Object(C.arrayMap)(e,(function(t){return t.address.col}));this.clearCache(Array.from(new Set(n)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Fe(ze(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Ge}},{key:"PLUGIN_PRIORITY",get:function(){return 10}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}],n&&Be(e.prototype,n),r&&Be(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a),$e=(n(36),{horizontal:"horizontal",vertical:"vertical"});function qe(t){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(t)}function Qe(t){return function(t){if(Array.isArray(t))return tn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ze(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Je(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||Ze(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ze(t,e){if(t){if("string"==typeof t)return tn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tn(t,e):void 0}}function tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function en(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==qe(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===qe(o)?o:String(o)),n)}var r,o}function nn(){return nn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=ln(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},nn.apply(this,arguments)}function rn(t,p){return rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},rn(t,p)}function on(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ln(t);if(e){var o=ln(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===qe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return an(t)}(this,n)}}function an(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ln(t){return ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ln(t)}it.a.getSingleton().register("modifyAutofillRange"),it.a.getSingleton().register("beforeAutofill"),it.a.getSingleton().register("afterAutofill");var sn="autofill",un=["fillHandle"],cn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rn(t,e)}(f,t);var e,n,r,l=on(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=l.call(this,t)).eventManager=new X.a(an(e)),e.addingStarted=!1,e.mouseDownOnCellCorner=!1,e.mouseDragOutside=!1,e.handleDraggedCells=0,e.directions=[],e.autoInsertRow=!1,e}return e=f,r=[{key:"PLUGIN_KEY",get:function(){return sn}},{key:"PLUGIN_PRIORITY",get:function(){return 20}},{key:"SETTING_KEYS",get:function(){return[sn].concat(un)}}],(n=[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.onAfterCellCornerMouseDown(e)})),this.addHook("afterOnCellCornerDblClick",(function(e){return t.onCellCornerDblClick(e)})),this.addHook("beforeOnCellMouseOver",(function(e,n){return t.onBeforeCellMouseOver(n)})),nn(ln(f.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),nn(ln(f.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),nn(ln(f.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var t=this,e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner(),r=n.row,o=n.col,l=e.getBottomEndCorner(),c=l.row,f=l.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:o,endRow:c,endCol:f}]),d=[],y=[],data=[];return Object(C.arrayEach)(h,(function(t){for(var e=t.startRow;e<=t.endRow;e+=1)-1===d.indexOf(e)&&d.push(e);for(var n=t.startCol;n<=t.endCol;n+=1)-1===y.indexOf(n)&&y.push(n)})),Object(C.arrayEach)(d,(function(e){var n=[];Object(C.arrayEach)(y,(function(r){n.push(t.hot.getCopyableData(e,r))})),data.push(n)})),data}},{key:"fillIn",value:function(){var t=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var e=Je(this.hot.selection.highlight.getFill().getVisualCorners(),4),n=e[0],r=e[1],o=e[2],l=e[3],c=this.hot.getSelectedRangeLast(),f=c.getTopStartCorner(),h=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var d=[f.row,f.col,h.row,h.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(f.row,n),Math.min(f.col,r),Math.max(h.row,o),Math.max(h.col,l)],d),v=function(t,e,n){var r,o,l;return e[0]===t[0]&&e[1]<t[1]?(l="left",r=n(e[0],e[1]),o=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(l="right",r=n(e[0],t[3]+1),o=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(l="up",r=n(e[0],e[1]),o=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(l="down",r=n(t[2]+1,e[1]),o=n(e[2],e[3])),r&&r.normalize(),o&&o.normalize(),{directionOfDrag:l,startOfDragCoords:r,endOfDragCoords:o}}(d,y,(function(e,n){return t.hot._createCellCoords(e,n)})),m=v.directionOfDrag,w=v.startOfDragCoords,O=v.endOfDragCoords;if(w&&w.row>-1&&w.col>-1){var S=this.getSelectionData(),C=c.clone(),E=this.hot._createCellRange(w,w,O),R=this.hot.runHooks("beforeAutofill",S,C,E,m);if(!1===R)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var k=function(t,e,data,n){var r=data.length,o=data?data[0].length:0,l=[],c=e.row-t.row,f=e.col-t.col;if(-1!==["down","up"].indexOf(n)){for(var h=[],col=0;col<f;col++){var d=parseInt(data[0][col],10),y=parseInt(data[r-1][col],10),v=("down"===n?y-d:d-y)/(r-1)||0;h.push(v)}l.push(h)}if(-1!==["right","left"].indexOf(n))for(var m=0;m<c;m++){var w=parseInt(data[m][0],10),O=parseInt(data[m][o-1],10),S=("right"===n?O-w:w-O)/(o-1)||0;l.push([S])}return l}(w,O,S,m),j=R,T=R;if(["up","left"].indexOf(m)>-1&&(1!==T.length||0!==T[0].length))if(j=[],"up"===m)for(var P=O.row-w.row+1,A=P%T.length,i=0;i<P;i++)j.push(T[(i+(T.length-A))%T.length]);else for(var M=O.col-w.col+1,_=M%T[0].length,x=0;x<T.length;x++){j.push([]);for(var I=0;I<M;I++)j[x].push(T[x][(I+(T[x].length-_))%T[x].length])}this.hot.populateFromArray(w.row,w.col,j,O.row,O.col,"".concat(this.pluginName,".fill"),null,m,k),this.setSelection(y),this.hot.runHooks("afterAutofill",j,C,E,m),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e=this.hot.getSelectedRangeLast(),n=e.getBottomEndCorner(),r=t;if(this.directions.includes($e.vertical)&&this.directions.includes($e.horizontal)){var o=e.getTopStartCorner();(n.col<=t.col||o.col>=t.col)&&(r=this.hot._createCellCoords(n.row,t.col)),(n.row<t.row||o.row>t.row)&&(r=this.hot._createCellCoords(t.row,n.col))}else if(this.directions.includes($e.vertical))r=this.hot._createCellCoords(t.row,n.col);else{if(!this.directions.includes($e.horizontal))return;r=this.hot._createCellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout((function(){t.hot.alter("insert_row_below",void 0,1,"".concat(t.pluginName,".fill")),t.addingStarted=!1}),200)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e,data=this.hot.getData(),n=this.hot.countRows(),r=t[2]+1;r<n;r++){for(var o=t[1];o<=t[3];o++)if(data[r][o])return-1;var l=data[r][t[1]-1],c=data[r][t[3]+1];(l||c)&&(e=r)}return e}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}},{key:"setSelection",value:function(t){var e;(e=this.hot).selectCell.apply(e,Qe(Object(C.arrayMap)(t,(function(t){return Math.max(t,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=this.hot.rootDocument.documentElement,n=Object(o.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Object(o.outerHeight)(this.hot.table),r=Object(o.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Object(o.outerWidth)(this.hot.table);return t.clientY>n&&t.clientX<=r}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)}))}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=function(t){var e={};return!0===t?(e.directions=Object.keys($e),e.autoInsertRow=!0):Object(c.isObject)(t)?(Object(E.isDefined)(t.autoInsertRow)?t.direction===$e.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Object(E.isDefined)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys($e)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){nn(ln(f.prototype),"destroy",this).call(this)}}])&&en(e.prototype,n),r&&en(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a);function fn(t){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fn(t)}function hn(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return dn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dn(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function pn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==fn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===fn(o)?o:String(o)),n)}var r,o}function yn(){return yn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=mn(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},yn.apply(this,arguments)}function bn(t,p){return bn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},bn(t,p)}function vn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=mn(t);if(e){var o=mn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===fn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function mn(t){return mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mn(t)}var gn="autoRowSize",wn="autoRowSize",On=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bn(t,e)}(f,t);var e,n,r,l=vn(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=l.call(this,t)).rowHeightsMap=void 0,e.headerHeight=null,e.ghostTable=new Te.a(e.hot),e.samplesGenerator=new xe((function(t,col){var n;return t>=0?n=e.hot.getDataAtCell(t,col):-1===t&&(n=e.hot.getColHeader(col)),{value:n}})),e.firstCalculation=!0,e.inProgress=!1,e.measuredRows=0,e.rowHeightsMap=new Ne.a,e.hot.rowIndexMapper.registerMap(wn,e.rowHeightsMap),e.addHook("beforeRowResize",(function(t,n,r){return e.onBeforeRowResize(t,n,r)})),e}return e=f,n=[{key:"isEnabled",value:function(){var t=this.hot.getSettings()[gn];return!0===t||Object(c.isObject)(t)}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeChangeRender",(function(e){return t.onBeforeChange(e)})),this.addHook("beforeColumnResize",(function(){return t.recalculateAllRowsHeight()})),this.addHook("beforeViewRender",(function(e){return t.onBeforeViewRender(e)})),this.addHook("modifyRowHeight",(function(e,n){return t.getRowHeight(n,e)})),this.addHook("modifyColumnHeaderHeight",(function(){return t.getColumnHeaderHeight()})),yn(mn(f.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this;this.headerHeight=null,yn(mn(f.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(e,n,r){return t.onBeforeRowResize(e,n,r)}))}},{key:"calculateRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof e?{from:e,to:e}:e,l="number"==typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var c=this.samplesGenerator.generateRowSamples(-1,l);this.ghostTable.addColumnHeadersRow(c.get(-1))}Object(re.rangeEach)(o.from,o.to,(function(e){if(r||null===t.rowHeightsMap.getValueAtIndex(e)){var n=t.samplesGenerator.generateRowSamples(e,l);Object(C.arrayEach)(n,(function(e){var n=hn(e,2),r=n[0],o=n[1];return t.ghostTable.addRow(r,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){t.ghostTable.getHeights((function(e,n){e<0?t.headerHeight=n:t.rowHeightsMap.setValueAtIndex(t.hot.toPhysicalRow(e),n)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0,r=this.hot.countRows()-1,o=null;this.inProgress=!0;var l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateRowsHeight({from:0,to:l},e),this.firstCalculation=!1,n=l+1),n<r?function l(){if(!t.hot)return Object(je.cancelAnimationFrame)(o),void(t.inProgress=!1);t.calculateRowsHeight({from:n,to:Math.min(n+f.CALCULATION_STEP,r)},e),(n=n+f.CALCULATION_STEP+1)<r?o=Object(je.requestAnimationFrame)(l):(Object(je.cancelAnimationFrame)(o),t.inProgress=!1,t.hot.view.adjustElementsSize(!0),t.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&t.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())}():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings()[gn],e=t&&Object(c.hasOwnProperty)(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&Object(c.hasOwnProperty)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Object(o.isVisible)(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=this.hot.getSettings()[gn],e=f.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return Object(c.isObject)(t)&&(e=t.syncLimit,Object(R.isPercentValue)(e)?e=Object(re.valueAccordingPercent)(n,e):e>>=0),Math.min(e,n)}},{key:"getRowHeight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t)),r=e;return null!==n&&n>(e||0)&&(r=n),r}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(t){var e=this,n="number"==typeof t?{from:t,to:t}:t,r=n.from,o=n.to;this.hot.batchExecution((function(){Object(re.rangeEach)(Math.min(r,o),Math.max(r,o),(function(t){e.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!Object(C.arrayFilter)(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(t){return null===t})).length}},{key:"onBeforeViewRender",value:function(){var t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-e,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,n){var r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){t.hot&&t.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),yn(mn(f.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return gn}},{key:"PLUGIN_PRIORITY",get:function(){return 40}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}],n&&pn(e.prototype,n),r&&pn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a),Sn=n(950),Cn=n(789),En=n(768);function Rn(t){return Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rn(t)}function kn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Rn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Rn(o)?o:String(o)),n)}var r,o}function jn(){return jn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=An(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},jn.apply(this,arguments)}function Tn(t,p){return Tn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Tn(t,p)}function Pn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=An(t);if(e){var o=An(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Rn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function An(t){return An=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},An(t)}var Mn=Object(Sn.a)("physicallyIndexed"),_n=Mn.getListWithInsertedItems,xn=Mn.getListWithRemovedItems,In=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tn(t,e)}(l,t);var e,n,r,o=Pn(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,(function(t){return t}))}return e=l,(n=[{key:"insert",value:function(t,e){var n=Object(Cn.b)(this.indexedValues,e);this.indexedValues=_n(n,t,e,this.initValueOrFn),jn(An(l.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){var e=xn(this.indexedValues,t);this.indexedValues=Object(Cn.a)(e,t),jn(An(l.prototype),"remove",this).call(this,t)}}])&&kn(e.prototype,n),r&&kn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(En.a);function Nn(t){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(t)}function Hn(t){return function(t){if(Array.isArray(t))return Dn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Dn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dn(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ln(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Nn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Nn(o)?o:String(o)),n)}var r,o}function Bn(){return Bn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Wn(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Bn.apply(this,arguments)}function Fn(t,p){return Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Fn(t,p)}function Vn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Wn(t);if(e){var o=Wn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Nn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Wn(t){return Wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wn(t)}var Un=Object(Sn.a)("physicallyIndexed"),zn=Un.getListWithInsertedItems,Gn=Un.getListWithRemovedItems,Yn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fn(t,e)}(l,t);var e,n,r,o=Vn(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,(function(t){return t}))}return e=l,(n=[{key:"insert",value:function(t,e){var n=this;this.indexedValues=zn(this.indexedValues,t,e,(function(t,e){return n.getNextValue(e)})),Bn(Wn(l.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Gn(this.indexedValues,t),Bn(Wn(l.prototype),"remove",this).call(this,t)}},{key:"getNextValue",value:function(t){return Math.max.apply(Math,Hn(this.getValues()))+1+t}}])&&Ln(e.prototype,n),r&&Ln(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(En.a);function Xn(t){return Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xn(t)}function Kn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Xn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Xn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Xn(o)?o:String(o)),n)}var r,o}function $n(){return $n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Jn(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},$n.apply(this,arguments)}function qn(t,p){return qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},qn(t,p)}function Qn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Jn(t);if(e){var o=Jn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Xn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Jn(t){return Jn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jn(t)}var Zn="bindRowsWithHeaders",er=new Map([["loose",In],["strict",Yn]]),nr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qn(t,e)}(l,t);var e,n,r,o=Qn(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,t)).headerIndexes=null,e}return e=l,r=[{key:"PLUGIN_KEY",get:function(){return Zn}},{key:"PLUGIN_PRIORITY",get:function(){return 210}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zn]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[Zn];"string"!=typeof e&&(e="loose");var n=er.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",(function(e){return t.onModifyRowHeader(e)})),$n(Jn(l.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),$n(Jn(l.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}},{key:"destroy",value:function(){$n(Jn(l.prototype),"destroy",this).call(this)}}])&&Kn(e.prototype,n),r&&Kn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a),rr=n(695);function or(t){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},or(t)}function ir(t){return function(t){if(Array.isArray(t))return ar(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ar(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ar(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function lr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vr(n.key),n)}}function sr(){return sr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=dr(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},sr.apply(this,arguments)}function ur(t,p){return ur=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ur(t,p)}function cr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=dr(t);if(e){var o=dr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===or(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return fr(t)}(this,n)}}function fr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dr(t){return dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dr(t)}function pr(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function yr(t,e,n){return(e=vr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vr(t){var e=function(input,t){if("object"!==or(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===or(e)?e:String(e)}function mr(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,wr(t,e,"get"))}function gr(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,wr(t,e,"set"),n),n}function wr(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Or="collapsibleColumns",Sr=["nestedHeaders"],Cr="collapsibleIndicator",Er=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Rr=new WeakMap,kr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ur(t,e)}(f,t);var e,n,r,c=cr(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return yr(fr(t=c.call.apply(c,[this].concat(n))),"nestedHeadersPlugin",null),yr(fr(t),"eventManager",new X.a(fr(t))),yr(fr(t),"headerStateManager",null),pr(fr(t),Rr,{writable:!0,value:null}),t}return e=f,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Or]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.hot.getSettings().nestedHeaders||Object(rr.b)("You need to configure the Nested Headers plugin in order to use collapsible headers."),gr(this,Rr,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return t.onInit()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(e,n,r){return t.onBeforeOnCellMouseDown(e,n,r)})),sr(dr(f.prototype),"enablePlugin",this).call(this),this.updatePlugin())}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var t=this.hot.getSettings().collapsibleColumns;"boolean"==typeof t?this.headerStateManager.mapState((function(t){return{collapsible:t.origColspan>1}})):Array.isArray(t)&&(this.headerStateManager.mapState((function(){return{collapsible:!1}})),this.headerStateManager.mergeStateWith(t))}sr(dr(f.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),gr(this,Rr,null),this.nestedHeadersPlugin=null,this.clearButtons(),sr(dr(f.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(button){button&&button.parentNode.removeChild(button)};Object(re.rangeEach)(0,t-1,(function(i){var t=e.childNodes[i],l=n.childNodes[i],c=r?r.childNodes[i]:null;Object(re.rangeEach)(0,t.childNodes.length-1,(function(e){var button=t.childNodes[e].querySelector(".".concat(Cr));o(button),l&&l.childNodes[e]&&(button=l.childNodes[e].querySelector(".".concat(Cr)),o(button)),r&&c&&c.childNodes[e]&&(button=c.childNodes[e].querySelector(".".concat(Cr)),o(button))}))}),!0)}}},{key:"expandSection",value:function(t){this.toggleCollapsibleSection([t],"expand")}},{key:"collapseSection",value:function(t){this.toggleCollapsibleSection([t],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(t){var e=this,n=this.headerStateManager.mapNodes((function(n){var r=n.collapsible,o=n.origColspan,l=n.headerLevel,c=n.columnIndex,f=n.isCollapsed;if(!0===r&&o>1&&(f&&"expand"===t||!f&&"collapse"===t))return{row:e.headerStateManager.levelToRowCoords(l),col:c}}));this.toggleCollapsibleSection(n,t)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(t,e){var n=this;if(!Er.has(e))throw new Error("Unsupported action is passed (".concat(e,")."));if(Array.isArray(t)){var r=Object(C.arrayFilter)(t,(function(t){return t.row<0})),o=r.length>0;Object(C.arrayEach)(r,(function(t){var r,l=t.row,c=t.col,f=null!==(r=n.headerStateManager.getHeaderSettings(l,c))&&void 0!==r?r:{},h=f.collapsible,d=f.isCollapsed;if(!h||d&&"collapse"===e||!d&&"expand"===e)return o=!1,!1}));var l=[],c=[];o&&Object(C.arrayEach)(r,(function(t){var r=t.row,o=t.col,f=n.headerStateManager.triggerNodeModification(e,r,o),h=f.colspanCompensation,d=f.affectedColumns,y=f.rollbackModification;h>0&&(c.push.apply(c,ir(d)),l.push(y))}));var f=this.getCollapsedColumns(),h=[];"collapse"===e?h=Object(C.arrayUnique)([].concat(ir(f),c)):"expand"===e&&(h=Object(C.arrayFilter)(f,(function(t){return!c.includes(t)})));var d=Er.get(e);if(!1!==this.hot.runHooks(d.beforeHook,f,h,o)){this.hot.batchExecution((function(){Object(C.arrayEach)(c,(function(t){mr(n,Rr).setValueAtIndex(n.hot.toPhysicalColumn(t),d.hideColumn)}))}),!0);var y=this.getCollapsedColumns().length!==f.length;this.hot.runHooks(d.afterHook,f,h,o,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}else Object(C.arrayEach)(l,(function(t){t()}))}}},{key:"getCollapsedColumns",value:function(){return mr(this,Rr).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(t,e,n){var r,l,c=null!==(r=this.headerStateManager.getHeaderSettings(n,t))&&void 0!==r?r:{},f=c.collapsible,h=c.origColspan,d=c.isCollapsed,y=f&&h>1&&t>=this.hot.getSettings().fixedColumnsStart,v=e.querySelector(".".concat(Cr));y?(v||(v=this.hot.rootDocument.createElement("div"),Object(o.addClass)(v,Cr),e.querySelector("div:first-child").appendChild(v)),Object(o.removeClass)(v,["collapsed","expanded"]),d?(Object(o.addClass)(v,"collapsed"),Object(o.fastInnerText)(v,"+")):(Object(o.addClass)(v,"expanded"),Object(o.fastInnerText)(v,"-"))):null===(l=v)||void 0===l||l.remove()}},{key:"onBeforeOnCellMouseDown",value:function(t,e){Object(o.hasClass)(t.target,Cr)&&(Object(o.hasClass)(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Object(o.hasClass)(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Object(l.stopImmediatePropagation)(t))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(t,e){e||this.updatePlugin()}},{key:"destroy",value:function(){gr(this,Rr,null),sr(dr(f.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Or}},{key:"PLUGIN_PRIORITY",get:function(){return 290}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Or].concat(Sr)}}],n&&lr(e.prototype,n),r&&lr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a),jr=(n(12),n(17),n(696),n(424),n(685)),Tr=n(848),Pr=(n(195),n(84),n(850));function Ar(t){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ar(t)}function Mr(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function _r(t,e,n){return(e=Hr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xr(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Ir(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ir(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Nr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hr(n.key),n)}}function Hr(t){var e=function(input,t){if("object"!==Ar(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ar(e)?e:String(e)}var Dr=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Lr=!1,Br=!0,Fr=!0,Vr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.sortingStates=new Pr.a,this.sortEmptyCells=Lr,this.indicator=Br,this.headerAction=Fr,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}var e,n,r;return e=t,n=[{key:"updateAllColumnsProperties",value:function(t){var e=this;Object(c.isObject)(t)&&Object(c.objectEach)(t,(function(t,n){Dr.includes(n)&&(e[n]=t)}))}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getSortOrderOfColumn",value:function(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((function(e){return xr(e,1)[0]===t}))}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(t){return Object(c.isObject)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}},{key:"getSortStates",value:function(){var t=this;return null===this.sortingStates?[]:this.sortingStates.getEntries().map((function(e){var n=xr(e,2),r=n[0],o=n[1];return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Mr(Object(source),!0).forEach((function(e){_r(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Mr(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({column:t.hot.toVisualColumn(r)},o)}))}},{key:"getColumnSortState",value:function(t){var e=this.getSortOrderOfColumn(t);if(Object(E.isDefined)(e))return{column:t,sortOrder:e}}},{key:"setSortStates",value:function(t){this.sortingStates.clear();for(var i=0;i<t.length;i+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[i].column),{sortOrder:t[i].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}],n&&Nr(e.prototype,n),r&&Nr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Wr="asc",Ur="desc",zr="colHeader";function Gr(t){if(t.some((function(t){return!1===function(t){if(!1===Object(c.isObject)(t))return!1;var e=t.column,n=t.sortOrder;return Number.isInteger(e)&&[Wr,Ur].includes(n)}(t)})))return!1;var e=t.map((function(t){return t.column}));return new Set(e).size===e.length}function Yr(t){if(t!==Ur)return t===Wr?Ur:Wr}function Xr(t){return t.querySelector(".".concat(zr))}function Kr(t,e){if(t<0||!e.parentNode)return!1;var n=e.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(e.parentNode)-n.length}function $r(t,e,n){return-1===t&&e>=0&&!1===Object(l.isRightClick)(n)}var qr="indicatorDisabled",Qr="columnSorting",Jr="sortAction",Zr=new Map([[Wr,"ascending"],[Ur,"descending"]]);function to(t,e,n,r){var o=[Qr];if(r&&o.push(Jr),!1===n)return o.push(qr),o;var l=t.getSortOrderOfColumn(e);return Object(E.isDefined)(l)&&o.push(Zr.get(l)),o}var eo=0,no=-1,ro=1;function oo(t,e,n){var r=e.locale;return function(e,o){var l=n.sortEmptyCells;return"string"==typeof e&&(e=e.toLocaleLowerCase(r)),"string"==typeof o&&(o=o.toLocaleLowerCase(r)),e===o?eo:Object(E.isEmpty)(e)?Object(E.isEmpty)(o)?eo:l&&"asc"===t?no:ro:Object(E.isEmpty)(o)?l&&"asc"===t?ro:no:isNaN(e)&&!isNaN(o)?"asc"===t?ro:no:!isNaN(e)&&isNaN(o)?"asc"===t?no:ro:(isNaN(e)||isNaN(o)||(e=parseFloat(e),o=parseFloat(o)),e<o?"asc"===t?no:ro:e>o?"asc"===t?ro:no:eo)}}var io="default";var ao=n(730),lo=Object(ao.a)("sorting.compareFunctionFactory"),so=lo.register,uo=lo.getItem,co=lo.hasItem,fo=Object(ao.a)("sorting.mainSortComparator"),ho=fo.register,po=fo.getItem;function yo(t){return co(t)?uo(t):uo(io)}function bo(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return vo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vo(t,e)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vo(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function mo(t){return mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mo(t)}so("numeric",(function(t,e,n){return function(e,r){var o=parseFloat(e),l=parseFloat(r),c=n.sortEmptyCells;if(o===l||isNaN(o)&&isNaN(l))return eo;if(c){if(Object(E.isEmpty)(e))return"asc"===t?no:ro;if(Object(E.isEmpty)(r))return"asc"===t?ro:no}return isNaN(o)?ro:isNaN(l)?no:o<l?"asc"===t?no:ro:o>l?"asc"===t?ro:no:eo}})),so("checkbox",(function(t,e,n){var r=e.checkedTemplate,o=e.uncheckedTemplate,l=n.sortEmptyCells;return function(c,f){var h=Object(E.isEmpty)(c),d=Object(E.isEmpty)(f),y=h?o:c,v=d?o:f,m=y===o||y===r,w=v===o||v===r;if(!1===l){if(h&&!1===d)return ro;if(!1===h&&d)return no}return!1===m&&w?"asc"===t?no:ro:m&&!1===w?"asc"===t?ro:no:!1===m&&!1===w?oo(t,e,n)(c,f):y===o&&v===r?"asc"===t?no:ro:y===r&&v===o?"asc"===t?ro:no:eo}})),so("date",(function(t,e,n){return function(r,o){var l=n.sortEmptyCells;if(r===o)return eo;if(Object(E.isEmpty)(r))return Object(E.isEmpty)(o)?eo:l&&"asc"===t?no:ro;if(Object(E.isEmpty)(o))return l&&"asc"===t?ro:no;var c=e.dateFormat,f=G(r,c),h=G(o,c);return f.isValid()?h.isValid()?h.isAfter(f)?"asc"===t?no:ro:h.isBefore(f)?"asc"===t?ro:no:eo:no:ro}})),so(io,oo);var go=["column"],wo=["column"];function Oo(t){return function(t){if(Array.isArray(t))return So(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return So(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return So(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function So(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Co(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Eo(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Co(Object(source),!0).forEach((function(e){Ro(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Co(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Ro(t,e,n){return(e=To(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ko(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}function jo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,To(n.key),n)}}function To(t){var e=function(input,t){if("object"!==mo(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==mo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===mo(e)?e:String(e)}function Po(){return Po="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=_o(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Po.apply(this,arguments)}function Ao(t,p){return Ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ao(t,p)}function Mo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_o(t);if(e){var o=_o(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===mo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function _o(t){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_o(t)}var xo="columnSorting",Io="append",No="replace";ho(xo,(function(t,e){return function(n,r){var o,l,c,f,h,d,y=bo(n).slice(1),v=bo(r).slice(1);return l=t[o=0],c=e[o],f=y[o],h=v[o],((d=c.columnSorting).compareFunctionFactory?d.compareFunctionFactory:yo(c.type))(l,c,d)(f,h)}})),it.a.getSingleton().register("beforeColumnSort"),it.a.getSingleton().register("afterColumnSort");var Ho=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ao(t,e)}(f,t);var e,n,r,l=Mo(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=l.call(this,t)).columnStatesManager=null,e.columnMetaCache=null,e.pluginKey=xo,e.indexesSequenceCache=null,e}return e=f,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.columnStatesManager=new Vr(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Ne.a((function(e){var n=t.hot.toVisualColumn(e);return null===n&&(n=e),t.getMergedPluginSettings(n)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("afterOnCellMouseDown",(function(e,n){return t.onAfterOnCellMouseDown(e,n)})),this.addHook("afterInit",(function(){return t.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.hot.view&&this.loadOrSortBySettings(),Po(_o(f.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this,e=function(e,n){var r=Xr(n);!1!==Kr(e,n)&&null!==r&&t.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",(function(){t.hot.removeHook("afterGetColHeader",e)})),this.hot.batchExecution((function(){null!==t.indexesSequenceCache&&(t.hot.rowIndexMapper.setIndexesSequence(t.indexesSequenceCache.getValues()),t.hot.rowIndexMapper.unregisterMap(t.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Po(_o(f.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){var e=this.getSortConfig(),n=this.getNormalizedSortConfigs(t),r=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",e,n,r)&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Tr.a),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",e,r?n:e,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(t){return Object(E.isDefined)(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(t){var e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}},{key:"areValidSortConfigs",value:function(t){var e=this.hot.countCols();return Gr(t)&&t.every((function(t){var n=t.column;return n<=e&&n>=0}))}},{key:"saveAllSortSettings",value:function(t){var e=this,n=this.columnStatesManager.getAllColumnsProperties();n.initialConfig=Object(C.arrayMap)(t,(function(t){var n=t.column,r=ko(t,go);return Eo({column:e.hot.toPhysicalColumn(n)},r)})),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var t=this,e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);var n=e.value;return Object(E.isDefined)(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Object(C.arrayMap)(n.initialConfig,(function(e){var n=e.column,r=ko(e,wo);return Eo({column:t.hot.toVisualColumn(n)},r)}))),n}},{key:"getColumnNextConfig",value:function(t){var e=this.columnStatesManager.getSortOrderOfColumn(t);if(Object(E.isDefined)(e)){var n=Yr(e);return Object(E.isDefined)(n)?{column:t,sortOrder:n}:void 0}var r=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<r)return{column:t,sortOrder:Yr()}}},{key:"getNextSortConfig",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Io,n=this.columnStatesManager.getIndexOfColumnInSortQueue(t),r=-1!==n,o=this.getSortConfig(),l=this.getColumnNextConfig(t);if(r){if(Object(E.isUndefined)(l))return[].concat(Oo(o.slice(0,n)),Oo(o.slice(n+1)));if(e===Io)return[].concat(Oo(o.slice(0,n)),Oo(o.slice(n+1)),[l]);if(e===No)return[].concat(Oo(o.slice(0,n)),[l],Oo(o.slice(n+1)))}return Object(E.isDefined)(l)?o.concat(l):o}},{key:"getPluginColumnConfig",value:function(t){if(Object(c.isObject)(t)){var e=t[this.pluginKey];if(Object(c.isObject)(e))return e}return{}}},{key:"getMergedPluginSettings",value:function(t){var e=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,t),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(n,e,this.getPluginColumnConfig(o.columns[t])):Object(jr.isFunction)(o.columns)?Object.assign(n,e,this.getPluginColumnConfig(o.columns(t))):Object.assign(n,e)}},{key:"getFirstCellSettings",value:function(t){var e=this.hot.getCellMeta(0,t),n=Object.create(e);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),n}},{key:"getNumberOfRowsToSort",value:function(t){var e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}},{key:"sortByPresetSortStates",value:function(t){var e=this;if(0!==t.length){for(var n=[],r=this.hot.countRows(),o=function(n){return Object(C.arrayMap)(t,(function(t){return e.hot.getDataAtCell(n,t.column)}))},l=0;l<this.getNumberOfRowsToSort(r);l+=1)n.push([this.hot.toPhysicalRow(l)].concat(o(l)));var c=Object(C.arrayMap)(n,(function(t){return t[0]}));!function(t,e){for(var n=po(e),r=arguments.length,o=new Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];t.sort(n.apply(void 0,o))}(n,this.pluginKey,Object(C.arrayMap)(t,(function(t){return t.sortOrder})),Object(C.arrayMap)(t,(function(t){return e.getFirstCellSettings(t.column)})));for(var f=n.length;f<r;f+=1)n.push([f].concat(o(f)));var h=Object(C.arrayMap)(n,(function(t){return t[0]})),d=new Map(Object(C.arrayMap)(c,(function(t,e){return[t,h[e]]}))),y=Object(C.arrayMap)(this.hot.rowIndexMapper.getIndexesSequence(),(function(t){return d.has(t)?d.get(t):t}));this.hot.rowIndexMapper.setIndexesSequence(y)}else this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues())}},{key:"loadOrSortBySettings",value:function(){var t=this.getAllSavedSortSettings();if(Object(c.isObject)(t))this.sortBySettings(t);else{var e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}},{key:"sortBySettings",value:function(t){if(Object(c.isObject)(t)){this.columnStatesManager.updateAllColumnsProperties(t);var e=t.initialConfig;(Array.isArray(e)||Object(c.isObject)(e))&&this.sort(e)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(t,e){var n=Xr(e);if(!1!==Kr(t,e)&&null!==n){var r=this.getFirstCellSettings(t)[this.pluginKey],o=r.indicator,l=r.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,t,o,l)}}},{key:"updateHeaderClasses",value:function(t){if(Object(o.removeClass)(t,Array.from(Zr.values()).concat(Jr,qr,Qr)),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Object(o.addClass)(t,to.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(t){Po(_o(f.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Object(E.isDefined)(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}},{key:"onAfterLoadData",value:function(t){!0===t&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&"SPAN"===t.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){!1!==$r(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==$r(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}},{key:"destroy",value:function(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),Po(_o(f.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return xo}},{key:"PLUGIN_PRIORITY",get:function(){return 50}}],n&&jo(e.prototype,n),r&&jo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a);n(244),n(425);function Do(t){return Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Do(t)}function Lo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Do(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Do(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Do(o)?o:String(o)),n)}var r,o}var Bo,Fo=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}var e,n,r;return e=t,n=[{key:"getEndpoint",value:function(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var e=this,n=[],r=t;if(r||"function"!=typeof this.settings)return r||(r=this.settings),Object(C.arrayEach)(r,(function(t){var r={};e.assignSetting(t,r,"ranges",[[0,e.hot.countRows()-1]]),e.assignSetting(t,r,"reversedRowCoords",!1),e.assignSetting(t,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"sourceColumn",t.destinationColumn),e.assignSetting(t,r,"type","sum"),e.assignSetting(t,r,"forceNumeric",!1),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"customFunction",null),e.assignSetting(t,r,"readOnly",!0),e.assignSetting(t,r,"roundFloat",!1),n.push(r)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(t,e,n,r){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(r instanceof Error)throw r;e[n]=r}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(t,e,n){if("function"===this.settingsType){var r=t.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();Object(C.arrayEach)(o,(function(o){"row"===r&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=n:"remove_row"===t&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=n:"remove_col"===t&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,e,n,r,source){var o=this,l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var c=t.indexOf("row")>-1?"row":"col",f=t.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=0===t.indexOf("move_row"),y=e;Object(C.arrayEach)(h,(function(t){"row"===c&&t.destinationRow>=y&&(t.alterRowOffset=f*n),"col"===c&&t.destinationColumn>=y&&(t.alterColumnOffset=f*n)})),this.resetAllEndpoints(h,!d),d?Object(C.arrayEach)(h,(function(t){o.extendEndpointRanges(t,y,r[0],r.length),o.recreatePhysicalRanges(t),o.clearOffsetInformation(t)})):Object(C.arrayEach)(h,(function(t){o.shiftEndpointCoordinates(t,y)})),l&&this.refreshAllEndpoints()}else this.hot.addHookOnce("beforeViewRender",(function t(){return o.hot.removeHook("beforeViewRender",t),o.refreshAllEndpoints()}))}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,e,n,r){Object(C.arrayEach)(t.ranges,(function(t){t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=r:n<t[0]&&(t[0]-=r):n>=t[0]&&n<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(t){var e=this,n=t.ranges,r=[],o=[];Object(C.arrayEach)(n,(function(t){var n=[];if(t[1])for(var i=t[0];i<=t[1];i++)n.push(e.hot.toPhysicalRow(i));else n.push(e.hot.toPhysicalRow(t[0]));o.push(n)})),Object(C.arrayEach)(o,(function(t){var e=[];Object(C.arrayEach)(t,(function(n,o){0===o?e.push(n):t[o]!==t[o-1]+1&&(e.push(t[o-1]),r.push(e),(e=[]).push(n)),o===t.length-1&&(e.push(n),r.push(e))}))})),t.ranges=r}},{key:"shiftEndpointCoordinates",value:function(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,Object(C.arrayEach)(t.ranges,(function(element){Object(C.arrayEach)(element,(function(n,r){n>=e&&(element[r]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.some((function(e){var n=e.alterRowOffset||0,r=e.alterColumnOffset||0;return e.destinationRow+n>=t.hot.countRows()||e.destinationColumn+r>=t.hot.countCols()}))||(this.cellsToSetCache=[],Object(C.arrayEach)(e,(function(e){t.resetEndpointValue(e,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var t=this;this.cellsToSetCache=[],Object(C.arrayEach)(this.getAllEndpoints(),(function(e){t.currentEndpoint=e,t.plugin.calculate(e),t.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var e=this,n=[];this.cellsToSetCache=[],Object(C.arrayEach)(t,(function(t,r,o){"".concat(t[2]||"")!=="".concat(t[3])&&Object(C.arrayEach)(e.getAllEndpoints(),(function(t,l){e.hot.propToCol(o[r][1])===t.sourceColumn&&-1===n.indexOf(l)&&n.push(l)}))})),Object(C.arrayEach)(n,(function(t){e.refreshEndpoint(e.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.alterRowOffset||0,r=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?n:0)),this.hot.toVisualColumn(t.destinationColumn+(e?r:0)),""])}},{key:"setEndpointValue",value:function(t,source){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var r=this.hot.toVisualRow(t.destinationRow);if(null!==r){var o=this.hot.getCellMeta(r,t.destinationColumn);"init"!==source&&o.readOnly===t.readOnly||(o.readOnly=t.readOnly,o.className="columnSummaryResult")}t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),e?this.hot.setDataAtCell(n,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){Object(rr.b)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}],n&&Lo(e.prototype,n),r&&Lo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Vo=Fo,Wo=n(690);function Uo(t){return null==t||isNaN(t)}function zo(t){return zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zo(t)}function Go(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==zo(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==zo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===zo(o)?o:String(o)),n)}var r,o}function Yo(){return Yo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=$o(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Yo.apply(this,arguments)}function Xo(t,p){return Xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Xo(t,p)}function Ko(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=$o(t);if(e){var o=$o(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===zo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function $o(t){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$o(t)}var qo="columnSummary",Qo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xo(t,e)}(l,t);var e,n,r,o=Ko(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,t)).endpoints=null,e}return e=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qo]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[qo],this.endpoints=new Vo(this,this.settings),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(e,n,source){return t.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,n,null,source)})),this.addHook("beforeCreateCol",(function(e,n,source){return t.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,n,null,source)})),this.addHook("beforeRemoveRow",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_row"].concat(r))})),this.addHook("beforeRemoveCol",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_col"].concat(r))})),this.addHook("afterCreateRow",(function(e,n,source){return t.endpoints.resetSetupAfterStructureAlteration("insert_row",e,n,null,source)})),this.addHook("afterCreateCol",(function(e,n,source){return t.endpoints.resetSetupAfterStructureAlteration("insert_col",e,n,null,source)})),this.addHook("afterRemoveRow",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_row"].concat(r))})),this.addHook("afterRemoveCol",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_col"].concat(r))})),this.addHook("afterRowMove",(function(){return t.onAfterRowMove.apply(t,arguments)})),Yo($o(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}},{key:"calculateSum",value:function(t){var e=this,n=0;return Object(c.objectEach)(t.ranges,(function(r){n+=e.getPartialSum(r,t.sourceColumn)})),n}},{key:"getPartialSum",value:function(t,col){var e=0,i=t[1]||t[0],n=null,r=0;do{if(null!==(n=Uo(n=this.getCellValue(i,col))?null:n)){var o=("".concat(n).split(".")[1]||[]).length||1;o>r&&(r=o)}e+=n||0,i-=1}while(i>=t[0]);return Math.round(e*Math.pow(10,r))/Math.pow(10,r)}},{key:"calculateMinMax",value:function(t,e){var n=this,r=null;return Object(c.objectEach)(t.ranges,(function(o){var l=n.getPartialMinMax(o,t.sourceColumn,e);if(null===r&&null!==l&&(r=l),null!==l)switch(e){case"min":r=Math.min(r,l);break;case"max":r=Math.max(r,l)}})),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(t,col,e){var n,r=null,i=t[1]||t[0];do{if(n=Uo(n=this.getCellValue(i,col))?null:n,null===r)r=n;else if(null!==n)switch(e){case"min":r=Math.min(r,n);break;case"max":r=Math.max(r,n)}i-=1}while(i>=t[0]);return r}},{key:"countEmpty",value:function(t,col){var e,n=0,i=t[1]||t[0];do{null===(e=Uo(e=this.getCellValue(i,col))?null:e)&&(n+=1),i-=1}while(i>=t[0]);return n}},{key:"countEntries",value:function(t){var e=this,n=0,r=t.ranges;return Object(c.objectEach)(r,(function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,l=e.countEmpty(r,t.sourceColumn);n+=o,n-=l})),n}},{key:"calculateAverage",value:function(t){return this.calculateSum(t)/this.countEntries(t)}},{key:"getCellValue",value:function(t,col){var e,n,r=this.hot.toVisualRow(t),o=this.hot.toVisualColumn(col),l=this.hot.getSourceDataAtCell(t,col),c="";if(null!==r&&null!==o&&(c=this.hot.getCellMeta(r,o).className||""),c.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof l&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Object(Wo.a)(Bo||(e=["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],(n=["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])||(n=e.slice(0)),Bo=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))),t,col));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(t,source){t&&"ColumnSummary.reset"!==source&&"ColumnSummary.set"!==source&&"loadData"!==source&&this.endpoints.refreshChangedEndpoints(t)}},{key:"onAfterRowMove",value:function(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}],r=[{key:"PLUGIN_KEY",get:function(){return qo}},{key:"PLUGIN_PRIORITY",get:function(){return 220}}],n&&Go(e.prototype,n),r&&Go(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);function Jo(t){return Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jo(t)}function Zo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Jo(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Jo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Jo(o)?o:String(o)),n)}var r,o}var ti=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootDocument=e,this.isRtl=n,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}var e,n,r;return e=t,n=[{key:"setPosition",value:function(t,e){this.editorStyle.left="".concat(t,"px"),this.editorStyle.top="".concat(e,"px")}},{key:"setSize",value:function(t,e){if(t&&e){var input=this.getInputElement();input.style.width="".concat(t,"px"),input.style.height="".concat(e,"px")}}},{key:"getSize",value:function(){return{width:Object(o.outerWidth)(this.getInputElement()),height:Object(o.outerHeight)(this.getInputElement())}}},{key:"resetSize",value:function(){var input=this.getInputElement();input.style.width="",input.style.height=""}},{key:"setReadOnlyState",value:function(t){this.getInputElement().readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Object(o.addClass)(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Object(o.addClass)(e,t.CLASS_EDITOR),Object(o.addClass)(n,t.CLASS_INPUT),e.appendChild(n),this.container.appendChild(e),e}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}],r=[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}],n&&Zo(e.prototype,n),r&&Zo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ei=ti,ni=(n(765),"---------");function ri(t){return Object(o.hasClass)(t,"htSeparator")}function oi(t){return Object(o.hasClass)(t,"htDisabled")}function ii(t){return Object(o.hasClass)(t,"htSelectionDisabled")}function ai(t){var e=t.getSelected();return e?e[0]<0?null:e:null}function si(t,e){var n={};return Object(C.arrayEach)(t,(function(t){t.forAll((function(t,col){t>=0&&col>=0&&(n[t]||(n[t]=[]),n[t][col]=e(t,col))}))})),n}function ui(t,e,n,r,o){Object(C.arrayEach)(t,(function(t){t.forAll((function(t,col){t>=0&&col>=0&&function(t,col,e,n,r,o){var l=r(t,col),c=n;l.className&&(c="vertical"===e?function(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(e)}(l.className,n):function(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(e)}(l.className,n));o(t,col,"className",c)}(t,col,e,n,r,o)}))}))}function ci(t,e){var n=!1;return Array.isArray(t)&&Object(C.arrayEach)(t,(function(t){return t.forAll((function(t,col){if(t>=0&&col>=0&&e(t,col))return n=!0,!1})),n})),n}function fi(label){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(label)}function hi(t,e){for(var n=t.slice(0);0<n.length&&n[0].name===e;)n.shift();return n}function di(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ni,n=t.slice(0);return n=function(t,e){var n=t.slice(0);return n.reverse(),(n=hi(n,e)).reverse(),n}(n=hi(n,e),e),n=function(t){var e=[];return Object(C.arrayEach)(t,(function(t,n){n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}(n),n}var pi=n(716);function yi(t){return yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yi(t)}function bi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==yi(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==yi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===yi(o)?o:String(o)),n)}var r,o}var vi=250,mi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}var e,n,r;return e=t,n=[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")}),250)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vi;this.showDebounced=Object(jr.debounce)((function(e){t.wasLastActionShow&&t.runLocalHooks("show",e.from.row,e.from.col)}),e)}},{key:"destroy",value:function(){this.clearLocalHooks()}}],n&&bi(e.prototype,n),r&&bi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(c.mixin)(mi,pi.a);var gi=mi,wi=n(667);function Oi(t){return Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oi(t)}function Si(t,e,n){return(e=Ei(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ci(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ei(n.key),n)}}function Ei(t){var e=function(input,t){if("object"!==Oi(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Oi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Oi(e)?e:String(e)}function Ri(){return Ri="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Pi(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Ri.apply(this,arguments)}function ki(t,p){return ki=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ki(t,p)}function ji(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Pi(t);if(e){var o=Pi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Oi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ti(t)}(this,n)}}function Ti(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pi(t){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pi(t)}var Ai="comments",Mi=new WeakMap,_i="comment",xi="value",Ii="style",Ni="readOnly",Hi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ki(t,e)}(f,t);var e,n,r,l=ji(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=l.call(this,t)).editor=null,e.displaySwitch=null,e.eventManager=null,e.range={},e.preventEditorAutoSwitch=!1,Mi.set(Ti(e),{tempEditorDimensions:{},cellBelowCursor:null}),e}return e=f,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ai]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.editor||(this.editor=new ei(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new X.a(this)),this.displaySwitch||(this.displaySwitch=new gi(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addToContextMenu(e)})),this.addHook("afterRenderer",(function(e,n,col,r,o,l){return t.onAfterRenderer(e,l)})),this.addHook("afterScrollHorizontally",(function(){return t.hide()})),this.addHook("afterScrollVertically",(function(){return t.hide()})),this.addHook("afterBeginEditing",(function(){return t.hide()})),this.displaySwitch.addLocalHook("hide",(function(){return t.hide()})),this.displaySwitch.addLocalHook("show",(function(e,col){return t.showAtCell(e,col)})),this.registerListeners(),Ri(Pi(f.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ri(Pi(f.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Ri(Pi(f.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var t=this,e=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(e,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return t.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(e){return t.onEditorMouseDown(e)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(e){return t.onEditorMouseUp(e)}))}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=Object(o.closest)(t.target,"TD","TBODY");return!!(e&&Object(o.hasClass)(e,"htCommentCell")&&Object(o.closest)(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!=t?n=t:null!=e&&(n=e);var r=this.range.from.row,col=this.range.from.col;this.updateCommentMeta(r,col,Si({},xi,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,_i),t&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(n)}},{key:"getComment",value:function(){var t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,xi)}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,xi)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.range.from,e=t.row,col=t.col;if(e<0||e>this.hot.countSourceRows()-1||col<0||col>this.hot.countSourceCols()-1)return!1;var meta=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(meta[_i]?meta[_i][xi]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var t,e;if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible()){var n=this.hot,r=n.rowIndexMapper,l=n.columnIndexMapper,c=this.range.from,f=c.row,h=c.col,d=r.getRenderableFromVisualIndex(f),y=l.getRenderableFromVisualIndex(h),v=null===d;this.editor.setPosition(0,0),null===d&&(d=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(f,-1))),null===y&&(y=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,-1)));var m=null===d,w=null===y;d=null!==(t=d)&&void 0!==t?t:0,y=null!==(e=y)&&void 0!==e?e:0;var O=this.hot,S=O.rootWindow,C=O.view._wt,E=C.wtTable,R=C.getCell({row:d,col:y},!0),k=this.getCommentMeta(f,h,Ii);k?this.editor.setSize(k.width,k.height):this.editor.resetSize();var j=w?0:E.getStretchedColumnWidth(y),T=v&&!m?Object(o.outerHeight)(R):0,P=R.getBoundingClientRect(),A=P.left,M=P.top,_=P.width,x=P.height,I=this.editor.getSize(),N=I.width,H=I.height,D=this.hot.rootWindow,L=D.innerWidth,B=D.innerHeight,F=this.hot.rootDocument.documentElement,V=A+S.scrollX+j,W=M+S.scrollY+T;this.hot.isRtl()&&(V-=N+j),this.hot.isLtr()&&A+_+N>L?V=A+S.scrollX-N-1:this.hot.isRtl()&&V<-(F.scrollWidth-F.clientWidth)&&(V=A+S.scrollX+j+1),M+H>B&&(W-=H-x+1),this.editor.setPosition(V,W),this.editor.setReadOnlyState(this.getCommentMeta(f,h,Ni))}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRangeLast();if(!t)return!1;var e=!1,n=t.getTopStartCorner();return this.getCommentMeta(n.row,n.col,xi)&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var r,o=this.hot.getCellMeta(t,e)[_i];o?(r=Object(c.deepClone)(o),Object(c.deepExtend)(r,n)):r=n,this.hot.setCellMeta(t,e,_i,r)}},{key:"getCommentMeta",value:function(t,e,n){var r=this.hot.getCellMeta(t,e);if(r[_i])return r[_i][n]}},{key:"onMouseDown",value:function(t){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(t)){var e=Object(o.closest)(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}},{key:"onMouseOver",value:function(t){var e=Mi.get(this),n=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Object(o.hasClass)(t.target,"wtBorder")||e.cellBelowCursor===t.target)&&this.editor)if(e.cellBelowCursor=n.elementFromPoint(t.clientX,t.clientY),this.targetIsCellWithComment(t)){var r=this.hot._createCellRange(this.hot.getCoords(t.target));this.displaySwitch.show(r)}else Object(o.isChildOf)(t.target,n)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(t,e){e[_i]&&e[_i][xi]&&Object(o.addClass)(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(t){Mi.get(this).tempEditorDimensions={width:Object(o.outerWidth)(t.target),height:Object(o.outerHeight)(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=Mi.get(this),n=Object(o.outerWidth)(t.target),r=Object(o.outerHeight)(t.target);n===e.tempEditorDimensions.width+1&&r===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,Si({},Ii,{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:t.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var t=this,e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((function(e,n){e>=0&&n>=0&&t.removeCommentAtCell(e,n,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var t=this,e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((function(e,n){if(e>=0&&n>=0){var r=!!t.getCommentMeta(e,n,Ni);t.updateCommentMeta(e,n,Si({},Ni,!r))}}))}},{key:"addToContextMenu",value:function(t){var e=this,n=function(){return e.hot.rowIndexMapper.getRenderableIndexesLength()>0&&e.hot.columnIndexMapper.getRenderableIndexesLength()>0};t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.checkSelectionCommentsConsistency()?e.hot.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_EDIT_COMMENT):e.hot.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!n()||!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return e.onContextMenuRemoveComment()},disabled:function(){return!n()||!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return ci(this.getSelectedRangeLast(),(function(e,col){var n=t.getCellMeta(e,col)[_i];if(n&&(n=n[Ni]),n)return!0}))&&(label=fi(label)),label},callback:function(){return e.onContextMenuMakeReadOnly()},disabled:function(){return!n()||!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner()&&e.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings()[Ai];if(Object(c.isObject)(t))return t.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Ri(Pi(f.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Ai}},{key:"PLUGIN_PRIORITY",get:function(){return 60}}],n&&Ci(e.prototype,n),r&&Ci(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a);function Di(t){return Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Di(t)}function Li(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Di(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Di(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Di(o)?o:String(o)),n)}var r,o}var Bi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.commands={},this.commonCallback=null}var e,n,r;return e=t,n=[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var l=t.split(":"),f=l[0],h=2===l.length?l[1]:null,d=this.commands[f];if(!d)throw new Error("Menu command '".concat(f,"' not exists."));if(h&&d.submenu&&(d=function(t,e){var n;return Object(C.arrayEach)(e,(function(e){var r=e.key?e.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=e,!1})),n}(h,d.submenu.items)),!0!==d.disabled&&("function"!=typeof d.disabled||!0!==d.disabled.call(this.hot))&&!Object(c.hasOwnProperty)(d,"submenu")){var y=[];"function"==typeof d.callback&&y.push(d.callback),"function"==typeof this.commonCallback&&y.push(this.commonCallback),r.unshift(l.join(":")),Object(C.arrayEach)(y,(function(t){return t.apply(e.hot,r)}))}}}],n&&Li(e.prototype,n),r&&Li(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Fi=Bi,Vi="alignment";var Wi="clear_column";var Ui="col_left";var zi="col_right";var Gi="make_read_only";var Yi="redo";var Xi=n(820);function Ki(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return $i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $i(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var qi="remove_col";function Qi(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Ji(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ji(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ji(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Zi="remove_row";var ta="row_above";var ea="row_below";var na="no_items";var ra,oa="undo";function ia(t){return ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ia(t)}function aa(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==ia(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ia(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ia(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var la=[ta,ea,Ui,zi,Wi,Zi,qi,oa,Yi,Gi,Vi,ni,na],sa=(aa(ra={},ni,(function(){return{name:ni}})),aa(ra,na,(function(){return{key:na,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}})),aa(ra,ta,(function(){return{key:ta,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){return!ai(this)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),aa(ra,ea,(function(){return{key:ea,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){return!ai(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),aa(ra,Ui,(function(){return{key:Ui,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled:function(){return!this.isColumnModificationAllowed()||(!ai(this)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}})),aa(ra,zi,(function(){return{key:zi,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled:function(){return!this.isColumnModificationAllowed()||(!ai(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}})),aa(ra,Wi,(function(){return{key:Wi,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(t,e){var n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){return!ai(this)||!this.selection.isSelectedByColumnHeader()}}})),aa(ra,Zi,(function(){return{key:Zi,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=Qi(t[0],3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback:function(){this.alter("remove_row",Object(Xi.g)(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){if(!ai(this))return!0;var t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden:function(){return!this.getSettings().allowRemoveRow}}})),aa(ra,qi,(function(){return{key:qi,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=Ki(t[0],4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback:function(){this.alter("remove_col",Object(Xi.f)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;if(!ai(this))return!0;var t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden:function(){return!this.getSettings().allowRemoveColumn}}})),aa(ra,oa,(function(){return{key:oa,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}})),aa(ra,Yi,(function(){return{key:Yi,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}})),aa(ra,Gi,(function(){return{key:Gi,name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_READ_ONLY);return ci(this.getSelectedRange(),(function(e,col){return t.getCellMeta(e,col).readOnly}))&&(label=fi(label)),label},callback:function(){var t=this,e=this.getSelectedRange(),n=ci(e,(function(e,col){return t.getCellMeta(e,col).readOnly}));Object(C.arrayEach)(e,(function(e){e.forAll((function(e,col){e>=0&&col>=0&&t.setCellMeta(e,col,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}})),aa(ra,Vi,(function(){return{key:Vi,name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Vi,":left"),name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return ci(this.getSelectedRange(),(function(e,col){var n=t.getCellMeta(e,col).className;if(n&&-1!==n.indexOf("htLeft"))return!0}))&&(label=fi(label)),label},callback:function(){var t=this,e=this.getSelectedRange(),n=si(e,(function(e,col){return t.getCellMeta(e,col).className})),r="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,e,r,o),ui(e,r,o,(function(e,col){return t.getCellMeta(e,col)}),(function(e,col,n,r){return t.setCellMeta(e,col,n,r)})),this.render()},disabled:!1},{key:"".concat(Vi,":center"),name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return ci(this.getSelectedRange(),(function(e,col){var n=t.getCellMeta(e,col).className;if(n&&-1!==n.indexOf("htCenter"))return!0}))&&(label=fi(label)),label},callback:function(){var t=this,e=this.getSelectedRange(),n=si(e,(function(e,col){return t.getCellMeta(e,col).className})),r="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,e,r,o),ui(e,r,o,(function(e,col){return t.getCellMeta(e,col)}),(function(e,col,n,r){return t.setCellMeta(e,col,n,r)})),this.render()},disabled:!1},{key:"".concat(Vi,":right"),name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return ci(this.getSelectedRange(),(function(e,col){var n=t.getCellMeta(e,col).className;if(n&&-1!==n.indexOf("htRight"))return!0}))&&(label=fi(label)),label},callback:function(){var t=this,e=this.getSelectedRange(),n=si(e,(function(e,col){return t.getCellMeta(e,col).className})),r="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,e,r,o),ui(e,r,o,(function(e,col){return t.getCellMeta(e,col)}),(function(e,col,n,r){return t.setCellMeta(e,col,n,r)})),this.render()},disabled:!1},{key:"".concat(Vi,":justify"),name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return ci(this.getSelectedRange(),(function(e,col){var n=t.getCellMeta(e,col).className;if(n&&-1!==n.indexOf("htJustify"))return!0}))&&(label=fi(label)),label},callback:function(){var t=this,e=this.getSelectedRange(),n=si(e,(function(e,col){return t.getCellMeta(e,col).className})),r="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,e,r,o),ui(e,r,o,(function(e,col){return t.getCellMeta(e,col)}),(function(e,col,n,r){return t.setCellMeta(e,col,n,r)})),this.render()},disabled:!1},{name:ni},{key:"".concat(Vi,":top"),name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return ci(this.getSelectedRange(),(function(e,col){var n=t.getCellMeta(e,col).className;if(n&&-1!==n.indexOf("htTop"))return!0}))&&(label=fi(label)),label},callback:function(){var t=this,e=this.getSelectedRange(),n=si(e,(function(e,col){return t.getCellMeta(e,col).className})),r="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,e,r,o),ui(e,r,o,(function(e,col){return t.getCellMeta(e,col)}),(function(e,col,n,r){return t.setCellMeta(e,col,n,r)})),this.render()},disabled:!1},{key:"".concat(Vi,":middle"),name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return ci(this.getSelectedRange(),(function(e,col){var n=t.getCellMeta(e,col).className;if(n&&-1!==n.indexOf("htMiddle"))return!0}))&&(label=fi(label)),label},callback:function(){var t=this,e=this.getSelectedRange(),n=si(e,(function(e,col){return t.getCellMeta(e,col).className})),r="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,e,r,o),ui(e,r,o,(function(e,col){return t.getCellMeta(e,col)}),(function(e,col,n,r){return t.setCellMeta(e,col,n,r)})),this.render()},disabled:!1},{key:"".concat(Vi,":bottom"),name:function(){var t=this,label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return ci(this.getSelectedRange(),(function(e,col){var n=t.getCellMeta(e,col).className;if(n&&-1!==n.indexOf("htBottom"))return!0}))&&(label=fi(label)),label},callback:function(){var t=this,e=this.getSelectedRange(),n=si(e,(function(e,col){return t.getCellMeta(e,col).className})),r="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,e,r,o),ui(e,r,o,(function(e,col){return t.getCellMeta(e,col)}),(function(e,col,n,r){return t.setCellMeta(e,col,n,r)})),this.render()},disabled:!1}]}}})),ra);function ua(){var t={};return Object(c.objectEach)(sa,(function(e,n){t[n]=e()})),t}function ca(t){return ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ca(t)}function fa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ca(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ca(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ca(o)?o:String(o)),n)}var r,o}var ha=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.predefinedItems=ua(),this.defaultOrderPattern=n}var e,n,r;return e=t,n=[{key:"setPredefinedItems",value:function(t){var e=this,n={};this.defaultOrderPattern.length=0,Object(c.objectEach)(t,(function(t,r){var o="";t.name===ni?(n[ni]=t,o=ni):isNaN(parseInt(r,10))?(t.key=void 0===t.key?r:t.key,n[r]=t,o=t.key):(n[t.key]=t,o=t.key),e.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],pattern=t;return pattern&&pattern.items?pattern=pattern.items:Array.isArray(pattern)||(pattern=e),Object(c.isObject)(pattern)?Object(c.objectEach)(pattern,(function(t,e){var o=n["string"==typeof t?t:e];o||(o=t),Object(c.isObject)(t)?Object(c.extend)(o,t):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=e),r.push(o)})):Object(C.arrayEach)(pattern,(function(t,e){var o=n[t];!o&&la.indexOf(t)>=0||(o||(o={name:t,key:"".concat(e)}),Object(c.isObject)(t)&&Object(c.extend)(o,t),void 0===o.key&&(o.key=e),r.push(o))})),r}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}],n&&fa(e.prototype,n),r&&fa(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();var da=ha;n(245);function pa(t){return pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pa(t)}function ya(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==pa(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==pa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===pa(o)?o:String(o)),n)}var r,o}var ba=function(){function t(object,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n,r,l,c,f,h,d=Object(o.getWindowScrollTop)(e),y=Object(o.getWindowScrollLeft)(e);this.rootWindow=e,this.type=this.getSourceType(object),"literal"===this.type?(n=parseInt(object.top,10),l=parseInt(object.left,10),f=object.height||0,h=object.width||0,r=n,c=l,n+=d,l+=y):"event"===this.type&&(n=parseInt(object.pageY,10),l=parseInt(object.pageX,10),f=object.target.clientHeight,h=object.target.clientWidth,r=n-d,c=l-y),this.top=n,this.topRelative=r,this.left=l,this.leftRelative=c,this.scrollTop=d,this.scrollLeft=y,this.cellHeight=f,this.cellWidth=h}var e,n,r;return e=t,n=[{key:"getSourceType",value:function(object){var t="literal";return object instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(element){return this.topRelative>=element.offsetHeight}},{key:"fitsBelow",value:function(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+element.offsetHeight<=t}},{key:"fitsOnRight",value:function(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+element.offsetWidth<=t}},{key:"fitsOnLeft",value:function(element){return this.leftRelative>=element.offsetWidth}}],n&&ya(e.prototype,n),r&&ya(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),va=ba,ma=n(861),ga=n(715);function wa(t){return wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wa(t)}function Oa(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Sa(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Oa(Object(source),!0).forEach((function(e){Ca(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Oa(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Ca(t,e,n){return(e=Ra(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ea(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ra(n.key),n)}}function Ra(t){var e=function(input,t){if("object"!==wa(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==wa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===wa(e)?e:String(e)}var ka=215,ja="menu",Ta=ja,Pa=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:ka,container:this.hot.rootDocument.documentElement},this.eventManager=new X.a(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}var e,n,r;return e=t,n=[{key:"registerEvents",value:function(){for(var t=this,e=this.hot.rootWindow;e;)this.eventManager.addEventListener(e.document,"mousedown",(function(e){return t.onDocumentMouseDown(e)})),this.eventManager.addEventListener(e.document,"contextmenu",(function(e){return t.onDocumentContextMenu(e)})),e=Object(o.getParentWindow)(e)}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(area){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[area]=t}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var e=Object(jr.debounce)((function(e){return t.openSubMenu(e)}),300),n=this.options.minWidth||ka,r=!1,c=Object(C.arrayFilter)(this.menuItems,(function(e){return e.key===na&&(r=!0),function(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}(e,t.hot)}));if(c.length<1&&!r)c.push(ua()[na]);else if(0===c.length)return;c=di(c,ni);var f=!1,h={data:c,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(t){return Object(E.isDefined)(t)&&t<n?n:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(e,n,r,col,o,l){return t.menuItemRenderer(e,n,r,col,o,l)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(n,r){t.isAllSubMenusClosed()?e(r.row):t.openSubMenu(r.row)},rowHeights:function(t){return c[t].name===ni?1:23},afterOnCellContextMenu:function(e){e.preventDefault(),Object(ga.isWindowsOS)()&&f&&t.hasSelectedItem()&&t.close(!0)},beforeOnCellMouseUp:function(e){t.hasSelectedItem()&&(f=!t.isCommandPassive(t.getSelectedItem()),t.executeCommand(e))},afterOnCellMouseUp:function(e){Object(ga.isWindowsOS)()&&Object(l.isRightClick)(e)||!f||!t.hasSelectedItem()||(Object(ga.isMobileBrowser)()||Object(ga.isIpadOS)()?setTimeout((function(){return t.close(!0)}),325):t.close(!0))},afterUnlisten:function(){!t.hasSelectedItem()&&t.isOpened()&&t.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new ma.a(this.container,h),this.hotMenu.addHook("afterInit",(function(){return t.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return t.onAfterSelection.apply(t,arguments)})),this.hotMenu.init(),this.hotMenu.listen();var d=this.hotMenu.getShortcutManager(),y=d.addContext(Ta),v=Sa(Sa({},{group:ja}),{},{runOnlyIf:function(e){return!1===Object(o.isInput)(e.target)||!1===t.container.contains(e.target)}});d.setActiveContextName("menu"),y.addShortcuts([{keys:[["Escape"]],callback:function(){t.keyEvent=!0,t.close(),t.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.selectNextCell(e[0],e[1]):t.selectFirstCell(),t.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.selectPrevCell(e[0],e[1]):t.selectLastCell(),t.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var e=t.hotMenu.getSelectedLast();if(t.keyEvent=!0,e){var menu=t.openSubMenu(e[0]);menu&&menu.selectFirstCell()}t.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e&&t.isSubMenu()&&(t.close(),t.parentMenu&&t.parentMenu.hotMenu.listen()),t.keyEvent=!1}},{keys:[["Enter"]],callback:function(e){var n=t.hotMenu.getSelectedLast();t.keyEvent=!0,t.hotMenu.getSourceDataAtRow(n[0]).submenu||(t.executeCommand(e),t.close(!0)),t.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.selectFirstCell(),t.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.selectLastCell(),t.keyEvent=!1}}],v),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!function(t){return Object(o.hasClass)(t,"htSubmenu")}(n))return!1;var r=this.hotMenu.getSourceDataAtRow(e),l=new t(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return l.setMenuItems(r.submenu.items),l.open(),l.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=l,l}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var t=this;Object(C.arrayEach)(this.hotMenu.getData(),(function(e,n){return t.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hasSelectedItem()){var e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),!this.isCommandPassive(e)){var n=this.hot.getSelectedRange(),r=n?function(t){return Object(C.arrayMap)(t,(function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}}))}(n):[];this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t)}}}},{key:"isCommandPassive",value:function(t){var e=t.isCommand,n=t.name,r=t.disabled,o=t.submenu,l=!0===r||"function"==typeof r&&!0===r.call(this.hot);return!1===e||n===ni||!0===l||o}},{key:"setPosition",value:function(t){var cursor=new va(t,this.container.ownerDocument.defaultView);this.options.keepInViewport?(cursor.fitsBelow(this.container)?this.setPositionBelowCursor(cursor):cursor.fitsAbove(this.container)?this.setPositionAboveCursor(cursor):this.setPositionBelowCursor(cursor),this.hot.isLtr()?this.setHorizontalPositionForLtr(cursor):this.setHorizontalPositionForRtl(cursor)):(this.setPositionBelowCursor(cursor),this.setPositionOnRightOfCursor(cursor))}},{key:"setHorizontalPositionForRtl",value:function(cursor){cursor.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(cursor):this.setPositionOnRightOfCursor(cursor)}},{key:"setHorizontalPositionForLtr",value:function(cursor){cursor.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(cursor):this.setPositionOnLeftOfCursor(cursor)}},{key:"setPositionAboveCursor",value:function(cursor){var t=this.offset.above+cursor.top-this.container.offsetHeight;this.isSubMenu()&&(t=cursor.top+cursor.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(t,"px")}},{key:"setPositionBelowCursor",value:function(cursor){var t=this.offset.below+cursor.top+1;this.isSubMenu()&&(t=cursor.top-1),this.container.style.top="".concat(t,"px")}},{key:"setPositionOnRightOfCursor",value:function(cursor){var t=cursor.left;if(this.isSubMenu()){var e=this.parentMenu.container.getBoundingClientRect().right;t+=cursor.cellWidth+e-(cursor.left+cursor.cellWidth)}else t+=this.offset.right;this.container.style.left="".concat(t,"px")}},{key:"setPositionOnLeftOfCursor",value:function(cursor){var t=this.offset.left+cursor.left-this.container.offsetWidth;if(this.isSubMenu()){var e=this.parentMenu.container.getBoundingClientRect().left;t-=cursor.left-e}this.container.style.left="".concat(t,"px")}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);ri(t)||oi(t)||ii(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);ri(e)||oi(e)||ii(e)?this.selectPrevCell(t,0):(this.hotMenu.selectCell(t,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(t,0,!0,!1))}},{key:"selectNextCell",value:function(t,col){var e=t+1,n=e<this.hotMenu.countRows()?this.hotMenu.getCell(e,col):null;n&&(ri(n)||oi(n)||ii(n)?this.selectNextCell(e,col):this.hotMenu.selectCell(e,col))}},{key:"selectPrevCell",value:function(t,col){var e=t-1,n=e>=0?this.hotMenu.getCell(e,col):null;n&&(ri(n)||oi(n)||ii(n)?this.selectPrevCell(e,col):this.hotMenu.selectCell(e,col))}},{key:"menuItemRenderer",value:function(t,e,n,col,r,l){var f,h=this,d=t.getSourceDataAtRow(n),y=this.hot.rootDocument.createElement("div"),v=function(t){return t.disableSelection},m=l;"function"==typeof m&&(m=m.call(this.hot)),Object(o.empty)(e),Object(o.addClass)(y,"htItemWrapper"),e.appendChild(y),f=d,new RegExp(ni,"i").test(f.name)?Object(o.addClass)(e,"htSeparator"):"function"==typeof d.renderer?(Object(o.addClass)(e,"htCustomMenuRenderer"),e.appendChild(d.renderer(t,y,n,col,r,m))):Object(o.fastInnerHTML)(y,m),function(t){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(h.hot)}(d)?(Object(o.addClass)(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):v(d)?(Object(o.addClass)(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):function(t){return Object(c.hasOwnProperty)(t,"submenu")}(d)?(Object(o.addClass)(e,"htSubmenu"),v(d)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,col,void 0,void 0,!1,!1)}))):(Object(o.removeClass)(e,["htSubmenu","htDisabled"]),v(d)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,col,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,r=e;return r&&(Object(jr.isFunction)(r)&&(r=null===(r=r.call(this.hot))||Object(E.isUndefined)(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),t=n.querySelector(".".concat(this.options.className,".").concat(r))),t||(t=n.createElement("div"),Object(o.addClass)(t,"htMenu ".concat(this.options.className)),r&&Object(o.addClass)(t,r),this.options.container.appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var t=this.hotMenu.view._wt.wtTable,data=this.hotMenu.getSettings().data,e=t.hider.style,n=t.holder.style,r=parseInt(e.width,10),o=Object(C.arrayReduce)(data,(function(t,e){return t+(e.name===ni?1:26)}),0);n.width="".concat(r+3,"px"),n.height="".concat(o+3,"px"),e.height=n.height}},{key:"onAfterSelection",value:function(t,e,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Object(o.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Object(o.isChildOf)(t.target,".htMenu")||this.close(!0))}},{key:"onDocumentContextMenu",value:function(t){this.isOpened()&&Object(o.hasClass)(t.target,"htCore")&&Object(o.isChildOf)(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}],n&&Ea(e.prototype,n),r&&Ea(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(c.mixin)(Pa,pi.a);var Aa=Pa;function Ma(t){return Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ma(t)}function _a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ma(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ma(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ma(o)?o:String(o)),n)}var r,o}function xa(){return xa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Da(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},xa.apply(this,arguments)}function Ia(t,p){return Ia=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ia(t,p)}function Na(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Da(t);if(e){var o=Da(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Ma(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ha(t)}(this,n)}}function Ha(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Da(t){return Da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Da(t)}var La="contextMenu";it.a.getSingleton().register("afterContextMenuDefaultOptions"),it.a.getSingleton().register("beforeContextMenuShow"),it.a.getSingleton().register("afterContextMenuShow"),it.a.getSingleton().register("afterContextMenuHide"),it.a.getSingleton().register("afterContextMenuExecute");var Ba=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ia(t,e)}(c,t);var e,n,r,l=Na(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=l.call(this,t)).eventManager=new X.a(Ha(e)),e.commandExecutor=new Fi(e.hot),e.itemsFactory=null,e.menu=null,e}return e=c,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[La]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[La];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new Aa(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))})),this.addHook("afterOnCellContextMenu",(function(e){return t.onAfterOnCellContextMenu(e)})),xa(Da(c.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),xa(Da(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),xa(Da(c.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(t){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement.getBoundingClientRect(),l=r.top,c=r.left;e=l-Object(o.getWindowScrollTop)(t.view),n=c-Object(o.getWindowScrollLeft)(t.view)}else e=-1*Object(o.getWindowScrollTop)(this.menu.hotMenu.rootWindow),n=-1*Object(o.getWindowScrollLeft)(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(t.pageY,10)+e,left:parseInt(t.pageX,10)+n})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(t){var e;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"prepareMenuItems",value:function(){var t=this;this.itemsFactory=new da(this.hot,c.DEFAULT_ITEMS);var e=this.hot.getSettings()[La],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);var r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),Object(C.arrayEach)(r,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}},{key:"onAfterOnCellContextMenu",value:function(t){var e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders,element=t.target;this.close(),Object(o.hasClass)(element,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),(n||r||function(element){return"TD"===element.nodeName||"TD"===element.parentNode.nodeName}(element)||Object(o.hasClass)(element,"current")&&Object(o.hasClass)(element,"wtBorder"))&&this.open(t))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),xa(Da(c.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return La}},{key:"PLUGIN_PRIORITY",get:function(){return 70}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[ta,ea,ni,Ui,zi,ni,Zi,qi,ni,oa,Yi,ni,Gi,ni,Vi]}}],n&&_a(e.prototype,n),r&&_a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a);Ba.SEPARATOR={name:ni};n(793);var Fa=n(1064);function Va(t){return Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Va(t)}function Wa(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Va(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Va(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Va(o)?o:String(o)),n)}var r,o}var Ua=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data={}}var e,n,r;return e=t,(n=[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}])&&Wa(e.prototype,n),r&&Wa(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function za(t){return za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},za(t)}function Ga(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==za(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==za(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===za(o)?o:String(o)),n)}var r,o}function Ya(t,e,n){return e&&Ga(t.prototype,e),n&&Ga(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Xa=Ya((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clipboardData=new Ua}));function Ka(t){return Ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ka(t)}function $a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ka(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ka(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ka(o)?o:String(o)),n)}var r,o}var qa=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new X.a(this),this.listenersCount=new WeakSet,this.container=e}var e,n,r;return e=t,(n=[{key:"useSecondaryElement",value:function(){var t=function(t){var e=tl.get(t);if(e)return e.parentElement||t.appendChild(e),e;var element=(t.defaultView?t:t.ownerDocument).createElement("textarea");return tl.set(t,element),element.setAttribute("data-hot-input",""),element.className="HandsontableCopyPaste",element.tabIndex=-1,element.autocomplete="off",element.wrap="hard",element.value=" ",t.appendChild(element),element}(this.container);this.listenersCount.has(t)||(this.listenersCount.add(t),Za(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(element){this.listenersCount.has(element)||(this.listenersCount.add(element),Za(this.eventManager,element,this)),this.mainElement=element}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Object(ga.isMobileBrowser)()||Object(o.selectElementIfAllowed)(this.mainElement)}}])&&$a(e.prototype,n),r&&$a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(c.mixin)(qa,pi.a);var Qa=new WeakMap;var Ja=function(t,e){return function(n){return e.runLocalHooks(t,n)}};function Za(t,element,e){t.addEventListener(element,"copy",Ja("copy",e)),t.addEventListener(element,"cut",Ja("cut",e)),t.addEventListener(element,"paste",Ja("paste",e))}var tl=new WeakMap;function el(t){if(t instanceof qa){var e=Qa.get(t.container);if((e=isNaN(e)?0:e)>0&&(e-=1),function(t){t.eventManager.clear()}(t),e<=0){e=0;var n=tl.get(t.container);n&&n.parentNode&&(n.parentNode.removeChild(n),tl.delete(t.container)),t.mainElement=null}Qa.set(t.container,e)}}function nl(t){return nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nl(t)}function rl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==nl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==nl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===nl(o)?o:String(o)),n)}var r,o}function il(t,e){ll(t,e),e.add(t)}function al(t,e,n){ll(t,e),e.set(t,n)}function ll(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function cl(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,hl(t,e,"get"))}function fl(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,hl(t,e,"set"),n),n}function hl(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var pl=new WeakMap,yl=new WeakMap,bl=new WeakMap,vl=new WeakMap,ml=new WeakMap,gl=new WeakMap,wl=new WeakSet,Ol=new WeakSet,Sl=function(){function t(e){var n=e.countRows,r=e.countColumns,o=e.rowsLimit,l=e.columnsLimit,c=e.countColumnHeaders;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),il(this,Ol),il(this,wl),al(this,pl,{writable:!0,value:void 0}),al(this,yl,{writable:!0,value:void 0}),al(this,bl,{writable:!0,value:void 0}),al(this,vl,{writable:!0,value:void 0}),al(this,ml,{writable:!0,value:void 0}),al(this,gl,{writable:!0,value:void 0}),fl(this,yl,n),fl(this,bl,r),fl(this,vl,o),fl(this,ml,l),fl(this,gl,c)}var e,n,r;return e=t,(n=[{key:"setSelectedRange",value:function(t){fl(this,pl,t)}},{key:"getCellsRange",value:function(){if(0===cl(this,yl).call(this)||0===cl(this,bl).call(this))return null;var t=cl(this,pl).getTopStartCorner(),e=t.row,n=t.col,r=cl(this,pl).getBottomEndCorner(),o=r.row,l=r.col,c=sl(this,Ol,El).call(this,e,o),f=sl(this,wl,Cl).call(this,n,l);return{isRangeTrimmed:o!==c||l!==f,startRow:e,startCol:n,endRow:c,endCol:f}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(0===cl(this,bl).call(this)||0===cl(this,gl).call(this))return null;var t=cl(this,pl).getTopStartCorner().col,e=cl(this,pl).getBottomEndCorner().col,n=sl(this,wl,Cl).call(this,t,e);return{isRangeTrimmed:e!==n,startRow:-1,startCol:t,endRow:-1,endCol:n}}},{key:"getAllColumnHeadersRange",value:function(){if(0===cl(this,bl).call(this)||0===cl(this,gl).call(this))return null;var t=cl(this,pl).getTopStartCorner().col,e=cl(this,pl).getBottomEndCorner().col,n=sl(this,wl,Cl).call(this,t,e);return{isRangeTrimmed:e!==n,startRow:-cl(this,gl).call(this),startCol:t,endRow:-1,endCol:n}}}])&&rl(e.prototype,n),r&&rl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Cl(t,e){return Math.min(e,Math.max(t+cl(this,ml).call(this)-1,t))}function El(t,e){return Math.min(e,Math.max(t+cl(this,vl).call(this)-1,t))}function Rl(t){var e=[],n=[];return Object(C.arrayEach)(t,(function(t){var r=Math.min(t.startRow,t.endRow),o=Math.max(t.startRow,t.endRow);Object(re.rangeEach)(r,o,(function(t){-1===e.indexOf(t)&&e.push(t)}));var l=Math.min(t.startCol,t.endCol),c=Math.max(t.startCol,t.endCol);Object(re.rangeEach)(l,c,(function(t){-1===n.indexOf(t)&&n.push(t)}))})),{rows:e,columns:n}}var kl=n(769);function jl(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Tl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tl(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Pl(t){return Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pl(t)}function Al(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bl(n.key),n)}}function Ml(){return Ml="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Nl(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Ml.apply(this,arguments)}function _l(t,p){return _l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},_l(t,p)}function xl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Nl(t);if(e){var o=Nl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Il(t)}(this,n)}}function Il(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nl(t){return Nl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nl(t)}function Hl(t,e,n){Dl(t,e),e.set(t,n)}function Dl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ll(t,e,n){return(e=Bl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bl(t){var e=function(input,t){if("object"!==Pl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Pl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Pl(e)?e:String(e)}function Fl(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Wl(t,e,"get"))}function Vl(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Wl(t,e,"set"),n),n}function Wl(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}it.a.getSingleton().register("afterCopyLimit"),it.a.getSingleton().register("modifyCopyableRange"),it.a.getSingleton().register("beforeCut"),it.a.getSingleton().register("afterCut"),it.a.getSingleton().register("beforePaste"),it.a.getSingleton().register("afterPaste"),it.a.getSingleton().register("beforeCopy"),it.a.getSingleton().register("afterCopy");var Ul="copyPaste",zl=["fragmentSelection"],Gl=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),Yl=new WeakMap,Xl=new WeakMap,Kl=new WeakMap,$l=new WeakMap,ql=new WeakMap,Ql=new WeakMap,Jl=new WeakMap,Zl=new WeakSet,ts=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_l(t,e)}(c,t);var e,n,r,l=xl(c);function c(){var t,e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);for(var r=arguments.length,o=new Array(r),f=0;f<r;f++)o[f]=arguments[f];return t=l.call.apply(l,[this].concat(o)),Dl(e=Il(t),n=Zl),n.add(e),Ll(Il(t),"columnsLimit",1/0),Ll(Il(t),"rowsLimit",1/0),Ll(Il(t),"pasteMode","overwrite"),Ll(Il(t),"uiContainer",t.hot.rootDocument.body),Hl(Il(t),Yl,{writable:!0,value:!1}),Hl(Il(t),Xl,{writable:!0,value:!1}),Hl(Il(t),Kl,{writable:!0,value:!1}),Hl(Il(t),$l,{writable:!0,value:"cells-only"}),Hl(Il(t),ql,{writable:!0,value:!1}),Hl(Il(t),Ql,{writable:!0,value:!1}),Hl(Il(t),Jl,{writable:!0,value:new Sl({countRows:function(){return t.hot.countRows()},countColumns:function(){return t.hot.countCols()},rowsLimit:function(){return t.rowsLimit},columnsLimit:function(){return t.columnsLimit},countColumnHeaders:function(){return t.hot.view.getColumnHeadersCount()}})}),Ll(Il(t),"copyableRanges",[]),Ll(Il(t),"focusableElement",void 0),t}return e=c,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ul]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e,n,r,o,l,f=this.hot.getSettings()[Ul];"object"===Pl(f)&&(this.pasteMode=null!==(e=f.pasteMode)&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(f.rowsLimit)?this.rowsLimit:f.rowsLimit,this.columnsLimit=isNaN(f.columnsLimit)?this.columnsLimit:f.columnsLimit,Vl(this,Yl,!!f.copyColumnHeaders),Vl(this,Xl,!!f.copyColumnGroupHeaders),Vl(this,Kl,!!f.copyColumnHeadersOnly),this.uiContainer=null!==(n=f.uiContainer)&&void 0!==n?n:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("afterOnCellMouseUp",(function(){return t.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return t.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return t.onBeforeKeyDown()})),this.focusableElement=(r=this.uiContainer,o=new qa(r),l=Qa.get(r),l=isNaN(l)?0:l,Qa.set(r,l+1),o),this.focusableElement.addLocalHook("copy",(function(e){return t.onCopy(e)})).addLocalHook("cut",(function(e){return t.onCut(e)})).addLocalHook("paste",(function(e){return t.onPaste(e)})),Ml(Nl(c.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),Ml(Nl(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&el(this.focusableElement),Ml(Nl(c.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){Vl(this,$l,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),Vl(this,ql,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Vl(this,Ql,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(t){return Object(Fa.b)(this.getRangedData(t))}},{key:"getRangedData",value:function(t){var e=this,data=[],n=Rl(t),r=n.rows,o=n.columns;return Object(C.arrayEach)(r,(function(t){var n=[];Object(C.arrayEach)(o,(function(r){t<0?n.push(e.hot.getColHeader(r,t)):n.push(e.hot.getCopyableData(t,r))})),data.push(n)})),data}},{key:"paste",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(t||e){var n=new Xa;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRangeLast();if(t){Fl(this,Jl).setSelectedRange(t);var e=new Map([["headers",null],["cells",null]]);"column-headers-only"===Fl(this,$l)?e.set("headers",Fl(this,Jl).getMostBottomColumnHeadersRange()):("with-column-headers"===Fl(this,$l)?e.set("headers",Fl(this,Jl).getMostBottomColumnHeadersRange()):"with-column-group-headers"===Fl(this,$l)&&e.set("headers",Fl(this,Jl).getAllColumnHeadersRange()),e.set("cells",Fl(this,Jl).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((function(t){return null!==t})).map((function(t){return{startRow:t.startRow,startCol:t.startCol,endRow:t.endRow,endCol:t.endCol}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var n=e.get("cells");if(null!==n&&n.isRangeTrimmed){var r=n.startRow,o=n.startCol,l=n.endRow,c=n.endCol;this.hot.runHooks("afterCopyLimit",l-r+1,c-o+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var t,e=null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.TEXTAREA;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}},{key:"populateValues",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(t.length){for(var n=t.length,r=t[0].length,o=[],l=e.getTopStartCorner(),c=l.row,f=l.col,h=e.getBottomEndCorner(),d=h.row,y=h.col,v=c,m=f,w=c,O=f;o.length<n||v<=d;){var S=this.hot.getCellMeta(v,f),C=S.skipRowOnPaste,E=S.visualRow;if(v=E+1,!0!==C){w=E,m=f;for(var R=[],k=o.length%n;R.length<r||m<=y;){var j=this.hot.getCellMeta(c,m),T=j.skipColumnOnPaste,P=j.visualCol;if(m=P+1,!0!==T){O=P;var A=R.length%r;R.push(t[k][A])}}o.push(R)}}return this.hot.populateFromArray(c,f,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,f,w,O]}}},{key:"onCopy",value:function(t){if((this.hot.isListening()||Fl(this,ql))&&!this.isEditorOpened()){this.setCopyableText(),Vl(this,ql,!1);var data=this.getRangedData(this.copyableRanges),e=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,Zl,es).call(this,this.copyableRanges);if(this.hot.runHooks("beforeCopy",data,this.copyableRanges,e)){var n=Object(Fa.b)(data);if(t&&t.clipboardData){var r=Object(kl._dataToHTML)(data,this.hot.rootDocument);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[Gl,r].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",data,this.copyableRanges,e)}Vl(this,$l,"cells-only"),t.preventDefault()}}},{key:"onCut",value:function(t){if((this.hot.isListening()||Fl(this,Ql))&&!this.isEditorOpened()){this.setCopyableText(),Vl(this,Ql,!1);var e=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",e,this.copyableRanges)){var n=Object(Fa.b)(e);if(t&&t.clipboardData){var r=Object(kl._dataToHTML)(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[Gl,r].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}}},{key:"onPaste",value:function(t){if(this.hot.isListening()&&!this.isEditorOpened()){var e;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){var n=Object(R.sanitize)(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});e=n&&/(<table)|(<TABLE)/g.test(n)?Object(kl.htmlToGridSettings)(n,this.hot.rootDocument).data:t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=Object(Fa.a)(e)),(!e||0!==e.length)&&!1!==this.hot.runHooks("beforePaste",e,this.copyableRanges)){var r=jl(this.populateValues(e),4),o=r[0],l=r[1],c=r[2],f=r[3];this.hot.selectCell(o,l,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,f)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"copy",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_COPY)},callback:function(){e.copyCellsOnly()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1})),Fl(this,Yl)&&t.items.push(function(t){return{key:"copy_with_column_headers",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,e)},callback:function(){t.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),Fl(this,Xl)&&t.items.push(function(t){return{key:"copy_with_column_group_headers",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,e)},callback:function(){t.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),Fl(this,Kl)&&t.items.push(function(t){return{key:"copy_column_headers_only",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,e)},callback:function(){t.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),t.items.push(function(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_CUT)},callback:function(){t.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(o.getSelectionText)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var t=this.hot.rootDocument.activeElement,e=this.hot.getActiveEditor();!e||t!==this.focusableElement.getFocusableElement()&&t!==e.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(el(this.focusableElement),this.focusableElement=null),Ml(Nl(c.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Ul}},{key:"SETTING_KEYS",get:function(){return[Ul].concat(zl)}},{key:"PLUGIN_PRIORITY",get:function(){return 80}}],n&&Al(e.prototype,n),r&&Al(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a);function es(t){for(var e=Rl(t).rows,n=0,r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}n(196);function ns(t,col){return"border_row".concat(t,"col").concat(col)}function rs(t){var e,n;(Object(E.isDefined)(t.start)||Object(E.isDefined)(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(Object(E.isDefined)(t.end)||Object(E.isDefined)(t.right))&&(t.end=null!==(n=t.end)&&void 0!==n?n:t.right);return delete t.left,delete t.right,t}function os(t){return Object(E.isDefined)(t.start)&&(t.left=t.start),Object(E.isDefined)(t.end)&&(t.right=t.end),t}function is(t,col){return{id:ns(t,col),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:col,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function as(t,e){var n=!1;return Object(C.arrayEach)(t.getSelectedRange(),(function(r){r.forAll((function(r,o){if(!(r<0||o<0)){var l=t.getCellMeta(r,o).borders;if(l){if(!e)return n=!0,!1;if(!Object(c.hasOwnProperty)(l[e],"hide")||!1===l[e].hide)return n=!0,!1}}}))})),n}function ls(label){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(label)}var ss=new Map([["left","start"],["right","end"]]);function us(t){var e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return as(this,e)&&(label=ls(label)),label},callback:function(n,r){var o=as(this,e);t.prepareBorder(r,e,o)}}}function cs(t){return{key:"borders:bottom",name:function(){var label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return as(this,"bottom")&&(label=ls(label)),label},callback:function(e,n){var r=as(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function fs(t){var e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_BORDERS_LEFT);return as(this,e)&&(label=ls(label)),label},callback:function(n,r){var o=as(this,e);t.prepareBorder(r,e,o)}}}function hs(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(e,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!as(this)}}}function ds(t){return ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ds(t)}function ps(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return ys(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ys(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ys(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function bs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ss(n.key),n)}}function vs(){return vs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Os(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},vs.apply(this,arguments)}function ms(t,p){return ms=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ms(t,p)}function gs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Os(t);if(e){var o=Os(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ds(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ws(t)}(this,n)}}function ws(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Os(t){return Os=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Os(t)}function Ss(t){var e=function(input,t){if("object"!==ds(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ds(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ds(e)?e:String(e)}var Cs="customBorders",Es=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ms(t,e)}(l,t);var e,n,r,o=gs(l);function l(){var t,e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var c=arguments.length,f=new Array(c),h=0;h<c;h++)f[h]=arguments[h];return t=o.call.apply(o,[this].concat(f)),e=ws(t),r=[],(n=Ss(n="savedBorders"))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return e=l,r=[{key:"PLUGIN_KEY",get:function(){return Cs}},{key:"PLUGIN_PRIORITY",get:function(){return 90}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Cs]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("init",(function(){return t.onAfterInit()})),vs(Os(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),vs(Os(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),vs(Os(l.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(t,e){var n=this,r=["top","bottom","start","end"],o=null;e&&(this.checkSettingsCohesion([e]),r=Object.keys(e),o=rs(e));var l=Object(Xi.c)(t),c=Object(Xi.e)(l);Object(C.arrayEach)(t,(function(t){for(var e=ps(c(t),4),l=e[0],f=e[1],h=e[2],d=e[3],y=function(t){for(var e=function(col){Object(C.arrayEach)(r,(function(e){var r,l;n.prepareBorderFromCustomAdded(t,col,o,(r=e,null!==(l=ss.get(r))&&void 0!==l?l:r))}))},col=f;col<=d;col+=1)e(col)},v=l;v<=h;v+=1)y(v)})),this.hot.view.render()}},{key:"getBorders",value:function(t){var e=this;if(!Array.isArray(t))return this.savedBorders;var n=Object(Xi.c)(t),r=Object(Xi.e)(n),o=[];return Object(C.arrayEach)(t,(function(t){for(var n=ps(r(t),4),l=n[0],c=n[1],f=n[2],h=n[3],d=function(t){for(var n=function(col){Object(C.arrayEach)(e.savedBorders,(function(e){e.row===t&&e.col===col&&o.push(os(e))}))},col=c;col<=h;col+=1)n(col)},y=l;y<=f;y+=1)d(y)})),o}},{key:"clearBorders",value:function(t){var e=this;t?this.setBorders(t):(Object(C.arrayEach)(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange(),e.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);var n=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col));this.checkCustomSelections(t,n,e)||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:n})}},{key:"prepareBorderFromCustomAdded",value:function(t,e,n,r){var o=this.hot.countRows(),l=this.hot.countCols();if(!(t>=o||e>=l)){var f,h,d=is(t,e);n&&(f=d,h=n,Object(c.hasOwnProperty)(h,"border")&&h.border&&(f.border=h.border),Object(c.hasOwnProperty)(h,"top")&&Object(E.isDefined)(h.top)&&(h.top?(Object(c.isObject)(h.top)||(h.top={width:1,color:"#000"}),f.top=h.top):(h.top={hide:!0},f.top=h.top)),Object(c.hasOwnProperty)(h,"bottom")&&Object(E.isDefined)(h.bottom)&&(h.bottom?(Object(c.isObject)(h.bottom)||(h.bottom={width:1,color:"#000"}),f.bottom=h.bottom):(h.bottom={hide:!0},f.bottom=h.bottom)),Object(c.hasOwnProperty)(h,"start")&&Object(E.isDefined)(h.start)&&(h.start?(Object(c.isObject)(h.start)||(h.start={width:1,color:"#000"}),f.start=h.start):(h.start={hide:!0},f.start=h.start)),Object(c.hasOwnProperty)(h,"end")&&Object(E.isDefined)(h.end)&&(h.end?(Object(c.isObject)(h.end)||(h.end={width:1,color:"#000"}),f.end=h.end):(h.end={hide:!0},f.end=h.end)),d=f,Object(C.arrayEach)(this.hot.selection.highlight.customSelections,(function(t){if(d.id===t.settings.id)return Object.assign(t.settings,n),d.id=t.settings.id,d.top=t.settings.top,d.bottom=t.settings.bottom,d.start=t.settings.start,d.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",os(d)),this.insertBorderIntoSettings(d,r)}}},{key:"prepareBorderFromCustomAddedRange",value:function(t,e){var n=this,r=Math.min(t.to.row,this.hot.countRows()-1),o=Math.min(t.to.col,this.hot.countCols()-1);Object(re.rangeEach)(t.from.row,r,(function(r){Object(re.rangeEach)(t.from.col,o,(function(o){var l=is(r,o),f=0;r===t.from.row&&Object(c.hasOwnProperty)(e,"top")&&(f+=1,l.top=e.top),r===t.to.row&&Object(c.hasOwnProperty)(e,"bottom")&&(f+=1,l.bottom=e.bottom),o===t.from.col&&Object(c.hasOwnProperty)(e,"start")&&(f+=1,l.start=e.start),o===t.to.col&&Object(c.hasOwnProperty)(e,"end")&&(f+=1,l.end=e.end),f>0&&(n.hot.setCellMeta(r,o,"borders",os(l)),n.insertBorderIntoSettings(l))}))}))}},{key:"removeAllBorders",value:function(t,e){var n=ns(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}},{key:"setBorder",value:function(t,e,n,r){var o=this.hot.getCellMeta(t,e).borders;o=o&&void 0!==o.border?rs(o):is(t,e),r?(o[n]={hide:!0},4===this.countHide(o)?this.removeAllBorders(t,e):(this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",os(o)))):(o[n]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",os(o)))}},{key:"prepareBorder",value:function(t,e,n){var r=this;Object(C.arrayEach)(t,(function(t){var o=t.start,l=t.end;if(o.row===l.row&&o.col===l.col)"noBorders"===e?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,e,n);else switch(e){case"noBorders":Object(re.rangeEach)(o.col,l.col,(function(t){Object(re.rangeEach)(o.row,l.row,(function(e){r.removeAllBorders(e,t)}))}));break;case"top":Object(re.rangeEach)(o.col,l.col,(function(t){r.setBorder(o.row,t,e,n)}));break;case"bottom":Object(re.rangeEach)(o.col,l.col,(function(t){r.setBorder(l.row,t,e,n)}));break;case"start":Object(re.rangeEach)(o.row,l.row,(function(t){r.setBorder(t,o.col,e,n)}));break;case"end":Object(re.rangeEach)(o.row,l.row,(function(t){r.setBorder(t,l.col,e,n)}))}}))}},{key:"createCustomBorders",value:function(t){var e=this;Object(C.arrayEach)(t,(function(t){var n=rs(t);t.range?e.prepareBorderFromCustomAddedRange(t.range,n):e.prepareBorderFromCustomAdded(t.row,t.col,n)}))}},{key:"countHide",value:function(t){var e=[t.top,t.bottom,t.start,t.end];return Object(C.arrayReduce)(e,(function(t,e){var n=t;return e&&e.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(t){var e=Object(C.arrayMap)(this.hot.selection.highlight.customSelections,(function(t){return t.settings.id})).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}},{key:"clearNullCellRange",value:function(){var t=this;Object(C.arrayEach)(this.hot.selection.highlight.customSelections,(function(e,n){if(null===e.cellRange)return t.hot.selection.highlight.customSelections[n].destroy(),t.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var t=this;Object(C.arrayEach)(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange()}))}},{key:"spliceBorder",value:function(t){var e=Object(C.arrayMap)(this.savedBorders,(function(t){return t.id})).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}},{key:"checkSavedBorders",value:function(t){var e=this,n=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),n=!0):Object(C.arrayEach)(this.savedBorders,(function(r,o){if(t.id===r.id)return e.savedBorders[o]=t,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(t,e,n){var r=!1;return Object(C.arrayEach)(this.hot.selection.highlight.customSelections,(function(o){if(t.id===o.settings.id)return Object(c.objectEach)(o.instanceBorders,(function(t){t.toggleHiddenClass(e,n)})),r=!0,!1})),r}},{key:"checkCustomSelections",value:function(t,e,n){var r=this.countHide(t),o=!1;return 4===r?(this.removeAllBorders(t.row,t.col),o=!0):Object(C.arrayEach)(this.hot.selection.highlight.customSelections,(function(r){if(t.id===r.settings.id)return r.visualCellRange=e,r.commit(),n&&Object(c.objectEach)(r.instanceBorders,(function(e){e.changeBorderStyle(n,t)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var t=this.hot.getSettings()[Cs];if(Array.isArray(t)){var e=Object(c.deepClone)(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(t){var e=t.some((function(t){return Object(E.isDefined)(t.left)||Object(E.isDefined)(t.right)})),n=function(t){return t.some((function(t){return Object(E.isDefined)(t.start)||Object(E.isDefined)(t.end)}))}(t);if(e&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;this.hot.getSettings()[Cs]&&t.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(e=this,{key:"borders:top",name:function(){var label=this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_BORDERS_TOP);return as(this,"top")&&(label=ls(label)),label},callback:function(t,n){var r=as(this,"top");e.prepareBorder(n,"top",r)}}),us(this),cs(this),fs(this),hs(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){vs(Os(l.prototype),"destroy",this).call(this)}}])&&bs(e.prototype,n),r&&bs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);function Rs(t){return Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(t)}function ks(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Rs(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Rs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Rs(o)?o:String(o)),n)}var r,o}function js(){return js="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Ms(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},js.apply(this,arguments)}function Ts(t,p){return Ts=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ts(t,p)}function Ps(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ms(t);if(e){var o=Ms(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Rs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return As(t)}(this,n)}}function As(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ms(t){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ms(t)}var _s="dragToScroll",xs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ts(t,e)}(f,t);var e,n,r,c=Ps(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=c.call(this,t)).eventManager=new X.a(As(e)),e.boundaries=null,e.callback=null,e.listening=!1,e}return e=f,r=[{key:"PLUGIN_KEY",get:function(){return _s}},{key:"PLUGIN_PRIORITY",get:function(){return 100}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[_s]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(e){return t.setupListening(e)})),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.setupListening(e)})),this.registerEvents(),js(Ms(f.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),js(Ms(f.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),js(Ms(f.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(t){this.boundaries=t}},{key:"setCallback",value:function(t){this.callback=t}},{key:"check",value:function(t,e){var n=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,r)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var t=this,e=this.hot.rootWindow;e;)this.eventManager.addEventListener(e.document,"contextmenu",(function(){return t.unlisten()})),this.eventManager.addEventListener(e.document,"mouseup",(function(){return t.unlisten()})),this.eventManager.addEventListener(e.document,"mousemove",(function(e){return t.onMouseMove(e)})),e=Object(o.getParentWindow)(e)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(t){if(!Object(l.isRightClick)(t)){var e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((function(t,n){t<0?e.scrollLeft-=50:t>0&&(e.scrollLeft+=50),n<0?e.scrollTop-=20:n>0&&(e.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(t){this.isListening()&&this.check(t.clientX,t.clientY)}},{key:"destroy",value:function(){js(Ms(f.prototype),"destroy",this).call(this)}}])&&ks(e.prototype,n),r&&ks(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a);function Is(t){return Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(t)}function Ns(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Is(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Is(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Is(o)?o:String(o)),n)}var r,o}function Hs(){return Hs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Fs(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Hs.apply(this,arguments)}function Ds(t,p){return Ds=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ds(t,p)}function Ls(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Fs(t);if(e){var o=Fs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Is(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Bs(t)}(this,n)}}function Bs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fs(t){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fs(t)}it.a.getSingleton().register("afterDropdownMenuDefaultOptions"),it.a.getSingleton().register("beforeDropdownMenuShow"),it.a.getSingleton().register("afterDropdownMenuShow"),it.a.getSingleton().register("afterDropdownMenuHide"),it.a.getSingleton().register("afterDropdownMenuExecute");var Vs="dropdownMenu",Ws="changeType",Us=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ds(t,e)}(c,t);var e,n,r,l=Ls(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=l.call(this,t)).eventManager=new X.a(Bs(e)),e.commandExecutor=new Fi(e.hot),e.itemsFactory=null,e.menu=null,e.hot.addHook("afterGetColHeader",(function(col,t){return e.onAfterGetColHeader(col,t)})),e}return e=c,n=[{key:"isEnabled",value:function(){return this.hot.getSettings()[Vs]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.itemsFactory=new da(this.hot,c.DEFAULT_ITEMS);var e=this.hot.getSettings()[Vs],n={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),Hs(Fs(c.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){t.hot.runHooks("afterDropdownMenuDefaultOptions",n),t.itemsFactory.setPredefinedItems(n.items);var r=t.itemsFactory.getItems(e);t.menu&&t.menu.destroy(),t.menu=new Aa(t.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||t.hot.rootDocument.body}),t.hot.runHooks("beforeDropdownMenuSetItems",r),t.menu.setMenuItems(r),t.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),t.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),t.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),t.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))})),Object(C.arrayEach)(r,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Hs(Fs(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Hs(Fs(c.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(e){return t.onTableClick(e)}))}},{key:"open",value:function(t){this.menu&&(this.menu.open(),t.width&&this.menu.setOffset("left",t.width),this.menu.setPosition(t))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"setListening",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(t){if(t.stopPropagation(),Object(o.hasClass)(t.target,Ws)&&!this.menu.isOpened()){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement.getBoundingClientRect();e=r.top,n=r.left}var rect=t.target.getBoundingClientRect();this.open({left:rect.left+n,top:rect.top+t.target.offsetHeight+3+e,width:rect.width,height:rect.height})}}},{key:"onAfterGetColHeader",value:function(col,t){var e=t.parentNode;if(e){var n=e.parentNode.childNodes,r=Array.prototype.indexOf.call(n,e);if(!(col<0||r!==n.length-1)){var o=t.querySelector(".".concat(Ws));if(!this.enabled||!o)if(this.enabled){var button=this.hot.rootDocument.createElement("button");button.className=Ws,button.type="button",button.onclick=function(){return!1},t.firstChild.insertBefore(button,t.firstChild.firstChild)}else o&&o.parentNode.removeChild(o)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Hs(Fs(c.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Vs}},{key:"PLUGIN_PRIORITY",get:function(){return 230}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Ui,zi,ni,qi,ni,Wi,ni,Gi,ni,Vi]}}],n&&Ns(e.prototype,n),r&&Ns(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a);function zs(t){return zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(t)}function Gs(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Ys(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ys(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ys(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Xs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==zs(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==zs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===zs(o)?o:String(o)),n)}var r,o}Us.SEPARATOR={name:ni};var Ks=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.options={}}var e,n,r;return e=t,(n=[{key:"setOptions",value:function(t){this.options=t}},{key:"getData",value:function(){var t=this,e=this._getDataRange(),n=e.startRow,r=e.startCol,o=e.endRow,l=e.endCol,c=this.options,data=[];return Object(re.rangeEach)(n,o,(function(e){var n=[];!c.exportHiddenRows&&t._isHiddenRow(e)||(Object(re.rangeEach)(r,l,(function(r){!c.exportHiddenColumns&&t._isHiddenColumn(r)||n.push(t.hot.getDataAtCell(e,r))})),data.push(n))})),data}},{key:"getRowHeaders",value:function(){var t=this,e=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,l=this.hot.getRowHeader();Object(re.rangeEach)(r,o,(function(n){!t.options.exportHiddenRows&&t._isHiddenRow(n)||e.push(l[n])}))}return e}},{key:"getColumnHeaders",value:function(){var t=this,e=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,l=this.hot.getColHeader();Object(re.rangeEach)(r,o,(function(n){!t.options.exportHiddenColumns&&t._isHiddenColumn(n)||e.push(l[n])}))}return e}},{key:"_getDataRange",value:function(){var t=this.hot.countCols()-1,e=this.hot.countRows()-1,n=Gs(this.options.range,4),r=n[0],o=void 0===r?0:r,l=n[1],c=void 0===l?0:l,f=n[2],h=void 0===f?e:f,d=n[3],y=void 0===d?t:d;return{startRow:o=Math.max(o,0),startCol:c=Math.max(c,0),endRow:h=Math.min(h,e),endCol:y=Math.min(y,t)}}},{key:"_isHiddenRow",value:function(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}},{key:"_isHiddenColumn",value:function(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}])&&Xs(e.prototype,n),r&&Xs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();n(662);function $s(t){return $s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(t)}function qs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==$s(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==$s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===$s(o)?o:String(o)),n)}var r,o}var Qs=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}var e,n,r;return e=t,r=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}],(n=[{key:"_mergeOptions",value:function(e){var n=Object(c.clone)(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=Object(c.extend)(Object(c.clone)(t.DEFAULT_OPTIONS),n),(n=Object(c.extend)(n,e)).filename=Object(R.substitute)(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}])&&qs(e.prototype,n),r&&qs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Js=Qs;function Zs(t){return Zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(t)}function tu(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Zs(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Zs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Zs(o)?o:String(o)),n)}var r,o}function eu(t,p){return eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},eu(t,p)}function nu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ru(t);if(e){var o=ru(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Zs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function ru(t){return ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ru(t)}var ou=String.fromCharCode(13),iu=String.fromCharCode(34),au=String.fromCharCode(10),lu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eu(t,e)}(l,t);var e,n,r,o=nu(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return e=l,n=[{key:"export",value:function(){var t=this,e=this.options,data=this.dataProvider.getData(),n=this.dataProvider.getColumnHeaders(),r=n.length>0,o=this.dataProvider.getRowHeaders(),l=o.length>0,c=e.bom?String.fromCharCode(65279):"";return r&&(n=Object(C.arrayMap)(n,(function(e){return t._escapeCell(e,!0)})),l&&(c+=e.columnDelimiter),c+=n.join(e.columnDelimiter),c+=e.rowDelimiter),Object(C.arrayEach)(data,(function(n,r){r>0&&(c+=e.rowDelimiter),l&&(c+=t._escapeCell(o[r])+e.columnDelimiter),c+=n.map((function(e){return t._escapeCell(e)})).join(e.columnDelimiter)})),c}},{key:"_escapeCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(E.stringify)(t);return""!==n&&(e||n.indexOf(ou)>=0||n.indexOf(iu)>=0||n.indexOf(au)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}],r=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}],n&&tu(e.prototype,n),r&&tu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(Js);function su(t){return su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(t)}var uu,cu,fu,hu=(uu={},fu=lu,(cu=function(t){var e=function(input,t){if("object"!==su(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==su(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===su(e)?e:String(e)}(cu="csv"))in uu?Object.defineProperty(uu,cu,{value:fu,enumerable:!0,configurable:!0,writable:!0}):uu[cu]=fu,uu);function du(t){return du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(t)}function pu(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yu(n.key),n)}}function yu(t){var e=function(input,t){if("object"!==du(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==du(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===du(e)?e:String(e)}function bu(t,p){return bu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},bu(t,p)}function vu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=mu(t);if(e){var o=mu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===du(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function mu(t){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mu(t)}var gu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bu(t,e)}(l,t);var e,n,r,o=vu(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return e=l,n=[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}},{key:"exportAsBlob",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}},{key:"downloadFile",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,l=this._createTypeFormatter(t,e),c=this._createBlob(l),f=o.URL||o.webkitURL,a=r.createElement("a"),h="".concat(l.options.filename,".").concat(l.options.fileExtension);if(void 0!==a.download){var d=f.createObjectURL(c);a.style.display="none",a.setAttribute("href",d),a.setAttribute("download",h),r.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),r.body.removeChild(a),setTimeout((function(){f.revokeObjectURL(d)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(c,h)}},{key:"_createTypeFormatter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!hu[t])throw new Error('Export format type "'.concat(t,'" is not supported.'));return function(t,e,n){return"function"==typeof hu[t]?new hu[t](e,n):null}(t,new Ks(this.hot),e)}},{key:"_createBlob",value:function(t){var e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:"".concat(t.options.mimeType,";charset=").concat(t.options.encoding)})),e}}],r=[{key:"PLUGIN_KEY",get:function(){return"exportFile"}},{key:"PLUGIN_PRIORITY",get:function(){return 240}}],n&&pu(e.prototype,n),r&&pu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);n(94);function wu(t){return wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(t)}function Ou(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Su(n.key),n)}}function Su(t){var e=function(input,t){if("object"!==wu(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==wu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===wu(e)?e:String(e)}var Cu=function(){function t(e,n){var r=n.id,o=n.stateless,l=void 0===o||o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.id=r,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=l?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Pr.a)}var e,n,r;return e=t,(n=[{key:"reset",value:function(){Object(C.arrayEach)(this.elements,(function(t){return t.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return null===this.hot||this.hidden}},{key:"restoreState",value:function(t){this.state&&this.setState(this.state.getValueAtIndex(t))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(t){this.state&&this.state.setValueAtIndex(t,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Object(C.arrayEach)(this.elements,(function(t){return t.destroy()})),this.state=null,this.elements=null,this.hot=null}}])&&Ou(e.prototype,n),r&&Ou(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(c.mixin)(Cu,pi.a);var Eu=Cu,Ru={};function ku(t,e){if(!Ru[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var n=Ru[t],r=n.condition,o=n.descriptor,l=e;return o.inputValuesDecorator&&(l=o.inputValuesDecorator(l)),function(t){return r.apply(t.meta.instance,[].concat([t],[l]))}}function ju(t){if(!Ru[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return Ru[t].descriptor}function Tu(t,e,n){n.key=t,Ru[t]={condition:e,descriptor:n}}var Pu="none";Tu(Pu,(function(){return!0}),{name:wi.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});var Au="empty";Tu(Au,(function(t){return Object(E.isEmpty)(t.value)}),{name:wi.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});var Mu="not_empty";function _u(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return xu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xu(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu(Mu,(function(t,e){return!ku(Au,e)(t)}),{name:wi.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});var Iu="eq";Tu(Iu,(function(t,e){var n=_u(e,1)[0];return Object(E.stringify)(t.value).toLocaleLowerCase(t.meta.locale)===Object(E.stringify)(n)}),{name:wi.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});var Nu="neq";function Hu(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Du(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Du(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Du(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu(Nu,(function(t,e){return!ku(Iu,e)(t)}),{name:wi.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});function Lu(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Bu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bu(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu("gt",(function(t,e){var n=Hu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n}),{name:wi.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});function Fu(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Vu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vu(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu("gte",(function(t,e){var n=Lu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n}),{name:wi.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});function Wu(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Uu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uu(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu("lt",(function(t,e){var n=Fu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n}),{name:wi.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});function zu(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Gu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gu(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu("lte",(function(t,e){var n=Wu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n}),{name:wi.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var Yu="date_after";function Xu(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Ku(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ku(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ku(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu(Yu,(function(t,e){var n=zu(e,1)[0],r=G(t.value,t.meta.dateFormat),o=G(n,t.meta.dateFormat);return!(!r.isValid()||!o.isValid())&&r.diff(o)>=0}),{name:wi.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});var $u="date_before";function qu(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Qu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qu(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu($u,(function(t,e){var n=Xu(e,1)[0],r=G(t.value,t.meta.dateFormat),o=G(n,t.meta.dateFormat);return!(!r.isValid()||!o.isValid())&&r.diff(o)<=0}),{name:wi.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});var Ju="between";Tu(Ju,(function(t,e){var n=qu(e,2),r=n[0],o=n[1];if("numeric"===t.meta.type){var l=parseFloat(r,10),c=parseFloat(o,10);r=Math.min(l,c),o=Math.max(l,c)}else if("date"===t.meta.type){var f=ku($u,[o]),h=ku(Yu,[r]);return f(t)&&h(t)}return t.value>=r&&t.value<=o}),{name:wi.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});var Zu="not_between";function tc(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return ec(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ec(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ec(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu(Zu,(function(t,e){return!ku(Ju,e)(t)}),{name:wi.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});var nc="begins_with";Tu(nc,(function(t,e){var n=tc(e,1)[0];return Object(E.stringify)(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Object(E.stringify)(n))}),{name:wi.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});n(312);function rc(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return oc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oc(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ic="ends_with";function ac(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return lc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lc(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tu(ic,(function(t,e){var n=rc(e,1)[0];return Object(E.stringify)(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Object(E.stringify)(n))}),{name:wi.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});var sc="contains";Tu(sc,(function(t,e){var n=ac(e,1)[0];return Object(E.stringify)(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Object(E.stringify)(n))>=0}),{name:wi.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});var uc="not_contains";Tu(uc,(function(t,e){return!ku(sc,e)(t)}),{name:wi.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});var cc="date_tomorrow";Tu(cc,(function(t){var e=G(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(G().subtract(-1,"days").startOf("day"),"d")}),{name:wi.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});var fc="date_today";Tu(fc,(function(t){var e=G(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(G().startOf("day"),"d")}),{name:wi.FILTERS_CONDITIONS_TODAY,inputsCount:0});var hc,dc="date_yesterday";function pc(t){return pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pc(t)}function yc(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==pc(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==pc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===pc(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Tu(dc,(function(t){var e=G(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(G().subtract(1,"days").startOf("day"),"d")}),{name:wi.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});var bc="text",vc=(yc(hc={},"numeric",[Pu,ni,Au,Mu,ni,Iu,Nu,ni,"gt","gte","lt","lte",Ju,Zu]),yc(hc,bc,[Pu,ni,Au,Mu,ni,Iu,Nu,ni,nc,ic,ni,sc,uc]),yc(hc,"date",[Pu,ni,Au,Mu,ni,Iu,Nu,ni,$u,Yu,Ju,ni,cc,fc,dc]),hc);function mc(t){return mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mc(t)}function gc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wc(n.key),n)}}function wc(t){var e=function(input,t){if("object"!==mc(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==mc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===mc(e)?e:String(e)}var Oc="built",Sc="building",Cc=["click","input","keydown","keypress","keyup","focus","blur","change"],Ec=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.eventManager=new X.a(this),this.options=Object(c.extend)(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}var e,n,r;return e=t,n=[{key:"setValue",value:function(t){this.options.value=t,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===Sc?this._element:this.buildState===Oc?(this.update(),this._element):(this.buildState=Sc,this.build(),this.buildState=Oc,this._element)}},{key:"isBuilt",value:function(){return this.buildState===Oc}},{key:"translateIfPossible",value:function(t){return"string"==typeof t&&t.startsWith(wi.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}},{key:"build",value:function(){var t=this,e=function(element,e){t.eventManager.addEventListener(element,e,(function(n){return t.runLocalHooks(e,n,t)}))};if(this.buildState||(this.buildState=Sc),this.options.className&&Object(o.addClass)(this._element,this.options.className),this.options.children.length)Object(C.arrayEach)(this.options.children,(function(element){return t._element.appendChild(element.element)}));else if(this.options.wrapIt){var element=this.hot.rootDocument.createElement(this.options.tagName);Object(c.objectEach)(this.options,(function(e,n){void 0!==element[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(element[n]=t.translateIfPossible(e))})),this._element.appendChild(element),Object(C.arrayEach)(Cc,(function(t){return e(element,t)}))}else Object(C.arrayEach)(Cc,(function(n){return e(t._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],r=[{key:"DEFAULTS",get:function(){return Object(c.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}],n&&gc(e.prototype,n),r&&gc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(c.mixin)(Ec,pi.a);var Rc=Ec;function kc(t){return kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kc(t)}function jc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tc(n.key),n)}}function Tc(t){var e=function(input,t){if("object"!==kc(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==kc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===kc(e)?e:String(e)}function Pc(){return Pc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=xc(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Pc.apply(this,arguments)}function Ac(t,p){return Ac=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ac(t,p)}function Mc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=xc(t);if(e){var o=xc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===kc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _c(t)}(this,n)}}function _c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xc(t){return xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xc(t)}var Ic=new WeakMap,Nc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ac(t,e)}(f,t);var e,n,r,l=Mc(f);function f(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),n=l.call(this,t,Object(c.extend)(f.DEFAULTS,e)),Ic.set(_c(n),{}),n.registerHooks(),n}return e=f,r=[{key:"DEFAULTS",get:function(){return Object(c.clone)({placeholder:"",type:"text",tagName:"input"})}}],(n=[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",(function(){return t.onClick()})),this.addLocalHook("keyup",(function(e){return t.onKeyup(e)}))}},{key:"build",value:function(){Pc(xc(f.prototype),"build",this).call(this);var t=Ic.get(this),e=this.hot.rootDocument.createElement("div");t.input=this._element.firstChild,Object(o.addClass)(this._element,"htUIInput"),Object(o.addClass)(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var input=Ic.get(this).input;input.type=this.options.type,input.placeholder=this.translateIfPossible(this.options.placeholder),input.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&Ic.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(t){this.options.value=t.target.value}}])&&jc(e.prototype,n),r&&jc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(Rc);function Hc(t){return Hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hc(t)}function Dc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lc(n.key),n)}}function Lc(t){var e=function(input,t){if("object"!==Hc(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Hc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Hc(e)?e:String(e)}function Bc(){return Bc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Uc(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Bc.apply(this,arguments)}function Fc(t,p){return Fc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Fc(t,p)}function Vc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Uc(t);if(e){var o=Uc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Hc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Wc(t)}(this,n)}}function Wc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uc(t){return Uc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Uc(t)}var zc=new WeakMap,Gc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fc(t,e)}(l,t);var e,n,r,o=Vc(l);function l(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,t,Object(c.extend)(l.DEFAULTS,e)),zc.set(Wc(n),{}),n.menu=null,n.items=[],n.registerHooks(),n}return e=l,r=[{key:"DEFAULTS",get:function(){return Object(c.clone)({className:"htUISelect",wrapIt:!1})}}],(n=[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",(function(){return t.onClick()}))}},{key:"setItems",value:function(t){this.items=this.translateNames(t),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(t){var e=this;return Object(C.arrayEach)(t,(function(t){t.name=e.translateIfPossible(t.name)})),t}},{key:"build",value:function(){var t=this;Bc(Uc(l.prototype),"build",this).call(this),this.menu=new Aa(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var caption=new Rc(this.hot,{className:"htUISelectCaption"}),e=new Rc(this.hot,{className:"htUISelectDropdown"}),n=zc.get(this);n.caption=caption,n.captionElement=caption.element,n.dropdown=e,Object(C.arrayEach)([caption,e],(function(element){return t._element.appendChild(element.element)})),this.menu.addLocalHook("select",(function(e){return t.onMenuSelect(e)})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuClosed()})),this.update()}},{key:"update",value:function(){var t;this.isBuilt()&&(t=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(wi.FILTERS_CONDITIONS_NONE),zc.get(this).captionElement.textContent=t,Bc(Uc(l.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var rect=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?rect.left-5:rect.left-31,top:rect.top-1,width:rect.width,height:rect.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(t){t.name!==ni&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var t=zc.get(this),caption=t.caption,e=t.dropdown;caption&&caption.destroy(),e&&e.destroy(),Bc(Uc(l.prototype),"destroy",this).call(this)}}])&&Dc(e.prototype,n),r&&Dc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(Rc);function Yc(t){return Yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yc(t)}function Xc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kc(n.key),n)}}function Kc(t){var e=function(input,t){if("object"!==Yc(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Yc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Yc(e)?e:String(e)}function $c(){return $c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Jc(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},$c.apply(this,arguments)}function qc(t,p){return qc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},qc(t,p)}function Qc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Jc(t);if(e){var o=Jc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Yc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Jc(t){return Jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jc(t)}var Zc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qc(t,e)}(h,t);var e,n,r,f=Qc(h);function h(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(n=f.call(this,t,{id:e.id,stateless:!1})).name=e.name,n.addSeparator=e.addSeparator,n.elements.push(new Gc(n.hot,{menuContainer:e.menuContainer})),n.elements.push(new Nc(n.hot,{placeholder:wi.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),n.elements.push(new Nc(n.hot,{placeholder:wi.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),n.registerHooks(),n}return e=h,n=[{key:"registerHooks",value:function(){var t=this;this.getSelectElement().addLocalHook("select",(function(e){return t.onConditionSelect(e)})),this.getSelectElement().addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),Object(C.arrayEach)(this.getInputElements(),(function(input){input.addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)}))}))}},{key:"setState",value:function(t){var e=this;if(this.reset(),t){var n=Object(c.clone)(t.command);n.name.startsWith(wi.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),Object(C.arrayEach)(t.args,(function(t,r){if(r>n.inputsCount-1)return!1;var element=e.getInputElement(r);element.setValue(t),element[n.inputsCount>r?"show":"hide"](),r||setTimeout((function(){return element.focus()}),10)}))}}},{key:"getState",value:function(){var t=this.getSelectElement().getValue()||ju(Pu),e=[];return Object(C.arrayEach)(this.getInputElements(),(function(element,n){t.inputsCount>n&&e.push(element.getValue())})),{command:t,args:e}}},{key:"updateState",value:function(t,e){var n=ju(t?t.name:Pu);this.state.setValueAtIndex(e,{command:n,args:t?t.args:[]}),t||Object(C.arrayEach)(this.getInputElements(),(function(element){return element.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(element){return element instanceof Gc}))[0]}},{key:"getInputElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}},{key:"getInputElements",value:function(){return this.elements.filter((function(element){return element instanceof Nc}))}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,col,l,c){Object(o.addClass)(n.parentNode,"htFiltersMenuCondition"),t.addSeparator&&Object(o.addClass)(n.parentNode,"border");var label=t.hot.rootDocument.createElement("div");return Object(o.addClass)(label,"htFiltersMenuLabel"),label.textContent=c,n.appendChild(label),n.parentNode.hasAttribute("ghost-table")||Object(C.arrayEach)(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"reset",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn(),e=[ju(Pu)];if(null!==t){var n=t.visualIndex;e=function(t){var e=[],n=t;return vc[n]||(n=bc),Object(C.arrayEach)(vc[n],(function(t){var option;option=t===ni?{name:ni}:Object(c.clone)(ju(t)),e.push(option)})),e}(this.hot.getDataType(0,n,this.hot.countRows(),n))}Object(C.arrayEach)(this.getInputElements(),(function(element){return element.hide()})),this.getSelectElement().setItems(e),$c(Jc(h.prototype),"reset",this).call(this),this.getSelectElement().setValue(e[0])}},{key:"onConditionSelect",value:function(t){Object(C.arrayEach)(this.getInputElements(),(function(element,e){element[t.inputsCount>e?"show":"hide"](),0===e&&setTimeout((function(){return element.focus()}),10)})),this.runLocalHooks("change",t)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(t){Object(k.isKey)(t.keyCode,"ENTER")?(this.runLocalHooks("accept"),Object(l.stopImmediatePropagation)(t)):Object(k.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(l.stopImmediatePropagation)(t))}}],n&&Xc(e.prototype,n),r&&Xc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),h}(Eu),tf=Zc,ef={};function nf(t,e,n){ef[t]={name:e,func:n}}var rf="conjunction",of=wi.FILTERS_LABELS_CONJUNCTION;nf(rf,of,(function(t,e){return t.every((function(t){return t.func(e)}))}));var af="disjunction",lf=wi.FILTERS_LABELS_DISJUNCTION;nf(af,lf,(function(t,e){return t.some((function(t){return t.func(e)}))}));var sf="disjunctionWithExtraCondition",uf=wi.FILTERS_LABELS_DISJUNCTION;function cf(t){return cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(t)}function ff(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hf(n.key),n)}}function hf(t){var e=function(input,t){if("object"!==cf(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==cf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===cf(e)?e:String(e)}function df(){return df="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=vf(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},df.apply(this,arguments)}function pf(t,p){return pf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},pf(t,p)}function yf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=vf(t);if(e){var o=vf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===cf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return bf(t)}(this,n)}}function bf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vf(t){return vf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vf(t)}nf(sf,uf,(function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((function(t){return t.func(e)}))&&t[t.length-1].func(e)}));var mf,gf=new WeakMap,wf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pf(t,e)}(l,t);var e,n,r,o=yf(l);function l(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,t,Object(c.extend)(l.DEFAULTS,e)),gf.set(bf(n),{}),n}return e=l,n=[{key:"build",value:function(){df(vf(l.prototype),"build",this).call(this);var t=gf.get(this);t.input=this._element.firstChild;var label=this.hot.rootDocument.createElement("label");label.textContent=this.translateIfPossible(this.options.label.textContent),label.htmlFor=this.translateIfPossible(this.options.label.htmlFor),t.label=label,this._element.appendChild(label),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=gf.get(this);t.input.checked=this.options.checked,t.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=t,this.update()}},{key:"focus",value:function(){this.isBuilt()&&gf.get(this).input.focus()}}],r=[{key:"DEFAULTS",get:function(){return Object(c.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}],n&&ff(e.prototype,n),r&&ff(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(Rc),Of=wf;function Sf(t){return Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(t)}function Cf(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ef(n.key),n)}}function Ef(t){var e=function(input,t){if("object"!==Sf(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Sf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Sf(e)?e:String(e)}function Rf(t,p){return Rf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Rf(t,p)}function kf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=jf(t);if(e){var o=jf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Sf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function jf(t){return jf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jf(t)}var Tf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rf(t,e)}(c,t);var e,n,r,l=kf(c);function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=l.call(this,t,{id:e.id,stateless:!1})).name=e.name,n.buildOperatorsElement(),n}return e=c,n=[{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Object(o.addClass)(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||Object(C.arrayEach)(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var t=this,e=[rf,af];Object(C.arrayEach)(e,(function(n){var r,o=new Of(t.hot,{name:"operator",label:{htmlFor:n,textContent:(r=n,ef[r].name)},value:n,checked:n===e[0],id:n});o.addLocalHook("change",(function(e){return t.onRadioInputChange(e)})),t.elements.push(o)}))}},{key:"setChecked",value:function(t){if(this.elements.length<t)throw Error(Object(Wo.a)(mf||(e=["Radio button with index "," doesn't exist."],n||(n=e.slice(0)),mf=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))),t));var e,n;Object(C.arrayEach)(this.elements,(function(element,e){element.setChecked(e===t)}))}},{key:"getActiveOperationId",value:function(){var t=this.elements.find((function(element){return element instanceof Of&&element.isChecked()}));return t?t.getValue():rf}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(t){this.reset(),t&&this.getActiveOperationId()!==t&&Object(C.arrayEach)(this.elements,(function(element){element.setChecked(element.getValue()===t)}))}},{key:"updateState",value:function(){var t=arguments.length>1?arguments[1]:void 0,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rf;e===sf&&(e=af),this.state.setValueAtIndex(t,e)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(t){this.setState(t.target.value)}}],n&&Cf(e.prototype,n),r&&Cf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(Eu),Pf=Tf;Object(je.getComparisonFunction)();function Af(t,e){var n=t;return""===n&&(n="(".concat(e,")")),n}var Mf=new Set([1]).has(1),_f=Mf&&"function"==typeof Array.from;function xf(t){var e=t;return Mf&&(e=new Set(e)),function(t){return Mf?e.has(t):!!~e.indexOf(t)}}function If(t){return null==t?"":t}function Nf(t){var e=t;return e=(e=_f?Array.from(new Set(e)):Object(C.arrayUnique)(e)).sort((function(a,b){return"number"==typeof a&&"number"==typeof b?a-b:a===b?0:a>b?1:-1}))}function Hf(base,t,e,n){var r,o=[],l=base===t;return l||(r=xf(t)),Object(C.arrayEach)(base,(function(t){var c=!1;(l||r(t))&&(c=!0);var f={checked:c,value:t,visualValue:Af(t,e)};n&&n(f),o.push(f)})),o}var Df=n(732);n(433);function Lf(t){return Lf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lf(t)}function Bf(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ff(n.key),n)}}function Ff(t){var e=function(input,t){if("object"!==Lf(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Lf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Lf(e)?e:String(e)}function Vf(){return Vf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Gf(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Vf.apply(this,arguments)}function Wf(t,p){return Wf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Wf(t,p)}function Uf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Gf(t);if(e){var o=Gf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Lf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return zf(t)}(this,n)}}function zf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gf(t){return Gf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gf(t)}var Yf=new WeakMap,Xf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wf(t,e)}(l,t);var e,n,r,o=Uf(l);function l(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,t,Object(c.extend)(l.DEFAULTS,e)),Yf.set(zf(n),{}),n}return e=l,r=[{key:"DEFAULTS",get:function(){return Object(c.clone)({href:"#",tagName:"a"})}}],(n=[{key:"build",value:function(){Vf(Gf(l.prototype),"build",this).call(this),Yf.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(Yf.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}])&&Bf(e.prototype,n),r&&Bf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(Rc);function Kf(t){return Kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kf(t)}function $f(t){return function(t){if(Array.isArray(t))return qf(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return qf(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qf(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qf(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Qf(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jf(n.key),n)}}function Jf(t){var e=function(input,t){if("object"!==Kf(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Kf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Kf(e)?e:String(e)}function Zf(){return Zf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=oh(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Zf.apply(this,arguments)}function eh(t,p){return eh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},eh(t,p)}function nh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=oh(t);if(e){var o=oh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Kf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rh(t)}(this,n)}}function rh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oh(t){return oh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oh(t)}var ih=new WeakMap,ah=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eh(t,e)}(h,t);var e,n,r,f=nh(h);function h(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,Object(c.extend)(h.DEFAULTS,e)),ih.set(rh(n),{}),n.searchInput=new Nc(n.hot,{placeholder:wi.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),n.selectAllUI=new Xf(n.hot,{textContent:wi.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),n.clearAllUI=new Xf(n.hot,{textContent:wi.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),n.items=[],n.itemsBox=null,n.registerHooks(),n}return e=h,n=[{key:"registerHooks",value:function(){var t=this;this.searchInput.addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)})),this.searchInput.addLocalHook("input",(function(e){return t.onInput(e)})),this.selectAllUI.addLocalHook("click",(function(e){return t.onSelectAllClick(e)})),this.clearAllUI.addLocalHook("click",(function(e){return t.onClearAllClick(e)}))}},{key:"setItems",value:function(t){this.items=t,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(t){this.locale=t}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return $f(this.items)}},{key:"getValue",value:function(){return t=this.items,e=[],Object(C.arrayEach)(t,(function(t){t.checked&&e.push(t.value)})),e;var t,e}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var t=this;Zf(oh(h.prototype),"build",this).call(this);var e=this.hot.rootDocument,n=e.createElement("div"),r=new Rc(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(r.element),this._element.appendChild(n);var l=function(n){t._element&&(t.itemsBox&&t.itemsBox.destroy(),Object(o.addClass)(n,"htUIMultipleSelectHot"),t.itemsBox=new t.hot.constructor(n,{data:t.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(t,e,col,n,r,o){t.title=o.instance.getDataAtRowProp(e,o.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return t.itemsBox.container.scrollWidth-Object(o.getScrollbarWidth)(e)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:t.hot.isRtl()?"rtl":"ltr"}),t.itemsBox.init(),t.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:function(e){t.runLocalHooks("keydown",e,t)},group:"multipleSelect.itemBox"}))};l(n),setTimeout((function(){return l(n)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){var t,e,n;this.isBuilt()&&(this.itemsBox.loadData((t=this.items,e=this.options.value,n=xf(e),Object(C.arrayMap)(t,(function(t){return t.checked=n(t.value),t})))),Zf(oh(h.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Zf(oh(h.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(t){var e,n=this,r=t.target.value.toLocaleLowerCase(this.getLocale());e=""===r?$f(this.items):Object(C.arrayFilter)(this.items,(function(t){return"".concat(t.value).toLocaleLowerCase(n.getLocale()).indexOf(r)>=0})),this.itemsBox.loadData(e)}},{key:"onInputKeyDown",value:function(t){this.runLocalHooks("keydown",t,this),Object(jr.partial)(k.isKey,t.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Object(l.stopImmediatePropagation)(t),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(t){var e=[];t.preventDefault(),Object(C.arrayEach)(this.itemsBox.getSourceData(),(function(t,n){t.checked=!0,e.push(Object(Df.dataRowToChangesArray)(t,n)[0])})),this.itemsBox.setSourceDataAtCell(e)}},{key:"onClearAllClick",value:function(t){var e=[];t.preventDefault(),Object(C.arrayEach)(this.itemsBox.getSourceData(),(function(t,n){t.checked=!1,e.push(Object(Df.dataRowToChangesArray)(t,n)[0])})),this.itemsBox.setSourceDataAtCell(e)}}],r=[{key:"DEFAULTS",get:function(){return Object(c.clone)({className:"htUIMultipleSelect",value:[]})}}],n&&Qf(e.prototype,n),r&&Qf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),h}(Rc),lh=ah;function sh(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return uh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uh(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uh(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ch="by_value";function fh(t){return fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(t)}function hh(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return dh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dh(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dh(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ph(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yh(n.key),n)}}function yh(t){var e=function(input,t){if("object"!==fh(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==fh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===fh(e)?e:String(e)}function bh(){return bh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=gh(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},bh.apply(this,arguments)}function vh(t,p){return vh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},vh(t,p)}function mh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=gh(t);if(e){var o=gh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===fh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function gh(t){return gh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gh(t)}Tu(ch,(function(t,e){return(0,sh(e,1)[0])(t.value)}),{name:"By value",inputsCount:0,inputValuesDecorator:function(t){return[xf(sh(t,1)[0])]},showOperators:!1});var wh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vh(t,e)}(f,t);var e,n,r,c=mh(f);function f(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,t,{id:e.id,stateless:!1})).name=e.name,n.elements.push(new lh(n.hot)),n.registerHooks(),n}return e=f,n=[{key:"registerHooks",value:function(){var t=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)}))}},{key:"setState",value:function(t){if(this.reset(),t&&t.command.key===ch){var select=this.getMultipleSelectElement();select.setItems(t.itemsSnapshot),select.setValue(t.args[0]),select.setLocale(t.locale)}}},{key:"getState",value:function(){var select=this.getMultipleSelectElement(),t=select.getItems();return{command:{key:select.isSelectedAllValues()||!t.length?Pu:ch},args:[select.getValue()],itemsSnapshot:t}}},{key:"updateState",value:function(t){var e=this,n=function(n,r,o,l,c){var f=hh(Object(C.arrayFilter)(r,(function(t){return t.name===ch})),1)[0],h={},d=e.hot.getTranslatedPhrase(wi.FILTERS_VALUES_BLANK_CELLS);if(f){var y=Nf(Object(C.arrayMap)(l(n,c),(function(t){return t.value})));o&&(f.args[0]=o);var v=[],m=Hf(y,f.args[0],d,(function(t){t.checked&&v.push(t.value)})),w=t.editedConditionStack.column;h.locale=e.hot.getCellMeta(0,w).locale,h.args=[v],h.command=ju(ch),h.itemsSnapshot=m}else h.args=[],h.command=ju(Pu);e.state.setValueAtIndex(n,h)};n(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&n(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(element){return element instanceof lh}))[0]}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,col,l,c){Object(o.addClass)(n.parentNode,"htFiltersMenuValue");var label=t.hot.rootDocument.createElement("div");return Object(o.addClass)(label,"htFiltersMenuLabel"),label.textContent=c,n.appendChild(label),n.parentNode.hasAttribute("ghost-table")||Object(C.arrayEach)(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"reset",value:function(){var t=this.hot.getTranslatedPhrase(wi.FILTERS_VALUES_BLANK_CELLS),e=Nf(this._getColumnVisibleValues()),n=Hf(e,e,t);this.getMultipleSelectElement().setItems(n),bh(gh(f.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(e);var r=this.hot.getPlugin("filters").getSelectedColumn();null!==r&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,r.visualIndex).locale)}},{key:"onInputKeyDown",value:function(t){Object(k.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(l.stopImmediatePropagation)(t))}},{key:"_getColumnVisibleValues",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:Object(C.arrayMap)(this.hot.getDataAtCol(t.visualIndex),(function(t){return If(t)}))}}],n&&ph(e.prototype,n),r&&ph(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(Eu),Oh=wh;function Sh(t){return Sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(t)}function Ch(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eh(n.key),n)}}function Eh(t){var e=function(input,t){if("object"!==Sh(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Sh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Sh(e)?e:String(e)}function Rh(t,p){return Rh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Rh(t,p)}function kh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=jh(t);if(e){var o=jh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Sh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function jh(t){return jh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jh(t)}var Th,Ph,Ah=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rh(t,e)}(c,t);var e,n,r,l=kh(c);function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=l.call(this,t,{id:e.id,stateless:!0})).name=e.name,n.elements.push(new Nc(n.hot,{type:"button",value:wi.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:c.BUTTON_OK})),n.elements.push(new Nc(n.hot,{type:"button",value:wi.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:c.BUTTON_CANCEL})),n.registerHooks(),n}return e=c,r=[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}],(n=[{key:"registerHooks",value:function(){var t=this;Object(C.arrayEach)(this.elements,(function(element){element.addLocalHook("click",(function(e,button){return t.onButtonClick(e,button)}))}))}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Object(o.addClass)(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||Object(C.arrayEach)(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(t,button){button.options.identifier===c.BUTTON_OK?this.accept():this.cancel()}}])&&Ch(e.prototype,n),r&&Ch(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(Eu);function Mh(t){return Mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(t)}function _h(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return xh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xh(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xh(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ih(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Nh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hh(n.key),n)}}function Hh(t){var e=function(input,t){if("object"!==Mh(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Mh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Mh(e)?e:String(e)}var Dh="ConditionCollection.filteringStates",Lh=function(){function t(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.isMapRegistrable=n,this.filteringStates=new Pr.a,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(Dh,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}var e,n,r;return e=t,n=[{key:"isEmpty",value:function(){return 0===this.getFilteredColumns().length}},{key:"isMatch",value:function(t,e){var n,r=this.filteringStates.getValueAtIndex(e),o=null!==(n=null==r?void 0:r.conditions)&&void 0!==n?n:[],l=null==r?void 0:r.operation;return this.isMatchInConditions(o,t,l)}},{key:"isMatchInConditions",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rf;return!t.length||function(t){if(!ef[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=ef[t].func;return function(t,n){return e(t,n)}}(n)(t,e)}},{key:"addCondition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rf,r=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,t).locale,l=Object(C.arrayMap)(e.args,(function(t){return"string"==typeof t?t.toLocaleLowerCase(o):t})),c=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);var f=this.getOperation(t);if(f){if(f!==n)throw Error(Object(Wo.a)(Th||(Th=Ih(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),t,f))}else if(Object(E.isUndefined)(ef[n]))throw new Error(Object(Wo.a)(Ph||(Ph=Ih(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var h=this.getConditions(t);0===h.length?this.filteringStates.setValueAtIndex(t,{operation:n,conditions:[{name:c,args:l,func:ku(c,l)}]},r):h.push({name:c,args:l,func:ku(c,l)}),this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function(t){var e,n;return null!==(e=null===(n=this.filteringStates.getValueAtIndex(t))||void 0===n?void 0:n.conditions)&&void 0!==e?e:[]}},{key:"getOperation",value:function(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map((function(t){return _h(t,1)[0]}))}},{key:"getColumnStackPosition",value:function(t){return this.getFilteredColumns().indexOf(t)}},{key:"exportAllConditions",value:function(){return Object(C.arrayReduce)(this.filteringStates.getEntries(),(function(t,e){var n=_h(e,2),r=n[0],o=n[1],l=o.operation,c=o.conditions;return t.push({column:r,operation:l,conditions:Object(C.arrayMap)(c,(function(t){return{name:t.name,args:t.args}}))}),t}),[])}},{key:"importAllConditions",value:function(t){var e=this;this.clean(),Object(C.arrayEach)(t,(function(t){Object(C.arrayEach)(t.conditions,(function(n){return e.addCondition(t.column,n)}))}))}},{key:"removeConditions",value:function(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(t,e){var n=this.getConditions(t);return e?n.some((function(t){return t.name===e})):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(Dh),this.filteringStates=null,this.clearLocalHooks()}}],n&&Nh(e.prototype,n),r&&Nh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(c.mixin)(Lh,pi.a);var Bh=Lh;function Fh(t){return Fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(t)}function Vh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wh(n.key),n)}}function Wh(t){var e=function(input,t){if("object"!==Fh(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Fh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Fh(e)?e:String(e)}var Uh=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.conditionCollection=e,this.columnDataFactory=n}var e,n,r;return e=t,n=[{key:"filter",value:function(){var t=this,e=[];return Object(C.arrayEach)(this.conditionCollection.getFilteredColumns(),(function(n,r){var o=t.columnDataFactory(n);r&&(o=t._getIntersectData(o,e)),e=t.filterByColumn(n,o)})),e}},{key:"filterByColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object(C.arrayEach)(n,(function(n){void 0!==n&&e.conditionCollection.isMatch(n,t)&&r.push(n)})),r}},{key:"_getIntersectData",value:function(data,t){var e=[];return Object(C.arrayEach)(t,(function(t){var n=t.meta.visualRow;void 0!==data[n]&&(e[n]=data[n])})),e}}],n&&Vh(e.prototype,n),r&&Vh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),zh=Uh;function Gh(t){return Gh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(t)}function Yh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xh(n.key),n)}}function Xh(t){var e=function(input,t){if("object"!==Gh(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Gh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Gh(e)?e:String(e)}var Kh=function(){function t(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[]};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.conditionCollection=n,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(t){return r._onConditionBeforeModify(t)})),this.conditionCollection.addLocalHook("afterRemove",(function(t){return r.updateStatesAtColumn(t)})),this.conditionCollection.addLocalHook("afterAdd",(function(t){return r.updateStatesAtColumn(t)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return r._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return r._onConditionAfterClean()}))}var e,n,r;return e=t,n=[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var t=this;this.grouping=!1,Object(C.arrayEach)(this.changes,(function(e){t.updateStatesAtColumn(e)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}},{key:"updateStatesAtColumn",value:function(t,e){var n=this;if(this.grouping)-1===this.changes.indexOf(t)&&this.changes.push(t);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(t);-1===o&&(o=this.latestEditedColumnPosition);var l=r.slice(0,o),c=r.slice(o);c.length&&c[0].column===t&&c.shift();var f=Object(jr.curry)((function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new Bh(n.hot,!1),l=[].concat(t,r);o.importAllConditions(l);var c,f=n.columnDataFactory(e);c=o.isEmpty()?f:new zh(o,(function(t){return n.columnDataFactory(t)})).filter();var h=xf(c=Object(C.arrayMap)(c,(function(t){return t.meta.visualRow})));return o.destroy(),Object(C.arrayFilter)(f,(function(t){return h(t.meta.visualRow)}))}))(l),h=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:h},dependentConditionStacks:c,filteredRowsFactory:f,conditionArgsChange:e})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var t=this;Object(C.arrayEach)(this.latestOrderStack,(function(e){t.updateStatesAtColumn(e)}))}},{key:"destroy",value:function(){var t=this;this.clearLocalHooks(),Object(c.objectEach)(this,(function(e,n){t[n]=null}))}}],n&&Yh(e.prototype,n),r&&Yh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(c.mixin)(Kh,pi.a);var $h,qh=Kh,Qh=n(851);function Jh(t){return Jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(t)}function Zh(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return ed(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ed(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ed(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function nd(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rd(n.key),n)}}function rd(t){var e=function(input,t){if("object"!==Jh(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Jh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Jh(e)?e:String(e)}function od(){return od="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=sd(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},od.apply(this,arguments)}function id(t,p){return id=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},id(t,p)}function ad(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=sd(t);if(e){var o=sd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Jh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ld(t)}(this,n)}}function ld(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sd(t){return sd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sd(t)}var ud="filters",cd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&id(t,e)}(c,t);var e,n,r,l=ad(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=l.call(this,t)).eventManager=new X.a(ld(e)),e.dropdownMenuPlugin=null,e.conditionCollection=null,e.conditionUpdateObserver=null,e.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),e.lastSelectedColumn=null,e.filtersRowsMap=null,e.hot.addHook("afterGetColHeader",(function(col,t){return e.onAfterGetColHeader(col,t)})),e}return e=c,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ud]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Qh.a),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=function(component){return component.addLocalHook("accept",(function(){return t.onActionBarSubmit("accept")})),component.addLocalHook("cancel",(function(){return t.onActionBarSubmit("cancel")})),component.addLocalHook("change",(function(e){return t.onComponentChange(component,e)})),component};if(!this.components.get("filter_by_condition")){var o=new tf(this.hot,{id:"filter_by_condition",name:function(){return"".concat(t.hot.getTranslatedPhrase(wi.FILTERS_DIVS_FILTER_BY_CONDITION),":")},addSeparator:!1,menuContainer:n});o.addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),this.components.set("filter_by_condition",r(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Pf(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var l=new tf(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});l.addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),this.components.set("filter_by_condition2",r(l))}this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Oh(this.hot,{id:"filter_by_value",name:function(){return"".concat(t.hot.getTranslatedPhrase(wi.FILTERS_DIVS_FILTER_BY_VALUE),":")}}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Ah(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Bh(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new qh(this.hot,this.conditionCollection,(function(e){return t.getDataMapAtColumn(e)})),this.conditionUpdateObserver.addLocalHook("update",(function(e){return t.updateComponents(e)}))),this.components.forEach((function(component){return component.show()})),this.addHook("beforeDropdownMenuSetItems",(function(e){return t.onBeforeDropdownMenuSetItems(e)})),this.addHook("afterDropdownMenuDefaultOptions",(function(e){return t.onAfterDropdownMenuDefaultOptions(e)})),this.addHook("afterDropdownMenuShow",(function(){return t.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return t.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(e){return t.onAfterChange(e)})),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),od(sd(c.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var t,e=this;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(component,t){component.destroy(),e.components.set(t,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)),od(sd(c.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rf,o=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(o,{command:{key:e},args:n},r)}},{key:"removeConditions",value:function(t){var e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}},{key:"clearConditions",value:function(t){if(void 0===t)this.conditionCollection.clean();else{var e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}},{key:"filter",value:function(){var t=this,e=this._createDataFilter(),n=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",o))if(n){var l=[];this.hot.batchExecution((function(){t.filtersRowsMap.clear();var n=xf(r=Object(C.arrayMap)(e.filter(),(function(t){return t.meta.visualRow})));Object(re.rangeEach)(t.hot.countSourceRows()-1,(function(t){n(t)||l.push(t)})),Object(C.arrayEach)(l,(function(e){t.filtersRowsMap.setValueAtIndex(e,!0)}))}),!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var t,e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}},{key:"clearColumnSelection",value:function(){var t=this.getSelectedColumn();null!==t&&this.hot.selectCell(0,t.visualIndex)}},{key:"getDataMapAtColumn",value:function(t){var e=this,n=this.hot.toVisualColumn(t),data=[];return Object(C.arrayEach)(this.hot.getSourceDataAtCol(n),(function(t,r){var o,l=e.hot.getCellMeta(r,n),c=l.row,col=l.col,f=l.visualCol,h=l.visualRow,d=l.type,y=l.instance,v=l.dateFormat,m=l.locale,w=null!==(o=e.hot.getDataAtCell(e.hot.toVisualRow(r),n))&&void 0!==o?o:t;data.push({meta:{row:c,col:col,visualCol:f,visualRow:h,type:d,instance:y,dateFormat:v,locale:m},value:If(w)})})),data}},{key:"onAfterChange",value:function(t){var e=this;t&&Object(C.arrayEach)(t,(function(t){var n=Zh(t,2)[1],r=e.hot.propToCol(n);e.conditionCollection.hasConditions(r)&&e.updateValueComponentCondition(r)}))}},{key:"updateValueComponentCondition",value:function(t){var e=Nf(this.hot.getDataAtCol(t));this.conditionUpdateObserver.updateStatesAtColumn(t,e)}},{key:"restoreComponents",value:function(t){var e,n=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((function(component){component.isHidden()||component.restoreState(n)})),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var t=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){t.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}},{key:"onAfterDropdownMenuDefaultOptions",value:function(t){t.items.push({name:ni}),this.components.forEach((function(component){t.items.push(component.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(t,e,n,r){var o=t;return o===af&&e.command.key!==Pu&&n.command.key!==Pu&&r.command.key!==Pu?o=sf:r.command.key!==Pu&&(e.command.key!==Pu&&n.command.key!==Pu||(o=rf)),o}},{key:"onActionBarSubmit",value:function(t){var e;if("accept"===t){var n,r=this.getSelectedColumn();if(null===r)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());var o=r.physicalIndex,l=this.components.get("filter_by_condition").getState(),c=this.components.get("filter_by_condition2").getState(),f=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),l,c,f);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(o);-1===d&&(d=void 0),this.conditionCollection.removeConditions(o),l.command.key!==Pu&&(this.conditionCollection.addCondition(o,l,h,d),c.command.key!==Pu&&this.conditionCollection.addCondition(o,c,h,d)),f.command.key!==Pu&&this.conditionCollection.addCondition(o,f,h,d),this.conditionUpdateObserver.flush(),this.components.forEach((function(component){return component.saveState(o)})),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}},{key:"onComponentChange",value:function(component,t){this.updateDependentComponentsVisibility(),component.constructor!==tf||t.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var t=this.components.get("filter_by_condition").getState().command,e=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents.apply(this,e):this.hideComponents.apply(this,e)}},{key:"onAfterGetColHeader",value:function(col,t){var e=this.hot.toPhysicalColumn(col);this.enabled&&this.conditionCollection.hasConditions(e)?Object(o.addClass)(t,"htFiltersActive"):Object(o.removeClass)(t,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new zh(e,(function(e){return t.getDataMapAtColumn(e)}))}},{key:"updateComponents",value:function(t){var e;if(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled){var n,r,o=t.editedConditionStack,l=o.conditions,c=o.column,f=l.filter((function(t){return t.name===ch})),h=l.filter((function(t){return t.name!==ch}));if(f.length>=2||h.length>=3)Object(rr.b)(Object(Wo.a)($h||(n=["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],(r=["The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."])||(r=n.slice(0)),$h=Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}})))));else{var d=this.conditionCollection.getOperation(c);this.components.get("filter_by_condition").updateState(h[0],c),this.components.get("filter_by_condition2").updateState(h[1],c),this.components.get("filter_operators").updateState(d,c),this.components.get("filter_by_value").updateState(t)}}}},{key:"getIndexesOfComponents",value:function(){var t=[];if(!this.dropdownMenuPlugin)return t;for(var menu=this.dropdownMenuPlugin.menu,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Object(C.arrayEach)(n,(function(component){Object(C.arrayEach)(menu.menuItems,(function(e,n){e.key===component.getMenuItemDescriptor().key&&t.push(n)}))})),t}},{key:"changeComponentsVisibility",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var e=this.dropdownMenuPlugin.menu.hotMenu,n=e.getPlugin("hiddenRows"),r=arguments.length,o=new Array(r>1?r-1:0),l=1;l<r;l++)o[l-1]=arguments[l];var c=this.getIndexesOfComponents.apply(this,o);t?n.showRows(c):n.hideRows(c),e.render()}}},{key:"hideComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(e))}},{key:"showComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(e))}},{key:"destroy",value:function(){var t=this;this.enabled&&(this.components.forEach((function(component,e){null!==component&&(component.destroy(),t.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),od(sd(c.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return ud}},{key:"PLUGIN_PRIORITY",get:function(){return 250}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}],n&&nd(e.prototype,n),r&&nd(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a);n(791);function fd(t){return fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(t)}function hd(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function pd(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?hd(Object(source),!0).forEach((function(e){yd(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):hd(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function yd(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==fd(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==fd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===fd(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var bd="internal-use-in-handsontable",vd={licenseKey:bd,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function md(t){var e,n;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[Yd])||void 0===e||null===(n=e.language)||void 0===n?void 0:n.langCode}}function gd(t){return Object.keys(t).reduce((function(e,n){return"hyperformula"!==n&&(e[n]=t[n]),e}),{})}function wd(t){return wd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(t)}function Od(){var t="engine_relationship",e=Object(ao.a)(Yd);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Sd(){var t="shared_engine_usage",e=Object(ao.a)(Yd);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Cd(t){var e,n=t.getSettings(),r=n[Yd],o=null==r?void 0:r.engine;if(!0===r)return null;if(Object(E.isUndefined)(o))return null;if("function"==typeof o.hyperformula||"function"==typeof o)return function(t,e,n){var r=e[Yd],o=function(t){var e,n=t[Yd],r=gd(null!=n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),o=md(t);return pd(pd(pd({},vd),r),o)}(e),l=Od(),c=Sd();(function(t,e){e&&e.forEach((function(e){var n=e.name,r=e.plugin,o=e.translations;try{t.registerFunction(n,r,o)}catch(t){Object(rr.b)(t.message)}}))})(t,r.functions),function(t,e){if(e){var n=e.langCode;try{t.registerLanguage(n,e)}catch(t){Object(rr.b)(t.message)}}}(t,r.language);var f=t.buildEmpty(o);return l.set(f,[n]),c.set(f,[n.guid]),function(t,e){e&&(t.suspendEvaluation(),e.forEach((function(e){var n=e.name,r=e.expression,o=e.scope,l=e.options;try{t.addNamedExpression(n,r,o,l)}catch(t){Object(rr.b)(t.message)}})),t.resumeEvaluation())}(f,r.namedExpressions),f.on("sheetAdded",(function(){f.rebuildAndRecalculate()})),f.on("sheetRemoved",(function(){f.rebuildAndRecalculate()})),f}(null!==(e=o.hyperformula)&&void 0!==e?e:o,n,t);if("object"===wd(o)&&Object(E.isUndefined)(o.hyperformula)){var l=Od(),c=Sd().get(o);return l.has(o)||l.set(o,[]),l.get(o).push(t),c&&c.push(t.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:bd}),o}return null}function Ed(t){var e,n=Od(),r=0===n.size?[]:Array.from(null!==(e=n.get(t))&&void 0!==e?e:[]);return new Map(r.map((function(t){return[t.getPlugin("formulas").sheetId,t]})))}function Rd(t,e){if(t){var n=Od(),r=n.get(t),o=Sd(),l=o.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),0===r.length&&n.delete(t)),l&&l.includes(e.guid)&&(l.splice(l.indexOf(e.guid),1),0===l.length&&(o.delete(t),t.destroy()))}}function kd(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function jd(t){return function(t){if(Array.isArray(t))return xd(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Td(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Pd(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Td(Object(source),!0).forEach((function(e){Fd(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Td(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Ad(t){return Ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(t)}function Md(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||_d(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _d(t,e){if(t){if("string"==typeof t)return xd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xd(t,e):void 0}}function xd(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Id(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vd(n.key),n)}}function Nd(){return Nd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Bd(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Nd.apply(this,arguments)}function Hd(t,p){return Hd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Hd(t,p)}function Dd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Bd(t);if(e){var o=Bd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Ad(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ld(t)}(this,n)}}function Ld(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bd(t){return Bd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bd(t)}function Fd(t,e,n){return(e=Vd(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vd(t){var e=function(input,t){if("object"!==Ad(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ad(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ad(e)?e:String(e)}function Wd(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function Ud(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Gd(t,e,"set"),n),n}function zd(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Gd(t,e,"get"))}function Gd(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Yd="formulas",Xd="row_move";it.a.getSingleton().register("afterNamedExpressionAdded"),it.a.getSingleton().register("afterNamedExpressionRemoved"),it.a.getSingleton().register("afterSheetAdded"),it.a.getSingleton().register("afterSheetRemoved"),it.a.getSingleton().register("afterSheetRenamed"),it.a.getSingleton().register("afterFormulasValuesUpdate");var Kd=function(source){return"UndoRedo.undo"===source||"UndoRedo.redo"===source||"auto"===source},$d=new WeakMap,qd=new WeakMap,Qd=new WeakMap,Jd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hd(t,e)}(l,t);var e,n,r,o=Dd(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Wd(Ld(t=o.call.apply(o,[this].concat(n))),$d,{writable:!0,value:!1}),Wd(Ld(t),qd,{writable:!0,value:!1}),Wd(Ld(t),Qd,{writable:!0,value:[["valuesUpdated",function(){var e;return(e=t).onEngineValuesUpdated.apply(e,arguments)}],["namedExpressionAdded",function(){var e;return(e=t).onEngineNamedExpressionsAdded.apply(e,arguments)}],["namedExpressionRemoved",function(){var e;return(e=t).onEngineNamedExpressionsRemoved.apply(e,arguments)}],["sheetAdded",function(){var e;return(e=t).onEngineSheetAdded.apply(e,arguments)}],["sheetRenamed",function(){var e;return(e=t).onEngineSheetRenamed.apply(e,arguments)}],["sheetRemoved",function(){var e;return(e=t).onEngineSheetRemoved.apply(e,arguments)}]]}),Fd(Ld(t),"staticRegister",Object(ao.a)("formulas")),Fd(Ld(t),"engine",null),Fd(Ld(t),"sheetName",null),t}return e=l,n=[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Yd]}},{key:"enablePlugin",value:function(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=Cd(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){var n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==n&&(this.sheetName=n)}this.addHook("beforeLoadData",(function(){return e.onBeforeLoadData.apply(e,arguments)})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeUpdateData",(function(){return e.onBeforeLoadData.apply(e,arguments)})),this.addHook("afterUpdateData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("modifyData",(function(){return e.onModifyData.apply(e,arguments)})),this.addHook("modifySourceData",(function(){return e.onModifySourceData.apply(e,arguments)})),this.addHook("beforeValidate",(function(){return e.onBeforeValidate.apply(e,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return e.onAfterSetSourceDataAtCell.apply(e,arguments)})),this.addHook("afterSetDataAtCell",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(){return e.onBeforeCreateRow.apply(e,arguments)})),this.addHook("beforeCreateCol",(function(){return e.onBeforeCreateCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("beforeRemoveCol",(function(){return e.onBeforeRemoveCol.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("beforeUndo",(function(t){(null==t?void 0:t.actionType)!==Xd&&e.engine.undo()})),this.addHook("beforeRedo",(function(t){(null==t?void 0:t.actionType)!==Xd&&e.engine.redo()})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("beforeAutofill",(function(){return e.onBeforeAutofill.apply(e,arguments)})),zd(this,Qd).forEach((function(t){var n=Md(t,2),r=n[0],o=n[1];return e.engine.on(r,o)})),Nd(Bd(l.prototype),"enablePlugin",this).call(this)}else Object(rr.b)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var t=this;zd(this,Qd).forEach((function(e){var n=Md(e,2),r=n[0],o=n[1];return t.engine.off(r,o)})),Rd(this.engine,this.hot),this.engine=null,Nd(Bd(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(t){this.engine.updateConfig(function(t){var e,n=t[Yd],r=gd(null!=n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),o=md(t);return pd(pd({},r),o)}(this.hot.getSettings()));var e=this.hot.getSettings()[Yd];if(Object(E.isDefined)(e)&&Object(E.isDefined)(e.sheetName)&&e.sheetName!==this.sheetName&&this.switchSheet(e.sheetName),!t.data&&null===this.sheetName){var n=this.hot.getSettings()[Yd].sheetName;n&&this.engine.doesSheetExist(n)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=n?n:void 0,this.hot.getSourceDataArray())}Nd(Bd(l.prototype),"updatePlugin",this).call(this,t)}},{key:"destroy",value:function(){var t=this;zd(this,Qd).forEach((function(e){var n,r=Md(e,2),o=r[0],l=r[1];return null===(n=t.engine)||void 0===n?void 0:n.off(o,l)})),Ud(this,Qd,null),Rd(this.engine,this.hot),this.engine=null,Nd(Bd(l.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(t,e,n,r,o){return!o&&t>=n?r+(t-n):e}},{key:"toPhysicalRowPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(t,this.hot.toPhysicalRow(t),this.hot.countRows(),this.hot.countSourceRows(),e)}},{key:"toPhysicalColumnPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(t,this.hot.toPhysicalColumn(t),this.hot.countCols(),this.hot.countSourceCols(),e)}},{key:"addSheet",value:function(t,e){if(Object(E.isDefined)(e)&&!Object(Df.isArrayOfArrays)(e))return Object(rr.b)("The provided data should be an array of arrays."),!1;if(null!=t&&this.engine.doesSheetExist(t))return Object(rr.b)("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!=t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(n),e),n}catch(t){return Object(rr.b)(t.message),!1}}},{key:"switchSheet",value:function(t){if(this.engine.doesSheetExist(t)){this.sheetName=t;var e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,"".concat(Object(R.toUpperCaseFirst)(Yd),".switchSheet"))}else Object(rr.a)("The sheet named `".concat(t,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);return null!==r&&null!==o?this.engine.getCellType({sheet:n,row:r,col:o}):"EMPTY"}},{key:"isFormulaCellType",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);return null!==r&&null!==o&&this.engine.doesCellHaveFormula({sheet:n,row:r,col:o})}},{key:"renderDependentSheets",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Set;t.forEach((function(t){var e,n=null==t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==n&&(r.has(n)||r.add(n))})),Ed(this.engine).forEach((function(t,o){var l;(n||o!==e.sheetId)&&r.has(o)&&(t.render(),null===(l=t.view)||void 0===l||l.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(t){var e=this,n=function(t){var e,n=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:{},r=n.row,col=n.col,o=n.sheet;return Object(E.isDefined)(o)?"".concat(o,":").concat(r,"x").concat(col):""},r=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((function(t){return n(t)})));t.forEach((function(t){var o,l,c=null!==(o=t.address)&&void 0!==o?o:{},f=c.row,col=c.col,h=Object(E.isDefined)(f)?e.hot.toVisualRow(f):null,d=Object(E.isDefined)(col)?e.hot.toVisualColumn(col):null;if(null!==h&&null!==d){var y=null==t||null===(l=t.address)||void 0===l?void 0:l.sheet,v=n(t);if(void 0!==y&&!r.has(v)){var m=Ed(e.engine).get(y);if(!m)return;m.validateCell(m.getDataAtCell(h,d),m.getCellMeta(h,d),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(t,e,n){var address={row:this.toPhysicalRowPosition(t),col:this.toPhysicalColumnPosition(e),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(address))return this.engine.setCellContents(address,n);Object(rr.b)("Not possible to set cell data at ".concat(JSON.stringify(address)))}},{key:"onBeforeValidate",value:function(t,e,n){var r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){var address={row:this.hot.toPhysicalRow(e),col:this.hot.toPhysicalColumn(r),sheet:this.sheetId},o=this.engine.getCellValue(address);return"object"===Ad(o)&&null!==o?o.value:o}return t}},{key:"onBeforeAutofill",value:function(t,e,n){var r=this,o=function(t){return Pd(Pd({},t),{},{sheet:r.sheetId})},l={start:o(e.getTopStartCorner()),end:o(e.getBottomEndCorner())},c={start:o(n.getTopStartCorner()),end:o(n.getBottomEndCorner())};return!1!==this.engine.isItPossibleToSetCellContents(c)&&this.engine.getFillRangeData(l,c)}},{key:"onBeforeLoadData",value:function(t,e){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(Object(R.toUpperCaseFirst)(Yd))||Ud(this,qd,Object(E.isUndefined)(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(t,e){var n,r;if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(Object(R.toUpperCaseFirst)(Yd)))if(this.sheetName=(n=this.engine,r=this.hot.getSettings()[Yd].sheetName,!Object(E.isUndefined)(r)&&n.doesSheetExist(r)||(r=n.addSheet(r)),r),zd(this,qd))this.switchSheet(this.sheetName);else{var o=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,o)){Ud(this,$d,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),Ud(this,$d,!1)}}}},{key:"onModifyData",value:function(t,e,n,r){if("get"===r&&!zd(this,$d)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o,l=this.hot.toVisualRow(t);if(!this.isFormulaCellType(l,e)&&"ARRAY"!==this.getCellType(l,e))return void(kd(n.value)&&(n.value=kd(o=n.value)?o.substr(1):o));var address={row:t,col:this.toPhysicalColumnPosition(e),sheet:this.sheetId},c=this.engine.getCellValue(address),f="object"===Ad(c)&&null!==c?c.value:c;n.value=f}}},{key:"onModifySourceData",value:function(t,e,n,r){if("get"===r&&!zd(this,$d)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(t),l=this.hot.propToCol(e);if(!this.isFormulaCellType(o,l)&&"ARRAY"!==this.getCellType(o,l))return;var c=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==c.width||0!==c.height){var address={row:t,col:this.toPhysicalColumnPosition(l),sheet:this.sheetId};n.value=this.engine.getCellSerialized(address)}}}},{key:"onAfterSetDataAtCell",value:function(t,source){var e=this;if(!Kd(source)){var n=[],r=[],o=this.engine.batch((function(){t.forEach((function(t){var o=Md(t,4),l=o[0],c=o[1],f=o[3],h=e.hot.propToCol(c),d=e.hot.toPhysicalRow(l),y=e.hot.toPhysicalColumn(h),address={row:d,col:y,sheet:e.sheetId};null!==d&&null!==y?e.syncChangeWithEngine(l,h,f):n.push([l,h,f]),r.push({address:address})}))}));n.length&&this.hot.addHookOnce("afterChange",(function(){var t=e.engine.batch((function(){n.forEach((function(t){var n=Md(t,3),r=n[0],o=n[1],l=n[2];e.syncChangeWithEngine(r,o,l)}))}));e.renderDependentSheets(t,!0)})),this.renderDependentSheets(o),this.validateDependentCells(o,r)}}},{key:"onAfterSetSourceDataAtCell",value:function(t,source){var e=this;if(!Kd(source)){var n=[],r=[];t.forEach((function(t){var o=Md(t,4),l=o[0],c=o[1],f=o[3],h=e.hot.propToCol(c);if(Object(re.isNumeric)(h)){var address={row:l,col:e.toPhysicalColumnPosition(h),sheet:e.sheetId};e.engine.isItPossibleToSetCellContents(address)?(r.push({address:address}),n.push.apply(n,jd(e.engine.setCellContents(address,f)))):Object(rr.b)("Not possible to set source cell data at ".concat(JSON.stringify(address)))}})),this.renderDependentSheets(n),this.validateDependentCells(n,r)}}},{key:"onBeforeCreateRow",value:function(t,e){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(t),e]))return!1}},{key:"onBeforeCreateCol",value:function(col,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(col),t]))return!1}},{key:"onBeforeRemoveRow",value:function(t,e,n){var r=this;return!1!==n.every((function(t){return r.engine.isItPossibleToRemoveRows(r.sheetId,[t,1])}))&&void 0}},{key:"onBeforeRemoveCol",value:function(col,t,e){var n=this;return!1!==e.every((function(t){return n.engine.isItPossibleToRemoveColumns(n.sheetId,[t,1])}))&&void 0}},{key:"onAfterCreateRow",value:function(t,e,source){if(!Kd(source)){var n=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(t),e]);this.renderDependentSheets(n)}}},{key:"onAfterCreateCol",value:function(col,t,source){if(!Kd(source)){var e=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(col),t]);this.renderDependentSheets(e)}}},{key:"onAfterRemoveRow",value:function(t,e,n,source){var r=this;if(!Kd(source)){var o=n.sort().reverse(),l=this.engine.batch((function(){o.forEach((function(t){r.engine.removeRows(r.sheetId,[t,1])}))}));this.renderDependentSheets(l)}}},{key:"onAfterRemoveCol",value:function(col,t,e,source){var n=this;if(!Kd(source)){var r=e.sort().reverse(),o=this.engine.batch((function(){r.forEach((function(t){n.engine.removeColumns(n.sheetId,[t,1])}))}));this.renderDependentSheets(o)}}},{key:"onAfterDetachChild",value:function(t,element,e){var n,r=this;Ud(this,$d,!0);var o=this.hot.getSourceDataArray(e,0,e+((null===(n=element.__children)||void 0===n?void 0:n.length)||0),this.hot.countSourceCols());Ud(this,$d,!1),o.forEach((function(t,n){t.forEach((function(t,o){r.engine.setCellContents({col:o,row:e+n,sheet:r.sheetId},[[t]])}))}))}},{key:"onEngineValuesUpdated",value:function(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}},{key:"onEngineNamedExpressionsAdded",value:function(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}},{key:"onEngineNamedExpressionsRemoved",value:function(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}},{key:"onEngineSheetAdded",value:function(t){this.hot.runHooks("afterSheetAdded",t)}},{key:"onEngineSheetRenamed",value:function(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}},{key:"onEngineSheetRemoved",value:function(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}}],r=[{key:"PLUGIN_KEY",get:function(){return Yd}},{key:"PLUGIN_PRIORITY",get:function(){return 260}}],n&&Id(e.prototype,n),r&&Id(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);function Zd(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return tp(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tp(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tp(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ep(t){return function(t){if(Array.isArray(t))return np(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return np(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return np(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function np(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var op=n(849);function ip(t){return ip="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(t)}function ap(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lp(n.key),n)}}function lp(t){var e=function(input,t){if("object"!==ip(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ip(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ip(e)?e:String(e)}function sp(){return sp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=hp(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},sp.apply(this,arguments)}function up(t,p){return up=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},up(t,p)}function cp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=hp(t);if(e){var o=hp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ip(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return fp(t)}(this,n)}}function fp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hp(t){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hp(t)}function dp(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function pp(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,bp(t,e,"get"))}function yp(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,bp(t,e,"set"),n),n}function bp(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}it.a.getSingleton().register("beforeHideColumns"),it.a.getSingleton().register("afterHideColumns"),it.a.getSingleton().register("beforeUnhideColumns"),it.a.getSingleton().register("afterUnhideColumns");var vp="hiddenColumns",mp=new WeakMap,gp=new WeakMap,wp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&up(t,e)}(f,t);var e,n,r,l=cp(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return dp(fp(t=l.call.apply(l,[this].concat(n))),mp,{writable:!0,value:{}}),dp(fp(t),gp,{writable:!0,value:null}),t}return e=f,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vp]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[vp];Object(c.isObject)(e)&&(yp(this,mp,e),Object(E.isUndefined)(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),yp(this,gp,new op.a),pp(this,gp).addLocalHook("init",(function(){return t.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,pp(this,gp)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(e,col,n){return t.onAfterGetCellMeta(e,col,n)})),this.addHook("modifyColWidth",(function(e,col){return t.onModifyColWidth(e,col)})),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader.apply(t,arguments)})),this.addHook("modifyCopyableRange",(function(e){return t.onModifyCopyableRange(e)})),sp(hp(f.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sp(hp(f.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),yp(this,mp,{}),sp(hp(f.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(t){var e=this,n=this.getHiddenColumns(),r=this.isValidConfig(t),o=n,l=pp(this,gp).getValues().slice(),c=t.length>0;if(r&&c){var f=t.map((function(t){return e.hot.toPhysicalColumn(t)}));Object(C.arrayEach)(f,(function(t){l[t]=!1})),o=Object(C.arrayReduce)(l,(function(t,n,r){return n&&t.push(e.hot.toVisualColumn(r)),t}),[])}!1!==this.hot.runHooks("beforeUnhideColumns",n,o,r&&c)&&(r&&c&&pp(this,gp).setValues(l),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&c,r&&o.length<n.length))}},{key:"showColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}},{key:"hideColumns",value:function(t){var e=this,n=this.getHiddenColumns(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t)))),!1!==this.hot.runHooks("beforeHideColumns",n,o,r)&&(r&&this.hot.batchExecution((function(){Object(C.arrayEach)(t,(function(t){pp(e,gp).setValueAtIndex(e.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}},{key:"hideColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}},{key:"getHiddenColumns",value:function(){var t=this;return Object(C.arrayMap)(pp(this,gp).getHiddenIndexes(),(function(e){return t.hot.toVisualColumn(e)}))}},{key:"isHidden",value:function(t){return pp(this,gp).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}},{key:"isValidConfig",value:function(t){var e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"resetCellsMeta",value:function(){Object(C.arrayEach)(this.hot.getCellsMeta(),(function(meta){meta&&(meta.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(t,e){return this.isHidden(e)?0:pp(this,mp).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof t&&this.hot.hasColHeaders()?t+15:void 0}},{key:"onAfterGetCellMeta",value:function(t,e,n){if(!1===pp(this,mp).copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this;if(pp(this,mp).copyPasteEnabled)return t;var n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return Object(C.arrayEach)(t,(function(t){var n=!0,o=0;Object(re.rangeEach)(t.startCol,t.endCol,(function(l){e.isHidden(l)?(n||r(t.startRow,t.endRow,o,l-1),n=!0):(n&&(o=l),l===t.endCol&&r(t.startRow,t.endRow,o,l),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(t,e){if(pp(this,mp).indicators&&!(t<0)){var n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Object(o.addClass)(e,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:ni},(e=this,{key:"hidden_columns_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=Zd(t,4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_HIDE_COLUMN,e)},callback:function(){for(var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.max(Math.min(n.col,r.col),0),l=Math.max(n.col,r.col),c=[],f=o;f<=l;f+=1)c.push(f);e.hideColumns(c);var h=c[c.length-1],d=this.columnIndexMapper.getNearestNotHiddenIndex(h,1,!0);Number.isInteger(d)&&d>=0?this.selectColumns(d):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(t){var e=[];return{key:"hidden_columns_show",name:function(){var t=e.length>1?1:0;return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_SHOW_COLUMN,t)},callback:function(){var n,r;if(0!==e.length){var o=e[0],l=e[e.length-1];o=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,l=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(l+1,1))&&void 0!==r?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),l-o+1===this.countCols()||this.selectColumns(o,l)}},disabled:!1,hidden:function(){var n=this,r=Object(C.arrayMap)(t.getHiddenColumns(),(function(t){return n.toPhysicalColumn(t)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),l=o.getTopStartCorner().col,c=o.getBottomEndCorner().col,f=this.columnIndexMapper,h=f.getRenderableFromVisualIndex(l),d=f.getRenderableFromVisualIndex(c),y=f.getNotTrimmedIndexes(),v=[];if(l!==c){if(c-l+1>d-h+1){var m=y.slice(l,c+1);v.push.apply(v,ep(m.filter((function(t){return r.includes(t)}))))}}else if(0===h&&h<l)v.push.apply(v,ep(y.slice(0,l)));else if(null===h)v.push.apply(v,ep(y.slice(0,this.countCols())));else{var w=this.countCols()-1;d===f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(w,-1))&&w>c&&v.push.apply(v,ep(y.slice(c+1)))}return Object(C.arrayEach)(v,(function(t){e.push(n.toVisualColumn(t))})),0===e.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(pp(this,mp).columns)&&this.hideColumns(pp(this,mp).columns)}},{key:"destroy",value:function(){yp(this,mp,null),yp(this,gp,null),sp(hp(f.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return vp}},{key:"PLUGIN_PRIORITY",get:function(){return 310}}],n&&ap(e.prototype,n),r&&ap(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a);function Op(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Sp(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sp(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sp(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Cp(t){return function(t){if(Array.isArray(t))return Ep(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ep(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ep(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ep(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Rp(t){return Rp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rp(t)}function kp(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jp(n.key),n)}}function jp(t){var e=function(input,t){if("object"!==Rp(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Rp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Rp(e)?e:String(e)}function Tp(){return Tp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=_p(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Tp.apply(this,arguments)}function Pp(t,p){return Pp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Pp(t,p)}function Ap(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_p(t);if(e){var o=_p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Rp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Mp(t)}(this,n)}}function Mp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _p(t){return _p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_p(t)}function xp(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function Ip(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Hp(t,e,"get"))}function Np(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Hp(t,e,"set"),n),n}function Hp(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}it.a.getSingleton().register("beforeHideRows"),it.a.getSingleton().register("afterHideRows"),it.a.getSingleton().register("beforeUnhideRows"),it.a.getSingleton().register("afterUnhideRows");var Dp="hiddenRows",Lp=new WeakMap,Bp=new WeakMap,Fp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pp(t,e)}(f,t);var e,n,r,l=Ap(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return xp(Mp(t=l.call.apply(l,[this].concat(n))),Lp,{writable:!0,value:{}}),xp(Mp(t),Bp,{writable:!0,value:null}),t}return e=f,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Dp]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[Dp];Object(c.isObject)(e)&&(Np(this,Lp,e),Object(E.isUndefined)(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),Np(this,Bp,new op.a),Ip(this,Bp).addLocalHook("init",(function(){return t.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,Ip(this,Bp)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(e,col,n){return t.onAfterGetCellMeta(e,col,n)})),this.addHook("modifyRowHeight",(function(e,n){return t.onModifyRowHeight(e,n)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader.apply(t,arguments)})),this.addHook("modifyCopyableRange",(function(e){return t.onModifyCopyableRange(e)})),Tp(_p(f.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Tp(_p(f.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Np(this,Lp,{}),Tp(_p(f.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(t){var e=this,n=this.getHiddenRows(),r=this.isValidConfig(t),o=n,l=Ip(this,Bp).getValues().slice(),c=t.length>0;if(r&&c){var f=t.map((function(t){return e.hot.toPhysicalRow(t)}));Object(C.arrayEach)(f,(function(t){l[t]=!1})),o=Object(C.arrayReduce)(l,(function(t,n,r){return n&&t.push(e.hot.toVisualRow(r)),t}),[])}!1!==this.hot.runHooks("beforeUnhideRows",n,o,r&&c)&&(r&&c&&Ip(this,Bp).setValues(l),this.hot.runHooks("afterUnhideRows",n,o,r&&c,r&&o.length<n.length))}},{key:"showRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}},{key:"hideRows",value:function(t){var e=this,n=this.getHiddenRows(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t)))),!1!==this.hot.runHooks("beforeHideRows",n,o,r)&&(r&&this.hot.batchExecution((function(){Object(C.arrayEach)(t,(function(t){Ip(e,Bp).setValueAtIndex(e.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",n,o,r,r&&o.length>n.length))}},{key:"hideRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}},{key:"getHiddenRows",value:function(){var t=this;return Object(C.arrayMap)(Ip(this,Bp).getHiddenIndexes(),(function(e){return t.hot.toVisualRow(e)}))}},{key:"isHidden",value:function(t){return Ip(this,Bp).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}},{key:"isValidConfig",value:function(t){var e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"resetCellsMeta",value:function(){Object(C.arrayEach)(this.hot.getCellsMeta(),(function(meta){meta&&(meta.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(t,e){return this.isHidden(e)?0:t}},{key:"onAfterGetCellMeta",value:function(t,e,n){if(!1===Ip(this,Lp).copyPasteEnabled&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenRow");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this;if(Ip(this,Lp).copyPasteEnabled)return t;var n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return Object(C.arrayEach)(t,(function(t){var n=!0,o=0;Object(re.rangeEach)(t.startRow,t.endRow,(function(l){e.isHidden(l)?(n||r(o,l-1,t.startCol,t.endCol),n=!0):(n&&(o=l),l===t.endRow&&r(o,l,t.startCol,t.endCol),n=!1)}))})),n}},{key:"onAfterGetRowHeader",value:function(t,e){if(Ip(this,Lp).indicators&&!(t<0)){var n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Object(o.addClass)(e,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:ni},(e=this,{key:"hidden_rows_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=Op(t,3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback:function(){for(var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.max(Math.min(n.row,r.row),0),l=Math.max(n.row,r.row),c=[],f=o;f<=l;f+=1)c.push(f);e.hideRows(c);var h=c[c.length-1],d=this.rowIndexMapper.getNearestNotHiddenIndex(h,1,!0);Number.isInteger(d)&&d>=0?this.selectRows(d):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){var e=[];return{key:"hidden_rows_show",name:function(){var t=e.length>1?1:0;return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_SHOW_ROW,t)},callback:function(){var n,r;if(0!==e.length){var o=e[0],l=e[e.length-1];o=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,l=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(l+1,1))&&void 0!==r?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),l-o+1===this.countRows()||this.selectRows(o,l)}},disabled:!1,hidden:function(){var n=this,r=Object(C.arrayMap)(t.getHiddenRows(),(function(t){return n.toPhysicalRow(t)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),l=o.getTopStartCorner().row,c=o.getBottomEndCorner().row,f=this.rowIndexMapper,h=f.getRenderableFromVisualIndex(l),d=f.getRenderableFromVisualIndex(c),y=f.getNotTrimmedIndexes(),v=[];if(l!==c){if(c-l+1>d-h+1){var m=y.slice(l,c+1);v.push.apply(v,Cp(m.filter((function(t){return r.includes(t)}))))}}else if(0===h&&h<l)v.push.apply(v,Cp(y.slice(0,l)));else if(null===h)v.push.apply(v,Cp(y.slice(0,this.countRows())));else{var w=this.countRows()-1;d===f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(w,-1))&&w>c&&v.push.apply(v,Cp(y.slice(c+1)))}return Object(C.arrayEach)(v,(function(t){e.push(n.toVisualRow(t))})),0===e.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(Ip(this,Lp).rows)&&this.hideRows(Ip(this,Lp).rows)}},{key:"destroy",value:function(){Np(this,Lp,null),Np(this,Bp,null),Tp(_p(f.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Dp}},{key:"PLUGIN_PRIORITY",get:function(){return 320}}],n&&kp(e.prototype,n),r&&kp(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a);function Vp(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Wp(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wp(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wp(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Up(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return zp(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zp(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zp(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Gp(t){return Gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gp(t)}function Yp(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xp(n.key),n)}}function Xp(t){var e=function(input,t){if("object"!==Gp(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Gp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Gp(e)?e:String(e)}function Kp(){return Kp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Jp(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Kp.apply(this,arguments)}function $p(t,p){return $p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},$p(t,p)}function qp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Jp(t);if(e){var o=Jp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Gp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Qp(t)}(this,n)}}function Qp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jp(t){return Jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jp(t)}it.a.getSingleton().register("beforeColumnFreeze"),it.a.getSingleton().register("afterColumnFreeze"),it.a.getSingleton().register("beforeColumnUnfreeze"),it.a.getSingleton().register("afterColumnUnfreeze");var Zp="manualColumnFreeze",ty=new WeakMap,ey=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$p(t,e)}(l,t);var e,n,r,o=qp(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),e=o.call(this,t),ty.set(Qp(e),{afterFirstUse:!1}),e}return e=l,r=[{key:"PLUGIN_KEY",get:function(){return Zp}},{key:"PLUGIN_PRIORITY",get:function(){return 110}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zp]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addContextMenuEntry(e)})),this.addHook("beforeColumnMove",(function(e,n){return t.onBeforeColumnMove(e,n)})),Kp(Jp(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){ty.get(this).afterFirstUse=!1,Kp(Jp(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Kp(Jp(l.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(t){var e=ty.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&t>n.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0),!1!==this.hot.runHooks("beforeColumnFreeze",t,r)&&(r&&(this.hot.columnIndexMapper.moveIndexes(t,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,r))}},{key:"unfreezeColumn",value:function(t){var e=ty.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&t<=n.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0),!1!==this.hot.runHooks("beforeColumnUnfreeze",t,r)&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,r))}},{key:"addContextMenuEntry",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(t,n){var r=Vp(n,1)[0].start.col;e.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}),function(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(e,n){var r=Up(n,1)[0].start.col;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}(this))}},{key:"onBeforeColumnMove",value:function(t,e){if(ty.get(this).afterFirstUse){var n=this.hot.getSettings().fixedColumnsStart;if(e<n)return!1;if(t.some((function(t){return t<n})))return!1}}}])&&Yp(e.prototype,n),r&&Yp(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);function ny(t){return ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(t)}function ry(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oy(n.key),n)}}function oy(t){var e=function(input,t){if("object"!==ny(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ny(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ny(e)?e:String(e)}var iy=0,ay="px",ly=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this._element=null,this.state=iy,this.inlineProperty=e.isRtl()?"right":"left"}var e,n,r;return e=t,(n=[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this.state===iy&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=iy}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){Object(re.isNumeric)(t)&&(this._element.style.top=t+ay),Object(re.isNumeric)(e)&&(this._element.style[this.inlineProperty]=e+ay)}},{key:"getPosition",value:function(){var style=this._element.style;return{top:style.top?parseInt(style.top,10):0,start:style[this.inlineProperty]?parseInt(style[this.inlineProperty],10):0}}},{key:"setSize",value:function(t,e){Object(re.isNumeric)(t)&&(this._element.style.width=t+ay),Object(re.isNumeric)(e)&&(this._element.style.height=e+ay)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){Object(re.isNumeric)(t)&&(this._element.style.marginTop=t+ay),Object(re.isNumeric)(e)&&(this._element.style["margin".concat(Object(R.toUpperCaseFirst)(this.inlineProperty))]=e+ay)}},{key:"getOffset",value:function(){var style=this._element.style,t="margin".concat(Object(R.toUpperCaseFirst)(this.inlineProperty));return{top:style.marginTop?parseInt(style.marginTop,10):0,start:style[t]?parseInt(style[t],10):0}}}])&&ry(e.prototype,n),r&&ry(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function sy(t){return sy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sy(t)}function uy(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cy(n.key),n)}}function cy(t){var e=function(input,t){if("object"!==sy(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==sy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===sy(e)?e:String(e)}function fy(){return fy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=py(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},fy.apply(this,arguments)}function hy(t,p){return hy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},hy(t,p)}function dy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=py(t);if(e){var o=py(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===sy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function py(t){return py=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},py(t)}var yy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hy(t,e)}(c,t);var e,n,r,l=dy(c);function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.apply(this,arguments)}return e=c,(n=[{key:"build",value:function(){fy(py(c.prototype),"build",this).call(this),Object(o.addClass)(this._element,"ht__manualColumnMove--backlight")}}])&&uy(e.prototype,n),r&&uy(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ly),by=yy;function vy(t){return vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vy(t)}function my(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gy(n.key),n)}}function gy(t){var e=function(input,t){if("object"!==vy(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==vy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===vy(e)?e:String(e)}function wy(){return wy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Cy(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},wy.apply(this,arguments)}function Oy(t,p){return Oy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Oy(t,p)}function Sy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Cy(t);if(e){var o=Cy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===vy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Cy(t){return Cy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cy(t)}var Ey=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oy(t,e)}(c,t);var e,n,r,l=Sy(c);function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.apply(this,arguments)}return e=c,(n=[{key:"build",value:function(){wy(Cy(c.prototype),"build",this).call(this),Object(o.addClass)(this._element,"ht__manualColumnMove--guideline")}}])&&my(e.prototype,n),r&&my(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ly),Ry=Ey;function ky(t){return ky="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(t)}function jy(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ty(n.key),n)}}function Ty(t){var e=function(input,t){if("object"!==ky(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ky(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ky(e)?e:String(e)}function Py(){return Py="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=xy(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Py.apply(this,arguments)}function Ay(t,p){return Ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ay(t,p)}function My(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=xy(t);if(e){var o=xy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ky(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _y(t)}(this,n)}}function _y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xy(t){return xy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xy(t)}it.a.getSingleton().register("beforeColumnMove"),it.a.getSingleton().register("afterColumnMove");var Iy="manualColumnMove",Ny=new WeakMap,Hy="ht__manualColumnMove",Dy="show-ui",Ly="on-moving--columns",By="after-selection--columns",Fy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ay(t,e)}(c,t);var e,n,r,l=My(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),e=l.call(this,t),Ny.set(_y(e),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),e.eventManager=new X.a(_y(e)),e.backlight=new by(t),e.guideline=new Ry(t),e}return e=c,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Iy]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterScrollVertically",(function(){return t.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.buildPluginUI(),this.registerEvents(),Object(o.addClass)(this.hot.rootElement,Hy),Py(xy(c.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Py(xy(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Object(o.removeClass)(this.hot.rootElement,Hy),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Py(xy(c.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(t,e){return this.moveColumns([t],e)}},{key:"moveColumns",value:function(t,e){var n=Ny.get(this),r=n.cachedDropIndex,o=this.isMovePossible(t,e),l=this.hot.runHooks("beforeColumnMove",t,e,r,o);if(n.cachedDropIndex=void 0,!1!==l){o&&this.hot.columnIndexMapper.moveIndexes(t,e);var c=o&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,r,o,c),c}}},{key:"dragColumn",value:function(t,e){return this.dragColumns([t],e)}},{key:"dragColumns",value:function(t,e){var n=this.countFinalIndex(t,e);return Ny.get(this).cachedDropIndex=e,this.moveColumns(t,n)}},{key:"isMovePossible",value:function(t,e){var n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>n,o=e<0,l=t.some((function(t){return t<0})),c=t.some((function(t){return t>=n}));return!(r||o||l||c)}},{key:"isColumnOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}},{key:"countFinalIndex",value:function(t,e){var n=Object(C.arrayReduce)(t,(function(t,n){return n<e&&(t+=1),t}),0);return e-n}},{key:"getColumnsWidth",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=0,o=t;o<=e;o+=1){var l=n.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==l&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(l)||0)}return r}},{key:"moveBySettingsOrLoad",value:function(){var t=this.hot.getSettings()[Iy];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}},{key:"isFixedColumnsStart",value:function(t){return t<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}},{key:"prepareColumnsToMoving",value:function(t,e){var n=[];return Object(re.rangeEach)(t,e,(function(i){n.push(i)})),n}},{key:"refreshPositions",value:function(){var t=Ny.get(this),e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(t.hoveredColumn)&&e>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1));var n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,l="number"==typeof r.scrollX?r.scrollX:r.scrollLeft,c=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.hoveredColumn-1),f=n.hider.offsetWidth,h=n.TBODY.offsetLeft,d=this.backlight.getOffset().start,y=this.backlight.getSize().width,v=0,m=0;if(this.hot.isRtl()){var w=this.hot.rootWindow,O=Object(o.outerWidth)(this.hot.rootElement),S=w.innerWidth-t.rootElementOffset-O;m=w.innerWidth-t.target.eventPageX-S-(void 0===r.scrollX?l:0)}else m=t.target.eventPageX-(t.rootElementOffset-(void 0===r.scrollX?l:0));if(t.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(t.hoveredColumn)&&(c+=l),c+=v,t.hoveredColumn<0)t.fixedColumnsStart>0?t.target.col=0:t.target.col=e>0?e-1:e;else if(t.target.TD.offsetWidth/2+c<=m){var C=t.hoveredColumn>=t.countCols?t.countCols-1:t.hoveredColumn;t.target.col=C+1,c+=t.target.TD.offsetWidth}else t.target.col=t.hoveredColumn;var E=m,R=c;m+y+d>=f?E=f-y-d:m+d<h+v&&(E=h+v+Math.abs(d)),c>=f-1?R=f-1:0===R?R=1:void 0!==r.scrollX&&t.hoveredColumn<t.fixedColumnsStart&&(R-=t.rootElementOffset<=r.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,E),this.guideline.setPosition(null,R)}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var l=this.hot.view._wt.wtTable,c=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),h=Ny.get(this),d=Object(o.hasClass)(t.target,"sortAction");if(!f||!c||h.pressed||0!==t.button||d)return h.pressed=!1,h.columnsToMove.length=0,void Object(o.removeClass)(this.hot.rootElement,[Ly,Dy]);var y=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();y&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var m=f.from,w=f.to,O=Math.min(m.col,w.col),S=Math.max(m.col,w.col);if(e.row<0&&e.col>=O&&e.col<=S){r.column=!0,h.pressed=!0,h.target.eventPageX=t.pageX,h.target.eventOffsetX=t.offsetX,h.hoveredColumn=e.col,h.target.TD=n,h.target.col=e.col,h.columnsToMove=this.prepareColumnsToMoving(O,S),h.hasRowHeaders=!!this.hot.getSettings().rowHeaders,h.countCols=this.hot.countCols(),h.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,h.rootElementOffset=Object(o.offset)(this.hot.rootElement).left;var C=h.hasRowHeaders?-1:0,E=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,R=e.col<h.fixedColumnsStart,k=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),j=Math.abs(t.offsetX-(this.hot.isRtl()?t.target.offsetWidth:0)),T=this.getColumnsWidth(O,e.col-1)+j,P=this.getColumnsWidth(C,O-1)+(R?k:0)+T;this.backlight.setPosition(E,P),this.backlight.setSize(this.getColumnsWidth(O,S),l.hider.offsetHeight-E),this.backlight.setOffset(null,-T),Object(o.addClass)(this.hot.rootElement,Ly)}else Object(o.removeClass)(this.hot.rootElement,By),h.pressed=!1,h.columnsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=Ny.get(this);if(e.pressed){if(t.target===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}e.target.eventPageX=t.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var l=this.hot.getSelectedRangeLast(),c=Ny.get(this);l&&c.pressed&&(c.columnsToMove.indexOf(e.col)>-1?Object(o.removeClass)(this.hot.rootElement,Dy):Object(o.addClass)(this.hot.rootElement,Dy),r.row=!0,r.column=!0,r.cell=!0,c.hoveredColumn=e.col,c.target.TD=n)}},{key:"onMouseUp",value:function(){var t=Ny.get(this),e=t.target.col,n=t.columnsToMove.length;if(t.hoveredColumn=void 0,t.pressed=!1,t.backlightWidth=0,Object(o.removeClass)(this.hot.rootElement,[Ly,Dy,By]),this.hot.selection.isSelectedByColumnHeader()&&Object(o.addClass)(this.hot.rootElement,By),!(n<1||void 0===e)){var r=t.columnsToMove[0],l=this.hot.toPhysicalColumn(r),c=this.dragColumns(t.columnsToMove,e);if(t.columnsToMove.length=0,!0===c){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(l),h=f+n-1;this.hot.selectColumns(f,h)}}}},{key:"onAfterScrollVertically",value:function(){var t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;this.backlight.setPosition(e),this.backlight.setSize(null,t.hider.offsetHeight-e)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Py(xy(c.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Iy}},{key:"PLUGIN_PRIORITY",get:function(){return 120}}],n&&jy(e.prototype,n),r&&jy(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a);function Vy(t){return Vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vy(t)}function Wy(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Uy(n.key),n)}}function Uy(t){var e=function(input,t){if("object"!==Vy(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Vy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Vy(e)?e:String(e)}function zy(){return zy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Ky(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},zy.apply(this,arguments)}function Gy(t,p){return Gy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Gy(t,p)}function Yy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ky(t);if(e){var o=Ky(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Vy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Xy(t)}(this,n)}}function Xy(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ky(t){return Ky=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ky(t)}var $y="manualColumnResize",qy="manualColumnWidths",Qy=new WeakMap,Jy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gy(t,e)}(c,t);var e,n,r,l=Yy(c);function c(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var n=(e=l.call(this,t)).hot.rootDocument;return e.currentTH=null,e.currentCol=null,e.selectedCols=[],e.currentWidth=null,e.newSize=null,e.startY=null,e.startWidth=null,e.startOffset=null,e.handle=n.createElement("DIV"),e.guide=n.createElement("DIV"),e.eventManager=new X.a(Xy(e)),e.pressed=null,e.dblclick=0,e.autoresizeTimeout=null,e.columnWidthsMap=void 0,Qy.set(Xy(e),{config:void 0}),Object(o.addClass)(e.handle,"manualColumnResizer"),Object(o.addClass)(e.guide,"manualColumnResizerGuide"),e}return e=c,r=[{key:"PLUGIN_KEY",get:function(){return $y}},{key:"PLUGIN_PRIORITY",get:function(){return 130}}],(n=[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[$y]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.columnWidthsMap=new Ne.a,this.columnWidthsMap.addLocalHook("init",(function(){return t.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(e,col){return t.onModifyColWidth(e,col)})),this.addHook("beforeStretchingColumnWidth",(function(e,n){return t.onBeforeStretchingColumnWidth(e,n)})),this.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)})),this.bindEvents(),zy(Ky(c.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),zy(Ky(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Qy.get(this).config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),zy(Ky(c.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",qy,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var t={};return this.hot.runHooks("persistentStateLoad",qy,t),t.value}},{key:"setManualSize",value:function(t,e){var n=Math.max(e,20),r=this.hot.toPhysicalColumn(t);return this.columnWidthsMap.setValueAtIndex(r,n),n}},{key:"clearManualSize",value:function(t){var e=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(e,null)}},{key:"onMapInit",value:function(){var t=this,e=Qy.get(this),n=this.hot.getSettings()[$y],r=this.loadManualColumnWidths();void 0!==r?this.hot.batchExecution((function(){r.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0):Array.isArray(n)?(this.hot.batchExecution((function(){n.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0),e.config=n):!0===n&&Array.isArray(e.config)&&this.hot.batchExecution((function(){e.config.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0)}},{key:"setupHandlePosition",value:function(t){var e=this;if(t.parentNode){this.currentTH=t;var n=this.hot.view._wt,r=n.wtTable.getCoords(this.currentTH),col=r.col;if(!(col<0)){var l,c=Object(o.outerHeight)(this.currentTH),f=this.currentTH.getBoundingClientRect();col<n.getSetting("fixedColumnsStart")&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(col),this.selectedCols=[];var h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){var d=this.hot.getSelectedRange();Object(C.arrayEach)(d,(function(t){var n=t.getTopStartCorner().col,r=t.getBottomEndCorner().col;Object(re.rangeEach)(n,r,(function(t){e.selectedCols.includes(t)||e.selectedCols.push(t)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(l.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(c,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(Object(o.outerHeight)(this.handle),10),e=parseInt(this.handle.style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Object(o.addClass)(this.handle,"active"),Object(o.addClass)(this.guide,"active"),this.guide.style.top="".concat(e,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Object(o.removeClass)(this.handle,"active"),Object(o.removeClass)(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(element){return!!Object(o.closest)(element,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(element){return"TABLE"!==element.tagName?"TH"===element.tagName?element:this.getClosestTHParent(element.parentNode):null}},{key:"onMouseOver",value:function(t){if(!Object(o.isDetached)(t.target)&&this.checkIfColumnHeader(t.target)){var th=this.getClosestTHParent(t.target);if(!th)return;var e=th.getAttribute("colspan");!th||null!==e&&"1"!==e||this.pressed||this.setupHandlePosition(th)}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeColumnResize",t.newSize,n,!0);void 0!==o&&(t.newSize=o),"all"===t.hot.getSettings().stretchH?t.clearManualSize(n):t.setManualSize(n,t.newSize),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",t.newSize,n,!0),r&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(Object(C.arrayEach)(this.selectedCols,(function(t){n(t)})),e()):Object(C.arrayEach)(this.selectedCols,(function(t){n(t,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;Object(o.hasClass)(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return e.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(t){var e=this;if(this.pressed){var n=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+n,Object(C.arrayEach)(this.selectedCols,(function(t){e.newSize=e.setManualSize(t,e.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeColumnResize",t.newSize,n,!1),r&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",t.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(Object(C.arrayEach)(this.selectedCols,(function(t){n(t)})),e()):Object(C.arrayEach)(this.selectedCols,(function(t){n(t,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootWindow,r=e.rootElement;this.eventManager.addEventListener(r,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(r,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(n,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(n,"mouseup",(function(){return t.onMouseUp()}))}},{key:"onModifyColWidth",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.toPhysicalColumn(e),o=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[$y]&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=this.columnWidthsMap.getValueAtIndex(e);return null===n&&(n=t),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){zy(Ky(c.prototype),"destroy",this).call(this)}}])&&Wy(e.prototype,n),r&&Wy(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a);function Zy(t){return Zy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zy(t)}function tb(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eb(n.key),n)}}function eb(t){var e=function(input,t){if("object"!==Zy(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Zy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Zy(e)?e:String(e)}var nb=0,rb="px",ob=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this._element=null,this.state=nb}var e,n,r;return e=t,(n=[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this.state===nb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=nb}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){void 0!==t&&(this._element.style.top=t+rb),void 0!==e&&(this._element.style.left=e+rb)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){t&&(this._element.style.width=t+rb),e&&(this._element.style.height=e+rb)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){t&&(this._element.style.marginTop=t+rb),e&&(this._element.style.marginLeft=e+rb)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}])&&tb(e.prototype,n),r&&tb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ib(t){return ib="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ib(t)}function ab(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lb(n.key),n)}}function lb(t){var e=function(input,t){if("object"!==ib(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ib(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ib(e)?e:String(e)}function sb(){return sb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=fb(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},sb.apply(this,arguments)}function ub(t,p){return ub=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ub(t,p)}function cb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=fb(t);if(e){var o=fb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ib(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function fb(t){return fb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fb(t)}var hb=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ub(t,e)}(c,t);var e,n,r,l=cb(c);function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.apply(this,arguments)}return e=c,(n=[{key:"build",value:function(){sb(fb(c.prototype),"build",this).call(this),Object(o.addClass)(this._element,"ht__manualRowMove--backlight")}}])&&ab(e.prototype,n),r&&ab(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ob),db=hb;function pb(t){return pb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(t)}function yb(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bb(n.key),n)}}function bb(t){var e=function(input,t){if("object"!==pb(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==pb(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===pb(e)?e:String(e)}function vb(){return vb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=wb(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},vb.apply(this,arguments)}function mb(t,p){return mb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},mb(t,p)}function gb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wb(t);if(e){var o=wb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===pb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function wb(t){return wb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wb(t)}var Ob=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mb(t,e)}(c,t);var e,n,r,l=gb(c);function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.apply(this,arguments)}return e=c,(n=[{key:"build",value:function(){vb(wb(c.prototype),"build",this).call(this),Object(o.addClass)(this._element,"ht__manualRowMove--guideline")}}])&&yb(e.prototype,n),r&&yb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ob),Sb=Ob;function Cb(t){return Cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cb(t)}function Eb(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rb(n.key),n)}}function Rb(t){var e=function(input,t){if("object"!==Cb(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Cb(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Cb(e)?e:String(e)}function kb(){return kb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Ab(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},kb.apply(this,arguments)}function jb(t,p){return jb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},jb(t,p)}function Tb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ab(t);if(e){var o=Ab(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Cb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Pb(t)}(this,n)}}function Pb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ab(t){return Ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ab(t)}it.a.getSingleton().register("beforeRowMove"),it.a.getSingleton().register("afterRowMove");var Mb="manualRowMove",_b=new WeakMap,xb="ht__manualRowMove",Ib="show-ui",Nb="on-moving--rows",Hb="after-selection--rows",Db=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jb(t,e)}(c,t);var e,n,r,l=Tb(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),e=l.call(this,t),_b.set(Pb(e),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),e.eventManager=new X.a(Pb(e)),e.backlight=new db(t),e.guideline=new Sb(t),e}return e=c,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Mb]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterScrollHorizontally",(function(){return t.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.buildPluginUI(),this.registerEvents(),Object(o.addClass)(this.hot.rootElement,xb),kb(Ab(c.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),kb(Ab(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Object(o.removeClass)(this.hot.rootElement,xb),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),kb(Ab(c.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(t,e){return this.moveRows([t],e)}},{key:"moveRows",value:function(t,e){var n=_b.get(this),r=n.cachedDropIndex,o=this.isMovePossible(t,e),l=this.hot.runHooks("beforeRowMove",t,e,r,o);if(n.cachedDropIndex=void 0,!1!==l){o&&this.hot.rowIndexMapper.moveIndexes(t,e);var c=o&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,r,o,c),c}}},{key:"dragRow",value:function(t,e){return this.dragRows([t],e)}},{key:"dragRows",value:function(t,e){var n=this.countFinalIndex(t,e);return _b.get(this).cachedDropIndex=e,this.moveRows(t,n)}},{key:"isMovePossible",value:function(t,e){var n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>n,o=e<0,l=t.some((function(t){return t<0})),c=t.some((function(t){return t>=n}));return!(r||o||l||c)}},{key:"isRowOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}},{key:"countFinalIndex",value:function(t,e){var n=Object(C.arrayReduce)(t,(function(t,n){return n<e&&(t+=1),t}),0);return e-n}},{key:"getRowsHeight",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=0,o=t;o<=e;o++){var l=n.getRenderableFromVisualIndex(o);null!==l&&(r+=this.hot.view._wt.wtTable.getRowHeight(l)||23)}return r}},{key:"moveBySettingsOrLoad",value:function(){var t=this.hot.getSettings()[Mb];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}},{key:"isFixedRowTop",value:function(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function(){var t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;var n=t.from,r=t.to,o=Math.min(n.row,r.row),l=Math.max(n.row,r.row);return Object(re.rangeEach)(o,l,(function(i){e.push(i)})),e}},{key:"refreshPositions",value:function(){var t=_b.get(this),e=t.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);var c=this.hot.view._wt.wtTable,f=t.target.TD,h=Object(o.offset)(this.hot.rootElement),d=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1),y=t.target.eventPageY-h.top+c.holder.scrollTop,v=c.hider.offsetHeight,m=c.TBODY.offsetTop,w=this.backlight.getOffset().top,O=this.backlight.getSize().height;this.isFixedRowTop(e.row)&&(d+=c.holder.scrollTop),e.row<0?t.target.row=n>0?n-1:n:f.offsetHeight/2+d<=y?(t.target.row=e.row+1,d+=0===e.row?f.offsetHeight-1:f.offsetHeight):t.target.row=e.row;var S=y,C=d;y+O+w>=v?S=v-O-w:y+w<m&&(S=m+Math.abs(w)),d>=v-1&&(C=v-1),this.backlight.setPosition(S),this.guideline.setPosition(C)}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var l=this.hot.view._wt,c=l.wtTable,f=l.wtViewport,h=this.hot.selection.isSelectedByRowHeader(),d=this.hot.getSelectedRangeLast(),y=_b.get(this);if(!d||!h||y.pressed||0!==t.button)return y.pressed=!1,y.rowsToMove.length=0,void Object(o.removeClass)(this.hot.rootElement,[Nb,Ib]);var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),m=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&m&&(this.guideline.appendTo(c.hider),this.backlight.appendTo(c.hider));var w=d.from,O=d.to,S=Math.min(w.row,O.row),C=Math.max(w.row,O.row);if(e.col<0&&e.row>=S&&e.row<=C){r.row=!0,y.pressed=!0,y.target.eventPageY=t.pageY,y.target.coords=e,y.target.TD=n,y.rowsToMove=this.prepareRowsToMoving();var E=c.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,E),this.backlight.setSize(c.hider.offsetWidth-E,this.getRowsHeight(S,C)),this.backlight.setOffset(-1*(this.getRowsHeight(S,e.row-1)+t.offsetY),null),Object(o.addClass)(this.hot.rootElement,Nb),this.refreshPositions()}else Object(o.removeClass)(this.hot.rootElement,Hb),y.pressed=!1,y.rowsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=_b.get(this);if(e.pressed){if(t.target===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}e.target.eventPageY=t.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var l=this.hot.getSelectedRangeLast(),c=_b.get(this);l&&c.pressed&&(c.rowsToMove.indexOf(e.row)>-1?Object(o.removeClass)(this.hot.rootElement,Ib):Object(o.addClass)(this.hot.rootElement,Ib),r.row=!0,r.column=!0,r.cell=!0,c.target.coords=e,c.target.TD=n)}},{key:"onMouseUp",value:function(){var t=_b.get(this),e=t.target.row,n=t.rowsToMove.length;if(t.pressed=!1,t.backlightHeight=0,Object(o.removeClass)(this.hot.rootElement,[Nb,Ib,Hb]),this.hot.selection.isSelectedByRowHeader()&&Object(o.addClass)(this.hot.rootElement,Hb),!(n<1||void 0===e)){var r=t.rowsToMove[0],l=this.hot.toPhysicalRow(r),c=this.dragRows(t.rowsToMove,e);if(t.rowsToMove.length=0,!0===c){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(l),h=f+n-1;this.hot.selectRows(f,h)}}}},{key:"onAfterScrollHorizontally",value:function(){var t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;this.backlight.setPosition(null,e),this.backlight.setSize(t.hider.offsetWidth-e)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),kb(Ab(c.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Mb}},{key:"PLUGIN_PRIORITY",get:function(){return 140}}],n&&Eb(e.prototype,n),r&&Eb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a),Lb=n(1062);function Bb(t){return Bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bb(t)}function Fb(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vb(n.key),n)}}function Vb(t){var e=function(input,t){if("object"!==Bb(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Bb(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Bb(e)?e:String(e)}function Wb(){return Wb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Yb(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Wb.apply(this,arguments)}function Ub(t,p){return Ub=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ub(t,p)}function zb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Yb(t);if(e){var o=Yb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Bb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Gb(t)}(this,n)}}function Gb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yb(t){return Yb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yb(t)}var Xb,Kb,$b,qb,Qb="manualRowResize",Jb="manualRowHeights",Zb=new WeakMap,tv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ub(t,e)}(c,t);var e,n,r,l=zb(c);function c(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var n=(e=l.call(this,t)).hot.rootDocument;return e.currentTH=null,e.currentRow=null,e.selectedRows=[],e.currentHeight=null,e.newSize=null,e.startY=null,e.startHeight=null,e.startOffset=null,e.handle=n.createElement("DIV"),e.guide=n.createElement("DIV"),e.eventManager=new X.a(Gb(e)),e.pressed=null,e.dblclick=0,e.autoresizeTimeout=null,e.rowHeightsMap=void 0,Zb.set(Gb(e),{config:void 0}),Object(o.addClass)(e.handle,"manualRowResizer"),Object(o.addClass)(e.guide,"manualRowResizerGuide"),e}return e=c,r=[{key:"PLUGIN_KEY",get:function(){return Qb}},{key:"PLUGIN_PRIORITY",get:function(){return 30}}],(n=[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Qb]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.rowHeightsMap=new Ne.a,this.rowHeightsMap.addLocalHook("init",(function(){return t.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(e,n){return t.onModifyRowHeight(e,n)})),this.bindEvents(),Wb(Yb(c.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Wb(Yb(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Zb.get(this).config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Wb(Yb(c.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",Jb,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var t={};return this.hot.runHooks("persistentStateLoad",Jb,t),t.value}},{key:"setManualSize",value:function(t,e){var n=this.hot.toPhysicalRow(t),r=Math.max(e,Lb.a.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,r),r}},{key:"setupHandlePosition",value:function(t){var e=this;this.currentTH=t;var view=this.hot.view,n=view._wt,r=n.wtTable.getCoords(this.currentTH),l=r.row;if(!(l<0)){var c,f=Object(o.outerWidth)(this.currentTH),h=this.currentTH.getBoundingClientRect(),d=l<n.getSetting("fixedRowsTop"),y=l>=view.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");d?c=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col):y&&(c=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),c||(c=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.selectedRows=[];var v=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&v){var m=this.hot.getSelectedRange();Object(C.arrayEach)(m,(function(t){var n=t.getTopStartCorner().row,r=t.getBottomStartCorner().row;Object(re.rangeEach)(n,r,(function(t){e.selectedRows.includes(t)||e.selectedRows.push(t)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(h.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(c.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(Object(o.outerWidth)(this.handle),10),e=parseInt(this.handle.style[this.inlineDir],10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Object(o.addClass)(this.handle,"active"),Object(o.addClass)(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(e,"px"),this.guide.style.width="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Object(o.removeClass)(this.handle,"active"),Object(o.removeClass)(this.guide,"active")}},{key:"checkIfRowHeader",value:function(element){var t,e;return Object(o.closest)(element,["TH"],this.hot.rootElement)&&"TBODY"===(null===(t=element.parentNode)||void 0===t||null===(e=t.parentNode)||void 0===e?void 0:e.tagName)}},{key:"getClosestTHParent",value:function(element){return"TABLE"!==element.tagName?"TH"===element.tagName?element:this.getClosestTHParent(element.parentNode):null}},{key:"getActualRowHeight",value:function(t){var e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&this.newSize<e?e:this.newSize}},{key:"onMouseOver",value:function(t){if(!Object(o.isDetached)(t.target)&&this.checkIfRowHeader(t.target)){var th=this.getClosestTHParent(t.target);th&&(this.pressed||this.setupHandlePosition(th))}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeRowResize",t.getActualRowHeight(n),n,!0);void 0!==o&&(t.newSize=o),t.setManualSize(n,t.newSize),t.hot.runHooks("afterRowResize",t.getActualRowHeight(n),n,!0),r&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(Object(C.arrayEach)(this.selectedRows,(function(t){n(t)})),e()):Object(C.arrayEach)(this.selectedRows,(function(t){n(t,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;Object(o.hasClass)(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return e.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),Object(C.arrayEach)(this.selectedRows,(function(t){e.newSize=e.setManualSize(t,e.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeRowResize",t.getActualRowHeight(n),n,!1),r&&e(),t.saveManualRowHeights(),t.hot.runHooks("afterRowResize",t.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(Object(C.arrayEach)(this.selectedRows,(function(t){n(t)})),e()):Object(C.arrayEach)(this.selectedRows,(function(t){n(t,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootElement,r=e.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(n,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(r,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(r,"mouseup",(function(){return t.onMouseUp()}))}},{key:"onModifyRowHeight",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.toPhysicalRow(e),o=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[Qb]&&o&&(n=o)}return n}},{key:"onMapInit",value:function(){var t=this,e=Zb.get(this),n=this.hot.getSettings()[Qb],r=this.loadManualRowHeights();this.hot.batchExecution((function(){void 0!==r?r.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)})):Array.isArray(n)?(n.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)})),e.config=n):!0===n&&Array.isArray(e.config)&&e.config.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)}))}),!0)}},{key:"destroy",value:function(){Wb(Yb(c.prototype),"destroy",this).call(this)}}])&&Fb(e.prototype,n),r&&Fb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a);function ev(t){return ev="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ev(t)}function nv(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function rv(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ov(n.key),n)}}function ov(t){var e=function(input,t){if("object"!==ev(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ev(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ev(e)?e:String(e)}var iv,av=function(){function t(e,n,r,o,l,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.row=e,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1,this.cellCoordsFactory=l,this.cellRangeFactory=c}var e,n,r;return e=t,r=[{key:"NEGATIVE_VALUES_WARNING",value:function(t){return Object(Wo.a)(Xb||(Xb=nv(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(t){return Object(Wo.a)(Kb||(Kb=nv(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function(t){return Object(Wo.a)($b||($b=nv(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function(t){return Object(Wo.a)(qb||(qb=nv(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),t.row,t.col)}},{key:"containsNegativeValues",value:function(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function(t){return 1===t.colspan&&1===t.rowspan}},{key:"containsZeroSpan",value:function(t){return 0===t.colspan||0===t.rowspan}},{key:"isOutOfBounds",value:function(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}}],(n=[{key:"normalize",value:function(t){var e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,e){var n=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,span=t[0]?"colspan":"rowspan",o=t[0]?"col":"row",l=Math.min(e,r),c=Math.max(e,r),f=this[o],h=this[o]+this[span]-1;if(f>=e&&(this[o]+=n),n>0)e<=h&&e>f&&(this[span]+=n);else if(n<0){if(l<=f&&c>=h)return this.removed=!0,!1;if(f>=l&&f<=c){var d=c-f+1,y=Math.abs(n)-d;this[o]-=y+n,this[span]-=d}else if(f<=l&&h>=c)this[span]+=n;else if(f<=l&&h>=l&&h<c){var v=h-l+1;this[span]-=v}}return!0}},{key:"isFarther",value:function(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}])&&rv(e.prototype,n),r&&rv(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function lv(t,e,n,col){e?e.row===n&&e.col===col?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function sv(t){return sv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sv(t)}function uv(t){return function(t){if(Array.isArray(t))return cv(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return cv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cv(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function fv(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hv(n.key),n)}}function hv(t){var e=function(input,t){if("object"!==sv(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==sv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===sv(e)?e:String(e)}var dv=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}var e,n,r;return e=t,n=[{key:"get",value:function(t,e){var n=this.mergedCells,r=!1;return Object(C.arrayEach)(n,(function(n){return!(n.row<=t&&n.row+n.rowspan-1>=t&&n.col<=e&&n.col+n.colspan-1>=e&&(r=n,1))})),r}},{key:"getByRange",value:function(t){var e=this.mergedCells,n=!1;return Object(C.arrayEach)(e,(function(e){return!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(n=e)})),n}},{key:"getWithinRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCells,o=[],l=t;if(!l.includesRange){var c=this.hot._createCellCoords(l.from.row,l.from.col),f=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(c,c,f)}return Object(C.arrayEach)(r,(function(t){var r=e.hot._createCellCoords(t.row,t.col),c=e.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),f=e.hot._createCellRange(r,r,c);n?l.overlaps(f)&&o.push(t):l.includesRange(f)&&o.push(t)})),!!o.length&&o}},{key:"add",value:function(e){var n=this.mergedCells,r=e.row,o=e.col,l=e.rowspan,c=e.colspan,f=new av(r,o,l,c,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(r,o),d=this.isOverlapping(f);return h||d?(Object(rr.b)(t.IS_OVERLAPPING_WARNING(f)),!1):(this.hot&&f.normalize(this.hot),n.push(f),f)}},{key:"remove",value:function(t,e){var n=this.mergedCells,r=this.get(t,e),o=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var t=this,e=this.mergedCells,n=[],r=[];Object(C.arrayEach)(e,(function(e){var r=t.hot.getCell(e.row,e.col);r&&n.push([r,t.get(e.row,e.col),e.row,e.col])})),this.mergedCells.length=0,Object(C.arrayEach)(n,(function(e,i){Object(re.rangeEach)(0,e.rowspan-1,(function(n){Object(re.rangeEach)(0,e.colspan-1,(function(o){if(0!==o||0!==n){var l=t.hot.getCell(e.row+n,e.col+o);l&&r.push([l,null,null,null])}}))})),n[i][1]=null})),Object(C.arrayEach)(n,(function(t){lv.apply(void 0,uv(t))})),Object(C.arrayEach)(r,(function(t){lv.apply(void 0,uv(t))}))}},{key:"isOverlapping",value:function(t){var e=this,n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)),r=!1;return Object(C.arrayEach)(this.mergedCells,(function(col){return!e.hot._createCellRange(e.hot._createCellCoords(0,0),e.hot._createCellCoords(col.row,col.col),e.hot._createCellCoords(col.row+col.rowspan-1,col.col+col.colspan-1)).overlaps(n)||(r=!0,!1)})),r}},{key:"isFirstRenderableMergedCell",value:function(t,e){var n=this.get(t,e);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===e}},{key:"getFirstRenderableCoords",value:function(t,e){var n=this.get(t,e);if(!n||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);var r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,o)}},{key:"shiftCollections",value:function(t,e,n){var r=this,o=[0,0];switch(t){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n}Object(C.arrayEach)(this.mergedCells,(function(t){t.shift(o,e)})),Object(re.rangeEachReverse)(this.mergedCells.length-1,0,(function(i){var t=r.mergedCells[i];t&&t.removed&&r.mergedCells.splice(r.mergedCells.indexOf(t),1)}))}}],r=[{key:"IS_OVERLAPPING_WARNING",value:function(t){return Object(Wo.a)(iv||(e=["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],(n=["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])||(n=e.slice(0)),iv=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))),t.row,t.col);var e,n}}],n&&fv(e.prototype,n),r&&fv(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),pv=dv;function yv(t){return yv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yv(t)}function bv(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return vv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vv(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function mv(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gv(n.key),n)}}function gv(t){var e=function(input,t){if("object"!==yv(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==yv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===yv(e)?e:String(e)}var wv=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var e,n,r;return e=t,(n=[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}},{key:"getDirection",value:function(t,e){return e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left"}},{key:"snapDragArea",value:function(t,e,n,r){var o=e.slice(0),l=this.getAutofillSize(t,e,n),c=bv(t,4),f=c[0],h=c[1],d=c[2],y=c[3],v=["up","down"].indexOf(n)>-1?d-f+1:y-h+1,m=l-Math.floor(l/v)*v,w=this.getFarthestCollection(t,e,n,r);if(w)if("down"===n){var O=w.row+w.rowspan-f-m;o[2]+O>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?O:0}else if("right"===n){var S=w.col+w.colspan-h-m;o[3]+S>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?S:0}else if("up"===n){var C=d-m-w.row+1;o[0]+C<0?o[0]+=m:o[0]-=m?C:0}else if("left"===n){var E=y-m-w.col+1;o[1]+E<0?o[1]+=m:o[1]-=m?E:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:r,fillSize:l,dragArea:o,cycleLength:v}),o}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),Object(c.extend)(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,e,n){var r=bv(t,4),o=r[0],l=r[1],c=r[2],f=r[3],h=bv(e,4),d=h[0],y=h[1],v=h[2],m=h[3];switch(n){case"up":return o-d;case"down":return v-c;case"left":return l-y;case"right":return m-f;default:return null}}},{key:"getDragArea",value:function(t,e,n){var r=bv(t,4),o=r[0],l=r[1],c=r[2],f=r[3],h=bv(e,4),d=h[0],y=h[1],v=h[2],m=h[3];switch(n){case"up":return[d,y,o-1,f];case"down":return[c+1,l,v,f];case"left":return[d,y,c,l-1];case"right":return[o,f+1,v,m];default:return null}}},{key:"getFarthestCollection",value:function(t,e,n,r){var o=bv(t,4),l=o[0],c=o[1],f=o[2],h=o[3],d=["up","down"].indexOf(n)>-1,y=d?f:h,v=d?l:c,m=this.getAutofillSize(t,e,n),w=d?f-l+1:h-c+1,O=m-Math.floor(m/w)*w,S=null,E=null,R=null;switch(n){case"up":S="includesVertically",R=y-O+1;break;case"left":S="includesHorizontally",R=y-O+1;break;case"down":S="includesVertically",R=v+O-1;break;case"right":S="includesHorizontally",R=v+O-1}return Object(C.arrayEach)(r,(function(t){t[S](R)&&t.isFarther(E,n)&&(E=t)})),E}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(t,n){switch(r){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}},l=0,c=null,f=1;do{for(var h=0;h<n.length;h+=1){if(o(c=n[h],l=f*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:c.row-l,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:c.row+l,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col-l,colspan:c.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col+l,colspan:c.colspan})}h===n.length-1&&(f+=1)}}while(o(c,l));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(t){var e=this,n={min:null,max:null},r={min:null,max:null};return Object(C.arrayEach)(t,(function(t){var o=t[0],l=e.plugin.hot.propToCol(t[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||l<r.min)&&(r.min=l),(null===r.max||l>r.max)&&(r.max=l)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,e,n){var r=bv(this.getDragArea(t,e,n),4),o=r[0],l=r[1],c=r[2],f=r[3],h=this.plugin.hot._createCellCoords(o,l),d=this.plugin.hot._createCellCoords(c,f),y=this.plugin.hot._createCellRange(h,h,d);return!!this.mergedCellsCollection.getWithinRange(y,!0)}}])&&mv(e.prototype,n),r&&mv(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ov(t){return Ov="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ov(t)}function Sv(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cv(n.key),n)}}function Cv(t){var e=function(input,t){if("object"!==Ov(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ov(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ov(e)?e:String(e)}var Ev=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var e,n,r;return e=t,(n=[{key:"snapDelta",value:function(t,e,n){var r=e.to,o=r.row+t.row,l=r.col+t.col;t.row?this.jumpOverMergedCell(t,n,o):t.col&&this.jumpOverMergedCell(t,n,l)}},{key:"jumpOverMergedCell",value:function(t,e,n){var r=t.row||t.col,o=null,l=null,c=null;t.row?(o=e.includesVertically(n),l=e.row,c=e.getLastRow()):t.col&&(o=e.includesHorizontally(n),l=e.col,c=e.getLastColumn()),0!==r&&(r>0?o&&n!==l&&(r+=c-n+1):o&&n!==c&&(r-=n-l+1),t.row?t.row=r:t.col&&(t.col=r))}},{key:"getUpdatedSelectionRange",value:function(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}},{key:"getSelectedMergedCellClassName",value:function(t,e,n,r){var o=Math.min(n[0],n[2]),l=Math.min(n[1],n[3]),c=Math.max(n[0],n[2]),f=Math.max(n[1],n[3]);if(void 0!==r&&this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e)){var h=this.plugin.mergedCellsCollection.get(t,e);if(h){var d=h.getLastRow(),y=h.getLastColumn();return o<=h.row&&l<=h.col&&c>=d&&f>=y?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.plugin.selectionCalculations.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}},{key:"isMergeCellFullySelected",value:function(t,e){var n=[];if(!e||!t)return!1;for(var r=0;r<t.rowspan;r+=1)for(var o=0;o<t.colspan;o+=1)n.push(this.hot._createCellCoords(t.row+r,t.col+o));for(var i=0;i<n.length;i+=1){for(var l=[],s=0;s<e.length;s+=1)l[s]=e[s].includes(n[i]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var t=[],i=0;i<=7;i+=1)t.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(i));return t.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),t}}])&&Sv(e.prototype,n),r&&Sv(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Rv(t){return Rv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rv(t)}function kv(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||Tv(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jv(t){return function(t){if(Array.isArray(t))return Pv(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Tv(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tv(t,e){if(t){if("string"==typeof t)return Pv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pv(t,e):void 0}}function Pv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Av(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mv(n.key),n)}}function Mv(t){var e=function(input,t){if("object"!==Rv(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Rv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Rv(e)?e:String(e)}function _v(){return _v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Hv(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},_v.apply(this,arguments)}function xv(t,p){return xv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},xv(t,p)}function Iv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Hv(t);if(e){var o=Hv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Rv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Nv(t)}(this,n)}}function Nv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hv(t){return Hv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hv(t)}it.a.getSingleton().register("beforeMergeCells"),it.a.getSingleton().register("afterMergeCells"),it.a.getSingleton().register("beforeUnmergeCells"),it.a.getSingleton().register("afterUnmergeCells");var Dv,Lv="mergeCells",Bv=new WeakMap,Fv=Lv,Vv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xv(t,e)}(f,t);var e,n,r,l=Iv(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),e=l.call(this,t),Bv.set(Nv(e),{lastDesiredCoords:null}),e.mergedCellsCollection=null,e.autofillCalculations=null,e.selectionCalculations=null,e}return e=f,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Lv]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mergedCellsCollection=new pv(this),this.autofillCalculations=new wv(this),this.selectionCalculations=new Ev(this),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("modifyTransformStart",(function(){return t.onModifyTransformStart.apply(t,arguments)})),this.addHook("afterModifyTransformStart",(function(){return t.onAfterModifyTransformStart.apply(t,arguments)})),this.addHook("modifyTransformEnd",(function(){return t.onModifyTransformEnd.apply(t,arguments)})),this.addHook("modifyGetCellCoords",(function(){return t.onModifyGetCellCoords.apply(t,arguments)})),this.addHook("beforeSetRangeStart",(function(){return t.onBeforeSetRangeStart.apply(t,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return t.onBeforeSetRangeStart.apply(t,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return t.onBeforeSetRangeEnd.apply(t,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return t.onAfterIsMultipleSelection.apply(t,arguments)})),this.addHook("afterRenderer",(function(){return t.onAfterRenderer.apply(t,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.addMergeActionsToContextMenu.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(){return t.onAfterGetCellMeta.apply(t,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return t.onAfterViewportRowCalculatorOverride.apply(t,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)})),this.addHook("modifyAutofillRange",(function(){return t.onModifyAutofillRange.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeDrawBorders",(function(){return t.onBeforeDrawAreaBorders.apply(t,arguments)})),this.addHook("afterDrawSelection",(function(){return t.onAfterDrawSelection.apply(t,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return t.onBeforeRemoveCellClassNames.apply(t,arguments)})),this.addHook("beforeUndoStackChange",(function(t,source){if("MergeCells"===source)return!1})),this.registerShortcuts(),_v(Hv(f.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),_v(Hv(f.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings()[Lv];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),_v(Hv(f.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var t=this;if(Object(ga.isChrome)()){var e=[],n=[];this.mergedCellsCollection.mergedCells.forEach((function(t){for(var e=t.row,r=t.rowspan,o=e+1;o<e+r;o++)n.push(o)})),(n=jv(new Set(n))).forEach((function(n){var r=t.hot.rowIndexMapper.getRenderableFromVisualIndex(n);t.hot.view._wt.wtOverlays.getOverlays(!0).map((function(t){return"master"===(null==t?void 0:t.name)?t:t.clone.wtTable})).forEach((function(t){var n=t.getRow(r);n&&(n.style.background=Object(o.getStyle)(n,"backgroundColor").replace(")",", 0.99)"),e.push(n))}))})),this.hot._registerTimeout((function(){e.forEach((function(t){t.style.background=Object(o.getStyle)(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}}},{key:"validateSetting",value:function(t){var e=!0;return!!t&&(av.containsNegativeValues(t)?(Object(rr.b)(av.NEGATIVE_VALUES_WARNING(t)),e=!1):av.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Object(rr.b)(av.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):av.isSingleCell(t)?(Object(rr.b)(av.IS_SINGLE_CELL(t)),e=!1):av.containsZeroSpan(t)&&(Object(rr.b)(av.ZERO_SPAN_WARNING(t)),e=!1),e)}},{key:"generateFromSettings",value:function(t){var e=this;if(Array.isArray(t)){var n=[];if(Object(C.arrayEach)(t,(function(t){if(e.validateSetting(t)){var r=e.hot._createCellCoords(t.row,t.col),o=e.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),l=e.hot._createCellRange(r,r,o);e.mergeRange(l,!0,!0),Object(re.rangeEach)(t.row,t.row+t.rowspan-1,(function(e){Object(re.rangeEach)(t.col,t.col+t.colspan-1,(function(r){0==(e===t.row&&r===t.col)&&n.push([e,r,null])}))}))}})),0===n.length)return;this.hot.setDataAtCell(n)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(t){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(t)}},{key:"toggleMergeOnSelection",value:function(){var t=this.hot.getSelectedRangeLast();if(t){t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var e=t.from,n=t.to;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var e=t.from,n=t.to;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){var e=t.from,n=t.to;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.getTopStartCorner(),l=t.getBottomEndCorner(),c={row:o.row,col:o.col,rowspan:l.row-o.row+1,colspan:l.col-o.col+1},f=[],h=null;return!!this.canMergeRange(c,n)&&(this.hot.runHooks("beforeMergeCells",t,n),Object(re.rangeEach)(0,c.rowspan-1,(function(i){Object(re.rangeEach)(0,c.colspan-1,(function(t){var n=null;f[i]||(f[i]=[]),0===i&&0===t?n=e.hot.getSourceDataAtCell(e.hot.toPhysicalRow(c.row),e.hot.toPhysicalColumn(c.col)):e.hot.setCellMeta(c.row+i,c.col+t,"hidden",!0),f[i][t]=n}))})),this.hot.setCellMeta(c.row,c.col,"spanned",!0),!this.mergedCellsCollection.add(c)||(r?h=[c.row,c.col,f]:this.hot.populateFromArray(c.row,c.col,f,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,c,n),h))}},{key:"unmergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(t);r&&(this.hot.runHooks("beforeUnmergeCells",t,n),Object(C.arrayEach)(r,(function(t){e.mergedCellsCollection.remove(t.row,t.col),Object(re.rangeEach)(0,t.rowspan-1,(function(i){Object(re.rangeEach)(0,t.colspan-1,(function(n){e.hot.removeCellMeta(t.row+i,t.col+n,"hidden")}))})),e.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,n),this.hot.render())}},{key:"toggleMerge",value:function(t){var e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}},{key:"merge",value:function(t,e,n,r){var o=this.hot._createCellCoords(t,e),l=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(o,o,l))}},{key:"unmerge",value:function(t,e,n,r){var o=this.hot._createCellCoords(t,e),l=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(o,o,l))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Lv]),this.hot.render()}},{key:"registerShortcuts",value:function(){var t=this;this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:function(){t.toggleMerge(t.hot.getSelectedRangeLast()),t.hot.render()},runOnlyIf:function(t){return!t.altKey},group:Fv})}},{key:"unregisterShortcuts",value:function(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Fv)}},{key:"onAfterIsMultipleSelection",value:function(t){if(t)for(var e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1;return t}},{key:"onModifyTransformStart",value:function(t){var e,n=Bv.get(this),r=this.hot.getSelectedRangeLast(),o={row:t.row,col:t.col},l=this.hot._createCellCoords(r.highlight.row,r.highlight.col),c=this.mergedCellsCollection.get(l.row,l.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=this.hot._createCellCoords(null,null)),c){var f=this.hot._createCellCoords(c.row,c.col),h=this.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1);this.hot._createCellRange(f,f,h).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=this.hot._createCellCoords(null,null)),o.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-l.row:o.row,o.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-l.col:o.col,t.row>0?o.row=c.row+c.rowspan-1-l.row+t.row:t.row<0&&(o.row=l.row-c.row+t.row),t.col>0?o.col=c.col+c.colspan-1-l.col+t.col:t.col<0&&(o.col=l.col-c.col+t.col)}e=this.hot._createCellCoords(r.highlight.row+o.row,r.highlight.col+o.col);var d=this.mergedCellsCollection.get(e.row,e.col);if(d){var y=this.mergedCellsCollection.getFirstRenderableCoords(d.row,d.col);n.lastDesiredCoords=e,o={row:y.row-l.row,col:y.col-l.col}}0!==o.row&&(t.row=o.row),0!==o.col&&(t.col=o.col)}},{key:"onModifyTransformEnd",value:function(t){var e=this,n=this.hot.getSelectedRangeLast(),r=Object(c.clone)(t),o=this.selectionCalculations.getUpdatedSelectionRange(n,t),l=Object(c.clone)(r),f=this.mergedCellsCollection.getWithinRange(o,!0);do{l=Object(c.clone)(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),Object(C.arrayEach)(f,(function(t){e.selectionCalculations.snapDelta(r,n,t)}))}while(r.row!==l.row||r.col!==l.col);t.row=r.row,t.col=r.col}},{key:"onModifyGetCellCoords",value:function(t,e){if(!(t<0||e<0)){var n=this.mergedCellsCollection.get(t,e);if(n){var r=n.row,o=n.col,l=n.colspan;return[r,o,r+n.rowspan-1,o+l-1]}}}},{key:"addMergeActionsToContextMenu",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var n=e.mergedCellsCollection.get(t[0],t[1]);if(n.row===t[0]&&n.col===t[1]&&n.row+n.rowspan-1===t[2]&&n.col+n.colspan-1===t[3])return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var t=this.getSelectedLast();return!t||av.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}},{key:"onAfterRenderer",value:function(t,e,col){var n=this.mergedCellsCollection.get(e,col),r=Object(c.isObject)(n)?Object(c.clone)(n):void 0;if(Object(c.isObject)(r)){var o=this.hot,l=o.rowIndexMapper,f=o.columnIndexMapper,h=r.row,d=r.col,y=r.colspan,v=r.rowspan,m=kv(this.translateMergedCellToRenderable(h,v,d,y),2),w=m[0],O=m[1],S=w-l.getRenderableFromVisualIndex(e)+1,C=O-f.getRenderableFromVisualIndex(col)+1;r.row=l.getNearestNotHiddenIndex(r.row,1),r.col=f.getNearestNotHiddenIndex(r.col,1),r.rowspan=Math.min(r.rowspan,S),r.colspan=Math.min(r.colspan,C)}lv(t,r,e,col)}},{key:"onBeforeSetRangeStart",value:function(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){var e=this.mergedCellsCollection.get(t.row,t.col),n=[e.row,e.col];t.row=n[0],t.col=n[1]}}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1){var r=this.mergedCellsCollection.mergedCells[i].getRange();e.expandByRange(r)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(t,col,e){var n=this.mergedCellsCollection.get(t,col);n&&(n.row!==t||n.col!==col?e.copyable=!1:(e.rowspan=n.rowspan,e.colspan=n.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(t){var e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}},{key:"modifyViewportRowStart",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(t.startRow),o=0;o<e;o+=1){var l=this.mergedCellsCollection.get(r,o);if(Object(c.isObject)(l)){var f=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(l.row,1));if(f<t.startRow)return t.startRow=f,void this.modifyViewportRowStart(t,e)}}}},{key:"modifyViewportRowEnd",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(t.endRow),o=0;o<e;o+=1){var l=this.mergedCellsCollection.get(r,o);if(Object(c.isObject)(l)){var f=l.row+l.rowspan-1,h=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(f,-1));if(h>t.endRow)return t.endRow=h,void this.modifyViewportRowEnd(t,e)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}},{key:"modifyViewportColumnStart",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(t.startColumn),o=0;o<e;o+=1){var l=this.mergedCellsCollection.get(o,r);if(Object(c.isObject)(l)){var f=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(l.col,1));if(f<t.startColumn)return t.startColumn=f,void this.modifyViewportColumnStart(t,e)}}}},{key:"modifyViewportColumnEnd",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(t.endColumn),o=0;o<e;o+=1){var l=this.mergedCellsCollection.get(o,r);if(Object(c.isObject)(l)){var f=l.col+l.colspan-1,h=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(f,-1));if(h>t.endColumn)return t.endColumn=h,void this.modifyViewportColumnEnd(t,e)}}}},{key:"translateMergedCellToRenderable",value:function(t,e,n,r){var o,l,c=this.hot,f=c.rowIndexMapper,h=c.columnIndexMapper;return o=0===e?f.getNearestNotHiddenIndex(t,1):f.getNearestNotHiddenIndex(t+e-1,-1),l=0===r?h.getNearestNotHiddenIndex(n,1):h.getNearestNotHiddenIndex(n+r-1,-1),[t>=0?f.getRenderableFromVisualIndex(o):t,n>=0?h.getRenderableFromVisualIndex(l):n]}},{key:"onModifyAutofillRange",value:function(t,select){this.autofillCalculations.correctSelectionAreaSize(select);var e=this.autofillCalculations.getDirection(select,t),n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(select,n,e))return n=select;var r=this.mergedCellsCollection.getWithinRange({from:{row:select[0],col:select[1]},to:{row:select[2],col:select[3]}});return r?n=this.autofillCalculations.snapDragArea(select,n,e,r):n}},{key:"onAfterCreateCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}},{key:"onAfterCreateRow",value:function(t,e,source){"auto"!==source&&this.mergedCellsCollection.shiftCollections("down",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}},{key:"onAfterChange",value:function(t,source){"Autofill.fill"===source&&this.autofillCalculations.recreateAfterDataPopulation(t)}},{key:"onBeforeDrawAreaBorders",value:function(t,e){if(e&&"area"===e){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);Object(C.arrayEach)(r,(function(e){n.getBottomEndCorner().row===e.getLastRow()&&n.getBottomEndCorner().col===e.getLastColumn()&&(t[2]=e.row,t[3]=e.col)}))}}},{key:"onAfterModifyTransformStart",value:function(t,e,n){if(this.enabled){var r=this.mergedCellsCollection.get(t.row,t.col);if(r){var o=e>0,l=e<0,c=n<0,f=n>0,h=r.row+r.rowspan-1==this.hot.countRows()-1,d=0===r.row,y=r.col+r.colspan-1==this.hot.countCols()-1,v=0===r.col;(o&&h||l&&d||f&&y||c&&v)&&(t.row=r.row,t.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],r=[{key:"PLUGIN_KEY",get:function(){return Lv}},{key:"PLUGIN_PRIORITY",get:function(){return 150}}],n&&Av(e.prototype,n),r&&Av(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a);function Wv(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Uv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uv(t,e)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function zv(){var t,e;Object(rr.b)(Object(Wo.a)(Dv||(t=["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],(e=["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."])||(e=t.slice(0)),Dv=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}})))))}var Gv="sort";function Yv(t,e,n){var r=[];return!1===n||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push("".concat(Gv,"-").concat(t.getIndexOfColumnInSortQueue(e)+1)),r}function Xv(t){return Xv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xv(t)}function Kv(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$v(n.key),n)}}function $v(t){var e=function(input,t){if("object"!==Xv(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Xv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Xv(e)?e:String(e)}function qv(){return qv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Zv(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},qv.apply(this,arguments)}function Qv(t,p){return Qv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Qv(t,p)}function Jv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zv(t);if(e){var o=Zv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Xv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Zv(t){return Zv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zv(t)}var tm="multiColumnSorting",nm="columnSorting";ho(tm,(function(t,e){return function(n,r){var o=Wv(n).slice(1),l=Wv(r).slice(1);return function n(r){var c=t[r],f=e[r],h=o[r],d=l[r],y=f.multiColumnSorting,v=(y.compareFunctionFactory?y.compareFunctionFactory:yo(f.type))(c,f,y)(h,d);if(v===eo){var m=r+1;if(void 0!==e[m])return n(m)}return v}(0)}}));var rm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qv(t,e)}(c,t);var e,n,r,l=Jv(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=l.call(this,t)).pluginKey=tm,e}return e=c,n=[{key:"isEnabled",value:function(){return qv(Zv(c.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[nm]&&zv(),qv(Zv(c.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){qv(Zv(c.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){qv(Zv(c.prototype),"sort",this).call(this,t)}},{key:"clearSort",value:function(){qv(Zv(c.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return qv(Zv(c.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(t){return qv(Zv(c.prototype),"getSortConfig",this).call(this,t)}},{key:"setSortConfig",value:function(t){qv(Zv(c.prototype),"setSortConfig",this).call(this,t)}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}},{key:"updateHeaderClasses",value:function(t){for(var e,n,r,l=arguments.length,f=new Array(l>1?l-1:0),h=1;h<l;h++)f[h-1]=arguments[h];(e=qv(Zv(c.prototype),"updateHeaderClasses",this)).call.apply(e,[this,t].concat(f)),Object(o.removeClass)(t,(n=t.className.split(" "),r=new RegExp("^".concat(Gv,"-[0-9]{1,2}$")),n.filter((function(t){return r.test(t)})))),!1!==this.enabled&&Object(o.addClass)(t,Yv.apply(void 0,f))}},{key:"onUpdateSettings",value:function(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[nm]&&zv(),qv(Zv(c.prototype),"onUpdateSettings",this).call(this,t)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==$r(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,"append"))):this.sort(this.getColumnNextConfig(e.col)))}}],r=[{key:"PLUGIN_KEY",get:function(){return tm}},{key:"PLUGIN_PRIORITY",get:function(){return 170}}],n&&Kv(e.prototype,n),r&&Kv(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ho);function om(t){return om="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},om(t)}function im(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,am(n.key),n)}}function am(t){var e=function(input,t){if("object"!==om(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==om(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===om(e)?e:String(e)}function lm(){return lm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=cm(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},lm.apply(this,arguments)}function sm(t,p){return sm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},sm(t,p)}function um(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=cm(t);if(e){var o=cm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===om(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function cm(t){return cm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cm(t)}var fm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sm(t,e)}(c,t);var e,n,r,l=um(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=l.call(this,t)).dragged=[],e.eventManager=null,e.lastSetCell=null,e}return e=c,r=[{key:"PLUGIN_KEY",get:function(){return"multipleSelectionHandles"}},{key:"PLUGIN_PRIORITY",get:function(){return 160}}],(n=[{key:"isEnabled",value:function(){return Object(ga.isMobileBrowser)()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new X.a(this)),this.registerListeners(),lm(cm(c.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var t=this,e=this,n=this.hot.rootElement;function r(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;var n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(t){var n;return Object(o.hasClass)(t.target,"topSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):Object(o.hasClass)(t.target,"bottomSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(t){return Object(o.hasClass)(t.target,"topSelectionHandle-HitArea")?(r.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):Object(o.hasClass)(t.target,"bottomSelectionHandle-HitArea")?(r.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var r,o,l,c,f,h,d=t.hot.rootDocument;if(0!==e.dragged.length){var y=d.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);y&&y!==e.lastSetCell&&("TD"!==y.nodeName&&"TH"!==y.nodeName||(-1===(r=e.hot.getCoords(y)).col&&(r.col=0),l=(o=e.hot.getSelectedRangeLast()).getWidth(),c=o.getHeight(),f=o.getDirection(),1===l&&1===c&&e.hot.selection.setRangeEnd(r),null!==(h=e.getCurrentRangeCoords(o,r,e.touchStartRange.direction,f,e.dragged[0])).start&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=y),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(t,e,n,r,o){var l=t.getTopStartCorner(),c=t.getBottomEndCorner(),f=t.getBottomStartCorner(),h=t.getTopEndCorner(),d={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":d="top"===o?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(f.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,l.col)};break;case"SE-NW":"bottom"===o&&(d={start:this.hot._createCellCoords(c.row,e.col),end:this.hot._createCellCoords(e.row,l.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===o?d={start:e,end:f}:d.end=e;break;case"NW-SE":"top"===o?d={start:e,end:c}:d.end=e;break;case"SE-NW":"top"===o?d={start:e,end:l}:d.end=e;break;case"SW-NE":"top"===o?d={start:e,end:h}:d.end=e}break;case"SW-NE":switch(r){case"NW-SE":d="bottom"===o?{start:this.hot._createCellCoords(e.row,l.col),end:this.hot._createCellCoords(f.row,e.col)}:{start:this.hot._createCellCoords(l.row,e.col),end:this.hot._createCellCoords(e.row,c.col)};break;case"SW-NE":d="top"===o?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,c.col)}:{start:this.hot._createCellCoords(e.row,l.col),end:this.hot._createCellCoords(l.row,e.col)};break;case"SE-NW":"bottom"===o?d={start:this.hot._createCellCoords(e.row,h.col),end:this.hot._createCellCoords(l.row,e.col)}:"top"===o&&(d={start:f,end:e})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===o&&(d.end=e);break;case"SE-NW":"top"===o?d.end=e:d={start:e,end:l}}}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}])&&im(e.prototype,n),r&&im(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a),hm=n(733);function dm(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.label,label=void 0===e?"":e,n=t.colspan,r=void 0===n?1:n,o=t.origColspan,l=void 0===o?1:o,c=t.collapsible,f=void 0!==c&&c,h=t.crossHiddenColumns,d=void 0===h?[]:h,y=t.isCollapsed,v=void 0!==y&&y,m=t.isHidden,w=void 0!==m&&m,O=t.isRoot,S=void 0!==O&&O,C=t.isPlaceholder;return{label:label,colspan:r,origColspan:l,collapsible:f,isCollapsed:v,crossHiddenColumns:d,isHidden:w,isRoot:S,isPlaceholder:void 0!==C&&C}}function pm(t){return function(t){if(Array.isArray(t))return ym(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ym(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ym(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ym(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function bm(t){return bm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bm(t)}var vm=["row","col"];function mm(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function gm(t,e,n){return(e=Sm(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wm(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}function Om(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sm(n.key),n)}}function Sm(t){var e=function(input,t){if("object"!==bm(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==bm(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===bm(e)?e:String(e)}function Cm(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function Em(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,km(t,e,"get"))}function Rm(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,km(t,e,"set"),n),n}function km(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var jm=["label","collapsible"],Tm=new WeakMap,Pm=new WeakMap,Am=new WeakMap,Mm=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Cm(this,Tm,{writable:!0,value:[]}),Cm(this,Pm,{writable:!0,value:0}),Cm(this,Am,{writable:!0,value:1/0})}var e,n,r;return e=t,n=[{key:"setColumnsLimit",value:function(t){Rm(this,Am,t)}},{key:"setData",value:function(){Rm(this,Tm,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=[];if(0===e)return n;Object(C.arrayEach)(t,(function(t){var r=[],o=0;n.push(r),Object(C.arrayEach)(t,(function(t){var n=dm();if(Object(c.isObject)(t)){var label=t.label,l=t.colspan;n.label=Object(E.stringify)(label),"number"==typeof l&&l>1&&(n.colspan=l,n.origColspan=l)}else n.label=Object(E.stringify)(t);var f=!1;if((o+=n.origColspan)>=e&&(n.colspan=n.origColspan-(o-e),n.origColspan=n.colspan,f=!0),r.push(n),n.colspan>1)for(var i=0;i<n.colspan-1;i++)r.push({label:"",isPlaceholder:!0});return!f}))}));var r=Math.max.apply(Math,pm(Object(C.arrayMap)(n,(function(t){return t.length}))));return Object(C.arrayEach)(n,(function(t){if(t.length<r){var e=Object(C.arrayMap)(new Array(r-t.length),(function(){return dm()}));t.splice.apply(t,[t.length,0].concat(pm(e)))}})),n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],Em(this,Am))),Rm(this,Pm,Em(this,Tm).length)}},{key:"getData",value:function(){return Em(this,Tm)}},{key:"mergeWith",value:function(t){var e=this;Object(C.arrayEach)(t,(function(t){var n=t.row,col=t.col,r=wm(t,vm),o=e.getHeaderSettings(n,col);null!==o&&Object(c.extend)(o,r,jm)}))}},{key:"map",value:function(t){Object(C.arrayEach)(Em(this,Tm),(function(header){Object(C.arrayEach)(header,(function(e){var n=t(function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?mm(Object(source),!0).forEach((function(e){gm(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):mm(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},e));Object(c.isObject)(n)&&Object(c.extend)(e,n,jm)}))}))}},{key:"getHeaderSettings",value:function(t,e){var n;if(t>=Em(this,Pm)||t<0)return null;var r=Em(this,Tm)[t];return e>=r.length?null:null!==(n=r[e])&&void 0!==n?n:null}},{key:"getHeadersSettings",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(t>=Em(this,Pm)||t<0)return r;for(var o=Em(this,Tm)[t],l=0,i=e;i<o.length;i++){var c=o[i];if(c.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=c.colspan,r.push(c),c.colspan>1&&(i+=c.colspan-1),l===n)break;if(l>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}},{key:"getLayersCount",value:function(){return Em(this,Pm)}},{key:"getColumnsCount",value:function(){return Em(this,Pm)>0?Em(this,Tm)[0].length:0}},{key:"clear",value:function(){Rm(this,Tm,[]),Rm(this,Pm,0)}}],n&&Om(e.prototype,n),r&&Om(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _m(t){return _m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_m(t)}function xm(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Im(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?xm(Object(source),!0).forEach((function(e){Hm(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):xm(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Nm(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dm(n.key),n)}}function Hm(t,e,n){return(e=Dm(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dm(t){var e=function(input,t){if("object"!==_m(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==_m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===_m(e)?e:String(e)}function Lm(t){return function(t){if(Array.isArray(t))return Bm(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Bm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bm(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bm(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Fm="BF",Vm=new Map([["DF-pre-order",function t(e,n){for(var r=e.call(n,this),i=0;i<this.childs.length;i++){if(!1===r)return!1;r=t.call(this.childs[i],e,n)}return r}],["DF-post-order",function t(e,n){for(var i=0;i<this.childs.length;i++){if(!1===t.call(this.childs[i],e,n))return!1}return e.call(n,this)}],["BF",function(t,e){var n=[this];!function r(){if(0!==n.length){var o=n.shift();n.push.apply(n,Lm(o.childs)),!1!==t.call(e,o)&&r()}}()}]]),Wm=function(){function t(data){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Hm(this,"data",{}),Hm(this,"parent",null),Hm(this,"childs",[]),this.data=data}var e,n,r;return e=t,n=[{key:"addChild",value:function(t){t.parent=this,this.childs.push(t)}},{key:"cloneTree",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new t(Im({},e.data)),i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}},{key:"replaceTreeWith",value:function(t){this.data=Im({},t.data),this.childs=[];for(var i=0;i<t.childs.length;i++)this.addChild(t.childs[i])}},{key:"walkDown",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fm;if(!Vm.has(e))throw new Error('Traversal strategy "'.concat(e,'" does not exist'));Vm.get(e).call(this,t,this)}},{key:"walkUp",value:function(t){var e=this;!function n(r){!1!==t.call(e,r)&&null!==r.parent&&n(r.parent)}(this)}}],n&&Nm(e.prototype,n),r&&Nm(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Um(t){return Um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Um(t)}function zm(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Gm(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?zm(Object(source),!0).forEach((function(e){Ym(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):zm(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Ym(t,e,n){return(e=qm(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xm(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Km(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Km(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Km(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function $m(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qm(n.key),n)}}function qm(t){var e=function(input,t){if("object"!==Um(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Um(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Um(e)?e:String(e)}function Qm(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function Jm(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,tg(t,e,"get"))}function Zm(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,tg(t,e,"set"),n),n}function tg(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var eg,ng,rg=new WeakMap,og=new WeakMap,ig=new WeakMap,ag=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Qm(this,rg,{writable:!0,value:new Map}),Qm(this,og,{writable:!0,value:new Map}),Qm(this,ig,{writable:!0,value:null}),Zm(this,ig,e)}var e,n,r;return e=t,n=[{key:"getRoots",value:function(){return Array.from(Jm(this,rg).values())}},{key:"getRootByColumn",value:function(t){var e;return Jm(this,og).has(t)&&(e=Jm(this,rg).get(Jm(this,og).get(t))),e}},{key:"getNode",value:function(t,e){var n=this.getRootByColumn(e);if(n){var r,o=e-Jm(this,og).get(e),l=0;return n.walkDown((function(n){var c=n.data,f=c.origColspan,h=c.headerLevel;if(t===h){if(o>=l&&o<=l+f-1)return(r=n).data.isRoot=e===r.data.columnIndex,!1;l+=f}})),r}}},{key:"rebuildTreeIndex",value:function(){var t=this,e=0;Jm(this,og).clear(),Object(C.arrayEach)(Jm(this,rg),(function(n){for(var r=Xm(n,2)[1].data.colspan,i=e;i<e+r;i++)Jm(t,og).set(i,e);e+=r}))}},{key:"buildTree",value:function(){this.clear();for(var t=Jm(this,ig).getColumnsCount(),e=0;e<t;){var n=Jm(this,ig).getHeaderSettings(0,e),r=new Wm;Jm(this,rg).set(e,r),this.buildLeaves(r,e,0,n.origColspan),e+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=Jm(this,ig).getHeadersSettings(n,e,o);n+=1,Object(C.arrayEach)(l,(function(o){var l,c=Gm(Gm({},o),{},{headerLevel:n-1,columnIndex:e});1===n?(t.data=c,l=t):(l=new Wm(c),t.addChild(l)),n<Jm(r,ig).getLayersCount()&&r.buildLeaves(l,e,n,o.origColspan),e+=o.origColspan}))}},{key:"clear",value:function(){Jm(this,rg).clear(),Jm(this,og).clear()}}],n&&$m(e.prototype,n),r&&$m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function lg(t,e){t.walkDown((function(t){var data=t.data,n=t.childs;if(!data.isHidden&&(e(data.columnIndex),0===n.length))for(var i=1;i<data.colspan;i++)e(data.columnIndex+i)}))}function sg(t,e){var n=t.childs;if(0!==n.length)return n[0].data[e]}function ug(t){return sg(t,"origColspan")===t.data.origColspan}function cg(t){var e=t.data,n=t.childs;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(ug(t))return cg(n[0]);e.isCollapsed=!1;var r=n.slice(1),o=new Set,l=0;if(r.length>0)Object(C.arrayEach)(r,(function(t){t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;var e=t.data;l+=e.colspan,lg(t,(function(t){o.add(t)}))}));else{var c=e.colspan,f=e.origColspan,h=e.columnIndex;l=f-c;for(var i=1;i<f;i++)o.add(h+i)}return t.walkUp((function(t){var data=t.data;data.colspan+=l,data.colspan>=data.origColspan?(data.colspan=data.origColspan,data.isCollapsed=!1):ug(t)&&(data.isCollapsed=sg(t,"isCollapsed"))})),{rollbackModification:function(){return fg(t)},affectedColumns:Array.from(o),colspanCompensation:l}}function fg(t){var e,n=t.data,r=t.childs;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(ug(t))return fg(r[0]);n.isCollapsed=!0;var o=r.slice(1),l=new Set;if(o.length>0)Object(C.arrayEach)(o,(function(t){lg(t,(function(t){l.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((function(t){t.data.isHidden=!0}))}));else for(var c=n.origColspan,f=n.columnIndex,i=1;i<c;i++){var h=f+i;l.add(h)}var d=n.colspan-(null!==(e=sg(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((function(t){var data=t.data;data.colspan-=d,data.colspan<=1?(data.colspan=1,data.isCollapsed=!0):ug(t)&&(data.isCollapsed=sg(t,"isCollapsed"))})),{rollbackModification:function(){return cg(t)},affectedColumns:Array.from(l),colspanCompensation:d}}var hg=new Map([["collapse",fg],["expand",cg],["hide-column",function(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Object(Wo.a)(eg||(n=["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],(r=["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."])||(r=n.slice(0)),eg=Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}})))));var n,r;if(!t.data.crossHiddenColumns.includes(e)){var o=!1;t.walkUp((function(t){if(t.data.collapsible)return o=!0,!1})),o||t.walkUp((function(t){var data=t.data;data.crossHiddenColumns.push(e),data.colspan>1?data.colspan-=1:data.isHidden=!0}))}}],["show-column",function(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Object(Wo.a)(ng||(n=["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],(r=["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."])||(r=n.slice(0)),ng=Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}})))));var n,r;if(t.data.crossHiddenColumns.includes(e)){var o=!1;t.walkUp((function(t){if(t.data.collapsible)return o=!0,!1})),o||t.walkUp((function(t){var data=t.data;data.crossHiddenColumns.splice(data.crossHiddenColumns.indexOf(e),1),!data.isHidden&&data.colspan<data.origColspan&&(data.colspan+=1),data.isHidden=!1}))}}]]);var dg=["crossHiddenColumns"];function pg(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}function yg(t){var e=[];return Object(C.arrayEach)(t,(function(t){t.walkDown((function(t){for(var n=t.data,r=n.origColspan,o=n.columnIndex,l=n.headerLevel,c=n.crossHiddenColumns,f=function(t,e){var n;Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n);return n}(e,l),h=!1,i=o;i<o+r;i++){if(c.includes(i)||h)f.push({label:"",isPlaceholder:!0});else{var d=bg(n);d.isRoot=!0,f.push(d),h=!0}}}))})),e}function bg(t){var e=dm(t);e.crossHiddenColumns;return pg(e,dg)}function vg(t){return vg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vg(t)}var mg=["row"];function gg(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function wg(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?gg(Object(source),!0).forEach((function(e){Og(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):gg(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Og(t,e,n){return(e=Eg(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sg(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}function Cg(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eg(n.key),n)}}function Eg(t){var e=function(input,t){if("object"!==vg(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==vg(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===vg(e)?e:String(e)}function Rg(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function kg(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Tg(t,e,"set"),n),n}function jg(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Tg(t,e,"get"))}function Tg(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Pg=new WeakMap,Ag=new WeakMap,Mg=new WeakMap,_g=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Rg(this,Pg,{writable:!0,value:new Mm}),Rg(this,Ag,{writable:!0,value:new ag(jg(this,Pg))}),Rg(this,Mg,{writable:!0,value:[[]]})}var e,n,r;return e=t,(n=[{key:"setState",value:function(t){jg(this,Pg).setData(t);var e=!1;try{jg(this,Ag).buildTree()}catch(t){jg(this,Ag).clear(),jg(this,Pg).clear(),e=!0}return kg(this,Mg,yg(jg(this,Ag).getRoots())),e}},{key:"setColumnsLimit",value:function(t){jg(this,Pg).setColumnsLimit(t)}},{key:"mergeStateWith",value:function(t){var e=this,n=Object(C.arrayMap)(t,(function(t){var n=t.row,r=Sg(t,mg);return wg({row:n<0?e.rowCoordsToLevel(n):n},r)}));jg(this,Pg).mergeWith(n),jg(this,Ag).buildTree(),kg(this,Mg,yg(jg(this,Ag).getRoots()))}},{key:"mapState",value:function(t){jg(this,Pg).map(t),jg(this,Ag).buildTree(),kg(this,Mg,yg(jg(this,Ag).getRoots()))}},{key:"mapNodes",value:function(t){return Object(C.arrayReduce)(jg(this,Ag).getRoots(),(function(e,n){return n.walkDown((function(n){var r=t(n.data);void 0!==r&&e.push(r)})),e}),[])}},{key:"triggerNodeModification",value:function(t,e,n){e<0&&(e=this.rowCoordsToLevel(e));var r,o=jg(this,Ag).getNode(e,n);return o&&(r=function(t,e,n){if(!hg.has(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return hg.get(t)(e,n)}(t,o,n),kg(this,Mg,yg(jg(this,Ag).getRoots()))),r}},{key:"triggerColumnModification",value:function(t,e){return this.triggerNodeModification(t,-1,e)}},{key:"rowCoordsToLevel",value:function(t){if(t>=0)return null;var e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}},{key:"levelToRowCoords",value:function(t){if(t<0)return null;var e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}},{key:"getHeaderSettings",value:function(t,e){var n,r;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(n=null===(r=jg(this,Mg)[t])||void 0===r?void 0:r[e])&&void 0!==n?n:null}},{key:"getHeaderTreeNodeData",value:function(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;var n=jg(this,Ag).getNode(t,e);return n?wg({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(t,e){var n;if((null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0}).isRoot)return e;for(var r=e-1;r>=0;){var o;if((null!==(o=this.getHeaderSettings(t,r))&&void 0!==o?o:{isRoot:!0}).isRoot)break;r-=1}return r}},{key:"getLayersCount",value:function(){return jg(this,Pg).getLayersCount()}},{key:"getColumnsCount",value:function(){return jg(this,Pg).getColumnsCount()}},{key:"clear",value:function(){kg(this,Mg,[]),jg(this,Pg).clear(),jg(this,Ag).clear()}}])&&Cg(e.prototype,n),r&&Cg(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function xg(t){return xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xg(t)}function Ig(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hg(n.key),n)}}function Ng(t,e,n){return(e=Hg(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hg(t){var e=function(input,t){if("object"!==xg(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==xg(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===xg(e)?e:String(e)}var Dg,Lg,Bg=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ng(this,"hot",void 0),Ng(this,"nestedHeaderSettingsGetter",void 0),Ng(this,"layersCount",0),Ng(this,"container",void 0),Ng(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}var e,n,r;return e=t,(n=[{key:"setLayersCount",value:function(t){return this.layersCount=t,this}},{key:"getWidth",value:function(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(var n=0;n<e;n++){var r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(o,t[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(t){for(var e=this.hot,n=e.rootDocument,r=e.columnIndexMapper,l=n.createDocumentFragment(),table=n.createElement("table"),c=!!this.hot.getSettings().dropdownMenu,f=r.getRenderableIndexesLength(),h=0;h<this.layersCount;h++){for(var tr=n.createElement("tr"),col=0;col<f;col++){var d=r.getVisualFromRenderableIndex(col);null===d&&(d=col);var th=n.createElement("th"),y=this.nestedHeaderSettingsGetter(h,d);if(y&&(!y.isPlaceholder||y.isHidden)){var label=y.label;c&&(label+='<button class="changeType"></button>'),Object(o.fastInnerHTML)(th,label),th.colSpan=y.colspan,tr.appendChild(th)}}table.appendChild(tr)}l.appendChild(table),t.appendChild(l)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}])&&Ig(e.prototype,n),r&&Ig(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Fg(t){return Fg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fg(t)}function Vg(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Wg(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$g(n.key),n)}}function Ug(){return Ug="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Xg(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},Ug.apply(this,arguments)}function zg(t,p){return zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},zg(t,p)}function Gg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Xg(t);if(e){var o=Xg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Fg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Yg(t)}(this,n)}}function Yg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xg(t){return Xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xg(t)}function Kg(t,e,n){return(e=$g(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $g(t){var e=function(input,t){if("object"!==Fg(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Fg(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Fg(e)?e:String(e)}function qg(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function Qg(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Zg(t,e,"set"),n),n}function Jg(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Zg(t,e,"get"))}function Zg(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var tw="nestedHeaders",ew=new WeakMap,nw=new WeakMap,rw=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zg(t,e)}(f,t);var e,n,r,c=Gg(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return qg(Yg(t=c.call.apply(c,[this].concat(n))),ew,{writable:!0,value:new _g}),qg(Yg(t),nw,{writable:!0,value:null}),Kg(Yg(t),"ghostTable",new Bg(t.hot,(function(e,n){return t.getHeaderSettings(e,n)}))),Kg(Yg(t),"detectedOverlappedHeaders",!1),t}return e=f,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tw]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings().nestedHeaders;Array.isArray(e)&&Array.isArray(e[0])||Object(rr.b)(Object(Wo.a)(Dg||(Dg=Vg(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",(function(){return t.onInit()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("afterOnCellMouseDown",(function(){return t.onAfterOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterGetColumnHeaderRenderers",(function(e){return t.onAfterGetColumnHeaderRenderers(e)})),this.addHook("modifyColWidth",(function(){return t.onModifyColWidth.apply(t,arguments)})),this.addHook("modifyColumnHeaderValue",(function(){return t.onModifyColumnHeaderValue.apply(t,arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return t.onBeforeHighlightingColumnHeader.apply(t,arguments)})),this.addHook("beforeCopy",(function(){return t.onBeforeCopy.apply(t,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)})),Ug(Xg(f.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var t=this;if(this.hot.view){var e=this.hot.getSettings().nestedHeaders;Jg(this,ew).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Jg(this,ew).setState(e)),this.detectedOverlappedHeaders&&Object(rr.b)(Object(Wo.a)(Lg||(Lg=Vg(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((function(e,n){var r=!0===e?"hide-column":"show-column";Jg(t,ew).triggerColumnModification(r,n)})),!Jg(this,nw)&&this.enabled&&Qg(this,nw,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((function(e){e.forEach((function(e){var n=e.op,r=e.index,o=e.newValue;if("replace"===n){var l=!0===o?"hide-column":"show-column";Jg(t,ew).triggerColumnModification(l,r)}})),t.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Ug(Xg(f.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Jg(this,ew).clear(),Jg(this,nw).unsubscribe(),Qg(this,nw,null),this.ghostTable.clear(),Ug(Xg(f.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Jg(this,ew)}},{key:"getLayersCount",value:function(){return Jg(this,ew).getLayersCount()}},{key:"getHeaderSettings",value:function(t,e){return Jg(this,ew).getHeaderSettings(t,e)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var t=this.hot.view._wt,e=t.getSetting("columnHeaders").length,n=t.wtTable.THEAD,r=t.wtOverlays.topOverlay.clone.wtTable.THEAD,l=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=0;i<e;i++){var c=n.childNodes[i];if(!c)break;for(var f=r.childNodes[i],h=l?l.childNodes[i]:null,d=0,y=c.childNodes.length;d<y;d++)c.childNodes[d].removeAttribute("colspan"),Object(o.removeClass)(c.childNodes[d],"hiddenHeader"),f&&f.childNodes[d]&&(f.childNodes[d].removeAttribute("colspan"),Object(o.removeClass)(f.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Object(o.removeClass)(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(t){var e=this,n=this.hot.view._wt.getSetting("fixedColumnsStart");return function(r,l){var c,f=e.hot,h=f.columnIndexMapper,view=f.view,d=h.getVisualFromRenderableIndex(r);null===d&&(d=r),l.removeAttribute("colspan"),Object(o.removeClass)(l,"hiddenHeader");var y=null!==(c=Jg(e,ew).getHeaderSettings(t,d))&&void 0!==c?c:{label:""},v=y.colspan,m=y.isHidden;if(y.isPlaceholder||m)Object(o.addClass)(l,"hiddenHeader");else if(v>1){var w,O,S=view._wt.wtOverlays,C=null===(w=S.topInlineStartCornerOverlay)||void 0===w?void 0:w.clone.wtTable.THEAD.contains(l),E=null===(O=S.inlineStartOverlay)||void 0===O?void 0:O.clone.wtTable.THEAD.contains(l),R=C||E?Math.min(v,n-r):v;R>1&&l.setAttribute("colspan",R)}e.hot.view.appendColHeader(d,l,(function(){return e.getColumnHeaderValue.apply(e,arguments)}),t)}}},{key:"getColumnHeaderValue",value:function(t,e){var n,r=null!==(n=Jg(this,ew).getHeaderSettings(e,t))&&void 0!==n?n:{},o=r.isHidden;return r.isPlaceholder||o?"":this.hot.getColHeader(t,e)}},{key:"onBeforeHighlightingColumnHeader",value:function(t,e,n){var r=Jg(this,ew).getHeaderTreeNodeData(e,t);if(!r)return t;var o=n.classNames,l=n.columnCursor,c=n.selectionType,f=n.selectionWidth,h=Jg(this,ew).getHeaderSettings(e,t),d=h.isRoot,y=h.colspan;if(c===hm.f){if(!d)return r.columnIndex}else c===hm.a&&(y>f-l||!d)&&(o.length=0);return t}},{key:"onBeforeCopy",value:function(data,t,e){if(0!==e.columnHeadersCount)for(var n=0;n<t.length;n++){var r=t[n],o=r.startRow,l=r.startCol,c=r.endRow,f=r.endCol,h=c-o+1;if(o>=0||1==l-f+1)break;for(var d=l;d<=f;d++)for(var y=o;y<=c;y++){var v,m=h+y,w=d-l;0!==w&&!1===(null===(v=Jg(this,ew).getHeaderTreeNodeData(y,d))||void 0===v?void 0:v.isRoot)&&(data[m][w]="")}}}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){var n=this._getHeaderTreeNodeDataByCoords(e);if(n){var r=this.hot.selection,o=r.isSelected()?r.getSelectedRange().current():null,c=[],f=n.columnIndex,h=n.origColspan,d=!r.inInSelection(e);t.shiftKey&&o?e.col<o.from.col?c.push(o.getTopEndCorner().col,f,e.row):e.col>o.from.col?c.push(o.getTopStartCorner().col,f+h-1,e.row):c.push(f,f+h-1,e.row):(Object(l.isLeftClick)(t)||Object(l.isRightClick)(t)&&d)&&c.push(f,f+h-1,e.row),r.selectColumns.apply(r,c)}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o;if(this.hot.view.isMouseDown()){var l=this._getHeaderTreeNodeDataByCoords(e);if(l){var c=l.columnIndex,f=l.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),y=h.getBottomEndCorner(),v=h.from;r.column=!0,r.cell=!0;var m=[];e.col<v.col?m.push(y.col,c):e.col>v.col?m.push(d.col,c+f-1):m.push(c,c+f-1),(o=this.hot).selectColumns.apply(o,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(t){t.length=0;for(var e=0;e<Jg(this,ew).getLayersCount();e++)t.push(this.headerRendererFactory(e))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){for(var e=Jg(this,ew).getLayersCount(),n=t.startColumn,r=!!e,o=0;o<e;o++){var l=Jg(this,ew).findLeftMostColumnIndex(o,t.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(l);if(l>=0&&(r=!1),Object(re.isNumeric)(c)&&c<t.startColumn){n=c;break}}t.startColumn=r?Jg(this,ew).getHeaderTreeNodeData(0,n).columnIndex:n}},{key:"onModifyColWidth",value:function(t,e){var n=this.ghostTable.getWidth(e);return t>n?t:n}},{key:"onModifyColumnHeaderValue",value:function(t,e,n){var r;return(null!==(r=Jg(this,ew).getHeaderTreeNodeData(n,e))&&void 0!==r?r:{label:""}).label}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(t,e){e||this.updatePlugin()}},{key:"destroy",value:function(){Qg(this,ew,null),null!==Jg(this,nw)&&(Jg(this,nw).unsubscribe(),Qg(this,nw,null)),Ug(Xg(f.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(t){if(!(t.row>=0||t.col<0))return Jg(this,ew).getHeaderTreeNodeData(t.row,t.col)}}],r=[{key:"PLUGIN_KEY",get:function(){return tw}},{key:"PLUGIN_PRIORITY",get:function(){return 280}}],n&&Wg(e.prototype,n),r&&Wg(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(ke.a);function ow(t){return function(t){if(Array.isArray(t))return iw(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return iw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iw(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iw(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function aw(t){return aw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(t)}function lw(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sw(n.key),n)}}function sw(t){var e=function(input,t){if("object"!==aw(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==aw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===aw(e)?e:String(e)}var uw=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=n,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}var e,n,r;return e=t,n=[{key:"setData",value:function(data){this.data=data}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var t;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}},{key:"updateWithData",value:function(data){this.setData(data),this.rewriteCache()}},{key:"rewriteCache",value:function(){var t=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Object(re.rangeEach)(0,this.data.length-1,(function(i){t.cacheNode(t.data[i],0,null)}))}},{key:"cacheNode",value:function(t,e,n){var r=this;this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&Object(C.arrayEach)(t.__children,(function(n){r.cacheNode(n,e+1,t)}))}},{key:"getDataObject",value:function(t){return null==t?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function(t,e,n,r){var o=this,l=!1,c=e;if(isNaN(c)&&c.end)return c;var f=t;return f||(f={__children:this.data},l=!0,c-=1),null!=n&&c===n?{result:f,end:!0}:null!=r&&f===r?{result:c,end:!0}:(c+=1,f.__children&&Object(C.arrayEach)(f.__children,(function(t){if(o.parentReference.set(t,l?null:f),c=o.readTreeNodes(t,c,n,r),isNaN(c)&&c.end)return!1})),c)}},{key:"mockParent",value:function(){var t=this.mockNode();return t.__children=this.data,t}},{key:"mockNode",value:function(){var t={};return Object(c.objectEach)(this.data[0],(function(e,n){t[n]=null})),t}},{key:"getRowIndex",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function(t){var e=null;e=isNaN(t)?t:this.getDataObject(t);var n=this.getRowParent(t);return null==n?this.data.indexOf(e):n.__children.indexOf(e)}},{key:"countAllRows",value:function(){var t={__children:this.data};return this.countChildren(t)}},{key:"countChildren",value:function(t){var e=this,n=0,r=t;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(Object(C.arrayEach)(r.__children,(function(t){n+=1,t.__children&&(n+=e.countChildren(t))})),n):0}},{key:"getRowParent",value:function(t){var e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}},{key:"getRowObjectParent",value:function(t){return t&&"object"===aw(t)?this.cache.nodeInfo.get(t).parent:null}},{key:"getRowLevel",value:function(t){var e=null;return(e=isNaN(t)?t:this.getDataObject(t))?this.getRowObjectLevel(e):null}},{key:"getRowObjectLevel",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}},{key:"isChild",value:function(t){return null!==this.getRowParent(t)}},{key:"getChild",value:function(t,e){var n;return(null===(n=t.__children)||void 0===n?void 0:n[e])||null}},{key:"isRowHighestLevel",value:function(t){return!this.isChild(t)}},{key:"isParent",value:function(t){var e,n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(e=n.__children)||void 0===e?void 0:e.length)}},{key:"addChild",value:function(t,element){var e=element;this.hot.runHooks("beforeAddChild",t,e);var n=null;t&&(n=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(t)+1,1);var r=t;t||(r=this.mockParent()),r.__children||(r.__children=[]),e||(e=this.mockNode()),r.__children.push(e),this.rewriteCache();var o=this.getRowIndex(e);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",t,e)}},{key:"addChildAtIndex",value:function(t,e,element){var n,r=element;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",t,r,e),t){var o=this.getRowIndex(t)+e+1;this.hot.runHooks("beforeCreateRow",o,1),t.__children.splice(e,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(o,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",o,1),n=o}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[e]);r=this.getDataObject(n),this.hot.runHooks("afterAddChild",t,r,e)}},{key:"addSibling",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(t),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null)}}},{key:"detachFromParent",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],element=null,r=[];Array.isArray(t)?(Object(re.rangeEach)(t[0],t[2],(function(i){var t=e.translateTrimmedRow(i);r.push(e.getDataObject(t))})),Object(re.rangeEach)(0,r.length-2,(function(i){e.detachFromParent(r[i],!1)})),element=r[r.length-1]):element=t;var o=this.getRowIndex(element),l=this.countChildren(element),c=this.getRowIndexWithinParent(element),f=this.getRowParent(element),h=this.getRowParent(f),d=this.getRowIndex(h),y=null;if(this.hot.runHooks("beforeDetachChild",f,element),null!=c){var v=Array.from(new Array(o+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",o,l+1,v,this.plugin.pluginName),f.__children.splice(c,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,l+1,v,this.plugin.pluginName),h){y=d+this.countChildren(h);var m=this.getChild(h,this.countChildren(h)-1),w=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",w+1,l+1,this.plugin.pluginName),h.__children.push(element)}else y=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",y-2,l+1,this.plugin.pluginName),this.data.push(element)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",y-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,element,this.getRowIndex(element)),n&&this.hot.render()}},{key:"filterData",value:function(t,e,n){var r=this,o=[];Object(C.arrayEach)(n,(function(t){o.push(r.getDataObject(t))})),Object(C.arrayEach)(o,(function(t){var e=r.getRowIndexWithinParent(t),n=r.getRowParent(t);null===n?r.data.splice(e,1):n.__children.splice(e,1)})),this.rewriteCache()}},{key:"spliceData",value:function(t,e,n){var r,o=this.getDataObject(t-1),l=null,c=t;if(o&&o.__children&&0===o.__children.length?(l=o,c=0):t<this.countAllRows()&&(l=this.getRowParent(t),c=this.getRowIndexWithinParent(t)),l)n?(r=l.__children).splice.apply(r,[c,e].concat(ow(n))):l.__children.splice(c,e);else if(n){var f;(f=this.data).splice.apply(f,[c,e].concat(ow(n)))}else this.data.splice(c,e);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(t){var e=t,n=null;do{null!==(n=this.getRowParent(n))&&(e=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(t,e,n,r){var o=e===this.hot.countRows(),l=this.getRowParent(t),c=this.getRowIndexWithinParent(t),f=l.__children.slice(c,c+1),h=t>e,d=o?this.getRowParent(e-1):this.getRowParent(e);null==d&&(d=this.getRowParent(e-1)),null==d&&(d=this.getDataObject(e-1)),d?d.__children||(d.__children=[]):(d=this.getDataObject(e)).__children=[];var y=o||n||r?d.__children.length:this.getRowIndexWithinParent(e),v=l===d;d.__children.splice(y,0,f[0]),l.__children.splice(c+(h&&v?1:0),1),this.syncRowWithRawSource(l),v||this.syncRowWithRawSource(d)}},{key:"translateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}},{key:"untranslateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}],n&&lw(e.prototype,n),r&&lw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),cw=uw;function fw(t){return fw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(t)}function hw(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pw(n.key),n)}}function dw(t,e,n){return e&&hw(t.prototype,e),n&&hw(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pw(t){var e=function(input,t){if("object"!==fw(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==fw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===fw(e)?e:String(e)}var yw=dw((function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=n,this.plugin=e}));function bw(t){return bw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(t)}function vw(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mw(n.key),n)}}function mw(t){var e=function(input,t){if("object"!==bw(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==bw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===bw(e)?e:String(e)}function gw(t,p){return gw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},gw(t,p)}function ww(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ow(t);if(e){var o=Ow(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===bw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Ow(t){return Ow=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ow(t)}var Sw=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gw(t,e)}(c,t);var e,n,r,l=ww(c);function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=l.call(this,t,e)).dataManager=n.plugin.dataManager,n.collapsingUI=n.plugin.collapsingUI,n.rowHeaderWidthCache=null,n}return e=c,r=[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}],(n=[{key:"appendLevelIndicators",value:function(t,e){var n=this.hot.toPhysicalRow(t),r=this.dataManager.getRowLevel(n),l=this.dataManager.getDataObject(n),f=e.getElementsByTagName("DIV")[0],h=f.querySelector("span.rowHeader"),d=f.querySelectorAll('[class^="ht_nesting"]');if(Object(C.arrayEach)(d,(function(t){t&&f.removeChild(t)})),Object(o.addClass)(e,c.CSS_CLASSES.indicatorContainer),r){var y=this.hot.rootDocument,v=h.cloneNode(!0);f.innerHTML="",Object(re.rangeEach)(0,r-1,(function(){var t=y.createElement("SPAN");Object(o.addClass)(t,c.CSS_CLASSES.emptyIndicator),f.appendChild(t)})),f.appendChild(v)}if(this.dataManager.hasChildren(l)){var m=this.hot.rootDocument.createElement("DIV");Object(o.addClass)(e,c.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?Object(o.addClass)(m,"".concat(c.CSS_CLASSES.button," ").concat(c.CSS_CLASSES.expandButton)):Object(o.addClass)(m,"".concat(c.CSS_CLASSES.button," ").concat(c.CSS_CLASSES.collapseButton)),f.appendChild(m)}}},{key:"updateRowHeaderWidth",value:function(t){var e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}])&&vw(e.prototype,n),r&&vw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(yw);function Cw(t){return Cw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cw(t)}function Ew(t){return function(t){if(Array.isArray(t))return Rw(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Rw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rw(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rw(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function kw(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jw(n.key),n)}}function jw(t){var e=function(input,t){if("object"!==Cw(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Cw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Cw(e)?e:String(e)}function Tw(t,p){return Tw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Tw(t,p)}function Pw(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Aw(t);if(e){var o=Aw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Cw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Aw(t){return Aw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Aw(t)}var Mw=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tw(t,e)}(f,t);var e,n,r,c=Pw(f);function f(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,t,e)).dataManager=n.plugin.dataManager,n.collapsedRows=[],n.collapsedRowsStash={stash:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,t)},shiftStash:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==e&&(e=1/0),Object(C.arrayEach)(n.lastCollapsedRows,(function(o,i){o>=t&&o<e&&(n.lastCollapsedRows[i]=o+r)}))},applyStash:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,t),n.lastCollapsedRows=void 0},trimStash:function(t,e){Object(re.rangeEach)(t,t+e-1,(function(i){var t=n.lastCollapsedRows.indexOf(i);t>-1&&n.lastCollapsedRows.splice(t,1)}))}},n}return e=f,n=[{key:"collapseChildren",value:function(t){var e,n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=[],c=null,f=null;return isNaN(t)?(c=t,f=this.dataManager.getRowIndex(c)):(c=this.dataManager.getDataObject(t),f=t),this.dataManager.hasChildren(c)&&Object(C.arrayEach)(c.__children,(function(t){l.push(n.dataManager.getRowIndex(t))})),e=this.collapseRows(l,!0,!1),o&&this.trimRows(e),r&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(f)&&this.collapsedRows.push(f),e}},{key:"collapseMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];Object(C.arrayEach)(t,(function(t){o.push.apply(o,Ew(e.collapseChildren(t,!1,!1)))})),r&&this.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}},{key:"collapseRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return Object(C.arrayEach)(t,(function(t){o.push(t),n&&e.collapseChildRows(t,o)})),r&&this.trimRows(o),o}},{key:"collapseChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);Object(C.arrayEach)(o.__children,(function(t){var r=e.dataManager.getRowIndex(t);n.push(r),e.collapseChildRows(r,n)}))}r&&this.trimRows(n)}},{key:"expandRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}},{key:"expandRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return Object(C.arrayEach)(t,(function(t){o.push(t),n&&e.expandChildRows(t,o)})),r&&this.untrimRows(o),o}},{key:"expandChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);Object(C.arrayEach)(o.__children,(function(t){if(!e.isAnyParentCollapsed(t)){var r=e.dataManager.getRowIndex(t);n.push(r),e.expandChildRows(r,n)}}))}r&&this.untrimRows(n)}},{key:"expandChildren",value:function(t){var e,n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=[],c=null,f=null;return isNaN(t)?(c=t,f=this.dataManager.getRowIndex(t)):(c=this.dataManager.getDataObject(t),f=t),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(c)&&Object(C.arrayEach)(c.__children,(function(t){var e=n.dataManager.getRowIndex(t);l.push(e)})),e=this.expandRows(l,!0,!1),o&&this.untrimRows(e),r&&this.renderAndAdjust(),e}},{key:"expandMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];Object(C.arrayEach)(t,(function(t){o.push.apply(o,Ew(e.expandChildren(t,!1,!1)))})),r&&this.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var t=this,data=this.dataManager.getData(),e=[];Object(C.arrayEach)(data,(function(n){t.dataManager.hasChildren(n)&&e.push(n)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}},{key:"expandAll",value:function(){var t=this,data=this.dataManager.getData(),e=[];Object(C.arrayEach)(data,(function(n){t.dataManager.hasChildren(n)&&e.push(n)})),this.expandMultipleChildren(e),this.renderAndAdjust()}},{key:"trimRows",value:function(t){var e=this;this.hot.batchExecution((function(){Object(C.arrayEach)(t,(function(t){e.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}},{key:"untrimRows",value:function(t){var e=this;this.hot.batchExecution((function(){Object(C.arrayEach)(t,(function(t){e.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}},{key:"areChildrenCollapsed",value:function(t){var e=this,n=isNaN(t)?t:this.dataManager.getDataObject(t),r=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&Object(C.arrayEach)(n.__children,(function(t){var n=e.dataManager.getRowIndex(t);if(!e.plugin.collapsedRowsMap.getValueAtIndex(n))return r=!1,!1})),r}},{key:"isAnyParentCollapsed",value:function(t){for(var e=t;null!==e;){e=this.dataManager.getRowParent(e);var n=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(t,e){if(!(e.col>=0)){var n=this.translateTrimmedRow(e.row);Object(o.hasClass)(t.target,Sw.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Object(l.stopImmediatePropagation)(t))}}},{key:"translateTrimmedRow",value:function(t){return this.hot.toPhysicalRow(t)}},{key:"untranslateTrimmedRow",value:function(t){return this.hot.toVisualRow(t)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}],n&&kw(e.prototype,n),r&&kw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(yw),_w=Mw;function xw(t){return xw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(t)}function Iw(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nw(n.key),n)}}function Nw(t){var e=function(input,t){if("object"!==xw(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==xw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===xw(e)?e:String(e)}function Hw(t,p){return Hw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Hw(t,p)}function Dw(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Bw(t);if(e){var o=Bw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===xw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Lw(t)}(this,n)}}function Lw(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bw(t){return Bw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bw(t)}var Fw,Vw=new WeakMap,Ww=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hw(t,e)}(l,t);var e,n,r,o=Dw(l);function l(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,t,e),Vw.set(Lw(n),{row_above:function(t,e){var r=e[e.length-1];n.dataManager.addSibling(r.start.row,"above")},row_below:function(t,e){var r=e[e.length-1];n.dataManager.addSibling(r.start.row,"below")}}),n.dataManager=n.plugin.dataManager,n}return e=l,(n=[{key:"appendOptions",value:function(t){var e=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var t=e.dataManager.translateTrimmedRow(e.hot.getSelectedLast()[0]),n=e.dataManager.getDataObject(t);e.dataManager.addChild(n)},disabled:function(){var t=e.hot.getSelectedLast();return!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(wi.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){e.dataManager.detachFromParent(e.hot.getSelectedLast())},disabled:function(){var t=e.hot.getSelectedLast(),n=e.dataManager.translateTrimmedRow(t[0]);return!e.dataManager.getRowParent(n)||!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{name:"---------"}];return Object(re.rangeEach)(0,t.items.length-1,(function(i){if(0===i)return Object(C.arrayEach)(n,(function(e,n){t.items.splice(i+n,0,e)})),!1})),this.modifyRowInsertingOptions(t)}},{key:"modifyRowInsertingOptions",value:function(t){var e=Vw.get(this);return Object(re.rangeEach)(0,t.items.length-1,(function(i){var option=e[t.items[i].key];null!=option&&(t.items[i].callback=option)})),t}}])&&Iw(e.prototype,n),r&&Iw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(yw);function Uw(t){return Uw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uw(t)}function zw(t){return function(t){if(Array.isArray(t))return Gw(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Gw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gw(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gw(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Yw(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xw(n.key),n)}}function Xw(t){var e=function(input,t){if("object"!==Uw(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Uw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Uw(e)?e:String(e)}var Kw=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}var e,n,r;return e=t,(n=[{key:"onBeforeRowMove",value:function(t,e,n,r){var o=this;if(this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:n,movePossible:r}))return!1;this.movedToCollapsed=!1;var l=n===this.hot.countRows(),c=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),f=!0,h=t.map((function(t){if(!f)return!1;var e=o.dataManager.translateTrimmedRow(t);return f=o.shouldAllowMoving(e,c),e})),d=-1===h.indexOf(c);if(!f||!d)return!1;var y=this.getBaseParent(h),v=this.getTargetParent(l,c),m=y===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(h,c,m),this.moveRows(h,c,v),this.dataManager.rewriteCache(),this.moveCellsMeta(h,c),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,n,r,r&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,n),!1}},{key:"displayAPICompatibilityWarning",value:function(t){var e,n,r=t.rows,o=t.finalIndex,l=t.dropIndex,c=t.movePossible,f=!1;return Object(E.isUndefined)(l)&&(Object(rr.b)(Object(Wo.a)(Fw||(e=["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],(n=["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])||(n=e.slice(0)),Fw=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))))),this.hot.runHooks("afterRowMove",r,o,l,c,!1),f=!0),f}},{key:"shouldAllowMoving",value:function(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}},{key:"getBaseParent",value:function(t){return this.dataManager.getRowParent(t[0])}},{key:"getTargetParent",value:function(t,e){var n=this.dataManager.getRowParent(t?e-1:e);return null==n&&(n=this.dataManager.getRowParent(e-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(t,e,n){n||(Math.max.apply(Math,zw(t))<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}},{key:"moveRows",value:function(t,e,n){var r=this,o=e===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((function(){t.forEach((function(t){r.dataManager.moveRow(t,e,r.movedToCollapsed,o)}))}))}},{key:"moveCellsMeta",value:function(t,e){var n,r=this,o=[],l=Math.max.apply(Math,zw(t))<e;t.forEach((function(t){o.push(r.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),(n=this.hot).spliceCellsMeta.apply(n,[e-(l?o.length:0),0].concat(o))}},{key:"selectCells",value:function(t,e){var n,r=t.length,o=0,l=0,c=null;if(this.movedToCollapsed){var f=null;f=t[r-1]<e?this.dataManager.translateTrimmedRow(e-r):this.dataManager.translateTrimmedRow(e);var h=this.dataManager.getRowParent(null===f?this.hot.countSourceRows()-1:f-1),d=this.dataManager.getRowIndex(h);l=o=this.dataManager.untranslateTrimmedRow(d)}else t[r-1]<e?o=(l=e-1)-r+1:l=(o=e)+r-1;c=this.hot.selection,n=this.hot.countCols()-1,c.setRangeStart(this.hot._createCellCoords(o,0)),c.setRangeEnd(this.hot._createCellCoords(l,n),!0)}},{key:"isRowOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}}])&&Yw(e.prototype,n),r&&Yw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $w(t){return $w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$w(t)}function qw(t){return function(t){if(Array.isArray(t))return Qw(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Qw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qw(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qw(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Jw(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zw(n.key),n)}}function Zw(t){var e=function(input,t){if("object"!==$w(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==$w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===$w(e)?e:String(e)}function tO(){return tO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=oO(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},tO.apply(this,arguments)}function eO(t,p){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},eO(t,p)}function nO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=oO(t);if(e){var o=oO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===$w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rO(t)}(this,n)}}function rO(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oO(t){return oO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oO(t)}var iO="nestedRows",aO=new WeakMap,lO=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eO(t,e)}(l,t);var e,n,r,o=nO(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,t)).dataManager=null,e.headersUI=null,e.collapsedRowsMap=null,aO.set(rO(e),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),e}return e=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[iO]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Qh.a),this.dataManager=new cw(this,this.hot),this.collapsingUI=new _w(this,this.hot),this.headersUI=new Sw(this,this.hot),this.contextMenuUI=new Ww(this,this.hot),this.rowMoveController=new Kw(this),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("beforeViewRender",(function(){return t.onBeforeViewRender.apply(t,arguments)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData.apply(t,arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength.apply(t,arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice.apply(t,arguments)})),this.addHook("filterData",(function(){return t.onFilterData.apply(t,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("beforeAddChild",(function(){return t.onBeforeAddChild.apply(t,arguments)})),this.addHook("afterAddChild",(function(){return t.onAfterAddChild.apply(t,arguments)})),this.addHook("beforeDetachChild",(function(){return t.onBeforeDetachChild.apply(t,arguments)})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return t.onModifyRowHeaderWidth.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("beforeRowMove",(function(){return t.onBeforeRowMove.apply(t,arguments)})),this.addHook("beforeLoadData",(function(data){return t.onBeforeLoadData(data)})),this.addHook("beforeUpdateData",(function(data){return t.onBeforeLoadData(data)})),tO(oO(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),tO(oO(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),tO(oO(l.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}},{key:"disableCoreAPIModifiers",value:function(){aO.get(this).skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){aO.get(this).skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n){this.collapsingUI.toggleState(t,e,n)}},{key:"onModifyRowData",value:function(t){if(!aO.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(t)}},{key:"onModifySourceLength",value:function(){if(!aO.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(t,e,element){return!(!aO.get(this).skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(t)&&(this.dataManager.spliceData(t,e,element),1))}},{key:"onFilterData",value:function(t,e,n){var r=aO.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),r.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(t){return this.contextMenuUI.appendOptions(t)}},{key:"onAfterGetRowHeader",value:function(t,e){this.headersUI.appendLevelIndicators(t,e)}},{key:"onModifyRowHeaderWidth",value:function(t){return this.headersUI.rowHeaderWidthCache||t}},{key:"onAfterRemoveRow",value:function(t,e,n,source){var r=this;if(source!==this.pluginName){var o=aO.get(this);setTimeout((function(){o.skipRender=null,r.headersUI.updateRowHeaderWidth(),r.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(t,e,n){var r=this,o=Array.from(n.reduce((function(t,e){if(r.dataManager.isParent(e)){var n=r.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(n)&&n.forEach((function(e){return t.add(r.dataManager.getRowIndex(e))})),t}return t.add(e)}),new Set));n.length=0,n.push.apply(n,o)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(t,element){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(element)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(t,element,e){this.collapsingUI.collapsedRowsStash.shiftStash(e,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var t=Math.max.apply(Math,qw(this.dataManager.cache.levels));t>0&&this.headersUI.updateRowHeaderWidth(t)}},{key:"onBeforeViewRender",value:function(t,e){aO.get(this).skipRender&&(e.skipRender=!0)}},{key:"destroy",value:function(){tO(oO(l.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(data){if(!Object(Df.isArrayOfObjects)(data))return Object(rr.a)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[iO]=!1,void this.disablePlugin();this.dataManager.setData(data),this.dataManager.rewriteCache()}}],r=[{key:"PLUGIN_KEY",get:function(){return iO}},{key:"PLUGIN_PRIORITY",get:function(){return 300}}],n&&Jw(e.prototype,n),r&&Jw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);function sO(t){return sO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sO(t)}function uO(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cO(n.key),n)}}function cO(t){var e=function(input,t){if("object"!==sO(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==sO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===sO(e)?e:String(e)}var fO=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootWindow=n,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}var e,n,r;return e=t,n=[{key:"saveValue",value:function(t,e){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(t),JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,e){var n=void 0===t?e:t,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(t){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(t))}},{key:"resetAll",value:function(){var t=this;Object(C.arrayEach)(this.savedKeys,(function(e,n){t.rootWindow.localStorage.removeItem("".concat(t.prefix,"_").concat(t.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}],n&&uO(e.prototype,n),r&&uO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),hO=fO;function dO(t){return dO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dO(t)}function pO(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yO(n.key),n)}}function yO(t){var e=function(input,t){if("object"!==dO(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==dO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===dO(e)?e:String(e)}function bO(){return bO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=gO(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},bO.apply(this,arguments)}function vO(t,p){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},vO(t,p)}function mO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=gO(t);if(e){var o=gO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===dO(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function gO(t){return gO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gO(t)}it.a.getSingleton().register("persistentStateSave"),it.a.getSingleton().register("persistentStateLoad"),it.a.getSingleton().register("persistentStateReset");var wO="persistentState",OO=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vO(t,e)}(l,t);var e,n,r,o=mO(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,t)).storage=void 0,e}return e=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[wO]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.storage||(this.storage=new hO(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(e,n){return t.saveValue(e,n)})),this.addHook("persistentStateLoad",(function(e,n){return t.loadValue(e,n)})),this.addHook("persistentStateReset",(function(){return t.resetValue()})),bO(gO(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,bO(gO(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),bO(gO(l.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(t,e){e.value=this.storage.loadValue(t)}},{key:"saveValue",value:function(t,e){this.storage.saveValue(t,e)}},{key:"resetValue",value:function(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}},{key:"destroy",value:function(){bO(gO(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return wO}},{key:"PLUGIN_PRIORITY",get:function(){return 0}}],n&&pO(e.prototype,n),r&&pO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);function SO(t){return SO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SO(t)}function CO(t){return function(t){if(Array.isArray(t))return EO(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return EO(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EO(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EO(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function RO(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kO(n.key),n)}}function kO(t){var e=function(input,t){if("object"!==SO(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==SO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===SO(e)?e:String(e)}function jO(){return jO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=AO(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},jO.apply(this,arguments)}function TO(t,p){return TO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},TO(t,p)}function PO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=AO(t);if(e){var o=AO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===SO(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function AO(t){return AO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},AO(t)}var MO="search",_O="htSearchResult",xO=function(t,e,col,data,n){t.getCellMeta(e,col).isSearchResult=n},IO=function(t,e,n){return!(Object(E.isUndefined)(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!Object(E.isUndefined)(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale)))},NO=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TO(t,e)}(l,t);var e,n,r,o=PO(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,t)).callback=xO,e.queryMethod=IO,e.searchResultClass=_O,e}return e=l,n=[{key:"isEnabled",value:function(){return this.hot.getSettings()[MO]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[MO];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){return t.onBeforeRenderer.apply(t,arguments)})),jO(AO(l.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var t=this,e=function(){return t.onBeforeRenderer.apply(t,arguments)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(function(){t.hot.removeHook("beforeRenderer",e)})),jO(AO(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),jO(AO(l.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),l=this.hot.countCols(),c=[],f=this.hot;return Object(re.rangeEach)(0,o-1,(function(o){Object(re.rangeEach)(0,l-1,(function(l){var h=e.hot.getDataAtCell(o,l),d=e.hot.getCellMeta(o,l),y=d.search.callback||n,v=(d.search.queryMethod||r)(t,h,d);if(v){var m={row:o,col:l,data:h};c.push(m)}y&&y(f,o,l,h,v)}))})),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(t){this.callback=t}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(t){this.queryMethod=t}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(t){this.searchResultClass=t}},{key:"updatePluginSettings",value:function(t){Object(c.isObject)(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}},{key:"onBeforeRenderer",value:function(t,e,col,n,r,o){var l,c=o.className||[],f=[];"string"==typeof c?f=c.split(" "):(l=f).push.apply(l,CO(c)),this.isEnabled()&&o.isSearchResult?f.includes(this.searchResultClass)||f.push("".concat(this.searchResultClass)):f.includes(this.searchResultClass)&&f.splice(f.indexOf(this.searchResultClass),1),o.className=f.join(" ")}},{key:"destroy",value:function(){jO(AO(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return MO}},{key:"PLUGIN_PRIORITY",get:function(){return 190}}],n&&RO(e.prototype,n),r&&RO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);function HO(t){return HO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HO(t)}function DO(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LO(n.key),n)}}function LO(t){var e=function(input,t){if("object"!==HO(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==HO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===HO(e)?e:String(e)}function BO(){return BO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=WO(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},BO.apply(this,arguments)}function FO(t,p){return FO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},FO(t,p)}function VO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=WO(t);if(e){var o=WO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===HO(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function WO(t){return WO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},WO(t)}var UO=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&FO(t,e)}(c,t);var e,n,r,l=VO(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=l.call(this,t)).scrollbars=[],e.clones=[],e.lockedCollection=!1,e.freezeOverlays=!1,e}return e=c,r=[{key:"PLUGIN_KEY",get:function(){return"touchScroll"}},{key:"PLUGIN_PRIORITY",get:function(){return 200}},{key:"SETTING_KEYS",get:function(){return!0}}],(n=[{key:"isEnabled",value:function(){return Object(je.isTouchSupported)()}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterViewRender",(function(){return t.onAfterViewRender()})),this.registerEvents(),BO(WO(c.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,BO(WO(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){BO(WO(c.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.addHook("beforeTouchScroll",(function(){return t.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return t.onAfterMomentumScroll()}))}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var t=this.hot.view._wt.wtOverlays,e=t.topOverlay,n=t.bottomOverlay,r=t.inlineStartOverlay,o=t.topInlineStartCornerOverlay,l=t.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),l&&l.clone&&this.scrollbars.push(l),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),l&&l.clone&&this.clones.push(l.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Object(C.arrayEach)(this.clones,(function(t){Object(o.addClass)(t,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var t=this;this.freezeOverlays=!1,Object(C.arrayEach)(this.clones,(function(t){Object(o.removeClass)(t,"hide-tween"),Object(o.addClass)(t,"show-tween")})),this.hot._registerTimeout((function(){Object(C.arrayEach)(t.clones,(function(t){Object(o.removeClass)(t,"show-tween")}))}),400),Object(C.arrayEach)(this.scrollbars,(function(t){t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}])&&DO(e.prototype,n),r&&DO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(ke.a);function zO(t){return zO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zO(t)}function GO(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,YO(n.key),n)}}function YO(t){var e=function(input,t){if("object"!==zO(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==zO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===zO(e)?e:String(e)}function XO(){return XO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=qO(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},XO.apply(this,arguments)}function KO(t,p){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},KO(t,p)}function $O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qO(t);if(e){var o=qO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===zO(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function qO(t){return qO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qO(t)}var QO="trimRows",JO=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&KO(t,e)}(l,t);var e,n,r,o=$O(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,t)).trimmedRowsMap=null,e}return e=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[QO]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Qh.a),this.trimmedRowsMap.addLocalHook("init",(function(){return t.onMapInit()})),XO(qO(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var t=this,e=this.hot.getSettings()[QO];Array.isArray(e)&&this.hot.batchExecution((function(){t.trimmedRowsMap.clear(),Object(C.arrayEach)(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),XO(qO(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),XO(qO(l.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(t){var e=this,n=this.getTrimmedRows(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t)))),!1!==this.hot.runHooks("beforeTrimRow",n,o,r)&&(r&&this.hot.batchExecution((function(){Object(C.arrayEach)(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",n,o,r,r&&o.length>n.length))}},{key:"trimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}},{key:"untrimRows",value:function(t){var e=this.getTrimmedRows(),n=this.isValidConfig(t),r=e,o=this.trimmedRowsMap.getValues().slice(),l=t.length>0;n&&l&&(Object(C.arrayEach)(t,(function(t){o[t]=!1})),r=Object(C.arrayReduce)(o,(function(t,e,n){return e&&t.push(n),t}),[])),!1!==this.hot.runHooks("beforeUntrimRow",e,r,n&&l)&&(n&&l&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",e,r,n&&l,n&&r.length<e.length))}},{key:"untrimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}},{key:"isTrimmed",value:function(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(t){var e=this.hot.countSourceRows();return t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"onMapInit",value:function(){var t=this,e=this.hot.getSettings()[QO];Array.isArray(e)&&this.hot.batchExecution((function(){Object(C.arrayEach)(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0)}},{key:"destroy",value:function(){XO(qO(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return QO}},{key:"PLUGIN_PRIORITY",get:function(){return 330}}],n&&GO(e.prototype,n),r&&GO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ke.a);function ZO(t){return ZO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZO(t)}function tS(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eS(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rS(n.key),n)}}function nS(t,e,n){return e&&eS(t.prototype,e),n&&eS(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function rS(t){var e=function(input,t){if("object"!==ZO(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ZO(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ZO(e)?e:String(e)}function oS(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iS(t,e)}function iS(t,p){return iS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},iS(t,p)}function aS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=lS(t);if(e){var o=lS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ZO(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function lS(t){return lS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lS(t)}function sS(t){return function(t){if(Array.isArray(t))return fS(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||cS(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uS(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||cS(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cS(t,e){if(t){if("string"==typeof t)return fS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fS(t,e):void 0}}function fS(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var hS="undoRedo";function dS(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(n,source){var r=this,o=n&&n.length;if(o&&n.find((function(t){var e=uS(t,4);return e[2]!==e[3]}))){e.done((function(){var e=n.reduce((function(t,e){return t.push(sS(e)),t}),[]);Object(C.arrayEach)(e,(function(e){e[1]=t.propToCol(e[1])}));var l=o>1?r.getSelected():[[e[0][0],e[0][1]]];return new dS.ChangeAction(e,l)}),source)}})),t.addHook("afterCreateRow",(function(t,n,source){e.done((function(){return new dS.CreateRowAction(t,n)}),source)})),t.addHook("beforeRemoveRow",(function(n,r,o,source){e.done((function(){var o=t.toPhysicalRow(n),l=Object(c.deepClone)(e.instance.getSourceData(o,0,o+r-1,e.instance.countSourceCols()-1));return new dS.RemoveRowAction(o,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())}),source)})),t.addHook("afterCreateCol",(function(t,n,source){e.done((function(){return new dS.CreateColumnAction(t,n)}),source)})),t.addHook("beforeRemoveCol",(function(n,r,o,source){e.done((function(){var o=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),c=[],f=[],h=[];Object(re.rangeEach)(o.length-1,(function(i){var e=[],n=o[i];Object(re.rangeEach)(l,l+(r-1),(function(r){e.push(n[t.toPhysicalColumn(r)])})),c.push(e)})),Object(re.rangeEach)(r-1,(function(i){h.push(t.toPhysicalColumn(l+i))})),Array.isArray(t.getSettings().colHeaders)&&Object(re.rangeEach)(r-1,(function(i){f.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+i)]||null)}));var d=t.columnIndexMapper.getIndexesSequence(),y=t.rowIndexMapper.getIndexesSequence();return new dS.RemoveColumnAction(l,h,c,f,d,y,t.getSettings().fixedColumnsStart)}),source)})),t.addHook("beforeCellAlignment",(function(t,n,r,o){e.done((function(){return new dS.CellAlignmentAction(t,n,r,o)}))})),t.addHook("beforeFilter",(function(t){e.done((function(){return new dS.FiltersAction(t)}))})),t.addHook("beforeRowMove",(function(t,n){!1!==t&&e.done((function(){return new dS.RowMoveAction(t,n)}))})),t.addHook("beforeMergeCells",(function(n,r){r||e.done((function(){return new dS.MergeCellsAction(t,n)}))})),t.addHook("afterUnmergeCells",(function(n,r){r||e.done((function(){return new dS.UnmergeCellsAction(t,n)}))})),t.addHook("afterInit",(function(){e.init()}))}dS.prototype.done=function(t,source){if(!this.ignoreNewActions&&!("UndoRedo.undo"===source||"UndoRedo.redo"===source||"auto"===source)){var e=this.doneActions.slice();if(!1!==this.instance.runHooks("beforeUndoStackChange",e,source)){var n=t(),r=this.undoneActions.slice();this.doneActions.push(n),this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",r),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice())}}},dS.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);var e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());var n=Object(c.deepClone)(e);if(!1===this.instance.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;var r=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,(function(){r.ignoreNewActions=!1,r.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},dS.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);var e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());var n=Object(c.deepClone)(e);if(!1===this.instance.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;var r=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,(function(){r.ignoreNewActions=!1,r.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},dS.prototype.isUndoAvailable=function(){return this.doneActions.length>0},dS.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},dS.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},dS.prototype.isEnabled=function(){return this.enabled},dS.prototype.enable=function(){if(!this.isEnabled()){var t,e=this.instance;this.enabled=!0,(t=e).undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()},this.registerShortcuts(),e.addHook("afterChange",bS)}},dS.prototype.disable=function(){if(this.isEnabled()){var t,e=this.instance;this.enabled=!1,delete(t=e).undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo,this.unregisterShortcuts(),e.removeHook("afterChange",bS)}},dS.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},dS.Action=function(){},dS.Action.prototype.undo=function(){},dS.Action.prototype.redo=function(){},dS.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},Object(c.inherit)(dS.ChangeAction,dS.Action),dS.ChangeAction.prototype.undo=function(t,e){for(var data=Object(c.deepClone)(this.changes),n=t.countEmptyRows(!0),r=t.countEmptyCols(!0),i=0,o=data.length;i<o;i++)data[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(data,null,null,"UndoRedo.undo");for(var l=0,f=data.length;l<f;l++){var h=uS(data[l],2),d=h[0],y=h[1];t.getSettings().minSpareRows&&d+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(d+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&y+1+t.getSettings().minSpareCols===t.countCols()&&r===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(y+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},dS.ChangeAction.prototype.redo=function(t,e){for(var data=Object(c.deepClone)(this.changes),i=0,n=data.length;i<n;i++)data[i].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(data,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},dS.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},Object(c.inherit)(dS.CreateRowAction,dS.Action),dS.CreateRowAction.prototype.undo=function(t,e){var n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},dS.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},dS.RemoveRowAction=function(t,data,e,n,r){this.index=t,this.data=data,this.actionType="remove_row",this.fixedRowsBottom=e,this.fixedRowsTop=n,this.rowIndexesSequence=r},Object(c.inherit)(dS.RemoveRowAction,dS.Action),dS.RemoveRowAction.prototype.undo=function(t,e){var n=this,r=t.getSettings(),o=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((function(t,e){Object.keys(t).forEach((function(r){var l=parseInt(r,10);o.push([n.index+e,isNaN(l)?r:l,t[r]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},dS.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},dS.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},Object(c.inherit)(dS.CreateColumnAction,dS.Action),dS.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},dS.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},dS.RemoveColumnAction=function(t,e,data,n,r,o,l){this.index=t,this.indexes=e,this.data=data,this.amount=this.data[0].length,this.headers=n,this.columnPositions=r.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=l},Object(c.inherit)(dS.RemoveColumnAction,dS.Action),dS.RemoveColumnAction.prototype.undo=function(t,e){var n=this;t.getSettings().fixedColumnsStart=this.fixedColumnsStart;for(var r=this.indexes.slice(0).sort(),o=function(t,e,o){return o[n.indexes.indexOf(r[e])]},l=this.data.length,c=[],f=0;f<l;f++)c.push(Object(C.arrayMap)(this.data[f],o));var h=Object(C.arrayMap)(this.headers,o),d=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Object(C.arrayEach)(t.getSourceDataArray(),(function(t,e){Object(C.arrayEach)(r,(function(n,r){t[n]=c[e][r],d.push([e,n,t[n]])}))})),t.setSourceDataAtCell(d,void 0,void 0,"UndoRedo.undo"),t.columnIndexMapper.insertIndexes(r[0],r.length),void 0!==this.headers&&Object(C.arrayEach)(h,(function(e,n){t.getSettings().colHeaders[r[n]]=e})),t.batchExecution((function(){t.rowIndexMapper.setIndexesSequence(n.rowPositions),t.columnIndexMapper.setIndexesSequence(n.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},dS.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},dS.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r},dS.CellAlignmentAction.prototype.undo=function(t,e){var n=this;Object(C.arrayEach)(this.range,(function(e){e.forAll((function(e,col){e>=0&&col>=0&&t.setCellMeta(e,col,"className",n.stateBefore[e][col]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},dS.CellAlignmentAction.prototype.redo=function(t,e){ui(this.range,this.type,this.alignment,(function(e,col){return t.getCellMeta(e,col)}),(function(e,col,n,r){return t.setCellMeta(e,col,n,r)})),t.addHookOnce("afterViewRender",e),t.render()},dS.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},Object(c.inherit)(dS.FiltersAction,dS.Action),dS.FiltersAction.prototype.undo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},dS.FiltersAction.prototype.redo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var pS=function(t){oS(n,t);var e=aS(n);function n(t,r){var o;tS(this,n),(o=e.call(this)).cellRange=r;var l=o.cellRange.getTopStartCorner(),c=o.cellRange.getBottomEndCorner();return o.rangeData=t.getData(l.row,l.col,c.row,c.col),o}return nS(n,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0);var r=this.cellRange.getTopStartCorner();t.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange)}}]),n}(dS.Action);dS.MergeCellsAction=pS;var yS=function(t){oS(n,t);var e=aS(n);function n(t,r){var o;return tS(this,n),(o=e.call(this)).cellRange=r,o}return nS(n,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}]),n}(dS.Action);function bS(t,source){if("loadData"===source)return this.undoRedo.clear()}dS.UnmergeCellsAction=yS,dS.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},Object(c.inherit)(dS.RowMoveAction,dS.Action),dS.RowMoveAction.prototype.undo=function(t,e){var n=this,r=t.getPlugin("manualRowMove"),o=[].concat(this.rows),l=o.filter((function(a){return a>n.finalIndex})),c=o.filter((function(a){return a<=n.finalIndex})),f=l.sort((function(a,b){return b-a})).concat(c.sort((function(a,b){return a-b})));t.addHookOnce("afterViewRender",e);for(var i=0;i<f.length;i+=1){var h=t.toVisualRow(f[i]);r.moveRow(h,f[i])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},dS.RowMoveAction.prototype.redo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},dS.prototype.init=function(){var t=this.instance.getSettings().undo,e=void 0===t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},dS.prototype.registerShortcuts=function(){var t=this,e=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:function(t){return!t.altKey},group:hS};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){t.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){t.redo()}}],n)},dS.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(hS)};var vS=it.a.getSingleton();vS.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),vS.register("beforeUndo"),vS.register("afterUndo"),vS.register("beforeRedo"),vS.register("afterRedo"),dS.PLUGIN_KEY="undoRedo",dS.SETTING_KEYS=!0;var mS=dS,gS=n(731);function wS(){Object(Ut.e)(L.a),Object(Ut.e)(D),Object(Ut.e)(z),Object(Ut.e)(ot),Object(Ut.e)(ht),Object(Ut.e)(S),Object(Ut.e)(gt),Object(Ut.e)(kt),Object(Ut.e)(Nt),Object(Ut.e)(r.a),Object(Ut.e)(Wt),Object(le.d)(Yt),Object(le.d)(zt.a),Object(le.d)(te),Object(le.d)(Gt),Object(le.d)(oe),Object(le.d)(ie),Object(le.d)(j.a),Object(le.d)(ae),Object(ye.d)(se),Object(ye.d)(fe),Object(ye.d)(he),Object(ye.d)(pe),Object(Re.d)(be),Object(Re.d)(ve),Object(Re.d)(me),Object(Re.d)(ge),Object(Re.d)(we),Object(Re.d)(Oe),Object(Re.d)(Se),Object(Re.d)(Ce.a),Object(Re.d)(Ee),Object(gS.d)(Ke),Object(gS.d)(cn),Object(gS.d)(On),Object(gS.d)(nr),Object(gS.d)(kr),Object(gS.d)(Ho),Object(gS.d)(Qo),Object(gS.d)(Hi),Object(gS.d)(Ba),Object(gS.d)(ts),Object(gS.d)(Es),Object(gS.d)(xs),Object(gS.d)(Us),Object(gS.d)(gu),Object(gS.d)(cd),Object(gS.d)(Jd),Object(gS.d)(wp),Object(gS.d)(Fp),Object(gS.d)(ey),Object(gS.d)(Fy),Object(gS.d)(Jy),Object(gS.d)(Db),Object(gS.d)(tv),Object(gS.d)(Vv),Object(gS.d)(rm),Object(gS.d)(fm),Object(gS.d)(rw),Object(gS.d)(lO),Object(gS.d)(OO),Object(gS.d)(NO),Object(gS.d)(UO),Object(gS.d)(JO),Object(gS.d)(mS)}},690:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n(34),n(64),n(85);var r=n(665);function o(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(r.arrayReduce)(t,(function(t,e,r){return t+e.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")}),"").trim()}},691:function(t,e,n){"use strict";function r(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function o(t){return!1===t.isImmediatePropagationEnabled}function l(t){return 2===t.button}function c(t){return 0===t.button}n.r(e),n.d(e,"stopImmediatePropagation",(function(){return r})),n.d(e,"isImmediatePropagationStopped",(function(){return o})),n.d(e,"isRightClick",(function(){return l})),n.d(e,"isLeftClick",(function(){return c}))},693:function(t,e,n){"use strict";n.d(e,"e",(function(){return O})),n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return m})),n.d(e,"d",(function(){return d})),n.d(e,"c",(function(){return y}));n(239),n(6),n(40),n(307),n(44);var r=n(688),o=n(730),l=new WeakMap,c=Object(o.a)("editors"),f=c.register,h=c.getItem,d=c.hasItem,y=c.getNames;c.getValues;function v(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},r.a.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function m(t,e){var n;if("function"==typeof t)l.get(t)||O(null,t),n=l.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=h(t)}if(!n)throw Error('No editor registered under name "'.concat(t,'"'));return n.getInstance(e)}function w(t){if("function"==typeof t)return t;if(!d(t))throw Error('No registered editor found under "'.concat(t,'" name'));return h(t).getConstructor()}function O(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);var n=new v(e);"string"==typeof t&&f(t,n),l.set(e,n)}},694:function(t,e,n){"use strict";n.d(e,"a",(function(){return H}));var r=n(787),o=n(153);function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function c(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){v(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function y(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function v(t,e,n){return(e=E(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function O(t,p){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},O(t,p)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w(t);if(e){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}(this,n)}}function E(t){var e=function(input,t){if("object"!=typeof input||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"==typeof e?e:String(e)}var R=Symbol("unassigned"),k=null;function j(source){var t=r.a.hooks.getRegistered(),e={};for(var n in Object.assign(e,r.a.DefaultSettings),e)e[n]={default:R};for(var i=0;i<t.length;i++)e[t[i]]={default:R};return e.settings={default:R},"HotTable"===source&&(e.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},e.wrapperRendererCacheSize={type:Number,default:3e3}),e}function T(t){var e={},n=t.settings;if(n!==R)for(var r in n)n.hasOwnProperty(r)&&n[r]!==R&&(e[r]=n[r]);for(var o in t)t.hasOwnProperty(o)&&"settings"!==o&&t[o]!==R&&(e[o]=t[o]);return e}function P(t,e){var n=T(t),r=t.settings?t.settings:n,o=t.settings?n:null,l={};for(var c in r)!r.hasOwnProperty(c)||void 0===r[c]||e&&"data"!==c&&_(e[c],r[c])||(l[c]=r[c]);for(var f in o)!o.hasOwnProperty(f)||"id"===f||"settings"===f||"wrapperRendererCacheSize"===f||void 0===o[f]||e&&"data"!==f&&_(e[f],o[f])||(l[f]=o[f]);return l}function A(t,e){var n=null;return t.every((function(slot,t){return!slot.data||!slot.data.attrs||void 0===slot.data.attrs[e]||(n=slot,!1)})),n}function M(t,e,n,data){var r=e.$el?e.$el.ownerDocument:document,o={propsData:n,parent:e,data:data};k||((k=r.createElement("DIV")).id="vueHotComponents",r.body.appendChild(k));var l=r.createElement("DIV");return k.appendChild(l),new t.componentOptions.Ctor(o).$mount(l)}function _(t,e){return JSON.stringify(t)===JSON.stringify(e)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var x,I=(function(t,e){!function(t){var e=Symbol("newer"),n=Symbol("older");function r(t,e){"number"!=typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function o(t,r){this.key=t,this.value=r,this[e]=void 0,this[n]=void 0}t.LRUMap=r,r.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][n]=t[n]),t[n]&&(t[n][e]=t[e]),t[e]=void 0,t[n]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},r.prototype.assign=function(t){var r,l=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var c=t[Symbol.iterator](),f=c.next();!f.done;f=c.next()){var h=new o(f.value[0],f.value[1]);if(this._keymap.set(h.key,h),r?(r[e]=h,h[n]=r):this.oldest=h,r=h,0==l--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},r.prototype.set=function(t,r){var l=this._keymap.get(t);return l?(l.value=r,this._markEntryAsUsed(l),this):(this._keymap.set(t,l=new o(t,r)),this.newest?(this.newest[e]=l,l[n]=this.newest):this.oldest=l,this.newest=l,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[n]=void 0,this._keymap.delete(t.key),--this.size,[t.key,t.value]},r.prototype.has=function(t){return this._keymap.has(t)}}(e)}(x={exports:{}},x.exports),x.exports).LRUMap;function N(template,style,script,t,e,n,r,o,l,c){"boolean"!=typeof r&&(l=o,o=r,r=!1);const f="function"==typeof script?script.options:script;let h;if(template&&template.render&&(f.render=template.render,f.staticRenderFns=template.staticRenderFns,f._compiled=!0,e&&(f.functional=!0)),t&&(f._scopeId=t),n?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),style&&style.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(n)},f._ssrRegister=h):style&&(h=r?function(t){style.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){style.call(this,o(t))}),h)if(f.functional){const t=f.render;f.render=function(e,n){return h.call(n),t(e,n)}}else{const t=f.beforeCreate;f.beforeCreate=t?[].concat(t,h):[h]}return script}var H=N({render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{attrs:{id:t.id}},[t._t("default")],2)},staticRenderFns:[]},undefined,{name:"HotTable",props:j("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new I(this.wrapperRendererCacheSize);return e.shift=function(){var t=I.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return P(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var component,t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),n=P(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,e&&(n.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(n.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new r.a.Core(this.$el,n),this.hotInstance.init(),(component=this).hotInstance&&(component.hotInstance.addHook("beforeChange",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateCol",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveCol",(function(){component.__internalEdit=!0}))),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,data=this.hotInstance.getSourceData(),n=[],r=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),l=this.hotInstance.isColumnModificationAllowed(),c=0;if(data&&data.length!==o&&data.length<o)for(var f=data.length;f<o;f++)n.push(f);if(l)if(c=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),data&&data[0]&&(null===(e=data[0])||void 0===e?void 0:e.length)!==c&&data[0].length<c)for(var h=data[0].length;h<c;h++)r.push(h);this.hotInstance.batch((function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(o-1,data.length-o),l&&0!==data.length&&(r.length>0?t.hotInstance.columnIndexMapper.removeIndexes(r):t.hotInstance.columnIndexMapper.insertIndexes(c-1,data[0].length-c))}))}},getGlobalRendererVNode:function(){return A(this.$slots.default||[],"hot-renderer")},getGlobalEditorVNode:function(){return A(this.$slots.default||[],"hot-editor")},getColumnSettings:function(){var t=this.$children.filter((function(t){return"HotColumn"===t.$options.name})),e=!1,n=t.map((function(t){return t.usesRendererComponent&&(e=!0),c({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(t,e){var n=this;return function(r,o,l,col,c,f,h){if(o&&!o.getAttribute("ghost-table")){var d=n.rendererCache,y={hotInstance:r,TD:o,row:l,col:col,prop:c,value:f,cellProperties:h,isRenderer:!0};if(d&&!d.has("".concat(l,"-").concat(col))){var v=M(t,e,t.componentOptions.propsData,y);d.set("".concat(l,"-").concat(col),{component:v,lastUsedTD:null})}var m=d.get("".concat(l,"-").concat(col)),w=m.component,O=m.lastUsedTD;if(Object.assign(w.$data,y),!w.$el.parentElement||O!==o){for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(w.$el),m.lastUsedTD=o}}return o}},getEditorClass:function(t,e){var n=t.key?t.key.toString():null,r=t.componentOptions.Ctor.options.name,o=n?"".concat(r,":").concat(n):r,l=this.editorCache,c=null;return l.has(o)?c=l.get(o):(c=M(t,e,t.componentOptions.propsData,{isEditor:!0}),l.set(o,c)),c.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:"12.3.1"},undefined,false,undefined,!1,void 0,void 0,void 0);j("HotColumn");function D(t){return D="function"==typeof Symbol&&"symbol"===f(Symbol.iterator)?function(t){return f(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":f(t)},D(t)}function L(t){return function(t){if(Array.isArray(t)){for(var i=0,e=new Array(t.length);i<t.length;i++)e[i]=t[i];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function B(t,e,n){(n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e)).forEach((function(r){var o=n?Reflect.getOwnMetadata(r,e,n):Reflect.getOwnMetadata(r,e);n?Reflect.defineMetadata(r,o,t,n):Reflect.defineMetadata(r,o,t)}))}var F={__proto__:[]}instanceof Array;var V=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function W(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t)if(V.indexOf(t)>-1)e[t]=n[t];else{var r=Object.getOwnPropertyDescriptor(n,t);void 0!==r.value?"function"==typeof r.value?(e.methods||(e.methods={}))[t]=r.value:(e.mixins||(e.mixins=[])).push({data:function(){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t,r.value)}}):(r.get||r.set)&&((e.computed||(e.computed={}))[t]={get:r.get,set:r.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return function(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var r in t.$options.props)t.hasOwnProperty(r)||n.push(r);n.forEach((function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var data=new e;e.prototype._init=n;var r={};return Object.keys(data).forEach((function(t){void 0!==data[t]&&(r[t]=data[t])})),r}(this,t)}});var r=t.__decorators__;r&&(r.forEach((function(t){return t(e)})),delete t.__decorators__);var l,c,f=Object.getPrototypeOf(t.prototype),h=f instanceof o?f.constructor:o,d=h.extend(e);return function(t,e,n){Object.getOwnPropertyNames(e).forEach((function(r){if(!U[r]){var o=Object.getOwnPropertyDescriptor(t,r);if(!o||o.configurable){var l,c,f=Object.getOwnPropertyDescriptor(e,r);if(!F){if("cid"===r)return;var h=Object.getOwnPropertyDescriptor(n,r);if(l=f.value,c=D(l),null!=l&&("object"===c||"function"===c)&&h&&h.value===f.value)return}Object.defineProperty(t,r,f)}}}))}(d,t,h),"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys&&(B(l=d,c=t),Object.getOwnPropertyNames(c.prototype).forEach((function(t){B(l.prototype,c.prototype,t)})),Object.getOwnPropertyNames(c).forEach((function(t){B(l,c,t)}))),d}var U={prototype:!0,arguments:!0,callee:!0,caller:!0};function z(t){return"function"==typeof t?W(t):function(e){return W(e,t)}}z.registerHooks=function(t){V.push.apply(V,L(t))};var G=function(t){m(n,t);var e=C(n);function n(){var t;return h(this,n),(t=e.apply(this,arguments)).name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return y(n,[{key:"mounted",value:function(){var t,e=this;this.$data.hotCustomEditorClass=(t=function(t){m(r,t);var n=C(r);function r(t){var o;return h(this,r),o=n.call(this,t),e.$data.hotCustomEditorInstance=S(o),o}return y(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(r.a.editors.BaseEditor),Object.getOwnPropertyNames(r.a.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(t=e[n]).call.apply(t,[this].concat(o))})})),t)}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];(t=r.a.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(t,col,e,n,o,l){return this.$data.hotInstance=l.instance,this.$data.row=t,this.$data.col=col,this.$data.prop=e,this.$data.TD=n,this.$data.originalValue=o,this.$data.cellProperties=l,r.a.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,col,e,n,o,l)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.a.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(o);G=function(t,e,n,desc){var r,o=arguments.length,l=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(l=(o<3?r(l):o>3?r(e,n,l):r(e,n))||l);return o>3&&l&&Object.defineProperty(e,n,l),l}([z({})],G)},695:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return l}));var r=n(673);function o(){var t;Object(r.isDefined)(console)&&(t=console).warn.apply(t,arguments)}function l(){var t;Object(r.isDefined)(console)&&(t=console).error.apply(t,arguments)}},696:function(t,e,n){n(7)({target:"Number",stat:!0},{isInteger:n(937)})},697:function(t,e,n){var content=n(946);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(19).default)("6a23fc8a",content,!0,{sourceMap:!1})},700:function(t,e,n){"use strict";n.r(e),n.d(e,"toUpperCaseFirst",(function(){return l})),n.d(e,"equalsIgnoreCase",(function(){return c})),n.d(e,"randomString",(function(){return f})),n.d(e,"isPercentValue",(function(){return h})),n.d(e,"substitute",(function(){return d})),n.d(e,"stripTags",(function(){return y})),n.d(e,"sanitize",(function(){return v}));n(669),n(6),n(86),n(34),n(64);var r=n(935),o=n(673);function l(t){return t[0].toUpperCase()+t.substr(1)}function c(){for(var t=[],e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var l=n.length;l;){l-=1;var c=Object(o.stringify)(n[l]).toLowerCase();-1===t.indexOf(c)&&t.push(c)}return 1===t.length}function f(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function h(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function d(template){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(template).replace(/(?:\\)?\[([^[\]]+)]/g,(function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]}))}function y(t){return v("".concat(t),{ALLOWED_TAGS:[]})}function v(t,e){return r.sanitize(t,e)}},715:function(t,e,n){"use strict";n.r(e),n.d(e,"setBrowserMeta",(function(){return f})),n.d(e,"setPlatformMeta",(function(){return h})),n.d(e,"isChrome",(function(){return d})),n.d(e,"isChromeWebKit",(function(){return y})),n.d(e,"isFirefox",(function(){return v})),n.d(e,"isFirefoxWebKit",(function(){return m})),n.d(e,"isSafari",(function(){return w})),n.d(e,"isEdge",(function(){return O})),n.d(e,"isEdgeWebKit",(function(){return S})),n.d(e,"isIE",(function(){return C})),n.d(e,"isIE9",(function(){return E})),n.d(e,"isMSBrowser",(function(){return R})),n.d(e,"isMobileBrowser",(function(){return k})),n.d(e,"isIOS",(function(){return j})),n.d(e,"isIpadOS",(function(){return T})),n.d(e,"isWindowsOS",(function(){return P})),n.d(e,"isMacOS",(function(){return A})),n.d(e,"isLinuxOS",(function(){return M}));n(34);var r=n(664),o=function(t){var e={value:!1,test:function(n,r){e.value=t(n,r)}};return e},l={chrome:o((function(t,e){return/Chrome/.test(t)&&/Google/.test(e)})),chromeWebKit:o((function(t){return/CriOS/.test(t)})),edge:o((function(t){return/Edge/.test(t)})),edgeWebKit:o((function(t){return/EdgiOS/.test(t)})),firefox:o((function(t){return/Firefox/.test(t)})),firefoxWebKit:o((function(t){return/FxiOS/.test(t)})),ie:o((function(t){return/Trident/.test(t)})),ie9:o((function(){return!!document.documentMode})),mobile:o((function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)})),safari:o((function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)}))},c={mac:o((function(t){return/^Mac/.test(t)})),win:o((function(t){return/^Win/.test(t)})),linux:o((function(t){return/^Linux/.test(t)})),ios:o((function(t){return/iPhone|iPad|iPod/i.test(t)}))};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.userAgent,n=void 0===e?navigator.userAgent:e,o=t.vendor,c=void 0===o?navigator.vendor:o;Object(r.objectEach)(l,(function(t){(0,t.test)(n,c)}))}function h(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).platform,e=void 0===t?navigator.platform:t;Object(r.objectEach)(c,(function(t){(0,t.test)(e)}))}function d(){return l.chrome.value}function y(){return l.chromeWebKit.value}function v(){return l.firefox.value}function m(){return l.firefoxWebKit.value}function w(){return l.safari.value}function O(){return l.edge.value}function S(){return l.edgeWebKit.value}function C(){return l.ie.value}function E(){return l.ie9.value}function R(){return l.ie.value||l.edge.value}function k(){return l.mobile.value}function j(){return c.ios.value}function T(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator).maxTouchPoints>2&&c.mac.value}function P(){return c.win.value}function A(){return c.mac.value}function M(){return c.linux.value}f(),h()},716:function(t,e,n){"use strict";var r=n(664),o=n(685),l={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t,e,n,r,l,c,f){if(this._localHooks[t])for(var h=this._localHooks[t].length,i=0;i<h;i++)Object(o.fastCall)(this._localHooks[t][i],this,e,n,r,l,c,f)},clearLocalHooks:function(){return this._localHooks={},this}};Object(r.defineGetter)(l,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.a=l},723:function(t,e,n){"use strict";n.d(e,"d",(function(){return w})),n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return y})),n.d(e,"b",(function(){return v}));var r=n(730),o=n(693),l=n(724),c=n(725),f=Object(r.a)("cellTypes"),h=f.register,d=f.getItem,y=f.hasItem,v=f.getNames;f.getValues;function m(t){if(!y(t))throw Error('You declared cell type "'.concat(t,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return d(t)}function w(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);var n=e,r=n.editor,f=n.renderer,d=n.validator;r&&Object(o.e)(t,r),f&&Object(l.d)(t,f),d&&Object(c.d)(t,d),h(t,e)}},724:function(t,e,n){"use strict";n.d(e,"d",(function(){return y})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return h}));var r=n(730),o=Object(r.a)("renderers"),l=o.register,c=o.getItem,f=o.hasItem,h=o.getNames;o.getValues;function d(t){if("function"==typeof t)return t;if(!f(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return c(t)}function y(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),l(t,e)}},725:function(t,e,n){"use strict";n.d(e,"d",(function(){return y})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return h}));var r=n(730),o=Object(r.a)("validators"),l=o.register,c=o.getItem,f=o.hasItem,h=o.getNames;o.getValues;function d(t){if("function"==typeof t)return t;if(!f(t))throw Error('No registered validator found under "'.concat(t,'" name'));return c(t)}function y(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),l(t,e)}},727:function(t,e,n){"use strict";n.r(e),n.d(e,"requestAnimationFrame",(function(){return f})),n.d(e,"isClassListSupported",(function(){return h})),n.d(e,"isTextContentSupported",(function(){return d})),n.d(e,"isGetComputedStyleSupported",(function(){return y})),n.d(e,"cancelAnimationFrame",(function(){return v})),n.d(e,"isTouchSupported",(function(){return m})),n.d(e,"hasCaptionProblem",(function(){return w})),n.d(e,"getComparisonFunction",(function(){return O})),n.d(e,"isPassiveEventSupported",(function(){return S}));var r,o,l;n(11),n(62),n(6),n(74),n(239),n(40),n(44);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t){return window.requestAnimationFrame(t)}function h(){return!!document.documentElement.classList}function d(){return!!document.createTextNode("test").textContent}function y(){return!!window.getComputedStyle}function v(t){window.cancelAnimationFrame(t)}function m(){return"ontouchstart"in window}function w(){return void 0===r&&function(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",t.insertBefore(n,e),document.body.appendChild(t),r=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}(),r}function O(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o||(o="object"===("undefined"==typeof Intl?"undefined":c(Intl))?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?function(a,b){return"".concat(a).localeCompare(b)}:function(a,b){return a===b?0:a>b?-1:1})}function S(){if(void 0!==l)return l;try{var t={get passive(){l=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){l=!1}return l}},728:function(t,e,n){"use strict";n.r(e),n.d(e,"KEY_CODES",(function(){return l})),n.d(e,"isPrintableChar",(function(){return f})),n.d(e,"isFunctionKey",(function(){return h})),n.d(e,"isCtrlKey",(function(){return d})),n.d(e,"isCtrlMetaKey",(function(){return y})),n.d(e,"isKey",(function(){return v}));n(48),n(63);var r=n(665),o=n(715),l={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Object(o.isFirefox)()?182:174,AUDIO_MUTE:Object(o.isFirefox)()?181:173,AUDIO_UP:Object(o.isFirefox)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},c=[l.ALT,l.ARROW_DOWN,l.ARROW_LEFT,l.ARROW_RIGHT,l.ARROW_UP,l.AUDIO_DOWN,l.AUDIO_MUTE,l.AUDIO_UP,l.BACKSPACE,l.CAPS_LOCK,l.DELETE,l.END,l.ENTER,l.ESCAPE,l.F1,l.F2,l.F3,l.F4,l.F5,l.F6,l.F7,l.F8,l.F9,l.F10,l.F11,l.F12,l.F13,l.F14,l.F15,l.F16,l.F17,l.F18,l.F19,l.HOME,l.INSERT,l.MEDIA_NEXT,l.MEDIA_PLAY_PAUSE,l.MEDIA_PREV,l.MEDIA_STOP,l.NULL,l.NUM_LOCK,l.PAGE_DOWN,l.PAGE_UP,l.PAUSE,l.SCROLL_LOCK,l.SHIFT,l.TAB];function f(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function h(t){return c.includes(t)}function d(t){var e=[];return Object(o.isMacOS)()?e.push(l.COMMAND_LEFT,l.COMMAND_RIGHT,l.COMMAND_FIREFOX):e.push(l.CONTROL),e.includes(t)}function y(t){return[l.CONTROL,l.COMMAND_LEFT,l.COMMAND_RIGHT,l.COMMAND_FIREFOX].includes(t)}function v(t,e){var n=e.split("|"),o=!1;return Object(r.arrayEach)(n,(function(e){if(t===l[e])return o=!0,!1})),o}},730:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(239),n(242),n(6),n(40),n(44),n(11),n(62),n(74),n(56),n(55),n(33),n(34);function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var l=new Map;function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";l.has(t)||l.set(t,new Map);var e=l.get(t);return{register:function(t,n){e.set(t,n)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return r(e.keys())},getValues:function(){return r(e.values())}}}},731:function(t,e,n){"use strict";n.d(e,"b",(function(){return x})),n.d(e,"a",(function(){return I})),n.d(e,"c",(function(){return N})),n.d(e,"d",(function(){return H}));n(36),n(11),n(62),n(6),n(74),n(239),n(40),n(44),n(56),n(55),n(33),n(34);var r=n(700),o=(n(242),n(84),n(309),n(677)),l=n(685);function c(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||h(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var y="asc",v=new Map([[y,[-1,1]],["desc",[1,-1]]]),m=function(t){return"The priority '".concat(t,"' is already declared in a map.")},w=function(t){return"The priority '".concat(t,"' is not a number.")};var O=n(788);n(682);function S(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var E=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function R(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||j(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){if(t){if("string"==typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(t,e):void 0}}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var P=function(t){return'There is already registered "'.concat(t,'" plugin.')},A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorPriorityExists,n=t.errorPriorityNaN,r=new Map;return e=Object(l.isFunction)(e)?e:m,n=Object(l.isFunction)(n)?n:w,{addItem:function(t,l){if(!Object(o.isNumeric)(t))throw new Error(n(t));if(r.has(t))throw new Error(e(t));r.set(t,l)},getItems:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,e=f(v.get(t)||v.get(y),2),n=e[0],o=e[1];return c(r).sort((function(a,b){return a[0]<b[0]?n:o})).map((function(t){return t[1]}))}}}({errorPriorityExists:function(t){return'There is already registered plugin on priority "'.concat(t,'".')},errorPriorityNaN:function(t){return'The priority "'.concat(t,'" is not a number.')}}),M=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).errorItemExists,e=new Set;return t=Object(l.isFunction)(t)?t:E,{addItem:function(n){if(e.has(n))throw new Error(t(n));e.add(n)},clear:function(){e.clear()},getItems:function(){return S(e)}}}({errorItemExists:P}),_=Object(O.a)({errorIdExists:P});function x(){return[].concat(k(A.getItems()),k(M.getItems()))}function I(t){var e=Object(r.toUpperCaseFirst)(t);return _.getItem(e)}function N(t){return!!I(t)}function H(t,e,n){var o=function(t,e,n){"function"==typeof t&&(t=(e=t).PLUGIN_KEY,n=e.PLUGIN_PRIORITY);return[t,e,n]}(t,e,n),l=R(o,3);t=l[0],e=l[1],n=l[2],void 0===I(t)&&function(t,e,n){var o=Object(r.toUpperCaseFirst)(t);if(_.hasItem(o))throw new Error(P(o));void 0===n?M.addItem(o):A.addItem(n,o);_.addItem(o,e)}(t,e,n)}},732:function(t,e,n){"use strict";n.r(e),n.d(e,"spreadsheetColumnLabel",(function(){return f})),n.d(e,"spreadsheetColumnIndex",(function(){return h})),n.d(e,"createSpreadsheetData",(function(){return d})),n.d(e,"createSpreadsheetObjectData",(function(){return y})),n.d(e,"createEmptySpreadsheetData",(function(){return v})),n.d(e,"dataRowToChangesArray",(function(){return m})),n.d(e,"countFirstRowKeys",(function(){return w})),n.d(e,"isArrayOfArrays",(function(){return O})),n.d(e,"isArrayOfObjects",(function(){return S}));n(6),n(12),n(14),n(11),n(62),n(74),n(239),n(40),n(44);var r=n(664);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=l.length;function f(t){for(var e,n=t+1,r="";n>0;)e=(n-1)%c,r=String.fromCharCode(65+e)+r,n=parseInt((n-e)/c,10);return r}function h(label){var t=0;if(label)for(var i=0,e=label.length-1;i<label.length;i+=1,e-=1)t+=Math.pow(c,e)*(l.indexOf(label[i])+1);return t-=1}function d(){var i,t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[];for(i=0;i<e;i++){var o=[];for(t=0;t<n;t++)o.push(f(t)+(i+1));r.push(o)}return r}function y(){var i,t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[];for(i=0;i<e;i++){var o={};for(t=0;t<n;t++)o["prop".concat(t)]=f(t)+(i+1);r.push(o)}return r}function v(t,e){for(var n,data=[],i=0;i<t;i++){n=[];for(var r=0;r<e;r++)n.push("");data.push(n)}return data}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t,r=[];return Array.isArray(t)&&Array.isArray(t[0])||(n=[t]),n.forEach((function(t,n){Array.isArray(t)?t.forEach((function(t,o){r.push([n+e,o,t])})):Object.keys(t).forEach((function(o){r.push([n+e,o,t[o]])}))})),r}function w(data){var t=0;return Array.isArray(data)&&(data[0]&&Array.isArray(data[0])?t=data[0].length:data[0]&&Object(r.isObject)(data[0])&&(t=Object(r.deepObjectSize)(data[0]))),t}function O(data){return!!(Array.isArray(data)&&data.length&&data.every((function(t){return Array.isArray(t)})))}function S(data){return!!(Array.isArray(data)&&data.length&&data.every((function(t){return"object"===o(t)&&!Array.isArray(t)&&null!==t})))}},733:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return l})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return f})),n.d(e,"d",(function(){return h}));var r="active-header",o="area",l="cell",c="fill",f="header",h="custom-selection"},765:function(t,e,n){"use strict";var r=n(7),o=n(22),l=n(142),c=o([].reverse),f=[1,2];r({target:"Array",proto:!0,forced:String(f)===String(f.reverse())},{reverse:function(){return l(this)&&(this.length=this.length),c(this)}})},766:function(t,e,n){"use strict";n.d(e,"b",(function(){return w})),n.d(e,"a",(function(){return O}));n(48),n(63),n(239),n(6),n(40),n(307),n(44),n(656),n(657),n(11),n(62),n(26),n(74),n(55),n(33),n(56),n(34);var r=n(728),o=n(691),l=n(666),c=n(693),f=n(683),h=n(673);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function m(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==d(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===d(o)?o:String(o)),n)}var r,o}var w="editorManager.navigation",O="editorManager.handlingEditor",S=function(){function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.tableMeta=n,this.selection=r,this.eventManager=new f.a(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(t){return o.onAfterDocumentKeyDown(t)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(t){!o.destroyed&&o.instance.isListening()&&o.openEditor("",t)})),this.instance.view._wt.update("onCellDblClick",(function(t,e,n){return o.onCellDblClick(t,e,n)}))}var e,n,d;return e=t,n=[{key:"registerShortcuts",value:function(){var t=this,e=this.instance.getShortcutManager(),n=e.getContext("grid"),r=e.getContext("editor"),l={group:O};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){t.closeEditorAndSaveChanges(e.isCtrlPressed()),t.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){t.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),t.activeEditor.focus()}}],l),n.addShortcuts([{keys:[["F2"]],callback:function(e){t.openEditor(null,e,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){t.instance.emptySelectedCells(),t.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(e,n){t.instance.getSettings().enterBeginsEditing?t.cellProperties.readOnly?t.moveSelectionAfterEnter():t.openEditor(null,e,!0):t.moveSelectionAfterEnter(n.includes("shift")),Object(o.stopImmediatePropagation)(e)}}],l)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(e){e&&t.prepareEditor()}));else{var e=this.instance.getSelectedRangeLast().highlight,n=e.row,col=e.col,r=this.instance.runHooks("modifyGetCellCoords",n,col),o=n,f=col;if(Array.isArray(r)){var h=y(r,2);o=h[0],f=h[1]}this.cellProperties=this.instance.getCellMeta(o,f);var d=this.instance.rootDocument.activeElement;if(d&&Object(l.isOutsideInput)(d)&&d.blur(),this.isCellEditable()){var td=this.instance.getCell(n,col,!0);if(td){var v=this.instance.getCellEditor(this.cellProperties),m=this.instance.colToProp(f),w=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(o),f);this.activeEditor=Object(c.b)(v,this.instance),this.activeEditor.prepare(n,col,m,td,w,this.cellProperties)}}else this.clearActiveEditor()}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){if(!this.activeEditor){var r=this.instance.getSelectedRangeLast().highlight,o=r.row,col=r.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),c=this.instance.columnIndexMapper.getRenderableFromVisualIndex(col);this.instance.view.scrollViewport(this.instance._createCellCoords(l,c)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}else this.clearActiveEditor()}},{key:"closeEditor",value:function(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){this.closeEditor(!0,t)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var t=this.instance.getCellEditor(this.cellProperties),e=this.instance.getSelectedRangeLast().highlight,n=e.row,col=e.col,r=this.instance,o=r.rowIndexMapper,l=r.columnIndexMapper,c=o.isHidden(this.instance.toPhysicalRow(n))||l.isHidden(this.instance.toPhysicalColumn(col));return!(this.cellProperties.readOnly||!t||c)}},{key:"moveSelectionAfterEnter",value:function(t){var e="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(t){var e=this;if(this.instance.isListening()){var n=t.keyCode;if(this.selection.isSelected()){var o=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(Object(r.isFunctionKey)(n)||Object(r.isCtrlMetaKey)(n)||o||this.isEditorOpened())){var l=this.instance.getShortcutManager().getContext("editor"),c={runOnlyIf:function(){return Object(h.isDefined)(e.instance.getSelected())},group:w};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){e.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){e.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){e.instance.selection.transformStart(0,-1*e.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){e.instance.selection.transformStart(0,e.instance.getDirectionFactor())}}],c),this.openEditor("",t)}}}}},{key:"onCellDblClick",value:function(t,e,n){"TD"===n.nodeName&&this.openEditor(null,t,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}],n&&m(e.prototype,n),d&&m(e,d),Object.defineProperty(e,"prototype",{writable:!1}),t}(),C=new WeakMap;S.getInstance=function(t,e,n){var r=C.get(t);return r||(r=new S(t,e,n),C.set(t,r)),r},e.c=S},767:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f}));n(36),n(55),n(48),n(63),n(11),n(62),n(6),n(74),n(239),n(40),n(44),n(56),n(33),n(34);var r=n(665);function o(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function c(t,e,n){return[].concat(o(t.slice(0,e)),o(n),o(t.slice(e)))}function f(t,e){return Object(r.arrayFilter)(t,(function(t){return!1===e.includes(t)}))}},768:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));n(55),n(656),n(657),n(11),n(62),n(6),n(26),n(74),n(239),n(40),n(44);var r=n(677),o=n(664),l=n(685),c=n(716);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==f(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===f(o)?o:String(o)),n)}var r,o}var d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.indexedValues=[],this.initValueOrFn=e}var e,n,o;return e=t,n=[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(t){var e=this.indexedValues;if(t<e.length)return e[t]}},{key:"setValues",value:function(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Object(l.isFunction)(this.initValueOrFn)?Object(r.rangeEach)(e-1,(function(e){return t.indexedValues.push(t.initValueOrFn(e))})):Object(r.rangeEach)(e-1,(function(){return t.indexedValues.push(t.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}],n&&h(e.prototype,n),o&&h(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(o.mixin)(d,c.a)},769:function(t,e,n){"use strict";n.r(e),n.d(e,"instanceToHTML",(function(){return h})),n.d(e,"_dataToHTML",(function(){return d})),n.d(e,"htmlToGridSettings",(function(){return y}));n(245),n(34),n(86),n(115),n(84),n(14),n(64),n(6),n(36),n(196),n(165),n(943),n(791),n(56),n(40),n(13),n(195),n(48),n(63),n(11),n(62),n(74),n(239),n(44),n(55),n(33);var r=n(673);function o(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var c={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},f=new RegExp(Object.keys(c).map((function(t){return"(".concat(t,")")})).join("|"),"gi");function h(t){for(var e=t.hasColHeaders(),n=t.hasRowHeaders(),o=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],data=t.getData.apply(t,o),l=data.length,c=l>0?data[0].length:0,f=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],y=n?1:0,v=e?1:0,m=0;m<l;m+=1){for(var w=e&&0===m,O=[],S=0;S<c;S+=1){var C=!w&&n&&0===S,E="";if(w)E="<th>".concat(t.getColHeader(S-y),"</th>");else if(C)E="<th>".concat(t.getRowHeader(m-v),"</th>");else{var R=data[m][S],k=t.getCellMeta(m-v,S-y),j=k.hidden,T=k.rowspan,P=k.colspan;if(!j){var A=[];if(T&&A.push('rowspan="'.concat(T,'"')),P&&A.push('colspan="'.concat(P,'"')),Object(r.isEmpty)(R))E="<td ".concat(A.join(" "),"></td>");else{var M=R.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");E="<td ".concat(A.join(" "),">").concat(M,"</td>")}}}O.push(E)}var _=["<tr>"].concat(O,["</tr>"]).join("");w?h.splice(1,0,_):d.splice(-1,0,_)}return f.splice(1,0,h.join(""),d.join("")),f.join("")}function d(input){for(var t=input.length,e=["<table>"],n=0;n<t;n+=1){var o=input[n],l=o.length,c=[];0===n&&e.push("<tbody>");for(var f=0;f<l;f+=1){var h=o[f],d=Object(r.isEmpty)(h)?"":h.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");c.push("<td>".concat(d,"</td>"))}e.push.apply(e,["<tr>"].concat(c,["</tr>"])),n+1===t&&e.push("</tbody>")}return e.push("</table>"),e.join("")}function y(element){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,e={},n=t.createDocumentFragment(),r=t.createElement("div");n.appendChild(r);var l=element;if("string"==typeof l){var h=l.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(t){var e=t.match(/<td\b[^>]*?>/g)[0],n=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(e).concat(n).concat("</td>")}));r.insertAdjacentHTML("afterbegin","".concat(h)),l=r.querySelector("table")}if(l&&function(element){return"TABLE"===(element&&element.nodeName||"")}(l)){var d,y=r.querySelector('meta[name$="enerator"]'),v=null!==l.querySelector("tbody th"),m=l.querySelector("tr"),w=m?Array.from(m.cells).reduce((function(t,e){return t+e.colSpan}),0)-(v?1:0):0,O=l.tFoot&&Array.from(l.tFoot.rows)||[],S=[],C=!1,E=0;if(l.tHead){var R=Array.from(l.tHead.rows).filter((function(tr){var t=null!==tr.querySelector("td");return t&&S.push(tr),!t}));C=(E=R.length)>0,E>1?e.nestedHeaders=Array.from(R).reduce((function(t,e){var n=Array.from(e.cells).reduce((function(t,header,e){if(v&&0===e)return t;var n=header.colSpan,r=header.innerHTML,o=n>1?{label:r,colspan:n}:r;return t.push(o),t}),[]);return t.push(n),t}),[]):C&&(e.colHeaders=Array.from(R[0].children).reduce((function(t,header,e){return v&&0===e||t.push(header.innerHTML),t}),[]))}S.length&&(e.fixedRowsTop=S.length),O.length&&(e.fixedRowsBottom=O.length);var k=[].concat(S,o(Array.from(l.tBodies).reduce((function(t,section){return t.push.apply(t,o(Array.from(section.rows))),t}),[])),o(O));d=k.length;for(var j=new Array(d),T=0;T<d;T++)j[T]=new Array(w);for(var P=[],A=[],M=0;M<d;M++)for(var tr=k[M],_=Array.from(tr.cells),x=_.length,I=0;I<x;I++){var N=_[I],H=N.nodeName,D=N.innerHTML,L=N.rowSpan,B=N.colSpan,col=j[M].findIndex((function(t){return void 0===t}));if("TD"===H){if(L>1||B>1){for(var F=M;F<M+L;F++)if(F<d)for(var V=col;V<col+B;V++)j[F][V]=null;var W=N.getAttribute("style");W&&W.includes("mso-ignore:colspan")||P.push({col:col,row:M,rowspan:L,colspan:B})}var U="";U=y&&/excel/gi.test(y.content)?D.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):D.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),j[M][col]=U.replace(f,(function(t){return c[t]}))}else A.push(D)}return P.length&&(e.mergeCells=P),A.length&&(e.rowHeaders=A),j.length&&(e.data=j),e}}},770:function(t,e,n){"use strict";n(6),n(12),n(85),n(656),n(657),n(11),n(62),n(26),n(74),n(239),n(40),n(44),n(55),n(33),n(56),n(34);var r=n(666),o=n(665);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}var e,n,l;return e=t,n=[{key:"addRow",value:function(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){var e=this.hot.getColHeader(0);if(null!=e){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),Object(o.arrayEach)(this.rows,(function(e){t(e.row,Object(r.outerHeight)(e.table)-1)}))}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),Object(o.arrayEach)(this.columns,(function(e){var n=e.table.getBoundingClientRect().width;t(e.col,Math.ceil(n))}))}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,e){this.settings||(this.settings={}),this.settings[t]=e}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){Object(o.arrayEach)(n.strings,(function(n){e.appendChild(t.createColElement(n.col))}))})),e}},{key:"createRow",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),th=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,th),r.appendChild(th)),this.samples.forEach((function(l){Object(o.arrayEach)(l.strings,(function(o){var l=o.col,c=e.hot.getCellMeta(t,l);c.col=l,c.row=t;var f=e.hot.getCellRenderer(c),td=n.createElement("td");td.setAttribute("ghost-table",1),f(e.hot,td,t,l,e.hot.colToProp(l),o.value,c),r.appendChild(td)}))})),r}},{key:"appendColumnHeadersRow",value:function(){var t=this,e=this.hot.rootDocument,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){var th=e.createElement("th");r.push([-1,th]),n.appendChild(th)}this.samples.forEach((function(t){Object(o.arrayEach)(t.strings,(function(t){var o=t.col,th=e.createElement("th");r.push([o,th]),n.appendChild(th)}))})),this.table.tHead.appendChild(n),Object(o.arrayEach)(r,(function(e){var n=c(e,2),r=n[0],th=n[1];t.hot.view.appendColHeader(r,th)}))}},{key:"createCol",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(l){Object(o.arrayEach)(l.strings,(function(o){var l=o.row,c=e.hot.getCellMeta(l,t);c.col=t,c.row=l;var f=e.hot.getCellRenderer(c),td=n.createElement("td"),tr=n.createElement("tr");td.setAttribute("ghost-table",1),f(e.hot,td,l,t,e.hot.colToProp(t),o.value,c),tr.appendChild(td),r.appendChild(tr)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var col=this.hot.rootDocument.createElement("col");return col.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(t),"px"),col}},{key:"createTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),table=e.createElement("table"),o=e.createElement("thead"),l=e.createElement("tbody"),c=e.createElement("colgroup"),tr=e.createElement("tr"),th=e.createElement("th");return this.isVertical()&&table.appendChild(c),this.isHorizontal()&&(tr.appendChild(th),o.appendChild(tr),table.style.tableLayout="auto",table.style.width="auto"),table.appendChild(o),this.isVertical()&&l.appendChild(tr),table.appendChild(l),Object(r.addClass)(table,t),n.appendChild(table),{fragment:n,table:table,tHead:o,tBody:l,colGroup:c,tr:tr,th:th}}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),o=e.createElement("div"),l="htGhostTable htAutoSize ".concat(t.trim());return Object(r.addClass)(o,l),n.appendChild(o),{fragment:n,container:o}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}],n&&h(e.prototype,n),l&&h(e,l),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=d},787:function(t,e,n){"use strict";var r=n(861),o=n(818),l=n(941),c=n(688),f=n(871),h=n(723),d=n(1059),y=n(1008),v=n(821),m=n(852);function w(t,e){var n=new r.a(t,e||{},o.d);return n.init(),n}Object(h.d)(d.a),w.editors={BaseEditor:y.a},w.Core=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new r.a(t,e,o.d)},w.DefaultSettings=Object(l.a)(),w.hooks=c.a.getSingleton(),w.CellCoords=v.a,w.CellRange=m.a,w.packageName="handsontable",w.buildDate="06/02/2023 12:34:58",w.version="12.3.1",w.languages={dictionaryKeys:f.a,getLanguageDictionary:f.b,getLanguagesDictionaries:f.c,registerLanguageDictionary:f.g,getTranslatedPhrase:f.d},e.a=w},788:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));n(239),n(242),n(6),n(40),n(44),n(102),n(11),n(62),n(74),n(55),n(33),n(56),n(34);var r=n(685);function o(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||c(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var h=function(t){return"The id '".concat(t,"' is already declared in a map.")};function d(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).errorIdExists,e=new Map;function n(){return o(e)}function c(t){return e.has(t)}return t=Object(r.isFunction)(t)?t:h,{addItem:function(n,r){if(c(n))throw new Error(t(n));e.set(n,r)},clear:function(){e.clear()},getId:function(t){var e=n().find((function(e){var n=l(e,2),r=n[0],element=n[1];return t===element&&r}))||[null];return l(e,1)[0]},getItem:function(t){return e.get(t)},getItems:n,hasItem:c,removeItem:function(t){return e.delete(t)}}}},789:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return l}));n(13),n(6);var r=n(665);function o(t,e){return Object(r.arrayMap)(t,(function(t){return t-e.filter((function(e){return e<t})).length}))}function l(t,e){var n=e[0],o=e.length;return Object(r.arrayMap)(t,(function(t){return t>=n?t+o:t}))}},790:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));n(419),n(420),n(6),n(130),n(670),n(16),n(656),n(657),n(11),n(62),n(26),n(74),n(239),n(40),n(44);var r=n(768),o=n(819);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=y(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},f.apply(this,arguments)}function h(t,p){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},h(t,p)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(v,t);var e,n,r,l=d(v);function v(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),l.apply(this,arguments)}return e=v,(n=[{key:"insert",value:function(t,e){this.indexedValues=Object(o.a)(this.indexedValues,t,e,this.initValueOrFn),f(y(v.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Object(o.b)(this.indexedValues,t),f(y(v.prototype),"remove",this).call(this,t)}}])&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),v}(r.a)},791:function(t,e,n){"use strict";var r=n(7),o=n(945).left,l=n(247),c=n(166);r({target:"Array",proto:!0,forced:!n(205)&&c>79&&c<83||!l("reduce")},{reduce:function(t){var e=arguments.length;return o(this,t,e,e>1?arguments[1]:void 0)}})},792:function(t,e,n){"use strict";function r(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}n.r(e),n.d(e,"getNormalizedDate",(function(){return r}))},793:function(t,e,n){n(949)},817:function(t,e,n){"use strict";n(313)("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(428))},818:function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f}));n(239),n(6),n(40),n(307),n(44),n(11),n(62);var r=new WeakMap,o=Symbol("rootInstance");function l(object){r.set(object,!0)}function c(t){return t===o}function f(object){return r.has(object)}},819:function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return h}));n(36),n(55),n(84),n(48),n(63),n(11),n(62),n(6),n(74),n(239),n(40),n(44),n(56),n(33),n(34);var r=n(685),o=n(665);function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function f(t,e,n,o){var c=n.length?n[0]:void 0;return[].concat(l(t.slice(0,c)),l(n.map((function(t,e){return Object(r.isFunction)(o)?o(t,e):o}))),l(void 0===c?[]:t.slice(c)))}function h(t,e){return Object(o.arrayFilter)(t,(function(t,n){return!1===e.includes(n)}))}},820:function(t,e,n){"use strict";n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return y})),n.d(e,"c",(function(){return E})),n.d(e,"e",(function(){return R})),n.d(e,"f",(function(){return k})),n.d(e,"g",(function(){return j})),n.d(e,"d",(function(){return T}));n(11),n(62),n(6),n(48),n(63),n(239),n(682),n(40),n(44),n(56),n(309),n(74),n(55),n(33),n(34);var r=n(852),o=n(665),l=n(673);function c(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}var d=0,y=1,v=2,m=3,w=[m,v],O=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],S=Symbol("root"),C=Symbol("child");function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;if(e!==S&&e!==C)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(t),o=e===S,l=d;if(n){var c=t[0];if(0===t.length)l=y;else if(o&&c instanceof r.a)l=m;else if(o&&Array.isArray(c))l=E(c,C);else if(t.length>=2&&t.length<=4){!t.some((function(t,e){return!O[e].includes(h(t))}))&&(l=v)}}return l}function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.keepDirection,r=void 0!==n&&n,o=e.propToCol;if(!w.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(e){var n=t===m,c=n?e.from.row:e[0],f=n?e.from.col:e[1],h=n?e.to.row:e[2],d=n?e.to.col:e[3];if("function"==typeof o&&("string"==typeof f&&(f=o(f)),"string"==typeof d&&(d=o(d))),Object(l.isUndefined)(h)&&(h=c),Object(l.isUndefined)(d)&&(d=f),!r){var y=c,v=f,w=h,O=d;c=Math.min(y,w),f=Math.min(v,O),h=Math.max(y,w),d=Math.max(v,O)}return[c,f,h,d]}}function k(t){var e=E(t);if(e===d||e===y)return[];var n=R(e),r=new Set;Object(o.arrayEach)(t,(function(t){var e=c(n(t),4),l=e[1],f=e[3],h=Math.max(l,0),d=f-h+1;Object(o.arrayEach)(Array.from(new Array(d),(function(t,i){return h+i})),(function(t){r.has(t)||r.add(t)}))}));var l=Array.from(r).sort((function(a,b){return a-b}));return Object(o.arrayReduce)(l,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[])}function j(t){var e=E(t);if(e===d||e===y)return[];var n=R(e),r=new Set;Object(o.arrayEach)(t,(function(t){var e=c(n(t),3),l=e[0],f=e[2],h=Math.max(l,0),d=f-h+1;Object(o.arrayEach)(Array.from(new Array(d),(function(t,i){return h+i})),(function(t){r.has(t)||r.add(t)}))}));var l=Array.from(r).sort((function(a,b){return a-b}));return Object(o.arrayReduce)(l,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[])}function T(t){return"number"==typeof t&&t>=0&&t<(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0)}},821:function(t,e,n){"use strict";n(239),n(6),n(40),n(307),n(44),n(656),n(657),n(11),n(62),n(26),n(74);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function l(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function c(t,e,n){return(e=f(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){var e=function(input,t){if("object"!==r(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===r(e)?e:String(e)}function h(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,y(t,e,"get"))}function d(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,y(t,e,"set"),n),n}function y(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var v=new WeakMap,m=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"row",null),c(this,"col",null),l(this,v,{writable:!0,value:!1}),d(this,v,r),void 0!==e&&void 0!==n&&(this.row=e,this.col=n)}var e,n,r;return e=t,(n=[{key:"isValid",value:function(t){return!(this.row<0||this.col<0||this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&(h(this,v)?this.col<=t.col:this.col>=t.col)}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&(h(this,v)?this.col>=t.col:this.col<=t.col)}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&(h(this,v)?this.col>=t.col:this.col<=t.col)}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&(h(this,v)?this.col<=t.col:this.col>=t.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,h(this,v))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&o(e.prototype,n),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=m},847:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return y}));n(36),n(34),n(55),n(244);var r,o=n(673),l=n(664),c=n(695),f=n(690);function h(t,e){return Object(l.objectEach)(e,(function(e,n){Object(o.isUndefined)(t[n])&&(t[n]=e)})),t}function d(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?"".concat(e[1].toLowerCase(),"-").concat(e[2].toUpperCase()):t}function y(t){var e,n;Object(o.isDefined)(t)&&Object(c.a)(Object(f.a)(r||(e=['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],(n=['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])||(n=e.slice(0)),r=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))),t))}},848:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));n(419),n(420),n(6),n(130),n(670),n(16),n(656),n(657),n(11),n(62),n(26),n(74),n(239),n(40),n(44);var r=n(768),o=n(767),l=n(789);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==c(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===c(o)?o:String(o)),n)}var r,o}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=v(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},h.apply(this,arguments)}function d(t,p){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},d(t,p)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v(t);if(e){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(m,t);var e,n,r,c=y(m);function m(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),c.call(this,(function(t){return t}))}return e=m,(n=[{key:"insert",value:function(t,e){var n=Object(l.b)(this.indexedValues,e);this.indexedValues=Object(o.a)(n,t,e),h(v(m.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){var e=Object(o.b)(this.indexedValues,t);this.indexedValues=Object(l.a)(e,t),h(v(m.prototype),"remove",this).call(this,t)}}])&&f(e.prototype,n),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),m}(r.a)},849:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));n(419),n(420),n(6),n(130),n(656),n(657),n(11),n(62),n(26),n(74),n(239),n(40),n(44);var r=n(790),o=n(665);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}function f(t,p){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},f(t,p)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(d,t);var e,n,r,l=h(d);function d(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),l.call(this,t)}return e=d,(n=[{key:"getHiddenIndexes",value:function(){return Object(o.arrayReduce)(this.getValues(),(function(t,e,n){return e&&t.push(n),t}),[])}}])&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),d}(r.a)},850:function(t,e,n){"use strict";n.d(e,"a",(function(){return R}));n(36),n(84),n(239),n(6),n(44),n(48),n(63),n(196),n(656),n(657),n(11),n(62),n(26),n(419),n(420),n(130),n(670),n(16),n(74),n(40),n(56),n(55),n(33),n(34);var r=n(768),o=n(819),l=n(767),c=n(789),f=n(685);function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function d(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function v(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=C(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},m.apply(this,arguments)}function w(t,p){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},w(t,p)}function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=C(t);if(e){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}(this,n)}}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(t){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},C(t)}function E(t){var e=function(input,t){if("object"!==h(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===h(e)?e:String(e)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}(y,t);var e,n,r,h=O(y);function y(){var t,e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return t=h.call.apply(h,[this].concat(l)),e=S(t),r=[],(n=E(n="orderOfIndexes"))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return e=y,n=[{key:"getValues",value:function(){var t=this;return this.orderOfIndexes.map((function(e){return t.indexedValues[e]}))}},{key:"setValues",value:function(t){this.orderOfIndexes=d(Array(t.length).keys()),m(C(y.prototype),"setValues",this).call(this,t)}},{key:"setValueAtIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(n,0,t),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(t){this.orderOfIndexes=Object(l.b)(this.orderOfIndexes,[t]),Object(f.isFunction)(this.initValueOrFn)?m(C(y.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn(t)):m(C(y.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,m(C(y.prototype),"setDefaultValues",this).call(this,t)}},{key:"insert",value:function(t,e){this.indexedValues=Object(o.a)(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=Object(c.b)(this.orderOfIndexes,e),m(C(y.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Object(o.b)(this.indexedValues,t),this.orderOfIndexes=Object(l.b)(this.orderOfIndexes,t),this.orderOfIndexes=Object(c.a)(this.orderOfIndexes,t),m(C(y.prototype),"remove",this).call(this,t)}},{key:"getEntries",value:function(){var t=this;return this.orderOfIndexes.map((function(e){return[e,t.getValueAtIndex(e)]}))}}],n&&v(e.prototype,n),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),y}(r.a)},851:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));n(419),n(420),n(6),n(130),n(656),n(657),n(11),n(62),n(26),n(74),n(239),n(40),n(44);var r=n(790),o=n(665);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==l(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===l(o)?o:String(o)),n)}var r,o}function f(t,p){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},f(t,p)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(d,t);var e,n,r,l=h(d);function d(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),l.call(this,t)}return e=d,(n=[{key:"getTrimmedIndexes",value:function(){return Object(o.arrayReduce)(this.getValues(),(function(t,e,n){return e&&t.push(n),t}),[])}}])&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),d}(r.a)},852:function(t,e,n){"use strict";n(48),n(63),n(669),n(239),n(6),n(40),n(307),n(44),n(656),n(657),n(11),n(62),n(26),n(74);var r=n(821);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function c(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function f(t,e,n){return(e=h(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t){var e=function(input,t){if("object"!==o(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===o(e)?e:String(e)}function d(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,v(t,e,"get"))}function y(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,v(t,e,"set"),n),n}function v(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var m=new WeakMap,w=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,"highlight",null),f(this,"from",null),f(this,"to",null),c(this,m,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=n.clone(),this.to=r.clone(),y(this,m,o)}var e,n,o;return e=t,(n=[{key:"setHighlight",value:function(t){return this.highlight=t.clone().normalize(),this}},{key:"setFrom",value:function(t){return this.from=t.clone(),this}},{key:"setTo",value:function(t){return this.to=t.clone(),this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(t){var e=t.row,col=t.col,n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return n.row<=e&&r.row>=e&&n.col<=col&&r.col>=col}},{key:"includesRange",value:function(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=t.getOuterTopStartCorner(),l=t.getOuterBottomEndCorner(),c=Math.min(e.row,o.row),f=Math.min(e.col,o.col),h=Math.max(n.row,l.row),d=Math.max(n.col,l.col),y=this._createCellCoords(c,f),v=this._createCellCoords(h,d);return this.from=y,this.to=v,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return d(this,m)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return d(this,m)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return d(this,m)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return d(this,m)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return d(this,m)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return d(this,m)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return d(this,m)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return d(this,m)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(e.from.row,e.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(e.from.row,e.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(e.to.row,e.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(e.to.row,e.to.col))))||t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof r.a))return!1;if(e){var n=e.from,o=e.to;if(e.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}return t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),l=Math.min(t.from.row,t.to.row),c=Math.max(t.from.row,t.to.row),f=Math.min(t.from.col,t.to.col),h=Math.max(t.from.col,t.to.col),d=[];return e===l&&d.push("top"),o===h&&d.push("right"),n===c&&d.push("bottom"),r===f&&d.push("left"),d}},{key:"getInner",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)t.row===r&&t.col===o?n.push(t):e.row===r&&e.col===o?n.push(e):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(t){for(var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++)if(!1===t(r,o))return}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to,d(this,m))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(t,e){return new r.a(t,e,d(this,m))}}])&&l(e.prototype,n),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=w},853:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));var r=1,o=2},861:function(t,e,n){"use strict";n.d(e,"a",(function(){return Ys}));n(11),n(62),n(74),n(33),n(244),n(239),n(6),n(682),n(40),n(44),n(48),n(309),n(196),n(696),n(26),n(55),n(36),n(422),n(84),n(34),n(64),n(56),n(669),n(765),n(12),n(54),n(938),n(242);var r=n(666),o=n(685),l=n(673),c=n(715),f=n(695),h=n(690),d=n(766),y=n(683),object=n(664),v=n(665),m=n(769),w=n(731),O=n(724),S=n(693),C=n(725),E=n(700),R=n(677),k=(n(307),n(656),n(657),n(691)),j=(n(419),n(420),n(130),n(727));function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function P(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==T(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===T(o)?o:String(o)),n)}var r,o}var A=new WeakMap,M=function(){function t(e,n,r,o,l,c){var f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wtSettings=r,this.domBindings=n,this.wtTable=l,this.selections=c,this.parent=f,this.eventManager=o,this.facadeGetter=e,A.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var e,n,f;return e=t,(n=[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(e){return t.onContextMenu(e)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(e){return t.onMouseOut(e)}));var e=function(){t.eventManager.addEventListener(t.wtTable.holder,"touchstart",(function(e){return t.onTouchStart(e)})),t.eventManager.addEventListener(t.wtTable.holder,"touchend",(function(e){return t.onTouchEnd(e)})),t.momentumScrolling||(t.momentumScrolling={}),t.eventManager.addEventListener(t.wtTable.holder,"scroll",(function(){clearTimeout(t.momentumScrolling._timeout),t.momentumScrolling.ongoing||t.wtSettings.getSetting("onBeforeTouchScroll"),t.momentumScrolling.ongoing=!0,t.momentumScrolling._timeout=setTimeout((function(){t.touchApplied||(t.momentumScrolling.ongoing=!1,t.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))};Object(c.isMobileBrowser)()?e():(Object(j.isTouchSupported)()&&e(),t.eventManager.addEventListener(t.wtTable.holder,"mouseup",(function(e){return t.onMouseUp(e)})),t.eventManager.addEventListener(t.wtTable.holder,"mousedown",(function(e){return t.onMouseDown(e)})))}},{key:"selectedCellWasTouched",value:function(t){var e=A.get(this),n=this.parentCell(t).coords;if(e.selectedCellBeforeTouchEnd&&n){var r=[n.row,e.selectedCellBeforeTouchEnd.from.row],o=r[0],l=r[1],c=[n.col,e.selectedCellBeforeTouchEnd.from.col];return o===l&&c[0]===c[1]}return!1}},{key:"parentCell",value:function(t){var e={},n=this.wtTable.TABLE,o=Object(r.closestDown)(t,["TD","TH"],n);return o?(e.coords=this.wtTable.getCoords(o),e.TD=o):Object(r.hasClass)(t,"wtBorder")&&Object(r.hasClass)(t,"current")?(e.coords=this.selections.getCell().cellRange.highlight,e.TD=this.wtTable.getCell(e.coords)):Object(r.hasClass)(t,"wtBorder")&&Object(r.hasClass)(t,"area")&&this.selections.createOrGetArea().cellRange&&(e.coords=this.selections.createOrGetArea().cellRange.to,e.TD=this.wtTable.getCell(e.coords)),e}},{key:"onMouseDown",value:function(t){var e=A.get(this),n=this.domBindings.rootDocument.activeElement,l=Object(o.partial)(r.getParent,t.target),c=t.target;if(c!==n&&l(0)!==n&&l(1)!==n){var f=this.parentCell(c);Object(r.hasClass)(c,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",t,c):f.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,f.coords,f.TD),(0===t.button||this.touchApplied)&&f.TD&&(e.dblClickOrigin[0]=f.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout((function(){e.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(t){if(this.wtSettings.has("onCellContextMenu")){var e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}},{key:"onMouseOver",value:function(t){if(this.wtSettings.has("onCellMouseOver")){var table=this.wtTable.TABLE,td=Object(r.closestDown)(t.target,["TD","TH"],table),e=this.parent||this;td&&td!==e.lastMouseOver&&Object(r.isChildOf)(td,table)&&(e.lastMouseOver=td,this.callListener("onCellMouseOver",t,this.wtTable.getCoords(td),td))}}},{key:"onMouseOut",value:function(t){if(this.wtSettings.has("onCellMouseOut")){var table=this.wtTable.TABLE,e=Object(r.closestDown)(t.target,["TD","TH"],table),n=Object(r.closestDown)(t.relatedTarget,["TD","TH"],table);e&&e!==n&&Object(r.isChildOf)(e,table)&&this.callListener("onCellMouseOut",t,this.wtTable.getCoords(e),e)}}},{key:"onMouseUp",value:function(t){var e=A.get(this),n=this.parentCell(t.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,n.coords,n.TD),(0===t.button||this.touchApplied)&&(n.TD===e.dblClickOrigin[0]&&n.TD===e.dblClickOrigin[1]?(Object(r.hasClass)(t.target,"corner")?this.callListener("onCellCornerDblClick",t,n.coords,n.TD):this.callListener("onCellDblClick",t,n.coords,n.TD),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):n.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout((function(){e.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(t){A.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var e,n=t.target,r=null===(e=this.parentCell(n))||void 0===e?void 0:e.coords,o=Object(l.isDefined)(r)&&r.row>=0&&r.col>=0;t.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance")&&(Object(c.isIOS)()&&(Object(c.isChromeWebKit)()||Object(c.isFirefoxWebKit)())&&this.selectedCellWasTouched(n)&&!["A","BUTTON","INPUT"].includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()),this.onMouseUp(t),this.touchApplied=!1}},{key:"callListener",value:function(t,e,n,r){var o=this.wtSettings.getSettingPure(t);o&&o(e,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var t=A.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}])&&P(e.prototype,n),f&&P(e,f),Object.defineProperty(e,"prototype",{writable:!1}),t}(),_=M,x=n(728);function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function N(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==I(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===I(o)?o:String(o)),n)}var r,o}var H=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}var e,n,r;return e=t,(n=[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}])&&N(e.prototype,n),r&&N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function L(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==D(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===D(o)?o:String(o)),n)}var r,o}var B=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}var e,n,r;return e=t,(n=[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}])&&L(e.prototype,n),r&&L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),F=0;function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function W(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==V(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===V(o)?o:String(o)),n)}var r,o}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){this.currentSize=this.nextSize,this.nextSize=t}},{key:"setOffset",value:function(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}])&&W(e.prototype,n),r&&W(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function G(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==z(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===z(o)?o:String(o)),n)}var r,o}var Y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.size=new U,this.workingSpace=F,this.sharedSize=null}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){this.size.setSize(t)}},{key:"setOffset",value:function(t){this.size.setOffset(t)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof U}},{key:"isPlaceOn",value:function(t){return this.workingSpace===t}},{key:"append",value:function(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}},{key:"prepend",value:function(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}])&&G(e.prototype,n),r&&G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function K(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==X(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===X(o)?o:String(o)),n)}var r,o}var $=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootNode=e,this.nodesPool=n,this.sizeSet=new Y,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){return this.sizeSet.setSize(t),this}},{key:"setOffset",value:function(t){return this.sizeSet.setOffset(t),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}},{key:"getCurrentNode",value:function(){var t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}},{key:"getRenderedChildCount",value:function(){var t=this.rootNode,e=this.sizeSet,n=0;if(this.isSharedViewSet())for(var element=t.firstElementChild;element;){if(element.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(1))break;element=element.nextElementSibling}else n=t.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var t=this.rootNode,e=this.sizeSet,n=this.isSharedViewSet(),r=e.getViewSize().nextSize,o=this.getRenderedChildCount();o<r;){var l=this.nodesPool();!n||n&&e.isPlaceOn(2)?t.appendChild(l):t.insertBefore(l,t.firstChild),o+=1}for(var c=n&&e.isPlaceOn(1);o>r;)t.removeChild(c?t.firstChild:t.lastChild),o-=1}},{key:"render",value:function(){var t=this.rootNode,e=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(n+=e.sharedSize.nextSize);var r=t.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();t.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}])&&K(e.prototype,n),r&&K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function J(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Q(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Q(o)?o:String(o)),n)}var r,o}function Z(t,p){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Z(t,p)}function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=et(t);if(e){var o=et(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function et(t){return et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},et(t)}var nt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z(t,e)}(l,t);var e,n,r,o=tt(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return e=l,(n=[{key:"prependView",value:function(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}])&&J(e.prototype,n),r&&J(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}($);function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ot(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ot(o)?o:String(o)),n)}var r,o}var at=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodeType=e.toUpperCase()}var e,n,r;return e=t,(n=[{key:"setRootDocument",value:function(t){this.rootDocument=t}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&it(e.prototype,n),r&&it(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function st(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==lt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===lt(o)?o:String(o)),n)}var r,o}var ut=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodesPool="string"==typeof e?new at(e):null,this.nodeType=e,this.rootNode=n,this.table=null,this.renderedNodes=0}var e,n,r;return e=t,(n=[{key:"setTable",value:function(table){this.nodesPool&&this.nodesPool.setRootDocument(table.rootDocument),this.table=table}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}])&&st(e.prototype,n),r&&st(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function ft(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ct(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ct(o)?o:String(o)),n)}var r,o}function ht(t,p){return ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ht(t,p)}function pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=yt(t);if(e){var o=yt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function yt(t){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yt(t)}var bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ht(t,e)}(l,t);var e,n,r,o=pt(l);function l(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,"TH")).orderViews=new WeakMap,t.sourceRowIndex=0,t}return e=l,(n=[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new nt(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.rowHeaderFunctions,r=t.rowHeadersCount,o=t.rows,l=t.cells,c=0;c<e;c++){var f=this.table.renderedRowToSource(c),h=o.getRenderedNode(c);this.sourceRowIndex=f;var d=this.obtainOrderView(h),y=l.obtainOrderView(h);d.appendView(y).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<r;v++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),n[v](f,m,v)}d.end()}}}])&&ft(e.prototype,n),r&&ft(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ut);function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function mt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==vt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==vt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===vt(o)?o:String(o)),n)}var r,o}function gt(t,p){return gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},gt(t,p)}function wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ot(t);if(e){var o=Ot(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}var St=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gt(t,e)}(c,t);var e,n,o,l=wt(c);function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,null,t)}return e=c,(n=[{key:"adjust",value:function(){var t=this.table,e=t.columnHeadersCount,n=t.rowHeadersCount,o=this.rootNode.firstChild;if(e){for(var l=this.table.columnsToRender+n,i=0,c=e;i<c;i++){for((o=this.rootNode.childNodes[i])||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;this.renderedNodes<l;)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>l;)o.removeChild(o.lastChild),this.renderedNodes-=1}var f=this.rootNode.childNodes.length;if(f>e)for(var h=e;h<f;h++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&Object(r.empty)(o)}},{key:"render",value:function(){for(var t=this.table.columnHeadersCount,e=0;e<t;e+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,l=n.rowHeadersCount,c=this.rootNode.childNodes[e],f=-1*l;f<o;f+=1){var h=this.table.renderedColumnToSource(f),d=c.childNodes[f+l];d.className="",d.removeAttribute("style"),r[e](h,d,e)}}}])&&mt(e.prototype,n),o&&mt(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(ut);function Ct(t){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ct(t)}function Et(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ct(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ct(o)?o:String(o)),n)}var r,o}function Rt(t,p){return Rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Rt(t,p)}function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=jt(t);if(e){var o=jt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function jt(t){return jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jt(t)}var Tt,Pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rt(t,e)}(c,t);var e,n,o,l=kt(c);function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,null,t)}return e=c,(n=[{key:"adjust",value:function(){for(var t=this.table,e=t.columnsToRender+t.rowHeadersCount;this.renderedNodes<e;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>e;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var t=this.table,e=t.columnsToRender,n=t.rowHeadersCount,o=0;o<n;o++){var l=this.table.renderedColumnToSource(o),c=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[o].style.width="".concat(c,"px")}for(var f=0;f<e;f++){var h=this.table.renderedColumnToSource(f),d=this.table.columnUtils.getStretchedColumnWidth(h);this.rootNode.childNodes[f+n].style.width="".concat(d,"px")}var y=this.rootNode.firstChild;y&&Object(r.addClass)(y,"rowHeader")}}])&&Et(e.prototype,n),o&&Et(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(ut);function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Mt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==At(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==At(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===At(o)?o:String(o)),n)}var r,o}function _t(t,p){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},_t(t,p)}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=It(t);if(e){var o=It(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===At(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function It(t){return It=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},It(t)}var Nt=!1,Ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e)}(l,t);var e,n,r,o=xt(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,"TR",t)).orderView=new $(t,(function(t){return e.nodesPool.obtain(t)}),e.nodeType),e}return e=l,(n=[{key:"getRenderedNode",value:function(t){return this.orderView.getNode(t)}},{key:"render",value:function(){var t,e,n=this.table.rowsToRender;!Nt&&n>1e3&&(Nt=!0,Object(f.b)(Object(h.a)(Tt||(t=['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],(e=['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'])||(e=t.slice(0)),Tt=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}})))))),this.orderView.setSize(n).setOffset(this.table.renderedRowToSource(0)).start();for(var r=0;r<n;r++)this.orderView.render();this.orderView.end()}}])&&Mt(e.prototype,n),r&&Mt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(ut);function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Lt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Dt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Dt(o)?o:String(o)),n)}var r,o}function Bt(t,p){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Bt(t,p)}function Ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Vt(t);if(e){var o=Vt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Dt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Vt(t){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vt(t)}var Wt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bt(t,e)}(c,t);var e,n,o,l=Ft(c);function c(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(t=l.call(this,"TD")).orderViews=new WeakMap,t.sourceRowIndex=0,t}return e=c,(n=[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new nt(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.columnsToRender,o=t.rows,l=t.rowHeaders,c=0;c<e;c++){var f=this.table.renderedRowToSource(c),h=o.getRenderedNode(c);this.sourceRowIndex=f;var d=this.obtainOrderView(h),y=l.obtainOrderView(h);d.prependView(y).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<n;v++){d.render();var m=d.getCurrentNode(),w=this.table.renderedColumnToSource(v);Object(r.hasClass)(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),this.table.cellRenderer(f,w,m)}d.end()}}}])&&Lt(e.prototype,n),o&&Lt(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(ut);function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function zt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ut(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ut(o)?o:String(o)),n)}var r,o}var Gt=function(){function t(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).cellRenderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}var e,n,r;return e=t,n=[{key:"setAxisUtils",value:function(t,e){this.rowUtils=t,this.columnUtils=e}},{key:"setViewportSize",value:function(t,e){this.rowsToRender=t,this.columnsToRender=e}},{key:"setFilters",value:function(t,e){this.rowFilter=t,this.columnFilter=e}},{key:"setHeaderContentRenderers",value:function(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}},{key:"setRenderers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.rowHeaders,n=t.columnHeaders,r=t.colGroup,o=t.rows,l=t.cells;e.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),l.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=l}},{key:"renderedRowToSource",value:function(t){return this.rowFilter.renderedToSource(t)}},{key:"renderedColumnToSource",value:function(t){return this.columnFilter.renderedToSource(t)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var t=this.rowsToRender,e=this.rows,n=0;n<t;n++){var r=e.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),l=this.rowUtils.getHeight(o);r.firstChild.style.height=l?"".concat(l-1,"px"):""}}}}],n&&zt(e.prototype,n),r&&zt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Yt(t){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yt(t)}function Xt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Yt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Yt(o)?o:String(o)),n)}var r,o}var Kt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.TABLE,r=e.THEAD,o=e.COLGROUP,l=e.TBODY,c=e.rowUtils,f=e.columnUtils,h=e.cellRenderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=new Gt(n,{cellRenderer:h}),this.renderer.setRenderers({rowHeaders:new bt,columnHeaders:new St(r),colGroup:new Pt(o),rows:new Ht(l),cells:new Wt}),this.renderer.setAxisUtils(c,f)}var e,n,r;return e=t,(n=[{key:"setFilters",value:function(t,e){return this.renderer.setFilters(t,e),this}},{key:"setViewportSize",value:function(t,e){return this.renderer.setViewportSize(t,e),this}},{key:"setHeaderContentRenderers",value:function(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}])&&Xt(e.prototype,n),r&&Xt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function qt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==$t(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==$t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===$t(o)?o:String(o)),n)}var r,o}var Qt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataAccessObject=e,this.wtSettings=n,this.headerWidths=new Map}var e,n,o;return e=t,(n=[{key:"getWidth",value:function(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(t){var e=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(t);if(e){var r=e.getStretchedColumnWidth(t,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(t){var e=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getHeaderWidth",value:function(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}},{key:"calculateWidths",value:function(){var t=this.wtSettings,e=this.dataAccessObject,n=e.wtTable,o=e.wtViewport,l=e.cloneSource,c=l?l.wtTable.holder:n.holder,f=c.offsetHeight<c.scrollHeight?Object(r.getScrollbarWidth)():0,h=t.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-f),null!=(h=t.getSetting("onModifyRowHeaderWidth",h)))for(var d=t.getSetting("rowHeaders").length,y=t.getSetting("defaultColumnWidth"),v=0;v<d;v++){var m=Array.isArray(h)?h[v]:h;m=null==m?y:m,this.headerWidths.set(v,m)}}}])&&qt(e.prototype,n),o&&qt(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Zt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Jt(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Jt(o)?o:String(o)),n)}var r,o}var te=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataAccessObject=e,this.wtSettings=n}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t){var e=this.wtSettings.getSetting("rowHeight",t),n=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}}])&&Zt(e.prototype,n),r&&Zt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ee="top",ne="bottom",re="inline_start",oe="top_inline_start_corner",ie="bottom_inline_start_corner",ae=[ee,ne,re,oe,ie],le=new Map([[ee,"ht_clone_".concat(ee)],[ne,"ht_clone_".concat(ne)],[re,"ht_clone_".concat(re," ht_clone_left")],[oe,"ht_clone_".concat(oe," ht_clone_top_left_corner")],[ie,"ht_clone_".concat(ie," ht_clone_bottom_left_corner")]]);function se(t){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(t)}function ue(t){return function(t){if(Array.isArray(t))return he(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||fe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||fe(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(t,e){if(t){if("string"==typeof t)return he(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?he(t,e):void 0}}function he(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function de(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ye(n.key),n)}}function pe(t,e,n){return(e=ye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ye(t){var e=function(input,t){if("object"!==se(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===se(e)?e:String(e)}var be=function(){function t(e,n,o,l,c){var f=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),pe(this,"wtSettings",null),pe(this,"domBindings",void 0),pe(this,"TBODY",null),pe(this,"THEAD",null),pe(this,"COLGROUP",null),pe(this,"hasTableHeight",!0),pe(this,"hasTableWidth",!0),pe(this,"isTableVisible",!1),pe(this,"tableOffset",0),pe(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===c,this.name=c,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=l,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,Object(r.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var h=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return f._modifyRowHeaderWidth(h)})),this.rowUtils=new te(this.dataAccessObject,this.wtSettings),this.columnUtils=new Qt(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Kt({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}var e,n,l;return e=t,n=[{key:"is",value:function(t){return this.name===t}},{key:"fixTableDomTree",value:function(){var t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(table){var t,e=table.parentNode;return e&&e.nodeType===Node.ELEMENT_NODE&&Object(r.hasClass)(e,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",e&&e.insertBefore(t,table),t.appendChild(table)),t.style.position="relative",t}},{key:"createHider",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r.hasClass)(n,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(e,t),e.appendChild(t)),e}},{key:"createHolder",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r.hasClass)(n,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",n&&n.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),e.appendChild(t)),e}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wtSettings,n=this.dataAccessObject,o=n.wtOverlays,l=n.wtViewport,c=e.getSetting("totalRows"),f=e.getSetting("totalColumns"),h=e.getSetting("rowHeaders"),d=h.length,y=e.getSetting("columnHeaders"),v=y.length,m=!1,w=t;if(this.isMaster&&(this.holderOffset=Object(r.offset)(this.holder),w=l.createRenderCalculators(w),d&&!e.getSetting("fixedColumnsStart"))){var O=o.inlineStartOverlay.getScrollPosition(),S=this.correctHeaderWidth;this.correctHeaderWidth=0!==O,S!==this.correctHeaderWidth&&(w=!1)}if(this.isMaster&&(m=o.updateStateOfRendering()),w)this.isMaster&&l.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Object(r.offset)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var C=c>0?this.getFirstRenderedRow():0,E=f>0?this.getFirstRenderedColumn():0;this.rowFilter=new B(C,c,v),this.columnFilter=new H(E,f,d);var R,k=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var j={};this.wtSettings.getSetting("beforeDraw",!0,j),k=!0!==j.skipRender}if(k)if(this.tableRenderer.setHeaderContentRenderers(h,y),(this.is(ne)||this.is(ie))&&this.tableRenderer.setHeaderContentRenderers(h,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(R=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ne))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var T=Object(r.outerWidth)(this.hider),P=Object(r.outerWidth)(this.TABLE);0!==T&&P!==T&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),R!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ne)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}var A=!1;return this.isMaster&&(A=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(A=o.bottomOverlay.resetFixedPosition()||A),A=o.inlineStartOverlay.resetFixedPosition()||A,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),A?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(w),m&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(col){for(var t,e,n,o=this.columnFilter.renderedToSource(col),l=this.wtSettings.getSetting("columnHeaders").length,c=this.wtSettings.getSetting("defaultRowHeight"),f=this.wtSettings.getSetting("columnHeaderHeight")||[];l;)l-=1,t=this.getColumnHeaderHeight(l),(e=this.getColumnHeader(o,l))&&(n=Object(r.innerHeight)(e),(!t&&c<n||t<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=n),Array.isArray(f)?null!==f[l]&&void 0!==f[l]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=f[l]):isNaN(f)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=f),this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]<(f[l]||f)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[l]=f[l]||f))}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wtSettings,e=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=0,r=t.getSetting("columnHeaders").length;i<r;i++)if(n[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height="".concat(n[i],"px")}}},{key:"resetOversizedRows",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(ne))&&!t.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);e.oversizedRows&&e.oversizedRows[o]&&(e.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll(".".concat(t)),i=0,n=e.length;i<n;i++)Object(r.removeClass)(e[i],t)}},{key:"refreshSelections",value:function(t){var e=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(t){for(var l=[],i=0;i<o;i++){for(var c=r[i].settings,f=c.highlightHeaderClassName,h=c.highlightRowClassName,d=c.highlightColumnClassName,y=r[i].classNames,v=y.length,m=0;m<v;m++)l.includes(y[m])||l.push(y[m]);f&&!l.includes(f)&&l.push(f),h&&!l.includes(h)&&l.push(h),d&&!l.includes(d)&&l.push(d)}var w=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(w))for(var O=0;O<w.length;O++)l.push(w[O]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var E=0;E<o;E++)r[E].draw(this.facadeGetter(),t)}}},{key:"getCell",value:function(t){var e=t.row,n=t.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",e,n);if(r&&Array.isArray(r)){var o=ce(r,2);e=o[0],n=o[1]}if(this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;var l=this.getRow(e);if(!l&&e>=0)throw new Error("TR was expected to be rendered but is not");var c=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!c&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return c}},{key:"getRow",value:function(t){var e,n,r=null,o=null;return t<0?(r=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(r=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceToRendered(t),o=this.TBODY),void 0!==r&&void 0!==o&&!(o.childNodes.length<r+1)&&o.childNodes[r]}},{key:"getColumnHeader",value:function(col){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=this.THEAD.childNodes[t];return null==e?void 0:e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)]}},{key:"getColumnHeaders",value:function(t){var e=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((function(t){var r=t.childNodes[n];r&&e.push(r)})),e}},{key:"getRowHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)&&!(e>=this.wtSettings.getSetting("rowHeaders").length)){var n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return null==n?void 0:n.childNodes[e]}}},{key:"getRowHeaders",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var e=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],l=null==o?void 0:o.childNodes[r];l&&e.push(l)}return e}},{key:"getCoords",value:function(t){var e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=Object(r.closest)(e,["TD","TH"])),null===e)return null;var n=e.parentNode,o=n.parentNode,l=Object(r.index)(n),col=e.cellIndex;return Object(r.overlayContainsElement)(oe,e,this.wtRootElement)||Object(r.overlayContainsElement)(ee,e,this.wtRootElement)?"THEAD"===o.nodeName&&(l-=o.childNodes.length):l=Object(r.overlayContainsElement)(ie,e,this.wtRootElement)||Object(r.overlayContainsElement)(ne,e,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-o.childNodes.length+l:o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(l):this.rowFilter.renderedToSource(l),col=Object(r.overlayContainsElement)(oe,e,this.wtRootElement)||Object(r.overlayContainsElement)(re,e,this.wtRootElement)||Object(r.overlayContainsElement)(ie,e,this.wtRootElement)?this.columnFilter.offsettedTH(col):this.columnFilter.visibleRowHeadedColumnToSourceColumn(col),this.wot.createCellCoords(l,col)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var t,e,n,o,l,c=this.TBODY.childNodes.length;if(c*this.wtSettings.getSetting("defaultRowHeight")!=Object(r.innerHeight)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;c;)c-=1,n=this.rowFilter.renderedToSource(c),t=this.getRowHeight(n),e=(l=(o=this.getTrForRow(n)).querySelector("th"))?Object(r.innerHeight)(l):Object(r.innerHeight)(o)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=e)}}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"isColumnHeaderRendered",value:function(t){if(t>=0)return!1;var e=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(t)<=e}},{key:"isRowHeaderRendered",value:function(t){if(t>=0)return!1;var e=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(t)<=e}},{key:"isRowBeforeRenderedRows",value:function(t){var e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}},{key:"isRowAfterRenderedRows",value:function(t){return t>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(t){var e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}},{key:"isColumnAfterRenderedColumns",value:function(t){return this.columnFilter&&t>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&t>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&t>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(t){return this.rowUtils.getHeight(t)}},{key:"getColumnHeaderHeight",value:function(t){return this.columnUtils.getHeaderHeight(t)}},{key:"getColumnWidth",value:function(t){return this.columnUtils.getWidth(t)}},{key:"getStretchedColumnWidth",value:function(t){return this.columnUtils.getStretchedColumnWidth(t)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Object(r.outerWidth)(this.TABLE)}},{key:"getHeight",value:function(){return Object(r.outerHeight)(this.TABLE)}},{key:"getTotalWidth",value:function(){var t=Object(r.outerWidth)(this.hider);return 0!==t?t:this.getWidth()}},{key:"getTotalHeight",value:function(){var t=Object(r.outerHeight)(this.hider);return 0!==t?t:this.getHeight()}},{key:"isVisible",value:function(){return Object(r.isVisible)(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(t){var e=Object(o.isFunction)(t)?t():null;return Array.isArray(e)?(e=ue(e))[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){var e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}],n&&de(e.prototype,n),l&&de(e,l),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ve=be,me={getFirstRenderedRow:function(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(object.defineGetter)(me,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var ge=me,we={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Object(object.defineGetter)(we,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var Oe=we;function Se(t){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Se(t)}function Ce(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Se(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Se(o)?o:String(o)),n)}var r,o}function Ee(t,p){return Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ee(t,p)}function Re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ke(t);if(e){var o=ke(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Se(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function ke(t){return ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ke(t)}var je=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ee(t,e)}(l,t);var e,n,r,o=Re(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,ee)}return e=l,n&&Ce(e.prototype,n),r&&Ce(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ve);Object(object.mixin)(je,ge),Object(object.mixin)(je,Oe);var Te=je;function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Ae(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_e(n.key),n)}}function Me(t,e,n){return(e=_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _e(t){var e=function(input,t){if("object"!==Pe(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Pe(e)?e:String(e)}var xe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Me(this,"dataAccessObject",void 0),Me(this,"lastScrolledColumnPos",-1),Me(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}var e,n,o;return e=t,(n=[{key:"scrollViewport",value:function(t,e,n,r,o){var l=this.scrollViewportHorizontally(t.col,n,o),c=this.scrollViewportVertically(t.row,e,r);return l||c}},{key:"scrollViewportHorizontally",value:function(t,e,n){var r=this.dataAccessObject,o=r.drawn,l=r.totalColumns;if(!o||!Number.isInteger(t)||t<0||t>l)return!1;var c=this.getFirstVisibleColumn(),f=this.getLastVisibleColumn(),h=void 0===e&&void 0===n,d=this.dataAccessObject,y=d.fixedColumnsStart,v=d.inlineStartOverlay;if(h&&t<y)return!1;var m=!1;return-1===c?m=v.scrollTo(t,h?t>this.lastScrolledColumnPos:e):(h&&(t<c||t>f)||!h)&&(m=v.scrollTo(t,h?t>f:e)),m&&(this.lastScrolledColumnPos=t),m}},{key:"scrollViewportVertically",value:function(t,e,n){var r=this.dataAccessObject,o=r.drawn,l=r.totalRows;if(!o||!Number.isInteger(t)||t<0||t>l)return!1;var c=this.getFirstVisibleRow(),f=this.getLastVisibleRow(),h=void 0===e&&void 0===n,d=this.dataAccessObject,y=d.fixedRowsBottom,v=d.fixedRowsTop,m=d.topOverlay;if(h&&(t<v||t>l-y-1))return!1;var w=!1;return-1===c?w=m.scrollTo(t,h?t>this.lastScrolledRowPos:n):(h&&(t<c||t>f)||!h)&&(w=m.scrollTo(t,h?t>f:n)),w&&(this.lastScrolledRowPos=t),w}},{key:"getFirstVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,n=t.wtTable,o=t.wtViewport,l=t.totalRows,c=t.fixedRowsTop,f=t.rootWindow,h=n.getFirstVisibleRow();if(e.mainTableScrollableElement===f){var d=Object(r.offset)(n.wtRootElement),y=Object(r.innerHeight)(n.hider),v=Object(r.innerHeight)(f),m=Object(r.getScrollTop)(f,f);if(d.top+y-v<=m){var w=o.getColumnHeaderHeight();w+=e.sumCellSizes(0,c);for(var O=l;O>0;O--)if(w+=e.sumCellSizes(O-1,O),d.top+y-w<=m){h=O;break}}}return h}},{key:"getLastVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,n=t.wtTable,o=t.wtViewport,l=t.totalRows,c=t.rootWindow,f=n.getLastVisibleRow();if(e.mainTableScrollableElement===c){var h=Object(r.offset)(n.wtRootElement),d=Object(r.getScrollTop)(c,c);if(h.top>d)for(var y=Object(r.innerHeight)(c),v=o.getColumnHeaderHeight(),m=1;m<=l;m++)if(v+=e.sumCellSizes(m-1,m),h.top+v-d>=y){f=m-2;break}}return f}},{key:"getFirstVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.inlineStartOverlay,n=t.wtTable,o=t.wtViewport,l=t.totalColumns,c=t.rootWindow,f=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===c){var h=Object(r.offset)(n.wtRootElement),d=Object(r.innerWidth)(n.hider),y=Object(r.innerWidth)(c),v=Math.abs(Object(r.getScrollLeft)(c,c));if(h.left+d-y<=v)for(var m=o.getRowHeaderWidth(),w=l;w>0;w--)if(m+=e.sumCellSizes(w-1,w),h.left+d-m<=v){f=w;break}}return f}},{key:"getLastVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.inlineStartOverlay,n=t.wtTable,o=t.wtViewport,l=t.totalColumns,c=t.rootWindow,f=n.getLastVisibleColumn();if(e.mainTableScrollableElement===c){var h=Object(r.offset)(n.wtRootElement),d=Math.abs(Object(r.getScrollLeft)(c,c));if(h.left>d)for(var y=Object(r.innerWidth)(c),v=o.getRowHeaderWidth(),m=1;m<=l;m++)if(v+=e.sumCellSizes(m-1,m),h.left+v-d>=y){f=m-2;break}}return f}}])&&Ae(e.prototype,n),o&&Ae(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Ie=n(821),Ne=n(852);function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}function De(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Be(n.key),n)}}function Le(t,e,n){return(e=Be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Be(t){var e=function(input,t){if("object"!==He(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===He(e)?e:String(e)}var Fe=function(){function t(table,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Le(this,"wtTable",void 0),Le(this,"wtScroll",void 0),Le(this,"wtViewport",void 0),Le(this,"wtOverlays",void 0),Le(this,"selections",void 0),Le(this,"wtEvent",void 0),Le(this,"guid","wt_".concat(Object(E.randomString)())),Le(this,"drawInterrupted",!1),Le(this,"drawn",!1),Le(this,"domBindings",void 0),Le(this,"wtSettings",void 0),this.domBindings={rootTable:table,rootDocument:table.ownerDocument,rootWindow:table.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new xe(this.createScrollDao())}var e,n,o;return e=t,n=[{key:"eventManager",get:function(){return new y.a(this)}},{key:"findOriginalHeaders",value:function(){var t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var e=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;e<n;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,n){Object(r.fastInnerText)(n,t[e])}])}}},{key:"createCellCoords",value:function(t,e){return new Ie.a(t,e,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(t,e,n){return new Ne.a(t,e,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(t);var e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=e-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<e&&t.row>=e-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"scrollViewport",value:function(t,e,n,r,o){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selections(){return t.selections},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count}}}}],n&&De(e.prototype,n),o&&De(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ve(t){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ve(t)}function We(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ke(n.key),n)}}function Ue(t,p){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Ue(t,p)}function ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ye(t);if(e){var o=Ye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Ve(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ge(t)}(this,n)}}function Ge(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ye(t){return Ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ye(t)}function Xe(t,e,n){return(e=Ke(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ke(t){var e=function(input,t){if("object"!==Ve(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ve(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ve(e)?e:String(e)}var $e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ue(t,e)}(l,t);var e,n,r,o=ze(l);function l(table,t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),Xe(Ge(n=o.call(this,table,t)),"cloneSource",void 0),Xe(Ge(n),"cloneOverlay",void 0);var r=n.wtSettings.getSetting("facade",Ge(n));return n.cloneSource=e.source,n.cloneOverlay=e.overlay,n.wtTable=n.cloneOverlay.createTable(n.getTableDao(),r,n.domBindings,n.wtSettings),n.wtViewport=e.viewport,n.selections=e.selections,n.wtEvent=new _(r,n.domBindings,n.wtSettings,n.eventManager,n.wtTable,n.selections,e.event),n.findOriginalHeaders(),n}return e=l,n&&We(e.prototype,n),r&&We(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Fe);function qe(t){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(t)}function Qe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Je(n.key),n)}}function Je(t){var e=function(input,t){if("object"!==qe(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===qe(e)?e:String(e)}var Ze=function(){function t(e,n,o,l,c){var f,h,d;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f=this,d=null,(h=Je(h="wtSettings"))in f?Object.defineProperty(f,h,{value:d,enumerable:!0,configurable:!0,writable:!0}):f[h]=d,Object(object.defineGetter)(this,"wot",e,{writable:!1}),this.domBindings=c,this.facadeGetter=n,this.wtSettings=l;var y=this.wot.wtTable,v=y.TABLE,m=y.hider,w=y.spreader,O=y.holder,S=y.wtRootElement;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=v,this.hider=m,this.spreader=w,this.holder=O,this.wtRootElement=S,this.trimmingContainer=Object(r.getTrimmingContainer)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}var e,n,o;return e=t,n=[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Object(r.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var t=this.wot.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Object(r.getScrollableElement)(t.TABLE)}},{key:"getRelativeCellPosition",value:function(element,t,e){if(!1!==this.clone.wtTable.holder.contains(element)){var n=this.mainTableScrollableElement===this.domBindings.rootWindow,r=e<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),l=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),c=this.clone.wtTable.spreader,h={start:this.getRelativeStartPosition(c),top:c.offsetTop},d={start:this.getRelativeStartPosition(element),top:element.offsetTop};return n?this.getRelativeCellPositionWithinWindow(o,r,d,h):this.getRelativeCellPositionWithinHolder(o,l,r,d,h)}Object(f.b)("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(t,e,n,o){var l=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=0,f=0;if(e){var h=l.left;this.isRtl()&&(h=this.domBindings.rootWindow.innerWidth-(l.left+l.width+Object(r.getScrollbarWidth)())),c=h<=0?-1*h:0}else c=o.start;return f=t?this.clone.wtTable.TABLE.getBoundingClientRect().top-l.top:o.top,{start:n.start+c,top:n.top+f}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,e,n,r,o){var l=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),c=this.wot.wtOverlays.topOverlay.getScrollPosition(),f=0,h=0;if(n||(f=l-o.start),e){var d=this.wot.wtTable.wtRootElement.getBoundingClientRect();h=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+d.top}else t||(h=c-o.top);return{start:r.start-f,top:r.top-h}}},{key:"makeClone",value:function(){if(-1===ae.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,o=e.rootWindow,l=n.createElement("DIV"),c=n.createElement("TABLE"),f=t.wtRootElement.parentNode;l.className="".concat(le.get(this.type)," handsontable"),l.setAttribute("dir",this.isRtl()?"rtl":"ltr"),l.style.position="absolute",l.style.top=0,l.style.overflow="visible",this.isRtl()?l.style.right=0:l.style.left=0,c.className=t.TABLE.className,l.appendChild(c),f.appendChild(l);var h=this.wtSettings.getSetting("preventOverflow");return!0===h||"horizontal"===h&&this.type===ee||"vertical"===h&&this.type===re?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(f).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=Object(r.getScrollableElement)(t.TABLE),new $e(c,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,r=e.style,o=t.parentNode.style;Object(v.arrayEach)([n,r,o],(function(style){style.width="",style.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}],n&&Qe(e.prototype,n),o&&Qe(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(t,e,n){return en=ln()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&rn(r,n.prototype),r},en.apply(null,arguments)}function nn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,un(n.key),n)}}function rn(t,p){return rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},rn(t,p)}function on(t){var e=ln();return function(){var n,r=sn(t);if(e){var o=sn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return an(t)}(this,n)}}function an(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ln(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function sn(t){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sn(t)}function un(t){var e=function(input,t){if("object"!==tn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==tn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===tn(e)?e:String(e)}var cn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rn(t,e)}(c,t);var e,n,o,l=on(c);function c(t,e,n,r){var o,f,h,d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),o=l.call(this,t,e,ee,n,r),f=an(o),d=-1,(h=un(h="cachedFixedRowsTop"))in f?Object.defineProperty(f,h,{value:d,enumerable:!0,configurable:!0,writable:!0}):f[h]=d,o.cachedFixedRowsTop=o.wtSettings.getSetting("fixedRowsTop"),o}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return en(Te,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode,e=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),o=0,l=!1;if(this.trimmingContainer!==e||n&&"vertical"===n)o=this.getScrollPosition(),Object(r.resetCssTransform)(t);else{var c=this.wot.wtTable.hider.getBoundingClientRect();l=Math.ceil(c.bottom)===t.offsetHeight,o=this.getOverlayOffset(),Object(r.setOverlayPosition)(t,"0px","".concat(o,"px"))}var f=this.adjustHeaderBordersPosition(o,l);return this.adjustElementsSize(),f}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Object(r.getWindowScrollLeft)(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wtSettings.getSetting("defaultRowHeight"),r=t,o=0;r<e;){var l=this.wot.wtTable.getRowHeight(r);o+=void 0===l?n:l,r+=1}return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,o=e.rootWindow,l=Object(r.getScrollbarWidth)(n),c=this.clone.wtTable.holder.parentNode.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===f){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,t.wtRootElement.scrollWidth),c.width="".concat(h,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var d=Object(r.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),c.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(t=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height="".concat(parseInt(e.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var n=this.wot,o=this.wtSettings,l=(n.cloneSource?n.cloneSource:n).wtTable.holder,c=this.getTableParentOffset(),f=0;if(e&&this.wot.wtTable.getRowHeight(t)>this.wot.wtViewport.getViewportHeight()&&(e=!1),e&&l.offsetHeight!==l.clientHeight&&(f=Object(r.getScrollbarWidth)(this.domBindings.rootDocument)),e){var h=o.getSetting("fixedRowsBottom"),d=o.getSetting("totalRows");c+=this.sumCellSizes(0,t+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(d-h,d),c+=1}else c+=this.sumCellSizes(o.getSetting("fixedRowsTop"),t);return c+=f,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(r.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var r=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();(n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>r&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Object(r.removeClass)(n,"emptyColumns"):Object(r.addClass)(n,"emptyColumns");var o=!1;if(!e){var l=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,f=this.wtSettings.getSetting("columnHeaders");if((c||0===l)&&f.length>0){var h=Object(r.hasClass)(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(Object(r.addClass)(n,"innerBorderTop"),o=!h):(Object(r.removeClass)(n,"innerBorderTop"),o=h)}}return o}}],n&&nn(e.prototype,n),o&&nn(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze),fn={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return 0===t||0===e?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(object.defineGetter)(fn,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var hn=fn;function dn(t){return dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dn(t)}function pn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==dn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==dn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===dn(o)?o:String(o)),n)}var r,o}function yn(t,p){return yn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},yn(t,p)}function bn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=vn(t);if(e){var o=vn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===dn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function vn(t){return vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vn(t)}var mn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yn(t,e)}(l,t);var e,n,r,o=bn(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,ne)}return e=l,n&&pn(e.prototype,n),r&&pn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ve);Object(object.mixin)(mn,hn),Object(object.mixin)(mn,Oe);var gn=mn;function wn(t){return wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wn(t)}function On(t,e,n){return On=kn()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&Cn(r,n.prototype),r},On.apply(null,arguments)}function Sn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tn(n.key),n)}}function Cn(t,p){return Cn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Cn(t,p)}function En(t){var e=kn();return function(){var n,r=jn(t);if(e){var o=jn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===wn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Rn(t)}(this,n)}}function Rn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function jn(t){return jn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jn(t)}function Tn(t){var e=function(input,t){if("object"!==wn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==wn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===wn(e)?e:String(e)}var Pn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cn(t,e)}(c,t);var e,n,o,l=En(c);function c(t,e,n,r){var o,f,h,d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),o=l.call(this,t,e,ne,n,r),f=Rn(o),d=-1,(h=Tn(h="cachedFixedRowsBottom"))in f?Object.defineProperty(f,h,{value:d,enumerable:!0,configurable:!0,writable:!0}):f[h]=d,o.cachedFixedRowsBottom=o.wtSettings.getSetting("fixedRowsBottom"),o}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return On(gn,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.domBindings.rootWindow,e=this.clone.wtTable.holder.parentNode;e.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),e.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,o=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,c=0;n.hasVerticalScroll()||(c+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(c+=Object(r.getScrollbarWidth)(o)),l.style.bottom="".concat(c,"px")}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Object(r.getWindowScrollLeft)(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot,r=n.wtTable,o=n.wtSettings.getSetting("defaultRowHeight"),l=t,c=0;l<e;){var f=r.getRowHeight(l);c+=void 0===f?o:f,l+=1}return c}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,o=this.domBindings,l=o.rootDocument,c=o.rootWindow,f=Object(r.getScrollbarWidth)(l),h=this.clone.wtTable.holder.parentNode.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==c||"horizontal"===d){var y=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(y-=f),y=Math.min(y,e.wtRootElement.scrollWidth),h.width="".concat(y,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var v=Object(r.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(v=0),h.height="".concat(v,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=0;e&&o.offsetHeight!==o.clientHeight&&(l=Object(r.getScrollbarWidth)(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),n+=l,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(r.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var r=this.wot.wtTable.getTotalHeight(),o=r-this.clone.wtTable.getTotalHeight(),l=this.domBindings.rootDocument.documentElement.clientHeight;(n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+r,0))>o&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==e,o=this.wtSettings.getSetting("columnHeaders"),l=!1;if((n||0===e)&&o.length>0){var c=this.wot.wtTable.holder.parentNode,f=Object(r.hasClass)(c,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(Object(r.addClass)(c,"innerBorderBottom"),l=!f):(Object(r.removeClass)(c,"innerBorderBottom"),l=f)}return l}}],n&&Sn(e.prototype,n),o&&Sn(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze),An={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Object(object.defineGetter)(An,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var Mn=An,_n={getFirstRenderedColumn:function(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Object(object.defineGetter)(_n,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var xn=_n;function In(t){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},In(t)}function Nn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==In(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==In(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===In(o)?o:String(o)),n)}var r,o}function Hn(t,p){return Hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Hn(t,p)}function Dn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ln(t);if(e){var o=Ln(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===In(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Ln(t){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ln(t)}var Bn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hn(t,e)}(l,t);var e,n,r,o=Dn(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,re)}return e=l,n&&Nn(e.prototype,n),r&&Nn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ve);Object(object.mixin)(Bn,Mn),Object(object.mixin)(Bn,xn);var Fn=Bn;function Vn(t){return Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vn(t)}function Wn(t,e,n){return Wn=Yn()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&zn(r,n.prototype),r},Wn.apply(null,arguments)}function Un(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Vn(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Vn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Vn(o)?o:String(o)),n)}var r,o}function zn(t,p){return zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},zn(t,p)}function Gn(t){var e=Yn();return function(){var n,r=Xn(t);if(e){var o=Xn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Vn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Yn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Xn(t){return Xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xn(t)}var Kn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zn(t,e)}(c,t);var e,n,o,l=Gn(c);function c(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,t,e,re,n,r)}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Wn(Fn,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot.wtTable;if(!this.needFullRender||!t.holder.parentNode)return!1;var e=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer!==e||o&&"horizontal"===o?(l=this.getScrollPosition(),Object(r.resetCssTransform)(n)):(l=this.getOverlayOffset()*(this.isRtl()?-1:1),Object(r.setOverlayPosition)(n,"".concat(l,"px"),"0px"));var c=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),c}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Object(r.getWindowScrollTop)(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wtSettings.getSetting("defaultColumnWidth"),r=t,o=0;r<e;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,o=e.rootWindow,l=Object(r.getScrollbarWidth)(n),c=this.clone.wtTable.holder.parentNode.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===f){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,t.wtRootElement.scrollHeight),c.height="".concat(h,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var d=Object(r.outerWidth)(this.clone.wtTable.TABLE);c.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(t=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width="".concat(parseInt(e.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=0;return e&&this.wot.wtTable.getColumnWidth(t)>this.wot.wtViewport.getViewportWidth()&&(e=!1),e&&o.offsetWidth!==o.clientWidth&&(l=Object(r.getScrollbarWidth)(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),n+=l,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return Math.abs(Object(r.getScrollLeft)(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;return this.trimmingContainer!==t||e&&"horizontal"===e||(n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0),n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Object(r.removeClass)(e,"emptyRows"):Object(r.addClass)(e,"emptyRows");var l=!1;if(o&&!n.length)Object(r.addClass)(e,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){var c=Object(r.hasClass)(e,"innerBorderInlineStart");t?(Object(r.addClass)(e,"innerBorderLeft innerBorderInlineStart"),l=!c):(Object(r.removeClass)(e,"innerBorderLeft innerBorderInlineStart"),l=c)}return l}}],n&&Un(e.prototype,n),o&&Un(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze);function $n(t){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$n(t)}function qn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==$n(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==$n(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===$n(o)?o:String(o)),n)}var r,o}function Qn(t,p){return Qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Qn(t,p)}function Jn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zn(t);if(e){var o=Zn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===$n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Zn(t){return Zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zn(t)}var er=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qn(t,e)}(l,t);var e,n,r,o=Jn(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,oe)}return e=l,n&&qn(e.prototype,n),r&&qn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ve);Object(object.mixin)(er,ge),Object(object.mixin)(er,xn);var nr=er;function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function or(t,e,n){return or=ur()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&ar(r,n.prototype),r},or.apply(null,arguments)}function ir(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dr(n.key),n)}}function ar(t,p){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ar(t,p)}function lr(t){var e=ur();return function(){var n,r=cr(t);if(e){var o=cr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===rr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return sr(t)}(this,n)}}function sr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ur(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function cr(t){return cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cr(t)}function fr(t,e,n){return(e=dr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dr(t){var e=function(input,t){if("object"!==rr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===rr(e)?e:String(e)}var pr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ar(t,e)}(c,t);var e,n,o,l=lr(c);function c(t,e,n,r,o,f){var h;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),fr(sr(h=l.call(this,t,e,oe,n,r)),"topOverlay",void 0),fr(sr(h),"inlineStartOverlay",void 0),h.topOverlay=o,h.inlineStartOverlay=f,h}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return or(nr,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();Object(r.setOverlayPosition)(t,"".concat(e,"px"),"".concat(n,"px"))}else Object(r.resetCssTransform)(t);var o=Object(r.outerHeight)(this.clone.wtTable.TABLE),l=Object(r.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),t.style.height="".concat(o,"px"),t.style.width="".concat(l,"px"),!1}}],n&&ir(e.prototype,n),o&&ir(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze);function yr(t){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yr(t)}function vr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==yr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===yr(o)?o:String(o)),n)}var r,o}function mr(t,p){return mr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},mr(t,p)}function gr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wr(t);if(e){var o=wr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===yr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function wr(t){return wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wr(t)}var Or=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mr(t,e)}(l,t);var e,n,r,o=gr(l);function l(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,t,e,n,r,ie)}return e=l,n&&vr(e.prototype,n),r&&vr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ve);Object(object.mixin)(Or,hn),Object(object.mixin)(Or,xn);var Sr=Or;function Cr(t){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr(t)}function Er(t,e,n){return Er=Tr()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&kr(r,n.prototype),r},Er.apply(null,arguments)}function Rr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Cr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Cr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Cr(o)?o:String(o)),n)}var r,o}function kr(t,p){return kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},kr(t,p)}function jr(t){var e=Tr();return function(){var n,r=Pr(t);if(e){var o=Pr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Cr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Tr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Pr(t){return Pr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pr(t)}var Ar=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kr(t,e)}(c,t);var e,n,o,l=jr(c);function c(t,e,n,r,o,f){var h;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(h=l.call(this,t,e,ie,n,r)).bottomOverlay=o,h.inlineStartOverlay=f,h}return e=c,n=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Er(Sr,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]="".concat(n,"px"),e.style.bottom="".concat(o,"px")}else Object(r.resetCssTransform)(e),this.repositionOverlay();var l=Object(r.outerHeight)(this.clone.wtTable.TABLE),c=Object(r.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),e.style.height="".concat(l,"px"),e.style.width="".concat(c,"px"),!1}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,o=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,c=0;n.hasVerticalScroll()||(c+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(c+=Object(r.getScrollbarWidth)(o)),l.style.bottom="".concat(c,"px")}}],n&&Rr(e.prototype,n),o&&Rr(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Ze);function Mr(t){return Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mr(t)}function _r(t,e,n){return _r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct.bind():function(t,e,n){var a=[null];a.push.apply(a,e);var r=new(Function.bind.apply(t,a));return n&&xr(r,n.prototype),r},_r.apply(null,arguments)}function xr(t,p){return xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},xr(t,p)}function Ir(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hr(n.key),n)}}function Nr(t,e,n){return(e=Hr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hr(t){var e=function(input,t){if("object"!==Mr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Mr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Mr(e)?e:String(e)}var Dr=function(){function t(e,n,o,l,c,f){var h=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Nr(this,"wot",null),Nr(this,"topOverlay",null),Nr(this,"bottomOverlay",null),Nr(this,"inlineStartOverlay",null),Nr(this,"topInlineStartCornerOverlay",null),Nr(this,"bottomInlineStartCornerOverlay",null),Nr(this,"browserLineHeight",void 0),Nr(this,"wtSettings",null),Nr(this,"resizeObserver",new ResizeObserver((function(t){Object(j.requestAnimationFrame)((function(){Array.isArray(t)&&t.length&&h.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=e,this.wtSettings=l,this.domBindings=o,this.facadeGetter=n,this.wtTable=f;var d=this.domBindings,y=d.rootDocument,v=d.rootWindow;this.instance=this.wot,this.eventManager=c,this.scrollbarSize=Object(r.getScrollbarWidth)(y);var m="hidden"===v.getComputedStyle(f.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=m?f.holder:Object(r.getScrollableElement)(f.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=v.scrollX,this.lastScrollY=v.scrollY}var e,n,o;return e=t,n=[{key:"getOverlays",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}},{key:"initBrowserLineHeight",value:function(){var t=this.domBindings,e=t.rootWindow,n=t.rootDocument,r=e.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),l=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||l}},{key:"initOverlays",value:function(){var t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=_r(cn,t),this.bottomOverlay=_r(Pn,t),this.inlineStartOverlay=_r(Kn,t),this.topInlineStartCornerOverlay=_r(pr,t.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=_r(Ar,t.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var t=this,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(e){return t.onKeyDown(e)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0}),o!==l&&this.eventManager.addEventListener(l,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0});var f,h=r.devicePixelRatio&&r.devicePixelRatio>1,d=this.scrollableElement===r,y=this.wtSettings.getSetting("preventWheel"),v={passive:d};(y||h||!Object(c.isChrome)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(e){return t.onCloneWheel(e,y)}),v),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((function(e){if(e&&e.needFullRender){var n=e.clone.wtTable.holder;t.eventManager.addEventListener(n,"wheel",(function(e){return t.onCloneWheel(e,y)}),v)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(f),f=setTimeout((function(){t.wtSettings.getSetting("onWindowResize")}),200)})),d||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(t){var e=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=t.target;this.keyPressed&&(r!==e&&o!==e&&!t.target.contains(r)||n!==e&&o!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t,e){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,l=t.target,c=o!==n&&l!==n&&!l.contains(o),f=r!==n&&l!==n&&!l.contains(r);if(!this.keyPressed||!c&&!f){var h=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&h)&&t.preventDefault()}}},{key:"onKeyDown",value:function(t){this.keyPressed=Object(x.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight);var r=this.scrollVertically(e),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(t){var e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(t){var e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.domBindings.rootWindow,e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],l=r[1];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==l||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;var c=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;c&&(c.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var t=this.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=Object(r.getScrollableElement)(t.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}},{key:"updateLastSpreaderSize",value:function(){var t=this.wtTable.spreader,e=t.clientWidth,n=t.clientHeight,r=e!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=n),r}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),l=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight(),f=n.hider.style;if(f.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,r),"px"),f.height="".concat(c+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var h=n.wtRootElement,d=h.scrollHeight,y=h.scrollWidth,v=n.holder,m=v.scrollHeight,w=v.scrollWidth;this.hasScrollbarRight=d<m,this.hasScrollbarBottom=y<w,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>y?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>d&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(element){if(!element)return null;var t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],e=null;return Object(v.arrayEach)(t,(function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(element)&&(e=t.clone)})),e}},{key:"syncOverlayTableClassNames",value:function(){var t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Object(v.arrayEach)(e,(function(e){e&&(e.clone.wtTable.TABLE.className=t.className)}))}}],n&&Ir(e.prototype,n),o&&Ir(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Lr=Dr;function Br(t){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Br(t)}function Fr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wr(n.key),n)}}function Vr(t,e,n){return(e=Wr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wr(t){var e=function(input,t){if("object"!==Br(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Br(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Br(e)?e:String(e)}var Ur=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Vr(this,"settings",{}),Vr(this,"defaults",Object.freeze(this.getDefaults())),Object(object.objectEach)(this.defaults,(function(t,r){if(void 0!==e[r])n.settings[r]=e[r];else{if(void 0===t)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=t}}))}var e,n,o;return e=t,(n=[{key:"getDefaults",value:function(){var t=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return t.getSetting("fixedColumnsStart")>0||t.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return t.getSetting("fixedRowsTop")>0||t.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return t.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,n,o){var l=t.getSetting("data",e,n);Object(r.fastInnerText)(o,null==l?"":l)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(t){return t},onBeforeHighlightingColumnHeader:function(t){return t},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(t,e){var n=this;return void 0===e?Object(object.objectEach)(t,(function(t,e){n.settings[e]=t})):this.settings[t]=e,this}},{key:"getSetting",value:function(t,e,n,r,o){return"function"==typeof this.settings[t]?this.settings[t](e,n,r,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"getSettingPure",value:function(t){return this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}])&&Fr(e.prototype,n),o&&Fr(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function zr(t){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zr(t)}function Gr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==zr(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==zr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===zr(o)?o:String(o)),n)}var r,o}function Yr(t,p){return Yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Yr(t,p)}function Xr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Kr(t);if(e){var o=Kr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===zr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Kr(t){return Kr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Kr(t)}var $r=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yr(t,e)}(c,t);var e,n,o,l=Xr(c);function c(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,t,e,n,r,"master")}return e=c,(n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=Object(r.getTrimmingContainer)(this.wtRootElement),e=this.domBindings.rootWindow;if(t===e)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=t.parentElement,o=Object(r.getStyle)(t,"height",e),l=Object(r.getStyle)(t,"overflow",e),c=this.holder.style,f=t.scrollWidth,h=t.scrollHeight,d=t.getBoundingClientRect(),y=d.width,v=d.height;if(n&&["auto","hidden","scroll"].includes(l)){var m=t.cloneNode(!1);m.style.overflow="auto",m.style.position="absolute",t.nextElementSibling?n.insertBefore(m,t.nextElementSibling):n.appendChild(m);var w=parseInt(Object(r.getComputedStyle)(m,e).height,10);n.removeChild(m),0===w&&(v=0)}v=Math.min(v,h),c.height="auto"===o?"auto":"".concat(v,"px"),y=Math.min(y,f),c.width="".concat(y,"px"),c.overflow="",this.hasTableHeight="auto"===c.height||v>0,this.hasTableWidth=y>0}this.isTableVisible=Object(r.isVisible)(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport,n="master",r=t.getSetting("columnHeaders").length;if(r&&!e.hasOversizedColumnHeadersMarked[n]){for(var o=t.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount(),i=0;i<r;i++)for(var c=-1*o;c<l;c++)this.markIfOversizedColumnHeader(c);e.hasOversizedColumnHeadersMarked[n]=!0}}}])&&Gr(e.prototype,n),o&&Gr(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(ve);Object(object.mixin)($r,Mn),Object(object.mixin)($r,Oe);var qr=$r,Qr=n(853),Jr=n(1062),Zr=n(1063);function to(t){return to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},to(t)}function eo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==to(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==to(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===to(o)?o:String(o)),n)}var r,o}var no=function(){function t(e,n,r,o,l){var c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=l,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){c.clientHeight=c.getWorkspaceHeight()}))}var e,n,o;return e=t,n=[{key:"getWorkspaceHeight",value:function(){var t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;return e===this.domBindings.rootWindow?t.documentElement.clientHeight:Object(r.outerHeight)(e)>0&&e.clientHeight>0?e.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var t,e,n=this.wtSettings,o=this.domBindings,l=o.rootDocument,c=o.rootWindow,f=this.dataAccessObject.inlineStartOverlayTrimmingContainer,h=l.documentElement.offsetWidth,d=n.getSetting("totalColumns"),y=n.getSetting("preventOverflow"),v=n.getSetting("rtlMode"),m=this.wtTable.TABLE.getBoundingClientRect(),w=h-(v?m.right-h:m.left);if(y)return Object(r.outerWidth)(this.wtTable.wtRootElement);if(t=n.getSetting("freezeOverlays")?Math.min(w,h):Math.min(this.getContainerFillWidth(),w,h),f===c&&d>0&&this.sumColumnWidths(0,d-1)>t)return l.documentElement.clientWidth;if(f!==c&&("scroll"===(e=Object(r.getStyle)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",c))||"hidden"===e||"auto"===e))return Math.max(t,f.clientWidth);var O=n.getSetting("stretchH");return"none"!==O&&O?t:Math.max(t,Object(r.outerWidth)(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){for(var n=0,r=t;r<e;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);var n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}},{key:"getWorkspaceOffset",value:function(){return Object(r.offset)(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Object(r.outerHeight)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}},{key:"getRowHeaderWidth",value:function(){var t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var i=0,n=e.length;i<n;i++)this.rowHeaderWidth+=t[i]||t}if(isNaN(this.rowHeaderWidth))if(e.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,c=e.length;l<c;l++)o?(this.rowHeaderWidth+=Object(r.outerWidth)(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var e=this.getRowHeaderWidth();return e>0?t-e:t}},{key:"createRowsCalculator",value:function(){var t,e,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qr.b,l=this.wtSettings,c=this.wtTable;this.rowHeaderWidth=NaN,t=l.getSetting("renderAllRows")&&o===Qr.b?1/0:this.getViewportHeight();var f=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;f<0&&(f=0);var h=l.getSetting("fixedRowsTop"),d=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");return h&&(f+=n=this.dataAccessObject.topOverlay.sumCellSizes(0,h),t-=n),d&&this.dataAccessObject.bottomOverlay.clone&&(t-=n=this.dataAccessObject.bottomOverlay.sumCellSizes(y-d,y)),e=c.holder.clientHeight===c.holder.offsetHeight?0:Object(r.getScrollbarWidth)(this.domBindings.rootDocument),new Jr.a({viewportSize:t,scrollOffset:f,totalItems:l.getSetting("totalRows"),itemSizeFn:function(t){return c.getRowHeight(t)},overrideFn:l.getSettingPure("viewportRowCalculatorOverride"),calculationType:o,scrollbarHeight:e})}},{key:"createColumnsCalculator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qr.b,e=this.wtSettings,n=this.wtTable,o=this.getViewportWidth(),l=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,l<0&&(l=0);var c=e.getSetting("fixedColumnsStart");if(c){var f=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,c);l+=f,o-=f}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=Object(r.getScrollbarWidth)(this.domBindings.rootDocument)),new Zr.a({viewportSize:o,scrollOffset:Math.abs(l),totalItems:e.getSetting("totalColumns"),itemSizeFn:function(t){return n.getColumnWidth(t)},overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:function(t,n){return e.getSetting("onBeforeStretchingColumnWidth",t,n)}})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){var e=this.createRowsCalculator(Qr.a),n=this.createColumnsCalculator(Qr.a);this.areAllProposedVisibleRowsAlreadyRendered(e)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(Qr.b),this.columnsRenderCalculator=this.createColumnsCalculator(Qr.b)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Qr.a),this.columnsVisibleCalculator=this.createColumnsCalculator(Qr.a)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){if(!this.rowsVisibleCalculator)return!1;var e=t.startRow,n=t.endRow;if(null===e&&null===n)return!1;var r=this.rowsRenderCalculator,o=r.startRow,l=r.endRow;return!(e<o||e===o&&e>0||n>l||n===l&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){if(!this.columnsVisibleCalculator)return!1;var e=t.startColumn,n=t.endColumn;if(null===e&&null===n)return!1;var r=this.columnsRenderCalculator,o=r.startColumn,l=r.endColumn;return!(e<o||e===o&&e>0||n>l||n===l&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Object(object.objectEach)(this.hasOversizedColumnHeadersMarked,(function(t,e,object){object[e]=void 0}))}}],n&&eo(e.prototype,n),o&&eo(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ro=no;function oo(t){return oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oo(t)}function io(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==oo(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==oo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===oo(o)?o:String(o)),n)}var r,o}function ao(t,p){return ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},ao(t,p)}function lo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=uo(t);if(e){var o=uo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===oo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return so(t)}(this,n)}}function so(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uo(t){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uo(t)}var co=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ao(t,e)}(c,t);var e,n,o,l=lo(c);function c(table,t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var n=(e=l.call(this,table,new Ur(t))).wtSettings.getSetting("facade",so(e));return e.wtTable=new qr(e.getTableDao(),n,e.domBindings,e.wtSettings),e.wtViewport=new ro(e.getViewportDao(),e.domBindings,e.wtSettings,e.eventManager,e.wtTable),e.selections=e.wtSettings.getSetting("selections"),e.wtEvent=new _(n,e.domBindings,e.wtSettings,e.eventManager,e.wtTable,e.selections),e.wtOverlays=new Lr(so(e),n,e.domBindings,e.wtSettings,e.eventManager,e.wtTable),e.exportSettingsAsClassNames(),e.findOriginalHeaders(),e}return e=c,(n=[{key:"exportSettingsAsClassNames",value:function(){var t=this,e=[],n=[];Object(object.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(r,o){t.wtSettings.getSetting(o).length&&n.push(r),e.push(r)})),Object(r.removeClass)(this.wtTable.wtRootElement.parentNode,e),Object(r.addClass)(this.wtTable.wtRootElement.parentNode,n)}},{key:"getViewportDao",value:function(){var t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}])&&io(e.prototype,n),o&&io(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(Fe);function fo(t){return fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fo(t)}function ho(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==fo(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==fo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===fo(o)?o:String(o)),n)}var r,o}var po=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e instanceof Fe?this._wot=e:this._initFromSettings(e)}var e,n,r;return e=t,n=[{key:"_initFromSettings",value:function(e){e.facade=function(e){var n=new t(e);return function(){return n}},this._wot=new co(e.table,e)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(t){this._wot.drawn=t}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(t){this._wot.drawInterrupted=t}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(t){this._wot.lastMouseOver=t}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(t){this._wot.momentumScrolling=t}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(t){this._wot.touchApplied=t}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(t){this._wot.eventListeners=t}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(t,e){return this._wot.createCellCoords(t,e)}},{key:"createCellRange",value:function(t,e,n){return this._wot.createCellRange(t,e,n)}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}},{key:"scrollViewport",value:function(t,e,n,r,o){return this._wot.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this._wot.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this._wot.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(t,e){return this._wot.wtSettings.update(t,e),this}},{key:"getSetting",value:function(t,e,n,r,o){return this._wot.wtSettings.getSetting(t,e,n,r,o)}},{key:"hasSetting",value:function(t){return this._wot.wtSettings.hasSetting(t)}},{key:"destroy",value:function(){this._wot.destroy()}}],n&&ho(e.prototype,n),r&&ho(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function yo(t){var e=t.isShiftKey,n=t.isLeftClick,r=t.isRightClick,o=t.coords,l=t.selection,c=t.controller,f=t.cellCoordsFactory,h=l.isSelected()?l.getSelectedRange().current():null,d=l.isSelectedByCorner(),y=l.isSelectedByRowHeader();if(e&&h)o.row>=0&&o.col>=0&&!c.cell?l.setRangeEnd(o):(d||y)&&o.row>=0&&o.col>=0&&!c.cell?l.setRangeEnd(f(o.row,o.col)):d&&o.row<0&&!c.column?l.setRangeEnd(f(h.to.row,o.col)):y&&o.col<0&&!c.row?l.setRangeEnd(f(o.row,h.to.col)):(!d&&!y&&o.col<0||d&&o.col<0)&&!c.row?l.selectRows(Math.max(h.from.row,0),o.row,o.col):(!d&&!y&&o.row<0||y&&o.row<0)&&!c.column&&l.selectColumns(Math.max(h.from.col,0),o.col,o.row);else{var v=!l.inInSelection(o),m=n||r&&v;o.row<0&&o.col>=0&&!c.column?m&&l.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!c.row?m&&l.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!c.cell?m&&l.setRangeStart(o):o.col<0&&o.row<0&&l.selectAll(!0,!0)}}var bo=new Map([["mousedown",yo],["mouseover",function(t){var e=t.isLeftClick,n=t.coords,r=t.selection,o=t.controller,l=t.cellCoordsFactory;if(e){var c=r.isSelectedByRowHeader(),f=r.isSelectedByColumnHeader(),h=r.tableProps.countCols(),d=r.tableProps.countRows();f&&!o.column?r.setRangeEnd(l(d-1,n.col)):c&&!o.row?r.setRangeEnd(l(n.row,h-1)):o.cell||r.setRangeEnd(n)}}],["touchstart",yo]]);function vo(t,e){var n=e.coords,r=e.selection,o=e.controller,l=e.cellCoordsFactory;bo.get(t.type)({coords:n,selection:r,controller:o,cellCoordsFactory:l,isShiftKey:t.shiftKey,isLeftClick:Object(k.isLeftClick)(t)||"touchstart"===t.type,isRightClick:Object(k.isRightClick)(t)})}var mo=n(818);function go(t){return go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},go(t)}function wo(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||So(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oo(t){return function(t){if(Array.isArray(t))return Co(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||So(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function So(t,e){if(t){if("string"==typeof t)return Co(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Co(t,e):void 0}}function Co(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Eo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jo(n.key),n)}}function Ro(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function ko(t,e,n){return(e=jo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jo(t){var e=function(input,t){if("object"!==go(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===go(e)?e:String(e)}function To(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Ao(t,e,"get"))}function Po(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Ao(t,e,"set"),n),n}function Ao(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Mo=new WeakMap,_o=new WeakMap,xo=new WeakMap,Io=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ko(this,"instance",void 0),ko(this,"eventManager",void 0),ko(this,"settings",void 0),ko(this,"THEAD",void 0),ko(this,"TBODY",void 0),ko(this,"_wt",void 0),ko(this,"activeWt",void 0),Ro(this,_o,{writable:!0,value:0}),Ro(this,xo,{writable:!0,value:0}),ko(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new y.a(this.instance),this.settings=this.instance.getSettings(),Mo.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var e,n,o;return e=t,n=[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}},{key:"getCellAtCoords",value:function(t,e){var td=this._wt.getCell(t,e);return td<0?null:td}},{key:"scrollViewport",value:function(t,e,n,r,o){return this._wt.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this._wt.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this._wt.scrollViewportVertically(t,e,n)}},{key:"createElements",value:function(){var t=Mo.get(this),e=this.instance,n=e.rootElement,o=e.rootDocument,l=n.getAttribute("style");l&&n.setAttribute("data-originalstyle",l),Object(r.addClass)(n,"handsontable"),t.table=o.createElement("TABLE"),Object(r.addClass)(t.table,"htCore"),this.instance.getSettings().tableClassName&&Object(r.addClass)(t.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var t=this,e=Mo.get(this),n=this.instance,o=n.rootElement,l=n.rootDocument,c=n.selection,f=l.documentElement;this.eventManager.addEventListener(o,"mousedown",(function(n){if(e.selectionMouseDown=!0,!t.isTextSelectionAllowed(n.target)){var o=t.instance.rootWindow;Object(r.clearTextSelection)(o),n.preventDefault(),o.focus()}})),this.eventManager.addEventListener(o,"mouseup",(function(){e.selectionMouseDown=!1})),this.eventManager.addEventListener(o,"mousemove",(function(n){e.selectionMouseDown&&!t.isTextSelectionAllowed(n.target)&&(t.settings.fragmentSelection&&Object(r.clearTextSelection)(t.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(f,"keyup",(function(t){c.isInProgress()&&!t.shiftKey&&c.finish()})),this.eventManager.addEventListener(f,"mouseup",(function(n){c.isInProgress()&&Object(k.isLeftClick)(n)&&c.finish(),e.mouseDown=!1,!Object(r.isOutsideInput)(l.activeElement)&&(c.isSelected()||c.isSelectedByAnyHeader()||o.contains(n.target)||Object(k.isRightClick)(n))||t.instance.unlisten()})),this.eventManager.addEventListener(f,"contextmenu",(function(t){c.isInProgress()&&Object(k.isRightClick)(t)&&(c.finish(),e.mouseDown=!1)})),this.eventManager.addEventListener(f,"touchend",(function(){c.isInProgress()&&c.finish(),e.mouseDown=!1})),this.eventManager.addEventListener(f,"mousedown",(function(n){var c=n.target,h=n.x||n.clientX,d=n.y||n.clientY,y=n.target;if(!e.mouseDown&&o&&t.instance.view){var v=t.instance.view._wt.wtTable.holder;if(y===v){var m=Object(r.getScrollbarWidth)(l);if(l.elementFromPoint(h+m,d)!==v||l.elementFromPoint(h,d+m)!==v)return}else for(;y!==f;){if(null===y){if(n.isTargetWebComponent)break;return}if(y===o)return;y=y.parentNode}("function"==typeof t.settings.outsideClickDeselects?t.settings.outsideClickDeselects(c):t.settings.outsideClickDeselects)?t.instance.deselectCell():t.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(e.table,"selectstart",(function(e){t.settings.fragmentSelection||Object(r.isInput)(e.target)||e.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(t){var e,n=t.row,col=t.col;return(e=this.instance)._createCellCoords.apply(e,Oo(this.translateFromRenderableToVisualIndex(n,col)))}},{key:"translateFromRenderableToVisualIndex",value:function(t,e){var n=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t,r=e>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===n&&(n=t),null===r&&(r=e),[n,r]}},{key:"countRenderableIndexes",value:function(t,e){var n=Math.min(t.getNotTrimmedIndexesLength(),e),r=t.getNearestNotHiddenIndex(n-1,-1);return null===r?0:t.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(t,e,n,r){if(isNaN(t)||t<0)return 0;var o=n.getNearestNotHiddenIndex(t,e),l=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(l))return 0;var c=0;return e<0?c=l+1:e>0&&(c=r-l),c}},{key:"countNotHiddenFixedColumnsStart",value:function(){var t=this.instance.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var t=this.instance.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var t=this.instance.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>t&&this.instance.countRenderedCols()>e}},{key:"initializeWalkontable",value:function(){var t=this,e=Mo.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:function(){return Object(mo.b)(t.instance)},preventOverflow:function(){return t.settings.preventOverflow},preventWheel:function(){return t.settings.preventWheel},stretchH:function(){return t.settings.stretchH},data:function(e,n){var r;return(r=t.instance).getDataAtCell.apply(r,Oo(t.translateFromRenderableToVisualIndex(e,n)))},totalRows:function(){return t.countRenderableRows()},totalColumns:function(){return t.countRenderableColumns()},fixedColumnsStart:function(){return t.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return t.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return t.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return t.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return t.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return t.settings.fixedRowsBottom>0},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var e=[];return t.instance.hasRowHeaders()&&e.push((function(e,n){var r=e>=0?t.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e;t.appendRowHeader(r,n)})),t.instance.runHooks("afterGetRowHeaderRenderers",e),Po(t,xo,e.length),e},columnHeaders:function(){var e=[];return t.instance.hasColHeaders()&&e.push((function(e,n){var r=e>=0?t.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;t.appendColHeader(r,n)})),t.instance.runHooks("afterGetColumnHeaderRenderers",e),Po(t,_o,e.length),e},columnWidth:function(e){var n=t.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getColWidth(null===n?e:n)},rowHeight:function(e){var n=t.instance.rowIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getRowHeight(null===n?e:n)},cellRenderer:function(e,n,r){var o=wo(t.translateFromRenderableToVisualIndex(e,n),2),l=o[0],c=o[1],f=t.instance.runHooks("modifyGetCellCoords",l,c),h=l,d=c;if(Array.isArray(f)){var y=wo(f,2);h=y[0],d=y[1]}var v=t.instance.getCellMeta(h,d),m=t.instance.colToProp(d),w=t.instance.getDataAtRowProp(h,m);t.instance.hasHook("beforeValueRender")&&(w=t.instance.runHooks("beforeValueRender",w,v)),t.instance.runHooks("beforeRenderer",r,l,c,m,w,v),t.instance.getCellRenderer(v)(t.instance,r,l,c,m,w,v),t.instance.runHooks("afterRenderer",r,l,c,m,w,v)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onWindowResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onContainerElementResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,l){var c=t.translateFromRenderableToVisualCoords(r),f={row:!1,column:!1,cell:!1};t.instance.listen(),t.activeWt=l,e.mouseDown=!0,t.instance.runHooks("beforeOnCellMouseDown",n,c,o,f),Object(k.isImmediatePropagationStopped)(n)||(vo(n,{coords:c,selection:t.instance.selection,controller:f,cellCoordsFactory:function(e,n){return t.instance._createCellCoords(e,n)}}),t.instance.runHooks("afterOnCellMouseDown",n,c,o),t.activeWt=t._wt)},onCellContextMenu:function(n,r,o,l){var c=t.translateFromRenderableToVisualCoords(r);t.activeWt=l,e.mouseDown=!1,t.instance.selection.isInProgress()&&t.instance.selection.finish(),t.instance.runHooks("beforeOnCellContextMenu",n,c,o),Object(k.isImmediatePropagationStopped)(n)||(t.instance.runHooks("afterOnCellContextMenu",n,c,o),t.activeWt=t._wt)},onCellMouseOut:function(e,n,r,o){var l=t.translateFromRenderableToVisualCoords(n);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseOut",e,l,r),Object(k.isImmediatePropagationStopped)(e)||(t.instance.runHooks("afterOnCellMouseOut",e,l,r),t.activeWt=t._wt)},onCellMouseOver:function(n,r,o,l){var c=t.translateFromRenderableToVisualCoords(r),f={row:!1,column:!1,cell:!1};t.activeWt=l,t.instance.runHooks("beforeOnCellMouseOver",n,c,o,f),Object(k.isImmediatePropagationStopped)(n)||(e.mouseDown&&vo(n,{coords:c,selection:t.instance.selection,controller:f,cellCoordsFactory:function(e,n){return t.instance._createCellCoords(e,n)}}),t.instance.runHooks("afterOnCellMouseOver",n,c,o),t.activeWt=t._wt)},onCellMouseUp:function(e,n,r,o){var l=t.translateFromRenderableToVisualCoords(n);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseUp",e,l,r),Object(k.isImmediatePropagationStopped)(e)||t.instance.isDestroyed||(t.instance.runHooks("afterOnCellMouseUp",e,l,r),t.activeWt=t._wt)},onCellCornerMouseDown:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(e,n){return t.beforeRender(e,n)},onDraw:function(e){return t.afterRender(e)},onScrollVertically:function(){return t.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return t.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return t.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(e,n,r){var o=t.instance.rowIndexMapper,l=o.getVisualFromRenderableIndex(e),c=t.instance.runHooks("beforeHighlightingRowHeader",l,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:function(e,n,r){var o=t.instance.columnIndexMapper,l=o.getVisualFromRenderableIndex(e),c=t.instance.runHooks("beforeHighlightingColumnHeader",l,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1))},onAfterDrawSelection:function(e,n,r){var o,l=wo(t.translateFromRenderableToVisualIndex(e,n),2),c=l[0],f=l[1],h=t.instance.selection.getSelectedRange(),d=h.size();if(d>0){var y=(null!=r?r:0)+1-d,v=h.peekByIndex(y);o=[v.from.row,v.from.col,v.to.row,v.to.col]}return t.instance.runHooks("afterDrawSelection",c,f,o,r)},onBeforeDrawBorders:function(e,n){var r=wo(e,4),o=r[0],l=r[1],c=r[2],f=r[3],h=[t.instance.rowIndexMapper.getVisualFromRenderableIndex(o),t.instance.columnIndexMapper.getVisualFromRenderableIndex(l),t.instance.rowIndexMapper.getVisualFromRenderableIndex(c),t.instance.columnIndexMapper.getVisualFromRenderableIndex(f)];return t.instance.runHooks("beforeDrawBorders",h,n)},onBeforeTouchScroll:function(){return t.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return t.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,n){var r=t.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return t.instance.runHooks("beforeStretchingColumnWidth",e,r)},onModifyRowHeaderWidth:function(e){return t.instance.runHooks("modifyRowHeaderWidth",e)},onModifyGetCellCoords:function(e,n,r){var o=t.instance.rowIndexMapper,l=t.instance.columnIndexMapper,c=n>=0?l.getVisualFromRenderableIndex(n):n,f=e>=0?o.getVisualFromRenderableIndex(e):e,h=t.instance.runHooks("modifyGetCellCoords",f,c,r);if(Array.isArray(h)){var d=wo(h,4),y=d[0],v=d[1],m=d[2],w=d[3];return[y>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(y,1)):y,v>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,1)):v,m>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(m,-1)):m,w>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:function(e){var n=t.settings.viewportRowRenderingOffset;if("auto"===n&&t.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=t.countRenderableRows(),o=e.startRow,l=e.endRow;if("number"==typeof n)e.startRow=Math.max(o-n,0),e.endRow=Math.min(l+n,r-1);else if("auto"===n){var c=Math.ceil(l/r*12);e.startRow=Math.max(o-c,0),e.endRow=Math.min(l+c,r-1)}}t.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var n=t.settings.viewportColumnRenderingOffset;if("auto"===n&&t.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=t.countRenderableColumns(),o=e.startColumn,l=e.endColumn;if("number"==typeof n&&(e.startColumn=Math.max(o-n,0),e.endColumn=Math.min(l+n,r-1)),"auto"===n){var c=Math.ceil(l/r*6);e.startColumn=Math.max(o-c,0),e.endColumn=Math.min(l+c,r-1)}}t.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.instance.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new po(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),l=o.width,c=o.height;this.setLastSize(l,c),this.eventManager.addEventListener(r,"mousedown",(function(t){t.target===r&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(t){t.target===r&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){t.settings.observeDOMVisibility&&t._wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())}))}},{key:"isTextSelectionAllowed",value:function(t){if(Object(r.isInput)(t))return!0;var e=Object(r.isChildOf)(t,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Mo.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var t,e;return null!==(t=null===(e=this.instance.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&void 0!==t&&t}},{key:"isCellEdited",value:function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function(t,e){t&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,e)}},{key:"afterRender",value:function(t){t&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(t,e){if(e.firstChild){var n=e.firstChild;if(!Object(r.hasClass)(n,"relative"))return Object(r.empty)(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var o=this.instance,l=o.rootDocument,c=o.getRowHeader,div=l.createElement("div"),span=l.createElement("span");div.className="relative",span.className="rowHeader",this.updateCellHeader(span,t,c),div.appendChild(span),e.appendChild(div)}this.instance.runHooks("afterGetRowHeader",t,e)}},{key:"appendColHeader",value:function(t,e){var label=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){var o=e.firstChild;Object(r.hasClass)(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),t,label,n):(Object(r.empty)(e),this.appendColHeader(t,e,label,n))}else{var l=this.instance.rootDocument,div=l.createElement("div"),span=l.createElement("span");div.className="relative",span.className="colHeader",this.updateCellHeader(span,t,label,n),div.appendChild(span),e.appendChild(div)}this.instance.runHooks("afterGetColHeader",t,e,n)}},{key:"updateCellHeader",value:function(element,t,content){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=t,o=this._wt.wtOverlays.getParentOverlay(element)||this._wt;element.parentNode&&(Object(r.hasClass)(element,"colHeader")?n=o.wtTable.columnFilter.sourceToRendered(t):Object(r.hasClass)(element,"rowHeader")&&(n=o.wtTable.rowFilter.sourceToRendered(t))),n>-1?Object(r.fastInnerHTML)(element,content(t,e)):(Object(r.fastInnerText)(element,String.fromCharCode(160)),Object(r.addClass)(element,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(t){var e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}},{key:"maximumVisibleElementHeight",value:function(t){var e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}},{key:"setLastSize",value:function(t,e){var n=Mo.get(this),r=[t,e];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var t=Mo.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return To(this,_o)}},{key:"getRowHeadersCount",value:function(){return To(this,xo)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}],n&&Eo(e.prototype,n),o&&Eo(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),No=Io,Ho=n(732);function Do(t){return Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Do(t)}function Lo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Do(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Do(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Do(o)?o:String(o)),n)}var r,o}var Bo=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var e,n,r;return e=t,n=[{key:"modifyRowData",value:function(t){var e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}},{key:"setData",value:function(data){this.data=data}},{key:"getAtColumn",value:function(t){var e=this,n=[];return Object(v.arrayEach)(this.data,(function(r,o){var l=e.getAtCell(o,t);n.push(l)})),n}},{key:"getAtRow",value:function(t,e,n){var r=this,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=void 0===e&&void 0===n,f=null,h=null;if(f=this.modifyRowData(t),Array.isArray(f))h=[],c?f.forEach((function(e,n){h[n]=r.getAtPhysicalCell(t,n,f)})):Object(R.rangeEach)(e,n,(function(n){h[n-e]=r.getAtPhysicalCell(t,n,f)}));else if(Object(object.isObject)(f)||Object(o.isFunction)(f))if(h=l?[]:{},!c||l){var d=this.countFirstRowKeys()-1;Object(R.rangeEach)(0,d,(function(o){var c=r.colToProp(o);if(o>=(e||0)&&o<=(n||d)&&!Number.isInteger(c)){var y=r.getAtPhysicalCell(t,c,f);l?h.push(y):Object(object.setProperty)(h,c,y)}}))}else Object(object.objectEach)(f,(function(e,n){Object(object.setProperty)(h,n,r.getAtPhysicalCell(t,n,f))}));return h}},{key:"setAtCell",value:function(t,e,n){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=Object(object.createObjectPropListener)(n);this.hot.runHooks("modifySourceData",t,this.propToCol(e),r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(e)?this.data[t][e]=n:Object(object.setProperty)(this.data[t],e,n)}}},{key:"getAtPhysicalCell",value:function(t,e,n){var r=null;if(n&&(r="string"==typeof e?Object(object.getProperty)(n,e):"function"==typeof e?e(n):n[e]),this.hot.hasHook("modifySourceData")){var o=Object(object.createObjectPropListener)(r);this.hot.runHooks("modifySourceData",t,this.colToProp(e),o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(t,e){var n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),n)}},{key:"getByRange",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,l=null,c=null,f=null,h=null;null===e||null===n?(o=!0,l=0,f=this.countRows()-1):(l=Math.min(e.row,n.row),c=Math.min(e.col,n.col),f=Math.max(e.row,n.row),h=Math.max(e.col,n.col));var d=[];return Object(R.rangeEach)(l,f,(function(e){d.push(o?t.getAtRow(e,void 0,void 0,r):t.getAtRow(e,c,h,r))})),d}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Object(Ho.countFirstRowKeys)(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}],n&&Lo(e.prototype,n),r&&Lo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Fo=Bo,Vo=(n(195),n(13),n(63),n(848)),Wo=n(849),Uo=n(768),zo=n(850),Go=n(790),Yo=n(851),Xo=new Map([["hiding",Wo.a],["index",Uo.a],["linkedPhysicalIndexToValue",zo.a],["physicalIndexToValue",Go.a],["trimming",Yo.a]]);var Ko=n(767),$o=n(942);function qo(t){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qo(t)}function Qo(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==qo(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==qo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===qo(o)?o:String(o)),n)}var r,o}function Jo(t,p){return Jo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},Jo(t,p)}function Zo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ti(t);if(e){var o=ti(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===qo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function ti(t){return ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ti(t)}var ei=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jo(t,e)}(c,t);var e,n,r,o=Zo(c);function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=o.call(this)).mergedValuesCache=[],n.aggregationFunction=t,n.fallbackValue=e,n}return e=c,n=[{key:"getMergedValues",value:function(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=Object(v.arrayMap)(this.get(),(function(map){return map.getValues()})),e=[],n=Object(l.isDefined)(t[0])&&t[0].length||0,r=0;r<n;r+=1){for(var o=[],c=0;c<this.getLength();c+=1)o.push(t[c][r]);e.push(o)}return Object(v.arrayMap)(e,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(t,e){var n=this.getMergedValues(e)[t];return Object(l.isDefined)(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}],n&&Qo(e.prototype,n),r&&Qo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}($o.a),ni=n(716);function ri(t){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ri(t)}function oi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ri(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ri(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ri(o)?o:String(o)),n)}var r,o}function ii(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function ai(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,si(t,e,"set"),n),n}function si(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var ui=new WeakMap,ci=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ii(this,ui,{writable:!0,value:[]})}var e,n,r;return e=t,(n=[{key:"subscribe",value:function(t){var e;return this.addLocalHook("change",t),this._write(function(t,e){return e.get?e.get.call(t):e.value}(e=this,si(e,ui,"get"))),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(t){return t.length>0&&this.runLocalHooks("change",t),this}},{key:"_writeInitialChanges",value:function(t){ai(this,ui,t)}}])&&oi(e.prototype,n),r&&oi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fi(t,e){for(var n=[],i=0,r=0;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function hi(t){return hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hi(t)}function di(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==hi(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==hi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===hi(o)?o:String(o)),n)}var r,o}function pi(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function yi(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,vi(t,e,"get"))}function bi(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,vi(t,e,"set"),n),n}function vi(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}Object(object.mixin)(ci,ni.a);var mi,gi=new WeakMap,wi=new WeakMap,Oi=new WeakMap,Si=new WeakMap,Ci=new WeakMap,Ei=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).initialIndexValue;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),pi(this,gi,{writable:!0,value:new Set}),pi(this,wi,{writable:!0,value:[]}),pi(this,Oi,{writable:!0,value:[]}),pi(this,Si,{writable:!0,value:!1}),pi(this,Ci,{writable:!0,value:!1}),bi(this,Ci,null!=e&&e)}var e,n,r;return e=t,(n=[{key:"createObserver",value:function(){var t=this,e=new ci;return yi(this,gi).add(e),e.addLocalHook("unsubscribe",(function(){yi(t,gi).delete(e)})),e._writeInitialChanges(fi(yi(this,wi),yi(this,Oi))),e}},{key:"emit",value:function(t){var e=yi(this,Oi);yi(this,Si)&&yi(this,wi).length===t.length||(0===t.length?t=new Array(e.length).fill(yi(this,Ci)):bi(this,wi,new Array(t.length).fill(yi(this,Ci))),yi(this,Si)||(bi(this,Si,!0),e=yi(this,wi)));var n=fi(e,t);yi(this,gi).forEach((function(t){return t._write(n)})),bi(this,Oi,t)}}])&&di(e.prototype,n),r&&di(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ri(t){return Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ri(t)}function ki(t){return function(t){if(Array.isArray(t))return ji(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ji(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ji(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ji(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ti(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ri(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ri(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ri(o)?o:String(o)),n)}var r,o}var Pi=new Set(["getFirstNotHiddenIndex"]),Ai=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.indexesSequence=new Vo.a,this.trimmingMapsCollection=new ei((function(t){return t.some((function(t){return!0===t}))}),!1),this.hidingMapsCollection=new ei((function(t){return t.some((function(t){return!0===t}))}),!1),this.variousMapsCollection=new $o.a,this.hidingChangesObservable=new Ei({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("change",e.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(t){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(t){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(t){e.runLocalHooks("change",t,e.variousMapsCollection)}))}var e,n,r;return e=t,n=[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(t){if("hiding"!==t)throw new Error('Unsupported index map type "'.concat(t,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(t,e,n){return this.registerMap(t,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Xo.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(Xo.get(t))(e)}(e,n))}},{key:"registerMap",value:function(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error('Map with name "'.concat(t,'" has been already registered.'));e instanceof Yo.a?this.trimmingMapsCollection.register(t,e):e instanceof Wo.a?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);var n=this.getNumberOfIndexes();return n>0&&e.init(n),e}},{key:"unregisterMap",value:function(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(t){var e=this.notTrimmedIndexesCache[t];return Object(l.isDefined)(e)?e:null}},{key:"getPhysicalFromRenderableIndex",value:function(t){var e=this.renderablePhysicalIndexesCache[t];return Object(l.isDefined)(e)?e:null}},{key:"getVisualFromPhysicalIndex",value:function(t){var e=this.fromPhysicalToVisualIndexesCache.get(t);return Object(l.isDefined)(e)?e:null}},{key:"getVisualFromRenderableIndex",value:function(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}},{key:"getRenderableFromVisualIndex",value:function(t){var e=this.fromVisualToRenderableIndexesCache.get(t);return Object(l.isDefined)(e)?e:null}},{key:"getFirstNotHiddenIndex",value:function(t,e){var n,r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t-e;Pi.has("getFirstNotHiddenIndex")&&(Pi.delete("getFirstNotHiddenIndex"),Object(f.b)(Object(h.a)(mi||(n=['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next \n                        major release. Please use "getNearestNotHiddenIndex" instead.'],(r=['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20\n                        major release. Please use "getNearestNotHiddenIndex" instead.'])||(r=n.slice(0)),mi=Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}}))))));var c=this.getPhysicalFromVisualIndex(t);return null===c?!0===o&&l!==t-e?this.getFirstNotHiddenIndex(l,-e,!1,l):null:!1===this.isHidden(c)?t:this.getFirstNotHiddenIndex(t+e,e,o,l)}},{key:"getNearestNotHiddenIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;var r=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return-1===(o=e>0?r.findIndex((function(e){return e>t})):r.reverse().findIndex((function(e){return e<t})))?n?this.getNearestNotHiddenIndex(t,-e,!1):null:r[o]}},{key:"initToLength",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=ki(new Array(t).keys()),this.notHiddenIndexesCache=ki(new Array(t).keys()),this.suspendOperations(),this.indexesSequence.init(t),this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(t){var e=this.getNumberOfIndexes();if(t<e){var n=ki(Array(this.getNumberOfIndexes()-t).keys()).map((function(i){return i+t}));this.removeIndexes(n)}else this.insertIndexes(e,t-e)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(t){this.indexesSequence.setValues(t)}},{key:"getNotTrimmedIndexes",value:function(){var t=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notTrimmedIndexesCache:this.getIndexesSequence().filter((function(e){return!1===t.isTrimmed(e)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var t=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notHiddenIndexesCache:this.getIndexesSequence().filter((function(e){return!1===t.isHidden(e)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var t=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter((function(e){return!1===t.isHidden(e)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(t,e){var n=this;"number"==typeof t&&(t=[t]);var r=Object(v.arrayMap)(t,(function(t){return n.getPhysicalFromVisualIndex(t)})),o=this.getNotTrimmedIndexesLength(),l=t.length,c=Object(Ko.b)(this.getIndexesSequence(),r),f=o-l;if(e+l<o){var h=c.filter((function(t){return!1===n.isTrimmed(t)}))[e];f=c.indexOf(h)}this.setIndexesSequence(Object(Ko.a)(c,f,r))}},{key:"isTrimmed",value:function(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}},{key:"isHidden",value:function(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}},{key:"insertIndexes",value:function(t,e){var n=this.getNotTrimmedIndexes()[t],r=Object(l.isDefined)(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),c=Object(v.arrayMap)(new Array(e).fill(r),(function(t,e){return t+e}));this.suspendOperations(),this.indexesSequence.insert(o,c),this.trimmingMapsCollection.insertToEvery(o,c),this.hidingMapsCollection.insertToEvery(o,c),this.variousMapsCollection.insertToEvery(o,c),this.resumeOperations()}},{key:"removeIndexes",value:function(t){this.suspendOperations(),this.indexesSequence.remove(t),this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}},{key:"updateCache",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var e=0;e<t;e+=1){var n=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(n,e)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var e=0;e<t;e+=1){var n=this.getPhysicalFromRenderableIndex(e),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,e)}}}],n&&Ti(e.prototype,n),r&&Ti(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(object.mixin)(Ai,ni.a);var Mi=n(688),_i=n(871),xi=n(847),Ii=(n(14),n(16),n(17),n(730)),Ni=n(733);n(670),n(306),n(115);function Hi(t){return Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hi(t)}function Di(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Li(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Li(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Li(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Bi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Hi(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Hi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Hi(o)?o:String(o)),n)}var r,o}var Fi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}var e,n,o;return e=t,n=[{key:"registerListeners",value:function(){var t=this,e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(function(){return t.onMouseDown()})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}));for(var n=function(e){var element=t.main.childNodes[e];t.eventManager.addEventListener(element,"mouseenter",(function(n){return t.onMouseEnter(n,t.main.childNodes[e])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),Object(k.stopImmediatePropagation)(t);var n=this,r=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function t(l){var c;((c=l).clientY<Math.floor(o.top)||c.clientY>Math.ceil(o.top+o.height)||c.clientX<Math.floor(o.left)||c.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(r,"mousemove",t),e.style.display="block")}))}}},{key:"createBorders",value:function(t){var e=this.wot.rootDocument;this.main=e.createElement("div");var n=["top","start","bottom","end","corner"],style=this.main.style;style.position="absolute",style.top=0,style.left=0;for(var i=0;i<5;i++){var r=n[i],div=e.createElement("div");div.className="wtBorder ".concat(this.settings.className||""),this.settings[r]&&this.settings[r].hide&&(div.className+=" hidden"),(style=div.style).backgroundColor=this.settings[r]&&this.settings[r].color?this.settings[r].color:t.border.color,style.height=this.settings[r]&&this.settings[r].width?"".concat(this.settings[r].width,"px"):"".concat(t.border.width,"px"),style.width=this.settings[r]&&this.settings[r].width?"".concat(this.settings[r].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(div)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(c.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var o=this.wot.wtTable,l=o.bordersHolder;l||((l=e.createElement("div")).className="htBorders",o.bordersHolder=l,o.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this,e=this.wot.rootDocument;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var n={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};Object(object.objectEach)(n,(function(e,n){t.selectionHandles.styles.bottomHitArea[n]=e,t.selectionHandles.styles.topHitArea[n]=e}));var r={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Object(object.objectEach)(r,(function(e,n){t.selectionHandles.styles.bottom[n]=e,t.selectionHandles.styles.top[n]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(t,col){var e=this.wot.selections.createOrGetArea();return!(!e.cellRange||t===e.cellRange.to.row&&col===e.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,col,e,n,r,o){var l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",c=this.selectionHandles.styles,f=c.top,h=c.topHitArea,d=c.bottom,y=c.bottomHitArea,v=parseInt(f.borderWidth,10),m=parseInt(f.width,10),w=parseInt(h.width,10),O=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();f.top="".concat(parseInt(e-m-1,10),"px"),f[l]="".concat(parseInt(n-m-1,10),"px"),h.top="".concat(parseInt(e-w/4*3,10),"px"),h[l]="".concat(parseInt(n-w/4*3,10),"px");var C=Math.min(parseInt(n+r,10),O-m-2*v),E=Math.min(parseInt(n+r-w/4,10),O-w-2*v);d[l]="".concat(C,"px"),y[l]="".concat(E,"px");var R=Math.min(parseInt(e+o,10),S-m-2*v),k=Math.min(parseInt(e+o-w/4,10),S-w-2*v);d.top="".concat(R,"px"),y.top="".concat(k,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(f.display="block",h.display="block",this.isPartRange(t,col)?(d.display="none",y.display="none"):(d.display="block",y.display="block")):(f.display="none",d.display="none",h.display="none",y.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||col===this.wot.wtSettings.getSetting("fixedColumnsStart")?(f.zIndex="9999",h.zIndex="9999"):(f.zIndex="",h.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e,n,o,l,f,h,d=this.wot,y=d.wtTable,v=d.rootDocument,m=d.rootWindow,w=y.getRenderedRowsCount(),i=0;i<w;i+=1){var s=y.rowFilter.renderedToSource(i);if(s>=t[0]&&s<=t[2]){e=s,f=t[0];break}}for(var O=w-1;O>=0;O-=1){var S=y.rowFilter.renderedToSource(O);if(S>=t[0]&&S<=t[2]){n=S;break}}for(var C=y.getRenderedColumnsCount(),E=0;E<C;E+=1){var R=y.columnFilter.renderedToSource(E);if(R>=t[1]&&R<=t[3]){o=R,h=t[1];break}}for(var k=C-1;k>=0;k-=1){var j=y.columnFilter.renderedToSource(k);if(j>=t[1]&&j<=t[3]){l=j;break}}if(void 0!==e&&void 0!==o){var T=y.getCell(this.wot.createCellCoords(e,o)),P=e!==n||o!==l,A=P?y.getCell(this.wot.createCellCoords(n,l)):T,M=Object(r.offset)(T),_=P?Object(r.offset)(A):M,x=Object(r.offset)(y.TABLE),I=Object(r.outerWidth)(y.TABLE),N=M.top,H=M.left,D=this.wot.wtSettings.getSetting("rtlMode"),L=0,B=0;if(D){var F=Object(r.outerWidth)(T),V=m.innerWidth-x.left-I;B=H+F-_.left,L=m.innerWidth-H-F-V-1}else B=_.left+Object(r.outerWidth)(A)-H,L=H-x.left-1;if(this.isEntireColumnSelected(e,n)){var W=this.getDimensionsFromHeader("columns",o,l,f,x),U=null;if(W){var z=Di(W,3);U=z[0],L=z[1],B=z[2]}U&&(T=U)}var G=N-x.top-1,Y=_.top+Object(r.outerHeight)(A)-N;if(this.isEntireRowSelected(o,l)){var X=this.getDimensionsFromHeader("rows",e,n,h,x),K=null;if(X){var $=Di(X,3);K=$[0],G=$[1],Y=$[2]}K&&(T=K)}var style=Object(r.getComputedStyle)(T,m);parseInt(style.borderTopWidth,10)>0&&(G+=1,Y=Y>0?Y-1:0),parseInt(style[D?"borderRightWidth":"borderLeftWidth"],10)>0&&(L+=1,B=B>0?B-1:0);var Q=D?"right":"left";this.topStyle.top="".concat(G,"px"),this.topStyle[Q]="".concat(L,"px"),this.topStyle.width="".concat(B,"px"),this.topStyle.display="block",this.startStyle.top="".concat(G,"px"),this.startStyle[Q]="".concat(L,"px"),this.startStyle.height="".concat(Y,"px"),this.startStyle.display="block";var J=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(G+Y-J,"px"),this.bottomStyle[Q]="".concat(L,"px"),this.bottomStyle.width="".concat(B,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(G,"px"),this.endStyle[Q]="".concat(L+B-J,"px"),this.endStyle.height="".concat(Y+1,"px"),this.endStyle.display="block";var Z=this.settings.border.cornerVisible;Z="function"==typeof Z?Z(this.settings.layerLevel):Z;var tt=this.wot.getSetting("onModifyGetCellCoords",n,l),et=n,nt=l;if(tt&&Array.isArray(tt)){var ot=Di(tt,4);et=ot[2],nt=ot[3]}if(Object(c.isMobileBrowser)()||!Z||this.isPartRange(et,nt))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(G+Y+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[Q]="".concat(L+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var it=Object(r.getTrimmingContainer)(y.TABLE),at=it===m;at&&(it=v.documentElement);var lt=parseInt(this.cornerDefaultStyle.width,10)/2,st=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){var ut=at?A.getBoundingClientRect().left:A.offsetLeft;(D?ut-parseInt(this.cornerDefaultStyle.width,10)/2<0:ut+Object(r.outerWidth)(A)+parseInt(this.cornerDefaultStyle.width,10)/2>=Object(r.innerWidth)(it))&&(this.cornerStyle[Q]="".concat(Math.floor(L+B+this.cornerCenterPointOffset-lt),"px"),this.cornerStyle[D?"borderLeftWidth":"borderRightWidth"]=0)}n===this.wot.getSetting("totalRows")-1&&(at?A.getBoundingClientRect().top:A.offsetTop)+Object(r.outerHeight)(A)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(r.innerHeight)(it)&&(this.cornerStyle.top="".concat(Math.floor(G+Y+this.cornerCenterPointOffset-st),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Object(c.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(n,l,G,L,B,Y)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,n,o,l){var c=this.wot.wtTable,f=c.wtRootElement.parentNode,h=null,d=null,y=null,v=null,m=null,w=null,O=null,S=null;switch(t){case"rows":h=function(){return c.getRowHeader.apply(c,arguments)},d=function(){return r.outerHeight.apply(void 0,arguments)},y="ht__selection--rows",w="top";break;case"columns":h=function(){return c.getColumnHeader.apply(c,arguments)},d=function(){return r.outerWidth.apply(void 0,arguments)},y="ht__selection--columns",w="left"}if(f.classList.contains(y)){var C=this.wot.getSetting("columnHeaders").length;if(O=h(e,C-o),S=h(n,C-o),!O||!S)return!1;var E=Object(r.offset)(O),R=Object(r.offset)(S);return O&&S&&(v=E[w]-l[w]-1,m=R[w]+d(S)-E[w]),[O,v,m]}return!1}},{key:"changeBorderStyle",value:function(t,e){var style=this[t].style,n=e[t];!n||n.hide?Object(r.addClass)(this[t],"hidden"):(Object(r.hasClass)(this[t],"hidden")&&Object(r.removeClass)(this[t],"hidden"),style.backgroundColor=n.color,"top"!==t&&"bottom"!==t||(style.height="".concat(n.width,"px")),"start"!==t&&"end"!==t||(style.width="".concat(n.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var e=1,n="#000",style=this[t].style;style.backgroundColor=n,style.width="".concat(e,"px"),style.height="".concat(e,"px")}},{key:"toggleHiddenClass",value:function(t,e){this.changeBorderToDefaultStyle(t),e?Object(r.addClass)(this[t],"hidden"):Object(r.removeClass)(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Object(c.isMobileBrowser)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}],n&&Bi(e.prototype,n),o&&Bi(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Vi=Fi;function Wi(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Ui(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ui(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function zi(t){return zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zi(t)}function Gi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==zi(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==zi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===zi(o)?o:String(o)),n)}var r,o}var Yi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var e,n,o;return e=t,n=[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new Vi(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,o){var l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=t.wtTable.getCell(this.settings.createCellCoords(e,n));if("object"===zi(c)){var f=o;l&&(f=this.classNameGenerator(c),this.classNames.includes(f)||this.classNames.push(f)),Object(r.addClass)(c,f)}return this}},{key:"linearClassNameGenerator",value:function(t,e){return function n(element){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===o)return t;var l=o>=0?o:e,c=t,f=0==(l-=1)?t:"".concat(t,"-").concat(l);if(Object(r.hasClass)(element,f)){var h=l+1;c="".concat(t,"-").concat(h)}else c=n(element,l);return c}}},{key:"draw",value:function(t){if(this.isEmpty())this.settings.border&&this.getBorder(t).disappear();else{var e=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),o=this.getCorners(),l=Wi(o,4),c=l[0],f=l[1],h=l[2],d=l[3],y=this.settings,v=y.highlightHeaderClassName,m=y.highlightColumnClassName,w=y.highlightRowClassName,O=y.highlightOnlyClosestHeader,S=y.selectionType,C=void 0===S||["active-header","header"].includes(S);if(C&&null!==f&&null!==d)for(var E=0,R=0;R<n;R+=1){var k=t.wtTable.columnFilter.renderedToSource(R);if(k>=f&&k<=d){var j=t.wtTable.getColumnHeaders(k),T=j.length-1;O&&j.length>1&&(j=[j[T]]);for(var P=0;P<j.length;P+=1){var A=[],M=j[P];v&&A.push(v),m&&A.push(m),P=O?T:P;var _=t.getSetting("onBeforeHighlightingColumnHeader",k,P,{selectionType:S,columnCursor:E,selectionWidth:d-f+1,classNames:A});_!==k&&(M=t.wtTable.getColumnHeader(_,P)),Object(r.addClass)(M,A)}E+=1}}if(null!==c&&null!==h)for(var x=0,I=0;I<e;I+=1){var N=t.wtTable.rowFilter.renderedToSource(I);if(C&&N>=c&&N<=h){var H=t.wtTable.getRowHeaders(N),D=H.length-1;O&&H.length>1&&(H=[H[D]]);for(var L=0;L<H.length;L+=1){var B=[],F=H[L];v&&B.push(v),w&&B.push(w),L=O?D:L;var V=t.getSetting("onBeforeHighlightingRowHeader",N,L,{selectionType:S,rowCursor:x,selectionHeight:h-c+1,classNames:B});V!==N&&(F=t.wtTable.getRowHeader(V,L)),Object(r.addClass)(F,B)}x+=1}if(null!==f&&null!==d)for(var W=0;W<n;W+=1){var U=t.wtTable.columnFilter.renderedToSource(W);N>=c&&N<=h&&U>=f&&U<=d?this.settings.className&&this.addClassAtCoords(t,N,U,this.settings.className,this.settings.markIntersections):N>=c&&N<=h?w&&this.addClassAtCoords(t,N,U,w):U>=f&&U<=d&&m&&this.addClassAtCoords(t,N,U,m);var z=t.getSetting("onAfterDrawSelection",N,U,this.settings.layerLevel);"string"==typeof z&&this.addClassAtCoords(t,N,U,z)}}t.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(t).appear(o)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(t){return t.destroy()}))}}],n&&Gi(e.prototype,n),o&&Gi(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Xi(t){return Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xi(t)}function Ki(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ta(n.key),n)}}function $i(){return $i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Zi(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(arguments.length<3?t:n):desc.value}},$i.apply(this,arguments)}function qi(t,p){return qi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,p){return t.__proto__=p,t},qi(t,p)}function Qi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zi(t);if(e){var o=Zi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Xi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ji(t)}(this,n)}}function Ji(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zi(t){return Zi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zi(t)}function ta(t){var e=function(input,t){if("object"!==Xi(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Xi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Xi(e)?e:String(e)}var ea=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qi(t,e)}(l,t);var e,n,r,o=Qi(l);function l(t,e){var n,r,c,f;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,t,null),r=Ji(n),f=null,(c=ta(c="visualCellRange"))in r?Object.defineProperty(r,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):r[c]=f,n.visualCellRange=e||null,n.commit(),n}return e=l,n=[{key:"add",value:function(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}},{key:"clear",value:function(){return this.visualCellRange=null,$i(Zi(l.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(t){var e=t.from,n=t.to,r=this.getNearestNotHiddenCoords(e,1),o=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===o)return null;if(r.row>o.row||r.col>o.col){if("header"!==this.settings.type&&"active-header"!==this.settings.type)return null;r=e,o=n}return this.settings.createCellRange(r,r,o)}},{key:"getNearestNotHiddenCoords",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),t.row,e);if(null===r)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),t.col,n);return null===o?null:this.settings.createCellCoords(r,o)}},{key:"getNearestNotHiddenIndex",value:function(t,e,n){if(e<0)return e;var r=t.getNearestNotHiddenIndex(e,n);return"header"!==this.settings.type&&"active-header"!==this.settings.type||null!==r?r:-1}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}},{key:"syncWith",value:function(t){var e="N-S"===t.getVerticalDirection()?1:-1,n="W-E"===t.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(t.from.clone().normalize(),e,n);if(null!==r&&t.overlaps(r)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(o)}return t.setHighlight(r),this}return t.setHighlight(t.from),this}},{key:"getCorners",value:function(){var t=this.cellRange,e=t.from,n=t.to,r=null===e.row||null===n.row,o=null===e.col||null===n.col,l=this.settings.createCellCoords(r?null:Math.min(e.row,n.row),o?null:Math.min(e.col,n.col)),c=this.settings.createCellCoords(r?null:Math.max(e.row,n.row),o?null:Math.max(e.col,n.col));return[l.row,l.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}},{key:"createRenderableCellRange",value:function(t,e){var n=this.settings.visualToRenderableCoords(t),r=this.settings.visualToRenderableCoords(e);return this.settings.createCellRange(n,n,r)}}],n&&Ki(e.prototype,n),r&&Ki(e,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(Yi),na=ea;function ra(t){return ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ra(t)}var oa=["activeHeaderClassName"];function ia(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function aa(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ia(Object(source),!0).forEach((function(e){la(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):ia(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function la(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==ra(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ra(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ra(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sa(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var ua=function(t){var e=t.activeHeaderClassName,n=sa(t,oa);return new na(aa(aa({highlightHeaderClassName:e},n),{},{selectionType:Ni.a}))};function ca(t){return ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ca(t)}var fa=["layerLevel","areaCornerVisible"];function ha(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function da(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ha(Object(source),!0).forEach((function(e){pa(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):ha(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function pa(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==ca(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ca(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===ca(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ya(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var ba=function(t){var e=t.layerLevel,n=t.areaCornerVisible,r=ya(t,fa);return new na(da(da({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:Ni.b}))};function va(t){return va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},va(t)}var ma=["cellCornerVisible"];function ga(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function wa(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ga(Object(source),!0).forEach((function(e){Oa(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):ga(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Oa(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==va(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==va(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===va(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sa(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var Ca=function(t){var e=t.cellCornerVisible,n=Sa(t,ma);return new na(wa(wa({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},n),{},{selectionType:Ni.c}))};function Ea(t){return Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ea(t)}var Ra=["border","visualCellRange"];function ka(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function ja(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ka(Object(source),!0).forEach((function(e){Ta(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):ka(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Ta(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==Ea(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ea(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ea(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pa(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var Aa=function(t){var e=t.border,n=t.visualCellRange,r=Pa(t,Ra);return new na(ja(ja(ja({},e),r),{},{selectionType:Ni.d}),n)};n(424);function Ma(t){return Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ma(t)}function _a(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function xa(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_a(Object(source),!0).forEach((function(e){Ia(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_a(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Ia(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==Ma(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ma(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ma(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Na=function(t){var e=Object.assign({},(function(t){if(null==t)throw new TypeError("Cannot destructure "+t)}(t),t));return new na(xa(xa({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:Ni.e}))};function Ha(t){return Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ha(t)}var Da=["headerClassName","rowClassName","columnClassName"];function La(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Ba(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?La(Object(source),!0).forEach((function(e){Fa(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):La(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Fa(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==Ha(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ha(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ha(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Va(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}var Wa=function(t){var e=t.headerClassName,n=t.rowClassName,r=t.columnClassName,o=Va(t,Da);return new na(Ba(Ba({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:Ni.f}))};function Ua(t){return Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(t)}function za(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Ga(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==Ua(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ua(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ua(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ya=Object(Ii.a)("highlight/types"),Xa=Ya.register,Ka=Ya.getItem;function $a(t,e){return Ka(t)(function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?za(Object(source),!0).forEach((function(e){Ga(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):za(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({type:t},e))}function qa(t){return qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qa(t)}function Qa(t){return function(t){if(Array.isArray(t))return Ja(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ja(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ja(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ja(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Za(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function tl(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Za(Object(source),!0).forEach((function(e){el(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Za(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function el(t,e,n){return(e=rl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rl(n.key),n)}}function rl(t){var e=function(input,t){if("object"!==qa(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==qa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===qa(e)?e:String(e)}Xa(Ni.a,ua),Xa(Ni.b,ba),Xa(Ni.c,Ca),Xa(Ni.d,Aa),Xa(Ni.e,Na),Xa(Ni.f,Wa);var il=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.layerLevel=0,this.cell=$a(Ni.c,t),this.fill=$a(Ni.e,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}var n,r,o;return n=e,r=[{key:"isEnabledFor",value:function(t,e){var n=t;t===Ni.c&&(n="current");var r=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var area,t=this.layerLevel;return this.areas.has(t)?area=this.areas.get(t):(area=$a(Ni.b,tl({layerLevel:t},this.options)),this.areas.set(t,area)),area}},{key:"getAreas",value:function(){return Qa(this.areas.values())}},{key:"createOrGetHeader",value:function(){var header,t=this.layerLevel;return this.headers.has(t)?header=this.headers.get(t):(header=$a(Ni.f,tl({},this.options)),this.headers.set(t,header)),header}},{key:"getHeaders",value:function(){return Qa(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var header,t=this.layerLevel;return this.activeHeaders.has(t)?header=this.activeHeaders.get(t):(header=$a(Ni.a,tl({},this.options)),this.activeHeaders.set(t,header)),header}},{key:"getActiveHeaders",value:function(){return Qa(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Qa(this.customSelections.values())}},{key:"addCustomSelection",value:function(t){this.customSelections.push($a(Ni.d,tl(tl({},this.options),t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(v.arrayEach)(this.areas.values(),(function(t){t.clear()})),Object(v.arrayEach)(this.headers.values(),(function(t){t.clear()})),Object(v.arrayEach)(this.activeHeaders.values(),(function(t){t.clear()}))}},{key:t,value:function(){return[this.cell,this.fill].concat(Qa(this.areas.values()),Qa(this.headers.values()),Qa(this.activeHeaders.values()),Qa(this.customSelections))[Symbol.iterator]()}}],r&&nl(n.prototype,r),o&&nl(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}(Symbol.iterator),al=il;function ll(t){return ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(t)}function sl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ll(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ll(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ll(o)?o:String(o)),n)}var r,o}var cl=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.ranges=[],this.createCellRange=t}var n,r,o;return n=e,r=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}},{key:"add",value:function(t){return this.ranges.push(this.createCellRange(t)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some((function(e){return e.includes(t)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+e-1;return n>=0&&(t=this.ranges[n]),t}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}],r&&sl(n.prototype,r),o&&sl(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}(Symbol.iterator),fl=cl;function hl(t){return hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(t)}function pl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==hl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==hl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===hl(o)?o:String(o)),n)}var r,o}var yl=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=e,this.options=n}var e,n,r;return e=t,n=[{key:"transformStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(t,e),o=this.range.current().highlight,l=this.options.visualToRenderableCoords(o),c=l.row,f=l.col,h=o,d=0,y=0;if(this.runLocalHooks("beforeTransformStart",r),null!==c&&null!==f){var v=this.options.countRows(),m=this.options.countCols(),w=this.options.fixedRowsBottom(),O=this.options.minSpareRows(),S=this.options.minSpareCols(),C=this.options.autoWrapRow(),E=this.options.autoWrapCol();c+t>v-1?n&&O>0&&!(w&&c>=v-w-1)?(this.runLocalHooks("insertRowRequire",v),v=this.options.countRows()):E&&(r.row=1-v,r.col=f+r.col===m-1?1-m:1):E&&c+r.row<0&&f+r.col>=0&&(r.row=v-1,r.col=f+r.col===0?m-1:-1),f+r.col>m-1?n&&S>0?(this.runLocalHooks("insertColRequire",m),m=this.options.countCols()):C&&(r.row=c+r.row===v-1?1-v:1,r.col=1-m):C&&f+r.col<0&&c+r.row>=0&&(r.row=c+r.row===0?v-1:-1,r.col=m-1);var R=this.options.createCellCoords(c+r.row,f+r.col);d=0,y=0,R.row<0?(d=-1,R.row=0):R.row>0&&R.row>=v&&(d=1,R.row=v-1),R.col<0?(y=-1,R.col=0):R.col>0&&R.col>=m&&(y=1,R.col=m-1),h=this.options.renderableToVisualCoords(R)}return this.runLocalHooks("afterTransformStart",h,d,y),h}},{key:"transformEnd",value:function(t,e){var n=this.options.createCellCoords(t,e),r=this.range.current(),o=r.to,l=0,c=0;this.runLocalHooks("beforeTransformEnd",n);var f=this.options.visualToRenderableCoords(r.highlight),h=f.row,d=f.col;if(null!==h&&null!==d){var y=this.options.countRows(),v=this.options.countCols(),m=this.options.visualToRenderableCoords(r.to),w=m.row,O=m.col,S=this.options.createCellCoords(w+n.row,O+n.col);l=0,c=0,S.row<0?(l=-1,S.row=0):S.row>0&&S.row>=y&&(l=1,S.row=y-1),S.col<0?(c=-1,S.col=0):S.col>0&&S.col>=v&&(c=1,S.col=v-1),o=this.options.renderableToVisualCoords(S)}return this.runLocalHooks("afterTransformEnd",o,l,c),o}}],n&&pl(e.prototype,n),r&&pl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(object.mixin)(yl,ni.a);var bl,vl=yl,ml=n(820);function gl(t){return gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(t)}function wl(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||function(t,e){if(!t)return;if("string"==typeof t)return Ol(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ol(t,e)}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ol(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Sl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==gl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==gl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===gl(o)?o:String(o)),n)}var r,o}var Cl=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new fl((function(t,e,n){return r.tableProps.createCellRange(t,e,n)})),this.highlight=new al({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(t,e){return r.tableProps.isDisabledCellSelection(t,e)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(t){return r.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return r.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return r.tableProps.createCellCoords(t,e)},createCellRange:function(t,e,n){return r.tableProps.createCellRange(t,e,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new vl(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(t){return r.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return r.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return r.tableProps.createCellCoords(t,e)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(e))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(e))}))}var e,n,r;return e=t,n=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=Object(l.isUndefined)(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,c=t.row<0,f=t.col<0,h=c&&f,d=t.clone();this.selectedByCorner=h,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),d),(!r||r&&!o&&Object(l.isUndefined)(e))&&this.selectedRange.clear(),this.selectedRange.add(d),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!h&&f&&this.selectedByRowHeader.add(this.getLayerLevel()),!h&&c&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,e){this.setRangeStart(t,e,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){var e=t.clone();this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Ni.c,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&(Object(v.arrayEach)(this.highlight.getAreas(),(function(t){t.clear()})),Object(v.arrayEach)(this.highlight.getHeaders(),(function(t){t.clear()})),Object(v.arrayEach)(this.highlight.getActiveHeaders(),(function(t){t.clear()}))),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),c=this.highlight.createOrGetActiveHeader();if(o.clear(),l.clear(),c.clear(),this.highlight.isEnabledFor(Ni.b,n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var f=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(f.from).commit().syncWith(f),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(Ni.f,n.highlight)){var h=0===this.tableProps.countRowsTranslated(),d=0===this.tableProps.countColsTranslated(),y=n;(h||d)&&(y=n.clone()),h&&(y.from.row=-1),d&&(y.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&y.from.normalize(),l.add(y.from).commit()):l.add(y.from).add(y.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===n.getWidth()&&c.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===n.getHeight()&&c.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=Object(object.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,n))}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&this.isEntireRowSelected(t)}},{key:"isEntireRowSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(t)}},{key:"isEntireColumnSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(t||e||0!==n&&0!==r){var o=this.tableProps.createCellCoords(e?-1:0,t?-1:0),l=this.tableProps.createCellCoords(n-1,r-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(t){var e,n,r=this,o=Object(ml.c)(t);if(o===ml.a)return!1;if(o===ml.b)throw new Error(Object(h.a)(bl||(e=["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],(n=["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."])||(n=e.slice(0)),bl=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})))));var l=Object(ml.e)(o,{propToCol:function(t){return r.tableProps.propToCol(t)},keepDirection:!0}),c=this.tableProps.countRows(),f=this.tableProps.countCols(),d=!t.some((function(t){var e=wl(l(t),4),n=e[0],r=e[1],o=e[2],h=e[3];return!(Object(ml.d)(n,c)&&Object(ml.d)(r,f)&&Object(ml.d)(o,c)&&Object(ml.d)(h,f))}));return d&&(this.clear(),Object(v.arrayEach)(t,(function(t){var e=wl(l(t),4),n=e[0],o=e[1],c=e[2],f=e[3];r.setRangeStartOnly(r.tableProps.createCellCoords(n,o),!1),r.setRangeEnd(r.tableProps.createCellCoords(c,f)),r.finish()}))),d}},{key:"selectColumns",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"==typeof t?this.tableProps.propToCol(t):t,o="string"==typeof e?this.tableProps.propToCol(e):e,l=this.tableProps.countCols(),c=this.tableProps.countRows(),f=Object(ml.d)(r,l)&&Object(ml.d)(o,l);return f&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(c-1,o)),this.finish()),f}},{key:"selectRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),l=Object(ml.d)(t,r)&&Object(ml.d)(e,r);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(t,n)),this.setRangeEnd(this.tableProps.createCellCoords(e,o-1)),this.finish()),l}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach((function(t){t.commit()})),this.isSelected()){var t=this.highlight.getCell(),e=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();r.commit(),o.commit(),l.commit()}this.highlight.useLayerLevel(e)}}}],n&&Sl(e.prototype,n),r&&Sl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object(object.mixin)(Cl,ni.a);var El=Cl,Rl=n(723);function kl(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r="string"==typeof e.type?Object(Rl.a)(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Object(object.objectEach)(e,(function(e,n){t._automaticallyAssignedMetaProps.delete(n)})),Object(object.isObject)(r)){n!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);var o={};Object(object.objectEach)(r,(function(e,r){var l;(function(t,e){var n;return"CELL_TYPE"!==t&&((null===(n=e._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(t))||!Object(object.hasOwnProperty)(e,t))})(r,n)&&(o[r]=e,null===(l=t._automaticallyAssignedMetaProps)||void 0===l||l.add(r))})),Object(object.extend)(t,o)}}function jl(t){return Number.isInteger(t)&&t>=0}function Tl(t,e){if(!t())throw new Error("Assertion failed: ".concat(e))}function Pl(t){return null==t}var Al=n(941);function Ml(t){return Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(t)}function _l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function xl(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_l(Object(source),!0).forEach((function(e){Il(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Il(t,e,n){return(e=Dl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dl(n.key),n)}}function Hl(t,e,n){return e&&Nl(t.prototype,e),n&&Nl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dl(t){var e=function(input,t){if("object"!==Ml(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ml(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===Ml(e)?e:String(e)}function Ll(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Bl=function(){function t(e){Ll(this,t),this.metaCtor=Hl((function t(){Ll(this,t)})),this.meta=this.metaCtor.prototype,Object(object.extend)(this.meta,Object(Al.a)()),this.meta.instance=e}return Hl(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){var e;Object(object.extend)(this.meta,t),kl(this.meta,xl(xl({},t),{},{type:null!==(e=t.type)&&void 0!==e?e:this.meta.type}),t)}}]),t}();function Fl(t){return Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(t)}function Vl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Fl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Fl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Fl(o)?o:String(o)),n)}var r,o}var Wl=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.getMetaConstructor();this.meta=new n}var e,n,r;return e=t,(n=[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){Object(object.extend)(this.meta,t),kl(this.meta,t,t)}}])&&Vl(e.prototype,n),r&&Vl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ul(t){return Ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(t)}function zl(t){return function(t){if(Array.isArray(t))return Gl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Gl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gl(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Yl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Ul(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Ul(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Ul(o)?o:String(o)),n)}var r,o}var Xl=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}var n,r,o;return n=e,r=[{key:"obtain",value:function(t){Tl((function(){return jl(t)}),"Expecting an unsigned number.");var e,n=this._getStorageIndexByKey(t);if(n>=0)void 0===(e=this.data[n])&&(e=this.valueFactory(t),this.data[n]=e);else if(e=this.valueFactory(t),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=e,this.index[t]=r}else this.data.push(e),this.index[t]=this.data.length-1;return e}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Tl((function(){return jl(t)||Pl(t)}),"Expecting an unsigned number or null/undefined argument.");for(var n=[],r=this.data.length,i=0;i<e;i++)n.push(r+i),this.data.push(void 0);var o=Pl(t)?this.index.length:t;this.index=[].concat(zl(this.index.slice(0,o)),n,zl(this.index.slice(o)))}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Tl((function(){return jl(t)||Pl(t)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(Pl(t)?this.index.length-e:t,e),i=0;i<n.length;i++){var r=n[i];"number"==typeof r&&this.holes.add(r)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var t=this;return Object(v.arrayFilter)(this.data,(function(e,n){return!t.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var t=[],i=0;i<this.data.length;i++){var e=this._getKeyByStorageIndex(i);-1!==e&&t.push([e,this.data[i]])}var n=0;return{next:function(){if(n<t.length){var e=t[n];return n+=1,{value:e,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(t){return this.index.length>t?this.index[t]:-1}},{key:"_getKeyByStorageIndex",value:function(t){return this.index.indexOf(t)}},{key:t,value:function(){return this.entries()}}],r&&Yl(n.prototype,r),o&&Yl(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}(Symbol.iterator);function Kl(t){return Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(t)}function $l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Kl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Kl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Kl(o)?o:String(o)),n)}var r,o}var ql=["data","width"],Ql=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.globalMeta=e,this.metas=new Xl((function(){return n._createMeta()}))}var e,n,r;return e=t,n=[{key:"updateMeta",value:function(t,e){var meta=this.getMeta(t);Object(object.extend)(meta,e),kl(meta,e)}},{key:"createColumn",value:function(t,e){this.metas.insert(t,e)}},{key:"removeColumn",value:function(t,e){this.metas.remove(t,e)}},{key:"getMeta",value:function(t){return this.metas.obtain(t)}},{key:"getMetaConstructor",value:function(t){return this.metas.obtain(t).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}Object(object.inherit)(n,t);for(var i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}(this.globalMeta.getMetaConstructor(),ql).prototype}}],n&&$l(e.prototype,n),r&&$l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Jl(t){return Jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jl(t)}function Zl(t){return function(t){if(Array.isArray(t))return ts(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ts(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ts(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ts(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function es(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==Jl(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==Jl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===Jl(o)?o:String(o)),n)}var r,o}var ns=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.columnMeta=e,this.metas=new Xl((function(){return n._createRow()}))}var e,n,r;return e=t,(n=[{key:"updateMeta",value:function(t,e,n){var meta=this.getMeta(t,e);Object(object.extend)(meta,n),kl(meta,n)}},{key:"createRow",value:function(t,e){this.metas.insert(t,e)}},{key:"createColumn",value:function(t,e){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(t,e)}},{key:"removeRow",value:function(t,e){this.metas.remove(t,e)}},{key:"removeColumn",value:function(t,e){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(t,e)}},{key:"getMeta",value:function(t,e,n){var r=this.metas.obtain(t).obtain(e);return void 0===n?r:r[n]}},{key:"setMeta",value:function(t,e,n,r){var o,l=this.metas.obtain(t).obtain(e);null===(o=l._automaticallyAssignedMetaProps)||void 0===o||o.delete(n),l[n]=r}},{key:"removeMeta",value:function(t,e,n){delete this.metas.obtain(t).obtain(e)[n]}},{key:"getMetas",value:function(){for(var t=[],e=Array.from(this.metas.values()),n=0;n<e.length;n++)t.push.apply(t,Zl(e[n].values()));return t}},{key:"getMetasAtRow",value:function(t){Tl((function(){return jl(t)}),"Expecting an unsigned number.");var e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var t=this;return new Xl((function(e){return t._createMeta(e)}))}},{key:"_createMeta",value:function(t){return new(this.columnMeta.getMetaConstructor(t))}}])&&es(e.prototype,n),r&&es(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function rs(t){return rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rs(t)}function os(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==rs(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==rs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===rs(o)?o:String(o)),n)}var r,o}var is=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.globalMeta=new Bl(e),this.tableMeta=new Wl(this.globalMeta),this.columnMeta=new Ql(this.globalMeta),this.cellMeta=new ns(this.columnMeta),o.forEach((function(t){return new t(n)})),this.globalMeta.updateMeta(r)}var e,n,r;return e=t,n=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(t){this.globalMeta.updateMeta(t)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(t){this.tableMeta.updateMeta(t)}},{key:"getColumnMeta",value:function(t){return this.columnMeta.getMeta(t)}},{key:"updateColumnMeta",value:function(t,e){this.columnMeta.updateMeta(t,e)}},{key:"getCellMeta",value:function(t,e,n){var r=n.visualRow,o=n.visualColumn,l=this.cellMeta.getMeta(t,e);return l.visualRow=r,l.visualCol=o,l.row=t,l.col=e,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(t,e,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,n)}},{key:"setCellMeta",value:function(t,e,n,r){this.cellMeta.setMeta(t,e,n,r)}},{key:"updateCellMeta",value:function(t,e,n){this.cellMeta.updateMeta(t,e,n)}},{key:"removeCellMeta",value:function(t,e,n){this.cellMeta.removeMeta(t,e,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(t){return this.cellMeta.getMetasAtRow(t)}},{key:"createRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}},{key:"removeRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}},{key:"createColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}},{key:"removeColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}],n&&os(e.prototype,n),r&&os(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function as(t){return as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},as(t)}function ls(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==as(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==as(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===as(o)?o:String(o)),n)}var r,o}Object(object.mixin)(is,ni.a);var ss=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",(function(t){return n.extendCellMeta(t)})),Mi.a.getSingleton().add("beforeRender",(function(t){t&&n.metaSyncMemo.clear()}),this.metaManager.hot)}var e,n,r;return e=t,(n=[{key:"extendCellMeta",value:function(t){var e,n=t.row,r=t.col;if(null===(e=this.metaSyncMemo.get(n))||void 0===e||!e.has(r)){var l=t.visualRow,c=t.visualCol,f=this.metaManager.hot,h=f.colToProp(c);t.prop=h,f.runHooks("beforeGetCellMeta",l,c,t);var d,y=Object(object.hasOwnProperty)(t,"type")?t.type:null,v=Object(o.isFunction)(t.cells)?t.cells(n,r,h):null;y&&(v?v.type=null!==(d=v.type)&&void 0!==d?d:y:v={type:y}),v&&this.metaManager.updateCellMeta(n,r,v),f.runHooks("afterGetCellMeta",l,c,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}])&&ls(e.prototype,n),r&&ls(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function us(t){return us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},us(t)}function cs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==us(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==us(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===us(o)?o:String(o)),n)}var r,o}var fs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(t,e,n){if(!n)throw new Error("The `".concat(t,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}var e,n,r;return e=t,(n=[{key:"extendMetaProps",value:function(){var t=this;this.propDescriptors.forEach((function(e,n){var r=e.target,o=e.onChange,l=void 0===o?function(){}:o,c="string"==typeof r,f=c?r:n,h="_".concat(f);t.metaManager.globalMeta.meta[h]=t.metaManager.globalMeta.meta[f],t.installPropWatcher(n,h,l),c&&t.installPropWatcher(r,h,l)}))}},{key:"installPropWatcher",value:function(t,e,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get:function(){return this[e]},set:function(o){var l=!r.usageTracker.has(t);r.usageTracker.add(t),n.call(r,t,o,l),this[e]=o},enumerable:!0,configurable:!0})}}])&&cs(e.prototype,n),r&&cs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),hs=n(1064);function ds(t){return function(t){if(Array.isArray(t))return ps(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ps(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ps(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ps(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ys(t){return ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ys(t)}function bs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==ys(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==ys(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===ys(o)?o:String(o)),n)}var r,o}var vs=function(){function t(e,data,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=data,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}var e,n,r;return e=t,n=[{key:"createMap",value:function(){var t=this.getSchema();if(void 0===t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var i,e=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,e){var n=0,r=0,o=!1;if("function"==typeof e){var l=Object(object.deepObjectSize)(t);n=l>0?l:this.countFirstRowKeys(),o=!0}else{var c=this.tableMeta.maxCols;n=Math.min(c,e.length)}for(i=0;i<n;i++){var f=o?e(i):e[i];if(Object(object.isObject)(f)){if(void 0!==f.data){var h=o?r:i;this.colToPropCache[h]=f.data,this.propToColCache.set(f.data,h)}r+=1}}}else this.recursiveDuckColumns(t)}},{key:"countFirstRowKeys",value:function(){return Object(Ho.countFirstRowKeys)(this.dataSource)}},{key:"recursiveDuckColumns",value:function(t,e,n){var r,o=this,l=e,c=n;return void 0===l&&(l=0,c=""),"object"!==ys(t)||Array.isArray(t)||Object(object.objectEach)(t,(function(t,e){null===t?(r=c+e,o.colToPropCache.push(r),o.propToColCache.set(r,l),l+=1):l=o.recursiveDuckColumns(t,l,"".concat(e,"."))})),l}},{key:"colToProp",value:function(t){if(!1===Number.isInteger(t))return t;var e=this.instance.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&Object(l.isDefined)(this.colToPropCache[e])?this.colToPropCache[e]:e}},{key:"propToCol",value:function(t){var e=this.propToColCache.get(t);if(Object(l.isDefined)(e))return this.instance.toVisualColumn(e);var n=this.instance.toVisualColumn(t);return null===n?t:n}},{key:"getSchema",value:function(){var t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?Object(object.duckSchema)(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},source=r.source,o=r.mode,l=void 0===o?"above":o,c=this.instance.countSourceRows(),f=c,h=0,d=t;if(("number"!=typeof d||d>=c)&&(d=c),d<this.instance.countRows()&&(f=this.instance.toPhysicalRow(d)),!1===this.instance.runHooks("beforeCreateRow",d,n,source)||null===f)return{delta:0};for(var y=this.tableMeta.maxRows,v=this.getSchema().length,m=[],w=function(){var t=null;"array"===e.instance.dataType?e.tableMeta.dataSchema?t=Object(object.deepClone)(e.getSchema()):(t=[],Object(R.rangeEach)(v-1,(function(){return t.push(null)}))):"function"===e.instance.dataType?t=e.tableMeta.dataSchema(d+h):(t={},Object(object.deepExtend)(t,e.getSchema())),m.push(t),h+=1};h<n&&c+h<y;)w();this.instance.rowIndexMapper.insertIndexes(d,h),"below"===l&&(f=Math.min(f+1,c)),this.spliceData(f,0,m);var O=this.instance.toVisualRow(f);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),h>0&&(null==t?this.metaManager.createRow(null,h):"auto"!==source&&this.metaManager.createRow(f,n)),this.instance.runHooks("afterCreateRow",O,h,source),this.instance.forceFullRender=!0,{delta:h,startPhysicalIndex:f}}},{key:"createCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},source=n.source,r=n.mode,o=void 0===r?"start":r;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,c=this.tableMeta.maxCols,f=this.instance.countSourceCols(),h=t;if(("number"!=typeof h||h>=f)&&(h=f),!1===this.instance.runHooks("beforeCreateCol",h,e,source))return{delta:0};var d=f;h<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(h));var y=this.instance.countSourceRows(),v=this.instance.countCols(),m=0,w=d;"end"===o&&(w=Math.min(w+1,f));for(var O=w;m<e&&v<c;){if("number"!=typeof h||h>=v)if(y>0)for(var S=0;S<y;S+=1)void 0===l[S]&&(l[S]=[]),l[S].push(null);else l.push([null]);else for(var C=0;C<y;C++)l[C].splice(w,0,null);m+=1,w+=1,v+=1}this.instance.columnIndexMapper.insertIndexes(h,m),m>0&&(null==t?this.metaManager.createColumn(null,m):"auto"!==source&&this.metaManager.createColumn(O,e));var E=this.instance.toVisualColumn(O);return this.instance.runHooks("afterCreateCol",E,m,source),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:O}}},{key:"removeRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(t)?t:-n,o=this.visualRowsToPhysical(r,n),c=this.instance.countSourceRows();if(r=(c+r)%c,!1===this.instance.runHooks("beforeRemoveRow",r,o.length,o,source))return!1;var f=o.length;if(this.filterData(r,f,o),r<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);var h=Object(l.isDefined)(this.tableMeta.columns)||Object(l.isDefined)(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===h&&this.instance.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((function(a,b){return b-a})).forEach((function(t){e.metaManager.removeRow(t,1)})),this.instance.runHooks("afterRemoveRow",r,f,o,source),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var n="number"!=typeof t?-e:t;n=(this.instance.countCols()+n)%this.instance.countCols();var r=this.visualColumnsToPhysical(n,e),o=r.slice(0).sort((function(a,b){return b-a}));if(!1===this.instance.runHooks("beforeRemoveCol",n,e,r,source))return!1;for(var l=!0,c=o.length,data=this.dataSource,f=0;f<c;f++)l&&r[0]!==r[f]-f&&(l=!1);if(l)for(var h=0,d=this.instance.countSourceRows();h<d;h++)data[h].splice(r[0],e),0===h&&this.metaManager.removeColumn(r[0],e);else for(var y=0,v=this.instance.countSourceRows();y<v;y++)for(var m=0;m<c;m++)data[y].splice(o[m],1),0===y&&this.metaManager.removeColumn(o[m],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(r),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,e,r,source),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(col,t,e){for(var n=this.instance.getDataAtCol(col),r=n.slice(t,t+e),o=n.slice(t+e),l=arguments.length,c=new Array(l>3?l-3:0),f=3;f<l;f++)c[f-3]=arguments[f];Object(v.extendArray)(c,o);for(var i=0;i<e;)c.push(null),i+=1;return Object(v.to2dArray)(c),this.instance.populateFromArray(t,col,c,null,null,"spliceCol"),r}},{key:"spliceRow",value:function(t,e,n){for(var r=this.instance.getSourceDataAtRow(t),o=r.slice(e,e+n),l=r.slice(e+n),c=arguments.length,f=new Array(c>3?c-3:0),h=3;h<c;h++)f[h-3]=arguments[h];Object(v.extendArray)(f,l);for(var i=0;i<n;)f.push(null),i+=1;return this.instance.populateFromArray(t,e,[f],null,null,"spliceRow"),o}},{key:"spliceData",value:function(t,e,n){var r=this;if(!1!==this.instance.runHooks("beforeDataSplice",t,e,n)){var o=[].concat(ds(this.dataSource.slice(0,t)),ds(n),ds(this.dataSource.slice(t)));this.dataSource.length=0,o.forEach((function(t){return r.dataSource.push(t)}))}}},{key:"filterData",value:function(t,e,n){var data=this.instance.runHooks("filterData",t,e,n);!1===Array.isArray(data)&&(data=this.dataSource.filter((function(t,e){return-1===n.indexOf(e)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,data)}},{key:"get",value:function(t,e){var n=this.instance.toPhysicalRow(t),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n),l=null;if((r=isNaN(o)?o:r)&&r.hasOwnProperty&&Object(object.hasOwnProperty)(r,e))l=r[e];else if("string"==typeof e&&e.indexOf(".")>-1){var c=e.split("."),f=r;if(!f)return null;for(var i=0,h=c.length;i<h;i++)if(void 0===(f=f[c[i]]))return null;l=f}else"function"==typeof e&&(l=e(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var d=Object(object.createObjectPropListener)(l);this.instance.runHooks("modifyData",n,this.propToCol(e),d,"get"),d.isTouched()&&(l=d.value)}return l}},{key:"getCopyable",value:function(t,e){return this.instance.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}},{key:"set",value:function(t,e,n){var r=this.instance.toPhysicalRow(t),o=n,l=this.dataSource[r],c=this.instance.runHooks("modifyRowData",r);if(l=isNaN(c)?c:l,this.instance.hasHook("modifyData")){var f=Object(object.createObjectPropListener)(o);this.instance.runHooks("modifyData",r,this.propToCol(e),f,"set"),f.isTouched()&&(o=f.value)}if(l&&l.hasOwnProperty&&Object(object.hasOwnProperty)(l,e))l[e]=o;else if("string"==typeof e&&e.indexOf(".")>-1){var h,d=e.split("."),y=l,i=0;for(i=0,h=d.length-1;i<h;i++)void 0===y[d[i]]&&(y[d[i]]={}),y=y[d[i]];y[d[i]]=o}else"function"==typeof e?e(this.dataSource.slice(r,r+1)[0],o):l[e]=o}},{key:"visualRowsToPhysical",value:function(t,e){for(var n,r=this.instance.countSourceRows(),o=[],l=(r+t)%r,c=e;l<r&&c;)n=this.instance.toPhysicalRow(l),o.push(n),c-=1,l+=1;return o}},{key:"visualColumnsToPhysical",value:function(t,e){for(var n=this.instance.countCols(),r=[],o=(n+t)%n,l=e;o<n&&l;){var col=this.instance.toPhysicalColumn(o);r.push(col),l-=1,o+=1}return r}},{key:"clear",value:function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}},{key:"getLength",value:function(){var t,e=this.tableMeta.maxRows;t=e<0||0===e?0:e||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}},{key:"getAll",value:function(){var e={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row!=0||this.instance.countSourceRows()?this.getRange(e,n,t.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(e,n,r){var o,l,c,output=[],f=this.tableMeta.maxRows,h=this.tableMeta.maxCols;if(0===f||0===h)return[];var d=r===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,y=Math.min(Math.max(f-1,0),Math.max(e.row,n.row)),v=Math.min(Math.max(h-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=y;o++){c=[];var m=o>=0?this.instance.toPhysicalRow(o):o;for(l=Math.min(e.col,n.col);l<=v&&null!==m;l++)c.push(d.call(this,o,this.colToProp(l)));null!==m&&output.push(c)}return output}},{key:"getText",value:function(e,n){return Object(hs.b)(this.getRange(e,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,n){return Object(hs.b)(this.getRange(e,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],r=[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}],n&&bs(e.prototype,n),r&&bs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ms=vs;function gs(t){return gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(t)}function ws(data,t,e,n){var r=n.hotInstance,l=n.dataMap,c=n.dataSource,f=n.internalSource,source=n.source,h=n.metaManager,d=n.firstRun,y=Object(E.toUpperCaseFirst)(f),v=r.getSettings();Array.isArray(v.dataSchema)?r.dataType="array":Object(o.isFunction)(v.dataSchema)?r.dataType="function":r.dataType="object",l&&l.destroy(),data=r.runHooks("before".concat(y),data,d,source);var m=new ms(r,data,h);if(t(m),"object"===gs(data)&&null!==data)data.push&&data.splice||(data=[data]);else{if(null!==data)throw new Error("".concat(f," only accepts array of objects or array of arrays (").concat(gs(data)," given)"));var w,O=m.getSchema();data=[];var S,C=0;for(C=0,S=v.startRows;C<S;C++)if("object"!==r.dataType&&"function"!==r.dataType||!v.dataSchema)if("array"===r.dataType)w=Object(object.deepClone)(O[0]),data.push(w);else{w=[];for(var R=0,k=v.startCols;R<k;R++)w.push(null);data.push(w)}else w=Object(object.deepClone)(O),data.push(w)}Array.isArray(data[0])&&(r.dataType="array"),v.data=data,m.dataSource=data,c.data=data,c.dataType=r.dataType,c.colToProp=m.colToProp.bind(m),c.propToCol=m.propToCol.bind(m),c.countCachedColumns=m.countCachedColumns.bind(m),e(m),r.runHooks("after".concat(y),data,d,source),d||(r.runHooks("afterChange",null,f),r.render())}var Os,Ss=n(788),Cs=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Es=function(t){return t.map((function(t){var e=t.toLowerCase();return Cs.has(e)?Cs.get(e):e})).sort().join("+")},Rs=function(t){return t.toLowerCase()};function ks(t){return function(t){if(Array.isArray(t))return Ps(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ts(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function js(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||Ts(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ts(t,e){if(t){if("string"==typeof t)return Ps(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ps(t,e):void 0}}function Ps(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var As=function(t){var e=Object(Ss.a)({errorIdExists:function(e){return'The "'.concat(e,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=r.keys,f=r.callback,d=r.group,y=r.runOnlyIf,v=void 0===y?function(){return!0}:y,m=r.captureCtrl,w=void 0!==m&&m,O=r.preventDefault,S=void 0===O||O,C=r.stopPropagation,E=void 0!==C&&C,R=r.relativeToGroup,k=r.position;if(Object(l.isUndefined)(d))throw new Error("You need to define the shortcut's group.");if(!1===Object(o.isFunction)(f))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(c))throw new Error(Object(h.a)(Os||(t=["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],(n=["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."])||(n=t.slice(0)),Os=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}})))));var j={callback:f,group:d,runOnlyIf:v,captureCtrl:w,preventDefault:S,stopPropagation:E};if(Object(l.isDefined)(R)){var T=[R,k];j.relativeToGroup=T[0],j.position=T[1]}c.forEach((function(t){var n=Es(t);if(e.hasItem(n)){var r=e.getItem(n),o=r.findIndex((function(t){return t.group===R}));-1!==o?"before"===k?o-=1:o+=1:o=r.length,r.splice(o,0,j)}else e.addItem(n,[j])}))},r=function(t){var n=Es(t);e.removeItem(n)};return{addShortcut:n,addShortcuts:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((function(t){Object(object.objectEach)(e,(function(n,r){!1===Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e[r])})),n(t)}))},getShortcuts:function(t){var n=Es(t),r=e.getItem(n);return Object(l.isDefined)(r)?r.slice():[]},hasShortcut:function(t){var n=Es(t);return e.hasItem(n)},removeShortcutsByKeys:r,removeShortcutsByGroup:function(t){e.getItems().forEach((function(e){var n=js(e,2),o=n[0],l=n[1],c=l.filter((function(option){return option.group!==t}));0===c.length?r(function(t){return t.split("+")}(o)):(l.length=0,l.push.apply(l,ks(c)))}))}}};var Ms,_s=["meta","alt","shift","control"],xs=(Ms=new Set,{press:function(t){Ms.add(t)},release:function(t){Ms.delete(t)},releaseAll:function(){Ms.clear()},isPressed:function(t){return Ms.has(t)}});var Is,Ns,Hs=function(t){var e=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,l=t.afterKeyDown,f=Object(Ss.a)({errorIdExists:function(t){return'The "'.concat(t,'" context name is already registered.')}}),h="grid",d=function(){return h},y=function(t){return f.getItem(t)},v=!1,m=function(t,e,n,o,l){var f=function(t){return _s.includes(t)},h=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return t.altKey&&n.push("alt"),e&&(t.ctrlKey||t.metaKey)?n.push("control/meta"):(t.ctrlKey&&n.push("control"),t.metaKey&&n.push("meta")),t.shiftKey&&n.push("shift"),n},d=function(t){if(!1!==e(t)){var r=n(t);if(229!==t.keyCode&&!1!==r&&!Object(k.isImmediatePropagationStopped)(t)){var d=Rs(t.key),y=[];f(d)?xs.press(d):y=h(t);var v=[d].concat(y);!l(t,v)&&(Object(c.isMacOS)()&&y.includes("meta")||!Object(c.isMacOS)()&&y.includes("control"))&&l(t,[d].concat(h(t,!0))),o(t)}}},y=function(t){if(!1!==e(t)){var n=Rs(t.key);!1!==f(n)&&xs.release(n)}},v=function(){xs.releaseAll()};return{mount:function(){for(var e=t;e;)e.document.documentElement.addEventListener("keydown",d),e.document.documentElement.addEventListener("keyup",y),e.document.documentElement.addEventListener("blur",v),e=Object(r.getParentWindow)(e)},unmount:function(){for(var e=t;e;)e.document.documentElement.removeEventListener("keydown",d),e.document.documentElement.removeEventListener("keyup",y),e.document.documentElement.removeEventListener("blur",v),e=Object(r.getParentWindow)(e)},isPressed:function(t){return xs.isPressed(t)},releasePressedKeys:function(){return xs.releaseAll()}}}(e,n,o,l,(function(t,e){var n=y(d()),r=!1;if(!n.hasShortcut(e))return r;for(var o=n.getShortcuts(e),l=0;l<o.length;l++){var c=o[l],f=c.callback,h=c.runOnlyIf,m=c.preventDefault,w=c.stopPropagation,O=c.captureCtrl;if(!1!==h(t)&&(v=O,r=!1===f(t,e),v=!1,m&&t.preventDefault(),w&&t.stopPropagation(),r))break}return r}));return m.mount(),{addContext:function(t){var e=As(t);return f.addItem(t,e),e},getActiveContextName:d,getContext:y,setActiveContextName:function(t){h=t},isCtrlPressed:function(){return!v&&(m.isPressed("control")||m.isPressed("meta"))},releasePressedKeys:function(){return m.releasePressedKeys()},destroy:function(){return m.unmount()}}};function Ds(t){return Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(t)}function Ls(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Bs(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,o,l,c=[],f=!0,h=!1;try{if(o=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=o.call(e)).done)&&(c.push(n.value),c.length!==i);f=!0);}catch(t){h=!0,r=t}finally{try{if(!f&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(h)throw r}}return c}}(t,i)||Vs(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fs(t){return function(t){if(Array.isArray(t))return Ws(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Vs(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vs(t,e){if(t){if("string"==typeof t)return Ws(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ws(t,e):void 0}}function Ws(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Us="gridDefault",zs=null,Gs=new Set;function Ys(t,e){var n,k,j,T,P,A=this,M=arguments.length>2&&void 0!==arguments[2]&&arguments[2],_=!1,x=this,I=new y.a(x),N=!0;Object(mo.a)(M)&&Object(mo.c)(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var H=null!==(n=null==e?void 0:e.layoutDirection)&&void 0!==n?n:"inherit",D=["rtl","ltr"].includes(H)?H:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",D),this.isRtl=function(){return"rtl"===D},this.isLtr=function(){return!x.isRtl()},this.getDirectionFactor=function(){return x.isLtr()?1:-1},e.language=Object(_i.e)(e.language);var L=new is(x,e,[ss,fs]),B=L.getTableMeta(),F=L.getGlobalMeta(),V=Object(Ss.a)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Object(mo.b)(this)&&Object(l._injectProductInfo)(e.licenseKey,t),this.guid="ht_".concat(Object(E.randomString)()),this.columnIndexMapper=new Ai,this.rowIndexMapper=new Ai,j=new Fo(x),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var W=function(t){var e=t.row,n=t.col;return x._createCellCoords(e>=0?x.rowIndexMapper.getRenderableFromVisualIndex(e):e,n>=0?x.columnIndexMapper.getRenderableFromVisualIndex(n):n)},U=new El(B,{rowIndexMapper:function(){return x.rowIndexMapper},columnIndexMapper:function(){return x.columnIndexMapper},countCols:function(){return x.countCols()},countRows:function(){return x.countRows()},propToCol:function(t){return k.propToCol(t)},isEditorOpened:function(){return!!x.getActiveEditor()&&x.getActiveEditor().isOpened()},countColsTranslated:function(){return A.view.countRenderableColumns()},countRowsTranslated:function(){return A.view.countRenderableRows()},getShortcutManager:function(){return x.getShortcutManager()},createCellCoords:function(t,e){return x._createCellCoords(t,e)},createCellRange:function(t,e,n){return x._createCellRange(t,e,n)},visualToRenderableCoords:W,renderableToVisualCoords:function(t){var e=t.row,n=t.col;return x._createCellCoords(e>=0?x.rowIndexMapper.getVisualFromRenderableIndex(e):e,n>=0?x.columnIndexMapper.getVisualFromRenderableIndex(n):n)},isDisabledCellSelection:function(t,e){return x.getCellMeta(t,e).disableVisualSelection}});this.selection=U;var z=function(t){t.hiddenIndexesChanged&&A.selection.refresh()};function G(t,e){var element="className"===t?x.rootElement:x.table;if(N)Object(r.addClass)(element,e);else{var n=[],o=[];F[t]&&(n=Array.isArray(F[t])?F[t]:Object(v.stringToArray)(F[t])),e&&(o=Array.isArray(e)?e:Object(v.stringToArray)(e));var l=Object(v.getDifferenceOfArrays)(n,o),c=Object(v.getDifferenceOfArrays)(o,n);l.length&&Object(r.removeClass)(element,l),c.length&&Object(r.addClass)(element,c)}F[t]=e}function Y(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function X(t,source,e){if(t.length){var n=x.getActiveEditor(),o=x.runHooks("beforeChange",t,source||"edit"),l=!0;if(!1!==o){var c,f,h=new Y;h.onQueueEmpty=function(t){n&&l&&n.cancelChanges(),e(t)};for(var i=t.length-1;i>=0;i--)if(null===t[i])t.splice(i,1);else{var d=Bs(t[i],4),y=d[0],v=d[1],m=d[3],col=k.propToCol(v),w=x.getCellMeta(y,col);"numeric"===w.type&&"string"==typeof m&&Object(R.isNumericLike)(m)&&(t[i][3]=(f=void 0,f=(c=m).replace(",","."),!1===isNaN(parseFloat(f))?parseFloat(f):c)),x.getCellValidator(w)&&(h.addValidatorToQueue(),x.validateCell(t[i][3],w,function(e,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){l=!1,t.splice(e,1),n.valid=!0;var c=x.getCell(n.visualRow,n.visualCol);null!==c&&Object(r.removeClass)(c,B.invalidCellClassName)}h.removeValidatorFormQueue()}}(i,w),source))}h.checkIfQueueIsEmpty()}else n&&n.cancelChanges()}}function K(t,source){var i=t.length-1;if(!(i<0)){for(;i>=0;i--){var e=!1;if(null!==t[i]){if(null!==t[i][2]&&void 0!==t[i][2]||null!==t[i][3]&&void 0!==t[i][3]){if(B.allowInsertRow)for(;t[i][0]>x.countRows()-1;){if(0===k.createRow(void 0,void 0,{source:source}).delta){e=!0;break}}if("array"===x.dataType&&(!B.columns||0===B.columns.length)&&B.allowInsertColumn)for(;k.propToCol(t[i][1])>x.countCols()-1;){if(0===k.createCol(void 0,void 0,{source:source}).delta){e=!0;break}}e||k.set(t[i][0],t[i][1],t[i][3])}}else t.splice(i,1)}x.forceFullRender=!0,T.adjustRowsAndCols(),x.runHooks("beforeChangeRender",t,source),P.lockEditor(),x._refreshBorders(null),P.unlockEditor(),x.view.adjustElementsSize(),x.runHooks("afterChange",t,source||"edit");var n=x.getActiveEditor();n&&Object(l.isDefined)(n.refreshValue)&&n.refreshValue()}}function $(t,e,n){return Array.isArray(t)?t:[[t,e,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("beforeSetRangeStart",(function(t){A.runHooks("beforeSetRangeStart",t)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(t){A.runHooks("beforeSetRangeStartOnly",t)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(t){A.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=A.view._wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=A.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(t){var e=Object(object.createObjectPropListener)(!1),n=A.selection.getSelectedRange(),o=n.current(),l=o.from,c=o.to,f=n.size()-1;A.runHooks("afterSelection",l.row,l.col,c.row,c.col,e,f),A.runHooks("afterSelectionByProp",l.row,x.colToProp(l.col),c.row,x.colToProp(c.col),e,f);var h=A.selection.isSelectedByAnyHeader(),d=A.selection.selectedRange.current(),y=!0;_&&(y=!1),e.isTouched()&&(y=!e.value);var v=A.selection.isSelectedByRowHeader(),m=A.selection.isSelectedByColumnHeader();!1!==y&&(h?v?A.view.scrollViewportVertically(x.rowIndexMapper.getRenderableFromVisualIndex(t.row)):m&&A.view.scrollViewportHorizontally(x.columnIndexMapper.getRenderableFromVisualIndex(t.col)):d&&!A.selection.isMultiple()?A.view.scrollViewport(W(d.from)):A.view.scrollViewport(W(t))),v&&m?Object(r.addClass)(A.rootElement,["ht__selection--rows","ht__selection--columns"]):v?(Object(r.removeClass)(A.rootElement,"ht__selection--columns"),Object(r.addClass)(A.rootElement,"ht__selection--rows")):m?(Object(r.removeClass)(A.rootElement,"ht__selection--rows"),Object(r.addClass)(A.rootElement,"ht__selection--columns")):Object(r.removeClass)(A.rootElement,["ht__selection--rows","ht__selection--columns"]),A._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(t){var e=t.length-1,n=t[e],r=n.from,o=n.to;A.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,e),A.runHooks("afterSelectionEndByProp",r.row,x.colToProp(r.col),o.row,x.colToProp(o.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(t){var e=A.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(t){A.runHooks("modifyTransformStart",t)})),this.selection.addLocalHook("afterModifyTransformStart",(function(t,e,n){A.runHooks("afterModifyTransformStart",t,e,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(t){A.runHooks("modifyTransformEnd",t)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(t,e,n){A.runHooks("afterModifyTransformEnd",t,e,n)})),this.selection.addLocalHook("afterDeselect",(function(){P.destroyEditor(),A._refreshBorders(),Object(r.removeClass)(A.rootElement,["ht__selection--rows","ht__selection--columns"]),A.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(t){A.alter("insert_row_above",t,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(t){A.alter("insert_col_start",t,1,"auto")})),T={alter:function(t,e){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,source=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,d=function(t){if(0===t.length)return[];var e=Fs(t);return e.sort((function(t,e){var n=Bs(t,1)[0],r=Bs(e,1)[0];return n===r?0:n>r?1:-1})),Object(v.arrayReduce)(e,(function(t,e){var n=Bs(e,2),r=n[0],o=n[1],l=t[t.length-1],c=Bs(l,2),f=c[0]+c[1];if(r<=f){var h=Math.max(o-(f-r),0);l[1]+=h}else t.push([r,o]);return t}),[e[0]])};switch(t){case"insert_row":Gs.has(t)||(Gs.add(t),Object(f.b)(Object(h.a)(Is||(Is=Ls(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),t)));case"insert_row_below":case"insert_row_above":var y=x.countSourceRows();if(B.maxRows===y)return;var m="insert_row_below"===t?"below":"above";e=null!==(n=e)&&void 0!==n?n:"insert_row"===t||"below"===m?y:0;var w=k.createRow(e,o,{source:source,mode:m}),O=w.delta,S=w.startPhysicalIndex;if(O){var C=U.selectedRange.current(),E=null==C?void 0:C.from,R=null==E?void 0:E.row,j=x.toVisualRow(S);if(U.isSelectedByCorner())x.selectAll();else if(Object(l.isDefined)(R)&&R>=j){var P=C.to,A=P.row,M=P.col,_=E.col;U.isSelectedByRowHeader()&&(_=-1),U.getSelectedRange().pop(),U.setRangeStartOnly(x._createCellCoords(R+O,_),!0),U.setRangeEnd(x._createCellCoords(A+O,M))}else x._refreshBorders()}break;case"insert_col":Gs.has(t)||(Gs.add(t),Object(f.b)(Object(h.a)(Ns||(Ns=Ls(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),t)));case"insert_col_start":case"insert_col_end":var I="insert_col_end"===t?"end":"start";e=null!==(r=e)&&void 0!==r?r:"insert_col"===t||"end"===I?x.countSourceCols():0;var N=k.createCol(e,o,{source:source,mode:I}),H=N.delta,D=N.startPhysicalIndex;if(H){if(Array.isArray(B.colHeaders)){var L=[x.toVisualColumn(D),0];L.length+=H,Array.prototype.splice.apply(B.colHeaders,L)}var F=U.selectedRange.current(),V=null==F?void 0:F.from,W=null==V?void 0:V.col,z=x.toVisualColumn(D);if(U.isSelectedByCorner())x.selectAll();else if(Object(l.isDefined)(W)&&W>=z){var G=F.to,Y=G.row,X=G.col,K=V.row;U.isSelectedByColumnHeader()&&(K=-1),U.getSelectedRange().pop(),U.setRangeStartOnly(x._createCellCoords(K,W+H),!0),U.setRangeEnd(x._createCellCoords(Y,X+H))}else x._refreshBorders()}break;case"remove_row":var $=function(t){var e=0;Object(v.arrayEach)(t,(function(t){var n=Bs(t,2),r=n[0],o=n[1],c=Object(l.isEmpty)(r)?x.countRows()-1:Math.max(r-e,0);if(Number.isInteger(r)&&(r=Math.max(r-e,0)),k.removeRow(r,o,source)){var f=x.countRows(),h=B.fixedRowsTop;h>=c+1&&(B.fixedRowsTop-=Math.min(o,h-c));var d=B.fixedRowsBottom;d&&c>=f-d&&(B.fixedRowsBottom-=Math.min(o,d)),e+=o}}))};Array.isArray(e)?$(d(e)):$([[e,o]]),T.adjustRowsAndCols(),x._refreshBorders();break;case"remove_col":var Q=function(t){var e=0;Object(v.arrayEach)(t,(function(t){var n=Bs(t,2),r=n[0],o=n[1],c=Object(l.isEmpty)(r)?x.countCols()-1:Math.max(r-e,0),f=x.toPhysicalColumn(c);if(Number.isInteger(r)&&(r=Math.max(r-e,0)),k.removeCol(r,o,source)){var h=B.fixedColumnsStart;h>=c+1&&(B.fixedColumnsStart-=Math.min(o,h-c)),Array.isArray(B.colHeaders)&&(void 0===f&&(f=-1),B.colHeaders.splice(f,o)),e+=o}}))};Array.isArray(e)?Q(d(e)):Q([[e,o]]),T.adjustRowsAndCols(),x._refreshBorders();break;default:throw new Error('There is no such action "'.concat(t,'"'))}c||T.adjustRowsAndCols()},adjustRowsAndCols:function(){var t,e=B.minRows,n=B.minSpareRows,r=B.minCols,o=B.minSpareCols;if(0===x.countRows()&&0===x.countCols()&&U.deselect(),e){var l=x.countRows();l<e&&k.createRow(l,e-l,{source:"auto"})}if(n){var c=x.countEmptyRows(!0);if(c<n){var f=n-c,h=Math.min(f,B.maxRows-x.countSourceRows());k.createRow(x.countRows(),h,{source:"auto"})}}(r||o)&&(t=x.countEmptyCols(!0));var d=x.countCols();if(r&&!B.columns&&d<r){var y=r-d;t+=y,k.createCol(d,y,{source:"auto"})}if(o&&!B.columns&&"array"===x.dataType&&t<o){d=x.countCols();var m=o-t,w=Math.min(m,B.maxCols-d);k.createCol(d,w,{source:"auto"})}if(U.isSelected()){var O=x.countRows(),S=x.countCols();Object(v.arrayEach)(U.selectedRange,(function(t){var e=!1,n=t.from.row,r=t.from.col,o=t.to.row,l=t.to.col;n>O-1?(e=!0,o>(n=O-1)&&(o=n)):o>O-1&&(e=!0,n>(o=O-1)&&(n=o)),r>S-1?(e=!0,l>(r=S-1)&&(l=r)):l>S-1&&(e=!0,r>(l=S-1)&&(r=l)),e&&x.selectCell(n,r,o,l)}))}x.view&&x.view.adjustElementsSize()},populateFromArray:function(t,input,e,source,n,r,o){var c,f,h,d,y=[],m={},w=[],O=t.row,S=t.col;if(0===(f=input.length))return!1;var C=0,E=0;switch(Object(object.isObject)(e)&&(C=e.col-S+1,E=e.row-O+1),n){case"shift_down":var R=Object(v.pivot)(input),k=R.length,j=Math.max(k,C),T=x.getData().slice(O),P=Object(v.pivot)(T).slice(S,S+j);for(h=0;h<j;h+=1)if(h<k){for(c=0,f=R[h].length;c<E-f;c+=1)R[h].push(R[h][c%f]);h<P.length?w.push(R[h].concat(P[h])):w.push(R[h].concat(new Array(T.length).fill(null)))}else w.push(R[h%k].concat(P[h]));x.populateFromArray(O,S,Object(v.pivot)(w));break;case"shift_right":var A=input.length,M=Math.max(A,E),_=x.getData().slice(O).map((function(t){return t.slice(S)}));for(c=0;c<M;c+=1)if(c<A){for(h=0,d=input[c].length;h<C-d;h+=1)input[c].push(input[c][h%d]);var I;if(c<_.length)for(var i=0;i<_[c].length;i+=1)input[c].push(_[c][i]);else(I=input[c]).push.apply(I,Fs(new Array(_[0].length).fill(null)))}else input.push(input[c%f].slice(0,M).concat(_[c]));x.populateFromArray(O,S,input);break;default:m.row=t.row,m.col=t.col;var N,H={row:e&&t?e.row-t.row+1:1,col:e&&t?e.col-t.col+1:1},D=0,L=0,F=!0,V=function(t){var col=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=input[t%input.length];return null!==col?e[col%e.length]:e},W=input.length,U=e?e.row-t.row+1:0;for(f=e?U:Math.max(W,U),c=0;c<f&&!(e&&m.row>e.row&&U>W||!B.allowInsertRow&&m.row>x.countRows()-1||m.row>=B.maxRows);c++){var z=c-D,G=V(z).length,Y=e?e.col-t.col+1:0;if(d=e?Y:Math.max(G,Y),m.col=t.col,N=x.getCellMeta(m.row,m.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!N.skipRowOnPaste){for(L=0,h=0;h<d&&!(e&&m.col>e.col&&Y>G||!B.allowInsertColumn&&m.col>x.countCols()-1||m.col>=B.maxCols);h++)if(N=x.getCellMeta(m.row,m.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!N.skipColumnOnPaste)if(N.readOnly&&"UndoRedo.undo"!==source)m.col+=1;else{var X=h-L,K=V(z,X),$=x.getDataAtCell(m.row,m.col),Q={row:z,col:X};if("Autofill.fill"===source){var J=x.runHooks("beforeAutofillInsidePopulate",Q,r,input,o,{},H);J&&(K=Object(l.isUndefined)(J.value)?K:J.value)}if(null!==K&&"object"===Ds(K))if(Array.isArray(K)&&null===$&&($=[]),null===$||"object"!==Ds($))F=!1;else{var Z=Object(object.duckSchema)(Array.isArray($)?$:$[0]||$),tt=Object(object.duckSchema)(Array.isArray(K)?K:K[0]||K);Object(object.isObjectEqual)(Z,tt)||Array.isArray(Z)&&Array.isArray(tt)?K=Object(object.deepClone)(K):F=!1}else null!==$&&"object"===Ds($)&&(F=!1);F&&y.push([m.row,m.col,K]),F=!0,m.col+=1}else L+=1,m.col+=1,d+=1;m.row+=1}else D+=1,m.row+=1,f+=1}x.setDataAtCell(y,null,null,source||"populateFromArray")}}},this.init=function(){j.setData(B.data),x.runHooks("beforeInit"),(Object(c.isMobileBrowser)()||Object(c.isIpadOS)())&&Object(r.addClass)(x.rootElement,"mobile"),this.updateSettings(B,!0),this.view=new No(this),P=d.c.getInstance(x,B,U),x.runHooks("init"),this.forceFullRender=!0,this.view.render(),N&&null===x.rootElement.offsetParent&&Object(r.observeVisibilityChangeOnce)(x.rootElement,(function(){x.view._wt.wtOverlays.updateLastSpreaderSize(),x.render(),x.view.adjustElementsSize()})),"object"===Ds(N)&&(x.runHooks("afterChange",N[0],N[1]),N=!1),x.runHooks("afterInit")},this._createCellCoords=function(t,e){return x.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,n){return x.view._wt.createCellRange(t,e,n)},this.validateCell=function(t,e,n,source){var r,c=x.getCellValidator(e);function f(t){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&!0!==e.hidden){var col=e.visualCol,r=e.visualRow,td=x.getCell(r,col,!0);if(td&&"TH"!==td.nodeName){var o=x.rowIndexMapper.getRenderableFromVisualIndex(r),l=x.columnIndexMapper.getRenderableFromVisualIndex(col);x.view._wt.getSetting("cellRenderer",o,l,td)}n(t)}else n(t)}Object(l.isRegExp)(c)&&(r=c,c=function(t,e){e(r.test(t))}),Object(o.isFunction)(c)?(t=x.runHooks("beforeValidate",t,e.visualRow,e.prop,source),x._registerImmediate((function(){c.call(e,t,(function(n){x&&(n=x.runHooks("afterValidate",n,t,e.visualRow,e.prop,source),e.valid=n,f(n),x.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,source))}))}))):x._registerImmediate((function(){e.valid=!0,f(e.valid,!1)}))},this.setDataAtCell=function(t,e,n,source){var i,r,o,input=$(t,e,n),l=[],c=source;for(i=0,r=input.length;i<r;i++){if("object"!==Ds(input[i]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof input[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");o=input[i][1]>=this.countCols()?input[i][1]:k.colToProp(input[i][1]),l.push([input[i][0],o,j.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]])}c||"object"!==Ds(t)||(c=e),x.runHooks("afterSetDataAtCell",l,c),X(l,c,(function(){K(l,c)}))},this.setDataAtRowProp=function(t,e,n,source){var i,r,input=$(t,e,n),o=[],l=source;for(i=0,r=input.length;i<r;i++)o.push([input[i][0],input[i][1],j.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]]);l||"object"!==Ds(t)||(l=e),x.runHooks("afterSetDataAtRowProp",o,l),X(o,l,(function(){K(o,l)}))},this.listen=function(){x&&!x.isListening()&&(zs=x.guid,x.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(zs=null,x.runHooks("afterUnlisten"))},this.isListening=function(){return zs===x.guid},this.destroyEditor=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];x._refreshBorders(t,e)},this.populateFromArray=function(t,e,input,n,r,source,o,l,c){if("object"!==Ds(input)||"object"!==Ds(input[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var f="number"==typeof n?x._createCellCoords(n,r):null;return T.populateFromArray(x._createCellCoords(t,e),input,f,source,o,l,c)},this.spliceCol=function(t,e,n){for(var r,o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return(r=k).spliceCol.apply(r,[t,e,n].concat(l))},this.spliceRow=function(t,e,n){for(var r,o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return(r=k).spliceRow.apply(r,[t,e,n].concat(l))},this.getSelected=function(){if(U.isSelected())return Object(v.arrayMap)(U.getSelectedRange(),(function(t){var e=t.from,n=t.to;return[e.row,e.col,n.row,n.col]}))},this.getSelectedLast=function(){var t,e=this.getSelected();return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){var t,e=this.getSelectedRange();return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(source){var t=this;if(U.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var e=[];Object(v.arrayEach)(U.getSelectedRange(),(function(n){var r=n.getTopStartCorner(),o=n.getBottomEndCorner();Object(R.rangeEach)(r.row,o.row,(function(n){Object(R.rangeEach)(r.col,o.col,(function(r){t.getCellMeta(n,r).readOnly||e.push([n,r,null])}))}))})),e.length>0&&this.setDataAtCell(e,source)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(P.lockEditor(),this._refreshBorders(null),P.unlockEditor()))},this.batchRender=function(t){this.suspendRender();var e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=t();return this.resumeExecution(e),n},this.batch=function(t){this.suspendRender(),this.suspendExecution();var e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(x.view){var t=x.view.getLastSize(),e=t.width,n=t.height,r=x.rootElement.getBoundingClientRect(),o=r.width,l=r.height,c=o!==e||l!==n;!1===x.runHooks("beforeRefreshDimensions",{width:e,height:n},{width:o,height:l},c)||((c||x.view._wt.wtOverlays.scrollableElement===x.rootWindow)&&(x.view.setLastSize(o,l),x.render()),x.runHooks("afterRefreshDimensions",{width:e,height:n},{width:o,height:l},c))}},this.updateData=function(data,source){var t=this;ws(data,(function(t){k=t}),(function(e){k=e,x.columnIndexMapper.fitToLength(t.getInitialColumnCount()),x.rowIndexMapper.fitToLength(t.countSourceRows()),T.adjustRowsAndCols()}),{hotInstance:x,dataMap:k,dataSource:j,internalSource:"updateData",source:source,metaManager:L,firstRun:N})},this.loadData=function(data,source){ws(data,(function(t){k=t}),(function(){L.clearCellsCache(),x.initIndexMappers(),T.adjustRowsAndCols(),N&&(N=[null,"loadData"])}),{hotInstance:x,dataMap:k,dataSource:j,internalSource:"loadData",source:source,metaManager:L,firstRun:N})},this.getInitialColumnCount=function(){var t=B.columns,e=0;if(Array.isArray(t))e=t.length;else if(Object(o.isFunction)(t))if("array"===x.dataType)for(var n=this.countSourceCols(),r=0;r<n;r+=1)t(r)&&(e+=1);else"object"!==x.dataType&&"function"!==x.dataType||(e=k.colToPropCache.length);else if(Object(l.isDefined)(B.dataSchema)){var c=k.getSchema();e=Array.isArray(c)?c.length:Object(object.deepObjectSize)(c)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,n,r){return Object(l.isUndefined)(t)?k.getAll():k.getRange(x._createCellCoords(t,e),x._createCellCoords(n,r),k.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,r){return k.getCopyableText(x._createCellCoords(t,e),x._createCellCoords(n,r))},this.getCopyableData=function(t,e){return k.getCopyable(t,k.colToProp(e))},this.getSchema=function(){return k.getSchema()},this.updateSettings=function(t){var i,e,n,r,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],f=(N?x.loadData:x.updateData).bind(this),h=!1;if(Object(l.isDefined)(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Object(l.isDefined)(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Object(l.isDefined)(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(i in t)"data"===i||("language"===i?(n=t.language,r=void 0,r=Object(xi.b)(n),Object(_i.f)(r)?(x.runHooks("beforeLanguageChange",r),F.language=r,x.runHooks("afterLanguageChange",r)):Object(xi.c)(n)):"className"===i?G("className",t.className):"tableClassName"===i&&x.table?(G("tableClassName",t.tableClassName),x.view._wt.wtOverlays.syncOverlayTableClassNames()):Mi.a.getSingleton().isRegistered(i)||Mi.a.getSingleton().isDeprecated(i)?(Object(o.isFunction)(t[i])||Array.isArray(t[i]))&&(t[i].initialHook=!0,x.addHook(i,t[i])):!c&&Object(object.hasOwnProperty)(t,i)&&(F[i]=t[i]));void 0===t.data&&void 0===B.data?f(null,"updateSettings"):void 0!==t.data?f(t.data,"updateSettings"):void 0!==t.columns&&(k.createMap(),x.initIndexMappers());var d=x.countCols(),y=B.columns;if(y&&Object(o.isFunction)(y)&&(h=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||L.clearCache(),d>0)for(i=0,e=0;i<d;i++){if(y){var v=h?y(i):y[e];v&&L.updateColumnMeta(e,v)}e+=1}Object(l.isDefined)(t.cell)&&Object(object.objectEach)(t.cell,(function(t){x.setCellMetaObject(t.row,t.col,t)})),x.runHooks("afterCellMetaReset");var m=x.rootElement.style.height;""!==m&&(m=parseInt(x.rootElement.style.height,10));var w=t.height;(Object(o.isFunction)(w)&&(w=w()),c)&&(x.rootElement.getAttribute("style")&&x.rootElement.setAttribute("data-initialstyle",x.rootElement.getAttribute("style")));if(null===w){var O=x.rootElement.getAttribute("data-initialstyle");O&&(O.indexOf("height")>-1||O.indexOf("overflow")>-1)?x.rootElement.setAttribute("style",O):(x.rootElement.style.height="",x.rootElement.style.overflow="")}else void 0!==w&&(x.rootElement.style.height=isNaN(w)?"".concat(w):"".concat(w,"px"),x.rootElement.style.overflow="hidden");if(void 0!==t.width){var S=t.width;Object(o.isFunction)(S)&&(S=S()),x.rootElement.style.width=isNaN(S)?"".concat(S):"".concat(S,"px")}c||(x.view&&(x.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),x.view._wt.exportSettingsAsClassNames()),x.runHooks("afterUpdateSettings",t)),T.adjustRowsAndCols(),x.view&&!N&&(x.forceFullRender=!0,P.lockEditor(),x._refreshBorders(null),x.view._wt.wtOverlays.adjustElementsSize(),P.unlockEditor()),c||!x.view||""!==m&&""!==w&&void 0!==w||m===w||x.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=x.getSelectedLast();if(B.getValue){if(Object(o.isFunction)(B.getValue))return B.getValue.call(x);if(t)return x.getData()[t[0][0]][B.getValue]}else if(t)return x.getDataAtCell(t[0],t[1])},this.getSettings=function(){return B},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,source,r){T.alter(t,e,n,source,r)},this.getCell=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,o=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===o||null===r?null:x.view.getCellAtCoords(x._createCellCoords(o,r),n)},this.getCoords=function(element){var t=this.view._wt.wtTable.getCoords(element);if(null===t)return null;var e=t.row,n=t.col,r=e,o=n;return e>=0&&(r=this.rowIndexMapper.getVisualFromRenderableIndex(e)),n>=0&&(o=this.columnIndexMapper.getVisualFromRenderableIndex(n)),x._createCellCoords(r,o)},this.colToProp=function(t){return k.colToProp(t)},this.propToCol=function(t){return k.propToCol(t)},this.toVisualRow=function(t){return A.rowIndexMapper.getVisualFromPhysicalIndex(t)},this.toVisualColumn=function(t){return A.columnIndexMapper.getVisualFromPhysicalIndex(t)},this.toPhysicalRow=function(t){return A.rowIndexMapper.getPhysicalFromVisualIndex(t)},this.toPhysicalColumn=function(t){return A.columnIndexMapper.getPhysicalFromVisualIndex(t)},this.getDataAtCell=function(t,e){return k.get(t,k.colToProp(e))},this.getDataAtRowProp=function(t,e){return k.get(t,e)},this.getDataAtCol=function(t){var e;return(e=[]).concat.apply(e,Fs(k.getRange(x._createCellCoords(0,t),x._createCellCoords(B.data.length-1,t),k.DESTINATION_RENDERER)))},this.getDataAtProp=function(t){var e,n=k.getRange(x._createCellCoords(0,k.propToCol(t)),x._createCellCoords(B.data.length-1,k.propToCol(t)),k.DESTINATION_RENDERER);return(e=[]).concat.apply(e,Fs(n))},this.getSourceData=function(t,e,n,r){return void 0===t?j.getData():j.getByRange(x._createCellCoords(t,e),x._createCellCoords(n,r))},this.getSourceDataArray=function(t,e,n,r){return void 0===t?j.getData(!0):j.getByRange(x._createCellCoords(t,e),x._createCellCoords(n,r),!0)},this.getSourceDataAtCol=function(t){return j.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,n,source){var input=$(t,e,n),r=this.hasHook("afterSetSourceDataAtCell"),o=[];r&&Object(v.arrayEach)(input,(function(t){var e=Bs(t,3),n=e[0],r=e[1],l=e[2];o.push([n,r,j.getAtCell(n,r),l])})),Object(v.arrayEach)(input,(function(t){var e=Bs(t,3),n=e[0],r=e[1],o=e[2];j.setAtCell(n,r,o)})),r&&this.runHooks("afterSetSourceDataAtCell",o,source),this.render();var c=x.getActiveEditor();c&&Object(l.isDefined)(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(t){return j.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return j.getAtCell(t,e)},this.getDataAtRow=function(t){return k.getRange(x._createCellCoords(t,0),x._createCellCoords(t,this.countCols()-1),k.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,r){var o=this,l=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,r],c=l[0],f=l[1],h=l[2],d=l[3],y=null,v=null;void 0===h&&(h=c),void 0===d&&(d=f);var m="mixed";return Object(R.rangeEach)(Math.max(Math.min(c,h),0),Math.max(c,h),(function(t){var e=!0;return Object(R.rangeEach)(Math.max(Math.min(f,d),0),Math.max(f,d),(function(n){var r=o.getCellMeta(t,n);return v=r.type,y?e=y===v:y=v,e})),m=e?v:"mixed",e})),m},this.removeCellMeta=function(t,e,n){var r=[this.toPhysicalRow(t),this.toPhysicalColumn(e)],o=r[0],l=r[1],c=L.getCellMetaKeyValue(o,l,n);!1!==x.runHooks("beforeRemoveCellMeta",t,e,n,c)&&(L.removeCellMeta(o,l,n),x.runHooks("afterRemoveCellMeta",t,e,n,c)),c=null},this.spliceCellsMeta=function(t){for(var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&L.removeRow(this.toPhysicalRow(t),n),o.length>0&&Object(v.arrayEach)(o.reverse(),(function(n){L.createRow(e.toPhysicalRow(t)),Object(v.arrayEach)(n,(function(n,r){return e.setCellMetaObject(t,r,n)}))})),x.render()},this.setCellMetaObject=function(t,e,n){var r=this;"object"===Ds(n)&&Object(object.objectEach)(n,(function(n,o){r.setCellMeta(t,e,o,n)}))},this.setCellMeta=function(t,e,n,r){if(!1!==x.runHooks("beforeSetCellMeta",t,e,n,r)){var o=t,l=e;t<this.countRows()&&(o=this.toPhysicalRow(t)),e<this.countCols()&&(l=this.toPhysicalColumn(e)),L.setCellMeta(o,l,n,r),x.runHooks("afterSetCellMeta",t,e,n,r)}},this.getCellsMeta=function(){return L.getCellsMeta()},this.getCellMeta=function(t,e){var n=this.toPhysicalRow(t),r=this.toPhysicalColumn(e);return null===n&&(n=t),null===r&&(r=e),L.getCellMeta(n,r,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return L.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===x.dataType||B.columns)},this.getCellRenderer=function(t,e){var n="number"==typeof t?x.getCellMeta(t,e).renderer:t.renderer;return"string"==typeof n?Object(O.b)(n):Object(l.isUndefined)(n)?Object(O.b)("text"):n},this.getCellEditor=function(t,e){var n="number"==typeof t?x.getCellMeta(t,e).editor:t.editor;return"string"==typeof n?Object(S.a)(n):Object(l.isUndefined)(n)?Object(S.a)("text"):n},this.getCellValidator=function(t,e){var n="number"==typeof t?x.getCellMeta(t,e).validator:t.validator;return"string"==typeof n?Object(C.b)(n):n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var r=new Y;t&&(r.onQueueEmpty=t);for(var i=x.countRows()-1;i>=0;)if(void 0===e||-1!==e.indexOf(i)){for(var o=x.countCols()-1;o>=0;)void 0===n||-1!==n.indexOf(o)?(r.addValidatorToQueue(),x.validateCell(x.getDataAtCell(i,o),x.getCellMeta(i,o),(function(t){if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),o-=1):o-=1;i-=1}else i-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=B.rowHeaders,n=t;return void 0!==n&&(n=x.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Object(R.rangeEach)(x.countRows()-1,(function(i){e.push(x.getRowHeader(i))}))):Array.isArray(e)&&void 0!==e[n]?e=e[n]:Object(o.isFunction)(e)?e=e(n):e&&"string"!=typeof e&&"number"!=typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!B.rowHeaders},this.hasColHeaders=function(){if(void 0!==B.colHeaders&&null!==B.colHeaders)return!!B.colHeaders;for(var i=0,t=x.countCols();i<t;i++)if(x.getColHeader(i))return!0;return!1},this.getColHeader=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=x.runHooks("modifyColHeader",t);if(void 0===n){for(var r=[],l=x.countCols(),i=0;i<l;i++)r.push(x.getColHeader(i));return r}var c=B.colHeaders,f=x.toPhysicalColumn(n),h=function(t){for(var e=[],n=x.countCols(),r=0;r<n;r++)Object(o.isFunction)(B.columns)&&B.columns(r)&&e.push(r);return e[t]}(f);return!1===B.colHeaders?c=null:B.columns&&Object(o.isFunction)(B.columns)&&B.columns(h)&&B.columns(h).title?c=B.columns(h).title:B.columns&&B.columns[f]&&B.columns[f].title?c=B.columns[f].title:Array.isArray(B.colHeaders)&&void 0!==B.colHeaders[f]?c=B.colHeaders[f]:Object(o.isFunction)(B.colHeaders)?c=B.colHeaders(f):B.colHeaders&&"string"!=typeof B.colHeaders&&"number"!=typeof B.colHeaders&&(c=Object(Ho.spreadsheetColumnLabel)(n)),c=x.runHooks("modifyColumnHeaderValue",c,t,e)},this._getColWidthFromSettings=function(col){var t;col>=0&&(t=x.getCellMeta(0,col).width);if(void 0!==t&&t!==B.width||(t=B.colWidths),null!=t){switch(Ds(t)){case"object":t=t[col];break;case"function":t=t(col)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(t){var e=x._getColWidthFromSettings(t);return void 0===(e=x.runHooks("modifyColWidth",e,t))&&(e=Zr.a.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=B.rowHeights;if(null!=e){switch(Ds(e)){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=x._getRowHeightFromSettings(t);return e=x.runHooks("modifyRowHeight",e,t)},this.countSourceRows=function(){return j.countRows()},this.countSourceCols=function(){return j.countFirstRowKeys()},this.countRows=function(){return k.getLength()},this.countCols=function(){var t=B.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return x.view._wt.drawn?x.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return x.view._wt.drawn?x.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return x.view._wt.drawn?x.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return x.view._wt.drawn?x.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Object(R.rangeEachReverse)(x.countRows()-1,(function(n){if(x.isEmptyRow(n))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Object(R.rangeEachReverse)(x.countCols()-1,(function(n){if(x.isEmptyCol(n))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return B.isEmptyRow.call(x,t)},this.isEmptyCol=function(t){return B.isEmptyCol.call(x,t)},this.selectCell=function(t,e,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Object(l.isUndefined)(t)&&!Object(l.isUndefined)(e)&&this.selectCells([[t,e,n,r]],o,c)},this.selectCells=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(_=!0);var n=U.selectCells(t);return n&&e&&x.listen(),_=!1,n},this.selectColumns=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return U.selectColumns(t,e)},this.selectRows=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return U.selectRows(t,e)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=t&&this.hasRowHeaders(),n=t&&this.hasColHeaders();_=!0,U.selectAll(e,n),_=!1};var Q=function(t,e){return t.getNearestNotHiddenIndex(e,1,!0)};this.scrollViewportTo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!n,l=!r,c=t,f=e;if(!(arguments.length>4&&void 0!==arguments[4])||arguments[4]){var h=Number.isInteger(t),d=Number.isInteger(e),y=h?Q(this.rowIndexMapper,t):void 0,v=d?Q(this.columnIndexMapper,e):void 0;if(null===y||null===v)return!1;c=h?x.rowIndexMapper.getRenderableFromVisualIndex(y):void 0,f=d?x.columnIndexMapper.getRenderableFromVisualIndex(v):void 0}var m=Number.isInteger(c),w=Number.isInteger(f);return m&&w?x.view.scrollViewport(x._createCellCoords(c,f),o,r,n,l):m&&!1===w?x.view.scrollViewportVertically(c,o,n):!(!w||!1!==m)&&x.view.scrollViewportHorizontally(f,r,l)},this.destroy=function(){if(x._clearTimeouts(),x._clearImmediates(),x.view&&x.view.destroy(),j&&j.destroy(),j=null,this.getShortcutManager().destroy(),L.clearCache(),Object(mo.b)(x)){var t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}Object(r.empty)(x.rootElement),I.destroy(),P&&P.destroy(),x.batchExecution((function(){x.rowIndexMapper.unregisterAll(),x.columnIndexMapper.unregisterAll(),V.getItems().forEach((function(t){Bs(t,2)[1].destroy()})),V.clear(),x.runHooks("afterDestroy")}),!0),Mi.a.getSingleton().destroy(x),Object(object.objectEach)(x,(function(t,e,n){var r;Object(o.isFunction)(t)?n[e]=(r=e,function(){throw new Error('The "'.concat(r,'" method cannot be called because this Handsontable instance has been destroyed'))}):"guid"!==e&&(n[e]=null)})),x.isDestroyed=!0,k&&k.destroy(),x.rowIndexMapper=null,x.columnIndexMapper=null,k=null,T=null,U=null,P=null,x=null},this.getActiveEditor=function(){return P.getActiveEditor()},this.getPlugin=function(t){var e=Object(E.toUpperCaseFirst)(t);return"UndoRedo"===e?this.undoRedo:V.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:V.getId(t)},this.getInstance=function(){return x},this.addHook=function(t,e){Mi.a.getSingleton().add(t,e,x)},this.hasHook=function(t){return Mi.a.getSingleton().has(t,x)||Mi.a.getSingleton().has(t)},this.addHookOnce=function(t,e){Mi.a.getSingleton().once(t,e,x)},this.removeHook=function(t,e){Mi.a.getSingleton().remove(t,e,x)},this.runHooks=function(t,e,n,r,o,l,c){return Mi.a.getSingleton().run(x,t,e,n,r,o,l,c)},this.getTranslatedPhrase=function(t,e){return Object(_i.d)(B.language,t,e)},this.toHTML=function(){return Object(m.instanceToHTML)(A)},this.toTableElement=function(){var t=A.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Object(m.instanceToHTML)(A)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){var e=t;"function"==typeof e&&(e=setTimeout(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(e)},this._clearTimeouts=function(){Object(v.arrayEach)(this.timeouts,(function(t){clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){Object(v.arrayEach)(this.immediates,(function(t){clearImmediate(t)}))},this._refreshBorders=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];P.destroyEditor(t),x.view.render(),e&&U.isSelected()&&P.prepareEditor()},this.isRtl=function(){return"rtl"===x.rootWindow.getComputedStyle(x.rootElement).direction},this.isLtr=function(){return!x.isRtl()},this.getDirectionFactor=function(){return x.isLtr()?1:-1};var J=Hs({handleEvent:function(t){var e=x.isListening(),n=void 0!==(null==t?void 0:t.key);return e&&n},beforeKeyDown:function(t){return A.runHooks("beforeKeyDown",t)},afterKeyDown:function(t){A.isDestroyed||x.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(function(t){!1===t.ctrlKey&&!1===t.metaKey&&J.releasePressedKeys()})),this.getShortcutManager=function(){return J};var Z=J.addContext("grid"),tt={runOnlyIf:function(){return Object(l.isDefined)(x.getSelected())&&x.countRenderedRows()>0&&x.countRenderedCols()>0},group:Us};J.setActiveContextName("grid"),Z.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){x.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var t=x.getSelectedRange(),e=t[t.length-1].highlight,n=e.row,r=e.col,o=x.getDataAtCell(n,r),l=new Map,i=0;i<t.length;i++)t[i].forAll((function(t,e){t>=0&&e>=0&&(t!==n||e!==r)&&(x.getCellMeta(t,e).readOnly||l.set("".concat(t,"x").concat(e),[t,e,o]))}));x.setDataAtCell(Array.from(l.values()))},runOnlyIf:function(){return x.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){U.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){U.setRangeStart(x._createCellCoords(x.rowIndexMapper.getNearestNotHiddenIndex(0,1),x.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){U.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t=x.getSelectedRangeLast(),e=t.from,n=t.to,r=x.rowIndexMapper.getNearestNotHiddenIndex(0,1);U.setRangeStart(e.clone()),U.setRangeEnd(x._createCellCoords(r,n.col))},runOnlyIf:function(){return!(x.selection.isSelectedByCorner()||x.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){U.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){U.setRangeStart(x._createCellCoords(x.rowIndexMapper.getNearestNotHiddenIndex(x.countRows()-1,-1),x.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){U.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t=x.getSelectedRangeLast(),e=t.from,n=t.to,r=x.rowIndexMapper.getNearestNotHiddenIndex(x.countRows()-1,-1);U.setRangeStart(e.clone()),U.setRangeEnd(x._createCellCoords(r,n.col))},runOnlyIf:function(){return!(x.selection.isSelectedByCorner()||x.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){U.transformStart(0,-1*x.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=x.getSelectedRangeLast().highlight.row,n=(t=x.columnIndexMapper).getNearestNotHiddenIndex.apply(t,Fs(x.isRtl()?[x.countCols()-1,-1]:[0,1]));U.setRangeStart(x._createCellCoords(e,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){U.transformEnd(0,-1*x.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=x.getSelectedRangeLast(),n=e.from,r=e.to,o=(t=x.columnIndexMapper).getNearestNotHiddenIndex.apply(t,Fs(x.isRtl()?[x.countCols()-1,-1]:[0,1]));U.setRangeStart(n.clone()),U.setRangeEnd(x._createCellCoords(r.row,o))},runOnlyIf:function(){return!(x.selection.isSelectedByCorner()||x.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){U.transformStart(0,x.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=x.getSelectedRangeLast().highlight.row,n=(t=x.columnIndexMapper).getNearestNotHiddenIndex.apply(t,Fs(x.isRtl()?[0,1]:[x.countCols()-1,-1]));U.setRangeStart(x._createCellCoords(e,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){U.transformEnd(0,x.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=x.getSelectedRangeLast(),n=e.from,r=e.to,o=(t=x.columnIndexMapper).getNearestNotHiddenIndex.apply(t,Fs(x.isRtl()?[0,1]:[x.countCols()-1,-1]));U.setRangeStart(n.clone()),U.setRangeEnd(x._createCellCoords(r.row,o))},runOnlyIf:function(){return!(x.selection.isSelectedByCorner()||x.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var t=parseInt(x.getSettings().fixedColumnsStart,10),e=x.getSelectedRangeLast().highlight.row,n=x.columnIndexMapper.getNearestNotHiddenIndex(t,1);U.setRangeStart(x._createCellCoords(e,n))},runOnlyIf:function(){return x.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){U.setRangeEnd(x._createCellCoords(U.selectedRange.current().from.row,x.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var t=parseInt(x.getSettings().fixedRowsTop,10),e=parseInt(x.getSettings().fixedColumnsStart,10),n=x.rowIndexMapper.getNearestNotHiddenIndex(t,1),r=x.columnIndexMapper.getNearestNotHiddenIndex(e,1);U.setRangeStart(x._createCellCoords(n,r))},runOnlyIf:function(){return x.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){U.setRangeStart(x._createCellCoords(x.getSelectedRangeLast().highlight.row,x.columnIndexMapper.getNearestNotHiddenIndex(x.countCols()-1,-1)))},runOnlyIf:function(){return x.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){U.setRangeEnd(x._createCellCoords(U.selectedRange.current().from.row,x.columnIndexMapper.getNearestNotHiddenIndex(x.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var t=parseInt(x.getSettings().fixedRowsBottom,10),e=x.rowIndexMapper.getNearestNotHiddenIndex(x.countRows()-t-1,-1),n=x.columnIndexMapper.getNearestNotHiddenIndex(x.countCols()-1,-1);U.setRangeStart(x._createCellCoords(e,n))},runOnlyIf:function(){return x.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){U.transformStart(-x.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var t=x.getSelectedRangeLast().to,e=Math.max(t.row-x.countVisibleRows(),0),n=x.rowIndexMapper.getNearestNotHiddenIndex(e,1);if(null!==n){var r=x._createCellCoords(n,t.col),o=t.row-x.view.getFirstFullyVisibleRow(),l=Math.max(r.row-o,0);U.setRangeEnd(r),x.scrollViewportTo(l)}}},{keys:[["PageDown"]],callback:function(){U.transformStart(x.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var t=x.getSelectedRangeLast().to,e=Math.min(t.row+x.countVisibleRows(),x.countRows()-1),n=x.rowIndexMapper.getNearestNotHiddenIndex(e,-1);if(null!==n){var r=x._createCellCoords(n,t.col),o=t.row-x.view.getFirstFullyVisibleRow(),l=Math.min(r.row-o,x.countRows()-1);U.setRangeEnd(r),x.scrollViewportTo(l)}}},{keys:[["Tab"]],callback:function(t){var e="function"==typeof B.tabMoves?B.tabMoves(t):B.tabMoves;U.transformStart(e.row,e.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var e="function"==typeof B.tabMoves?B.tabMoves(t):B.tabMoves;U.transformStart(-e.row,-e.col)}}],tt),Object(w.b)().forEach((function(t){var e=Object(w.a)(t);V.addItem(t,new e(A))})),Mi.a.getSingleton().run(x,"construct")}},871:function(t,e,n){"use strict";n.d(e,"a",(function(){return v})),n.d(e,"g",(function(){return T})),n.d(e,"b",(function(){return P})),n.d(e,"f",(function(){return A})),n.d(e,"c",(function(){return M})),n.d(e,"d",(function(){return _})),n.d(e,"e",(function(){return x}));var object=n(664),r=n(665),o=n(673),l=n(847),c=n(730);n(696),n(26);var f=Object(c.a)("phraseFormatters"),h=f.register,d=f.getValues;h("pluralize",(function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}));n(656),n(657),n(11),n(62),n(6),n(74),n(239),n(40),n(44);var y,v=n(667);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function w(t,e,n){return(e=function(t){var e=function(input,t){if("object"!==m(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(t,"string");return"symbol"===m(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O=(w(y={languageCode:"en-US"},v.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),w(y,v.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),w(y,v.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),w(y,v.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),w(y,v.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),w(y,v.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),w(y,v.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),w(y,v.CONTEXTMENU_ITEMS_UNDO,"Undo"),w(y,v.CONTEXTMENU_ITEMS_REDO,"Redo"),w(y,v.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),w(y,v.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),w(y,v.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),w(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),w(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),w(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),w(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),w(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),w(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),w(y,v.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),w(y,v.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),w(y,v.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),w(y,v.CONTEXTMENU_ITEMS_BORDERS,"Borders"),w(y,v.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),w(y,v.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),w(y,v.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),w(y,v.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),w(y,v.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),w(y,v.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),w(y,v.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),w(y,v.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),w(y,v.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),w(y,v.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),w(y,v.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),w(y,v.CONTEXTMENU_ITEMS_COPY,"Copy"),w(y,v.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,["Copy with header","Copy with headers"]),w(y,v.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,["Copy with group header","Copy with group headers"]),w(y,v.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,["Copy header only","Copy headers only"]),w(y,v.CONTEXTMENU_ITEMS_CUT,"Cut"),w(y,v.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),w(y,v.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),w(y,v.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),w(y,v.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),w(y,v.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),w(y,v.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),w(y,v.FILTERS_CONDITIONS_NONE,"None"),w(y,v.FILTERS_CONDITIONS_EMPTY,"Is empty"),w(y,v.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),w(y,v.FILTERS_CONDITIONS_EQUAL,"Is equal to"),w(y,v.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),w(y,v.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),w(y,v.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),w(y,v.FILTERS_CONDITIONS_CONTAINS,"Contains"),w(y,v.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),w(y,v.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),w(y,v.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),w(y,v.FILTERS_CONDITIONS_LESS_THAN,"Less than"),w(y,v.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),w(y,v.FILTERS_CONDITIONS_BETWEEN,"Is between"),w(y,v.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),w(y,v.FILTERS_CONDITIONS_AFTER,"After"),w(y,v.FILTERS_CONDITIONS_BEFORE,"Before"),w(y,v.FILTERS_CONDITIONS_TODAY,"Today"),w(y,v.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),w(y,v.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),w(y,v.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),w(y,v.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),w(y,v.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),w(y,v.FILTERS_LABELS_CONJUNCTION,"And"),w(y,v.FILTERS_LABELS_DISJUNCTION,"Or"),w(y,v.FILTERS_BUTTONS_SELECT_ALL,"Select all"),w(y,v.FILTERS_BUTTONS_CLEAR,"Clear"),w(y,v.FILTERS_BUTTONS_OK,"OK"),w(y,v.FILTERS_BUTTONS_CANCEL,"Cancel"),w(y,v.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),w(y,v.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),w(y,v.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),y),S=O.languageCode,C=Object(c.a)("languagesDictionaries"),E=C.register,R=C.getItem,k=C.hasItem,j=C.getValues;function T(t,e){var n=t,r=e;return Object(object.isObject)(t)&&(n=(r=t).languageCode),function(t,e){t!==S&&Object(l.a)(e,R(S))}(n,r),E(n,Object(object.deepClone)(r)),Object(object.deepClone)(r)}function P(t){return A(t)?Object(object.deepClone)(R(t)):null}function A(t){return k(t)}function M(){return j()}function _(t,e,n){var l=P(t);if(null===l)return null;var c=l[e];if(Object(o.isUndefined)(c))return null;var f=function(t,e){var n=t;return Object(r.arrayEach)(function(){return d()}(),(function(r){n=r(t,e)})),n}(c,n);return Array.isArray(f)?f[0]:f}function x(t){var e=Object(l.b)(t);return A(e)||(e=S,Object(l.c)(t)),e}T(O)},933:function(t,e,n){"use strict";var r=n(37),o=n(430),l=TypeError;t.exports=function(t){if(r(this),"string"===t||"default"===t)t="string";else if("number"!==t)throw l("Incorrect hint");return o(this,t)}},934:function(t,e,n){"use strict";var r=n(7),o=n(249).codeAt;r({target:"String",proto:!0},{codePointAt:function(t){return o(this,t)}})},935:function(t,e,n){t.exports=function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,p){return e=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},e(t,p)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function r(t,o,l){return r=n()?Reflect.construct:function(t,n,r){var a=[null];a.push.apply(a,n);var o=new(Function.bind.apply(t,a));return r&&e(o,r.prototype),o},r.apply(null,arguments)}function o(t){return l(t)||c(t)||f(t)||d()}function l(t){if(Array.isArray(t))return h(t)}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function f(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var y=Object.hasOwnProperty,v=Object.setPrototypeOf,m=Object.isFrozen,w=Object.getPrototypeOf,O=Object.getOwnPropertyDescriptor,S=Object.freeze,C=Object.seal,E=Object.create,R="undefined"!=typeof Reflect&&Reflect,k=R.apply,j=R.construct;k||(k=function(t,e,n){return t.apply(e,n)}),S||(S=function(t){return t}),C||(C=function(t){return t}),j||(j=function(t,e){return r(t,o(e))});var T=B(Array.prototype.forEach),P=B(Array.prototype.pop),A=B(Array.prototype.push),M=B(String.prototype.toLowerCase),_=B(String.prototype.toString),x=B(String.prototype.match),I=B(String.prototype.replace),N=B(String.prototype.indexOf),H=B(String.prototype.trim),D=B(RegExp.prototype.test),L=F(TypeError);function B(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return k(t,e,r)}}function F(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return j(t,n)}}function V(t,e,n){n=n||M,v&&v(t,null);for(var r=e.length;r--;){var element=e[r];if("string"==typeof element){var o=n(element);o!==element&&(m(e)||(e[r]=o),element=o)}t[element]=!0}return t}function W(object){var t,e=E(null);for(t in object)!0===k(y,object,[t])&&(e[t]=object[t]);return e}function U(object,t){for(;null!==object;){var desc=O(object,t);if(desc){if(desc.get)return B(desc.get);if("function"==typeof desc.value)return B(desc.value)}object=w(object)}function e(element){return console.warn("fallback value for",element),null}return e}var z=S(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),G=S(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Y=S(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),X=S(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),K=S(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),$=S(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=S(["#text"]),html=S(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg=S(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Q=S(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),J=S(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Z=C(/\{\{[\w\W]*|[\w\W]*\}\}/gm),tt=C(/<%[\w\W]*|[\w\W]*%>/gm),et=C(/\${[\w\W]*}/gm),nt=C(/^data-[\-\w.\u00B7-\uFFFF]/),ot=C(/^aria-[\-\w]+$/),it=C(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),at=C(/^(?:\w+script|data):/i),lt=C(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),st=C(/^html$/i),ut=function(){return"undefined"==typeof window?null:window},ct=function(e,n){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var l="dompurify"+(r?"#"+r:"");try{return e.createPolicy(l,{createHTML:function(html){return html},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+l+" could not be created."),null}};function ft(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut(),n=function(t){return ft(t)};if(n.version="2.4.5",n.removed=[],!e||!e.document||9!==e.document.nodeType)return n.isSupported=!1,n;var r=e.document,l=e.document,c=e.DocumentFragment,f=e.HTMLTemplateElement,h=e.Node,d=e.Element,y=e.NodeFilter,v=e.NamedNodeMap,m=void 0===v?e.NamedNodeMap||e.MozNamedAttrMap:v,w=e.HTMLFormElement,O=e.DOMParser,C=e.trustedTypes,E=d.prototype,R=U(E,"cloneNode"),k=U(E,"nextSibling"),j=U(E,"childNodes"),B=U(E,"parentNode");if("function"==typeof f){var template=l.createElement("template");template.content&&template.content.ownerDocument&&(l=template.content.ownerDocument)}var F=ct(C,r),ht=F?F.createHTML(""):"",pt=l,yt=pt.implementation,bt=pt.createNodeIterator,vt=pt.createDocumentFragment,mt=pt.getElementsByTagName,gt=r.importNode,wt={};try{wt=W(l).documentMode?l.documentMode:{}}catch(t){}var Ot={};n.isSupported="function"==typeof B&&yt&&void 0!==yt.createHTMLDocument&&9!==wt;var St,Ct,Et=Z,Rt=tt,kt=et,jt=nt,Tt=ot,Pt=at,At=lt,Mt=it,_t=null,xt=V({},[].concat(o(z),o(G),o(Y),o(K),o(text))),It=null,Nt=V({},[].concat(o(html),o(svg),o(Q),o(J))),Ht=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Dt=null,Lt=null,Bt=!0,Ft=!0,Vt=!1,Wt=!0,Ut=!1,zt=!1,Gt=!1,Yt=!1,Xt=!1,Kt=!1,$t=!1,qt=!0,Qt=!1,Jt="user-content-",Zt=!0,te=!1,ee={},ne=null,re=V({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),oe=null,ie=V({},["audio","video","img","source","image","track"]),ae=null,le=V({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),se="http://www.w3.org/1998/Math/MathML",ue="http://www.w3.org/2000/svg",ce="http://www.w3.org/1999/xhtml",fe=ce,he=!1,de=null,pe=V({},[se,ue,ce],_),ye=["application/xhtml+xml","text/html"],be="text/html",ve=null,me=l.createElement("form"),ge=function(t){return t instanceof RegExp||t instanceof Function},we=function(e){ve&&ve===e||(e&&"object"===t(e)||(e={}),e=W(e),St=St=-1===ye.indexOf(e.PARSER_MEDIA_TYPE)?be:e.PARSER_MEDIA_TYPE,Ct="application/xhtml+xml"===St?_:M,_t="ALLOWED_TAGS"in e?V({},e.ALLOWED_TAGS,Ct):xt,It="ALLOWED_ATTR"in e?V({},e.ALLOWED_ATTR,Ct):Nt,de="ALLOWED_NAMESPACES"in e?V({},e.ALLOWED_NAMESPACES,_):pe,ae="ADD_URI_SAFE_ATTR"in e?V(W(le),e.ADD_URI_SAFE_ATTR,Ct):le,oe="ADD_DATA_URI_TAGS"in e?V(W(ie),e.ADD_DATA_URI_TAGS,Ct):ie,ne="FORBID_CONTENTS"in e?V({},e.FORBID_CONTENTS,Ct):re,Dt="FORBID_TAGS"in e?V({},e.FORBID_TAGS,Ct):{},Lt="FORBID_ATTR"in e?V({},e.FORBID_ATTR,Ct):{},ee="USE_PROFILES"in e&&e.USE_PROFILES,Bt=!1!==e.ALLOW_ARIA_ATTR,Ft=!1!==e.ALLOW_DATA_ATTR,Vt=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Wt=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ut=e.SAFE_FOR_TEMPLATES||!1,zt=e.WHOLE_DOCUMENT||!1,Xt=e.RETURN_DOM||!1,Kt=e.RETURN_DOM_FRAGMENT||!1,$t=e.RETURN_TRUSTED_TYPE||!1,Yt=e.FORCE_BODY||!1,qt=!1!==e.SANITIZE_DOM,Qt=e.SANITIZE_NAMED_PROPS||!1,Zt=!1!==e.KEEP_CONTENT,te=e.IN_PLACE||!1,Mt=e.ALLOWED_URI_REGEXP||Mt,fe=e.NAMESPACE||ce,Ht=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ge(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ht.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ge(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ht.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ht.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ut&&(Ft=!1),Kt&&(Xt=!0),ee&&(_t=V({},o(text)),It=[],!0===ee.html&&(V(_t,z),V(It,html)),!0===ee.svg&&(V(_t,G),V(It,svg),V(It,J)),!0===ee.svgFilters&&(V(_t,Y),V(It,svg),V(It,J)),!0===ee.mathMl&&(V(_t,K),V(It,Q),V(It,J))),e.ADD_TAGS&&(_t===xt&&(_t=W(_t)),V(_t,e.ADD_TAGS,Ct)),e.ADD_ATTR&&(It===Nt&&(It=W(It)),V(It,e.ADD_ATTR,Ct)),e.ADD_URI_SAFE_ATTR&&V(ae,e.ADD_URI_SAFE_ATTR,Ct),e.FORBID_CONTENTS&&(ne===re&&(ne=W(ne)),V(ne,e.FORBID_CONTENTS,Ct)),Zt&&(_t["#text"]=!0),zt&&V(_t,["html","head","body"]),_t.table&&(V(_t,["tbody"]),delete Dt.tbody),S&&S(e),ve=e)},Oe=V({},["mi","mo","mn","ms","mtext"]),Se=V({},["foreignobject","desc","title","annotation-xml"]),Ce=V({},["title","style","font","a","script"]),Ee=V({},G);V(Ee,Y),V(Ee,X);var Re=V({},K);V(Re,$);var ke=function(element){var t=B(element);t&&t.tagName||(t={namespaceURI:fe,tagName:"template"});var e=M(element.tagName),n=M(t.tagName);return!!de[element.namespaceURI]&&(element.namespaceURI===ue?t.namespaceURI===ce?"svg"===e:t.namespaceURI===se?"svg"===e&&("annotation-xml"===n||Oe[n]):Boolean(Ee[e]):element.namespaceURI===se?t.namespaceURI===ce?"math"===e:t.namespaceURI===ue?"math"===e&&Se[n]:Boolean(Re[e]):element.namespaceURI===ce?!(t.namespaceURI===ue&&!Se[n])&&!(t.namespaceURI===se&&!Oe[n])&&!Re[e]&&(Ce[e]||!Ee[e]):!("application/xhtml+xml"!==St||!de[element.namespaceURI]))},je=function(t){A(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=ht}catch(e){t.remove()}}},Te=function(t,e){try{A(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){A(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!It[t])if(Xt||Kt)try{je(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},Pe=function(t){var e,n;if(Yt)t="<remove></remove>"+t;else{var r=x(t,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===St&&fe===ce&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var o=F?F.createHTML(t):t;if(fe===ce)try{e=(new O).parseFromString(o,St)}catch(t){}if(!e||!e.documentElement){e=yt.createDocument(fe,"template",null);try{e.documentElement.innerHTML=he?ht:o}catch(t){}}var body=e.body||e.documentElement;return t&&n&&body.insertBefore(l.createTextNode(n),body.childNodes[0]||null),fe===ce?mt.call(e,zt?"html":"body")[0]:zt?e.documentElement:body},Ae=function(t){return bt.call(t.ownerDocument||t,t,y.SHOW_ELEMENT|y.SHOW_COMMENT|y.SHOW_TEXT,null,!1)},Me=function(t){return t instanceof w&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof m)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},_e=function(object){return"object"===t(h)?object instanceof h:object&&"object"===t(object)&&"number"==typeof object.nodeType&&"string"==typeof object.nodeName},xe=function(t,e,data){Ot[t]&&T(Ot[t],(function(t){t.call(n,e,data,ve)}))},Ie=function(t){var content;if(xe("beforeSanitizeElements",t,null),Me(t))return je(t),!0;if(D(/[\u0080-\uFFFF]/,t.nodeName))return je(t),!0;var e=Ct(t.nodeName);if(xe("uponSanitizeElement",t,{tagName:e,allowedTags:_t}),t.hasChildNodes()&&!_e(t.firstElementChild)&&(!_e(t.content)||!_e(t.content.firstElementChild))&&D(/<[/\w]/g,t.innerHTML)&&D(/<[/\w]/g,t.textContent))return je(t),!0;if("select"===e&&D(/<template/i,t.innerHTML))return je(t),!0;if(!_t[e]||Dt[e]){if(!Dt[e]&&He(e)){if(Ht.tagNameCheck instanceof RegExp&&D(Ht.tagNameCheck,e))return!1;if(Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(e))return!1}if(Zt&&!ne[e]){var r=B(t)||t.parentNode,o=j(t)||t.childNodes;if(o&&r)for(var i=o.length-1;i>=0;--i)r.insertBefore(R(o[i],!0),k(t))}return je(t),!0}return t instanceof d&&!ke(t)?(je(t),!0):"noscript"!==e&&"noembed"!==e||!D(/<\/no(script|embed)/i,t.innerHTML)?(Ut&&3===t.nodeType&&(content=t.textContent,content=I(content,Et," "),content=I(content,Rt," "),content=I(content,kt," "),t.textContent!==content&&(A(n.removed,{element:t.cloneNode()}),t.textContent=content)),xe("afterSanitizeElements",t,null),!1):(je(t),!0)},Ne=function(t,e,n){if(qt&&("id"===e||"name"===e)&&(n in l||n in me))return!1;if(Ft&&!Lt[e]&&D(jt,e));else if(Bt&&D(Tt,e));else if(!It[e]||Lt[e]){if(!(He(t)&&(Ht.tagNameCheck instanceof RegExp&&D(Ht.tagNameCheck,t)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(t))&&(Ht.attributeNameCheck instanceof RegExp&&D(Ht.attributeNameCheck,e)||Ht.attributeNameCheck instanceof Function&&Ht.attributeNameCheck(e))||"is"===e&&Ht.allowCustomizedBuiltInElements&&(Ht.tagNameCheck instanceof RegExp&&D(Ht.tagNameCheck,n)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(n))))return!1}else if(ae[e]);else if(D(Mt,I(n,At,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==N(n,"data:")||!oe[t])if(Vt&&!D(Pt,I(n,At,"")));else if(n)return!1;return!0},He=function(t){return t.indexOf("-")>0},De=function(e){var r,o,l,c;xe("beforeSanitizeAttributes",e,null);var f=e.attributes;if(f){var h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:It};for(c=f.length;c--;){var d=r=f[c],y=d.name,v=d.namespaceURI;if(o="value"===y?r.value:H(r.value),l=Ct(y),h.attrName=l,h.attrValue=o,h.keepAttr=!0,h.forceKeepAttr=void 0,xe("uponSanitizeAttribute",e,h),o=h.attrValue,!h.forceKeepAttr&&(Te(y,e),h.keepAttr))if(Wt||!D(/\/>/i,o)){Ut&&(o=I(o,Et," "),o=I(o,Rt," "),o=I(o,kt," "));var m=Ct(e.nodeName);if(Ne(m,l,o)){if(!Qt||"id"!==l&&"name"!==l||(Te(y,e),o=Jt+o),F&&"object"===t(C)&&"function"==typeof C.getAttributeType)if(v);else switch(C.getAttributeType(m,l)){case"TrustedHTML":o=F.createHTML(o);break;case"TrustedScriptURL":o=F.createScriptURL(o)}try{v?e.setAttributeNS(v,y,o):e.setAttribute(y,o),P(n.removed)}catch(t){}}}else Te(y,e)}xe("afterSanitizeAttributes",e,null)}},Le=function t(e){var n,r=Ae(e);for(xe("beforeSanitizeShadowDOM",e,null);n=r.nextNode();)xe("uponSanitizeShadowNode",n,null),Ie(n)||(n.content instanceof c&&t(n.content),De(n));xe("afterSanitizeShadowDOM",e,null)};return n.sanitize=function(o){var body,l,f,d,y,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((he=!o)&&(o="\x3c!--\x3e"),"string"!=typeof o&&!_e(o)){if("function"!=typeof o.toString)throw L("toString is not a function");if("string"!=typeof(o=o.toString()))throw L("dirty is not a string, aborting")}if(!n.isSupported){if("object"===t(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof o)return e.toStaticHTML(o);if(_e(o))return e.toStaticHTML(o.outerHTML)}return o}if(Gt||we(v),n.removed=[],"string"==typeof o&&(te=!1),te){if(o.nodeName){var m=Ct(o.nodeName);if(!_t[m]||Dt[m])throw L("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof h)1===(l=(body=Pe("\x3c!----\x3e")).ownerDocument.importNode(o,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?body=l:body.appendChild(l);else{if(!Xt&&!Ut&&!zt&&-1===o.indexOf("<"))return F&&$t?F.createHTML(o):o;if(!(body=Pe(o)))return Xt?null:$t?ht:""}body&&Yt&&je(body.firstChild);for(var w=Ae(te?o:body);f=w.nextNode();)3===f.nodeType&&f===d||Ie(f)||(f.content instanceof c&&Le(f.content),De(f),d=f);if(d=null,te)return o;if(Xt){if(Kt)for(y=vt.call(body.ownerDocument);body.firstChild;)y.appendChild(body.firstChild);else y=body;return(It.shadowroot||It.shadowrootmod)&&(y=gt.call(r,y,!0)),y}var O=zt?body.outerHTML:body.innerHTML;return zt&&_t["!doctype"]&&body.ownerDocument&&body.ownerDocument.doctype&&body.ownerDocument.doctype.name&&D(st,body.ownerDocument.doctype.name)&&(O="<!DOCTYPE "+body.ownerDocument.doctype.name+">\n"+O),Ut&&(O=I(O,Et," "),O=I(O,Rt," "),O=I(O,kt," ")),F&&$t?F.createHTML(O):O},n.setConfig=function(t){we(t),Gt=!0},n.clearConfig=function(){ve=null,Gt=!1},n.isValidAttribute=function(t,e,n){ve||we({});var r=Ct(t),o=Ct(e);return Ne(r,o,n)},n.addHook=function(t,e){"function"==typeof e&&(Ot[t]=Ot[t]||[],A(Ot[t],e))},n.removeHook=function(t){if(Ot[t])return P(Ot[t])},n.removeHooks=function(t){Ot[t]&&(Ot[t]=[])},n.removeAllHooks=function(){Ot={}},n}return ft()}()},936:function(t,e,n){var r=n(42);t.exports=function(t){return void 0!==t&&(r(t,"value")||r(t,"writable"))}},937:function(t,e,n){var r=n(46),o=Math.floor;t.exports=Number.isInteger||function(t){return!r(t)&&isFinite(t)&&o(t)===t}},938:function(t,e,n){n(939),n(940)},939:function(t,e,n){var r=n(7),o=n(27),l=n(315).clear;r({global:!0,bind:!0,enumerable:!0,forced:o.clearImmediate!==l},{clearImmediate:l})},940:function(t,e,n){var r=n(7),o=n(27),l=n(315).set,c=n(335),f=o.setImmediate?c(l,!1):l;r({global:!0,bind:!0,enumerable:!0,forced:o.setImmediate!==f},{setImmediate:f})},941:function(t,e,n){"use strict";n(11),n(62),n(6),n(74),n(239),n(40),n(44);var r=n(673),o=n(664);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}e.a=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(col){var t,e,n;for(t=0,e=this.countRows();t<e;t++)if(n=this.getDataAtCell(t,col),!1===Object(r.isEmpty)(n))return!1;return!0},isEmptyRow:function(t){var col,e,n,meta;for(col=0,e=this.countCols();col<e;col++)if(n=this.getDataAtCell(t,col),!1===Object(r.isEmpty)(n))return"object"===l(n)&&(meta=this.getCellMeta(t,col),Object(o.isObjectEqual)(this.getSchema()[meta.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}}},942:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return y}));n(239),n(242),n(6),n(40),n(44),n(12),n(56),n(656),n(657),n(11),n(62),n(26),n(74);var r=n(673),o=n(664),l=n(716);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,o=void 0,o=function(input,t){if("object"!==c(input)||null===input)return input;var e=input[Symbol.toPrimitive];if(void 0!==e){var n=e.call(input,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(input)}(r,"string"),"symbol"===c(o)?o:String(o)),n)}var r,o}var h=0,d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.collection=new Map}var e,n,o;return e=t,(n=[{key:"register",value:function(t,e){var n=this;!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(function(){return n.runLocalHooks("change",e)})),h+=1)}},{key:"unregister",value:function(t){var e=this.collection.get(t);Object(r.isDefined)(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),h-=1)}},{key:"unregisterAll",value:function(){var t=this;this.collection.forEach((function(e,n){return t.unregister(n)})),this.collection.clear()}},{key:"get",value:function(t){return Object(r.isUndefined)(t)?Array.from(this.collection.values()):this.collection.get(t)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(t){this.collection.forEach((function(e){e.remove(t)}))}},{key:"insertToEvery",value:function(t,e){this.collection.forEach((function(n){n.insert(t,e)}))}},{key:"initEvery",value:function(t){this.collection.forEach((function(e){e.init(t)}))}}])&&f(e.prototype,n),o&&f(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(){return h}Object(o.mixin)(d,l.a)},943:function(t,e,n){var r=n(7),o=n(944);r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},944:function(t,e,n){"use strict";var r=n(143),o=n(88),l=n(117),c=n(77),f=n(247),h=Math.min,d=[].lastIndexOf,y=!!d&&1/[1].lastIndexOf(1,-0)<0,v=f("lastIndexOf"),m=y||!v;t.exports=m?function(t){if(y)return r(d,this,arguments)||0;var e=o(this),n=c(e),f=n-1;for(arguments.length>1&&(f=h(f,l(arguments[1]))),f<0&&(f=n+f);f>=0;f--)if(f in e&&e[f]===t)return f||0;return-1}:d},945:function(t,e,n){var r=n(87),o=n(60),l=n(202),c=n(77),f=TypeError,h=function(t){return function(e,n,h,d){r(n);var y=o(e),v=l(y),m=c(y),w=t?m-1:0,i=t?-1:1;if(h<2)for(;;){if(w in v){d=v[w],w+=i;break}if(w+=i,t?w<0:m<=w)throw f("Reduce of empty array with no initial value")}for(;t?w>=0:m>w;w+=i)w in v&&(d=n(d,v[w],w,y));return d}};t.exports={left:h(!1),right:h(!0)}},946:function(t,e,n){var r=n(18)((function(i){return i[1]}));r.push([t.i,'/*!\n * Copyright (c) HANDSONCODE sp. z o. o.\n * \n * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o., a Polish corporation based in\n * Gdynia, Poland, at Aleja Zwycięstwa 96-98, registered by the District Court in Gdansk under number\n * 538651, EU tax ID number: PL5862294002, share capital: PLN 62,800.00.\n * \n * This software is protected by applicable copyright laws, including international treaties, and dual-\n * licensed – depending on whether your use for commercial purposes, meaning intended for or\n * resulting in commercial advantage or monetary compensation, or not.\n * \n * If your use is strictly personal or solely for evaluation purposes, meaning for the purposes of testing\n * the suitability, performance, and usefulness of this software outside the production environment,\n * you agree to be bound by the terms included in the "handsontable-non-commercial-license.pdf" file.\n * \n * Your use of this software for commercial purposes is subject to the terms included in an applicable\n * license agreement.\n * \n * In any case, you must not make any such use of this software as to develop software which may be\n * considered competitive with this software.\n * \n * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS"\n * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO EVENT AND UNDER NO\n * LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY DIRECT,\n * INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM\n * USE OR INABILITY TO USE THIS SOFTWARE.\n * \n * Version: 12.3.1\n * Release date: 06/02/2023 (built at 06/02/2023 12:35:03)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-md-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{height:auto;position:relative;width:0}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:0;min-height:auto}.handsontable table.htCore{border-collapse:separate;border-spacing:0;border-width:0;cursor:default;margin:0;max-height:none;max-width:none;outline-width:0;table-layout:fixed;width:0}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{background-color:#fff;border-bottom:1px solid #ccc;border-left-width:0;border-right:1px solid #ccc;border-top-width:0;empty-cells:show;height:22px;line-height:21px;outline-width:0;overflow:hidden;padding:0 4px;vertical-align:top;white-space:pre-wrap}[dir=rtl].handsontable td,[dir=rtl].handsontable th{border-left:1px solid #ccc;border-right-width:0}.handsontable th:last-child{border-bottom:1px solid #ccc;border-left:none;border-right:1px solid #ccc}[dir=rtl].handsontable th:last-child{border-left:1px solid #ccc;border-right:none}.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable td:first-of-type,[dir=rtl].handsontable th:first-child,[dir=rtl].handsontable th:nth-child(2){border-right:1px solid #ccc}.handsontable .ht_clone_top th:nth-child(2){border-left-width:0;border-right:1px solid #ccc}[dir=rtl].handsontable .ht_clone_top th:nth-child(2){border-left:1px solid #ccc;border-right-width:0}.handsontable.htRowHeaders thead tr th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable.htRowHeaders thead tr th:nth-child(2){border-right:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child{border-left:1px solid #ccc;border-right-width:0}[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child{border-left-width:0;border-right:1px solid #ccc}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;font-weight:400;text-align:center;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{font-size:0;position:absolute}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{cursor:crosshair;font-size:0}.ht_clone_master{z-index:100}.ht_clone_inline_start{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_inline_start_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_inline_start_corner{z-index:180}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_inline_start,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_inline_start thead,.handsontable .ht_master thead,.handsontable .ht_master tr th{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_inline_start .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{color:#373737;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Helvetica Neue",Arial,sans-serif;font-size:13px;font-weight:400;touch-action:manipulation}.handsontable a{color:#104acc}.handsontable.htAutoSize{left:-99000px;position:absolute;top:-99000px;visibility:hidden}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}.hot-display-license-info{color:#373737;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Helvetica Neue",Arial,sans-serif;font-size:10px;font-weight:400;padding:5px 0 3px;text-align:left}.hot-display-license-info a{color:#104acc;font-size:10px}.handsontable .manualColumnResizer{cursor:col-resize;height:25px;position:absolute;top:0;width:5px;z-index:210}.handsontable .manualRowResizer{cursor:row-resize;height:5px;left:0;position:absolute;width:50px;z-index:210}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{background-color:#34a9db;border-left:none;border-right:1px dashed #777;display:none;margin-left:5px;margin-right:0;position:absolute;right:auto;top:0;width:0}[dir=rtl].handsontable .manualColumnResizerGuide{border-left:1px dashed #777;border-right:none;left:auto;margin-left:0;margin-right:5px}.handsontable .manualRowResizerGuide{background-color:#34a9db;border-bottom:1px dashed #777;bottom:0;display:none;height:0;left:0;margin-top:5px;position:absolute}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable .columnSorting{position:relative}.handsontable .columnSorting.sortAction:hover{cursor:pointer;-webkit-text-decoration:underline;text-decoration:underline}.handsontable span.colHeader.columnSorting:before{background-position-x:right;background-repeat:no-repeat;background-size:contain;content:"";height:10px;left:auto;margin-top:-6px;padding-left:8px;padding-right:0;position:absolute;right:-9px;top:50%;width:5px}[dir=rtl].handsontable span.colHeader.columnSorting:before{background-position-x:left;left:-9px;padding-left:0;padding-right:8px;right:auto}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC")}.handsontable span.colHeader.columnSorting.descending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=")}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):after{content:"*";display:inline-block;padding-right:20px;position:relative}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{background:#005eff;bottom:0;bottom:-100%\\9;content:"";left:0;position:absolute;right:0;top:0}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{bottom:-100%}}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{background-color:#fff;border:none;border-radius:0;box-shadow:inset 0 0 0 2px #5292f7;color:#000;display:block;font-family:inherit;font-size:inherit;line-height:21px;margin:0;outline-width:0;padding:1px 5px 0;resize:none}.handsontableInput:focus{outline:none}.handsontableInputHolder{left:0;position:absolute;top:0}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{color:#777;content:"▶";font-size:9px;position:absolute;right:5px}[dir=rtl].handsontable .htSubmenu :after{content:""}[dir=rtl].handsontable .htSubmenu :before{color:#777;content:"◀";font-size:9px;left:5px;position:absolute}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{background:#fff;border:1px solid #ccc;border-collapse:separate}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent!important}.handsontable.listbox td,.handsontable.listbox th{text-overflow:ellipsis;white-space:nowrap}.handsontable.listbox td.htDimmed{color:inherit;cursor:default;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr td.current,.handsontable.listbox tr:hover td{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.handsontable .collapsibleIndicator{background:#eee;border:1px solid #a6a6a6;border-radius:10px;box-shadow:0 0 0 6px #eee;color:#222;cursor:pointer;font-size:10px;height:10px;left:auto;line-height:8px;position:absolute;right:5px;text-align:center;top:50%;transform:translateY(-50%);width:10px}[dir=rtl].handsontable .collapsibleIndicator{left:5px;right:auto}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch;-webkit-user-select:none;-moz-user-select:none;user-select:none}.handsontable.mobile .handsontableInput:focus{-webkit-appearance:none;box-shadow:inset 0 0 0 2px #5292f7}.topSelectionHandle-HitArea:not(.ht_master .topSelectionHandle-HitArea),.topSelectionHandle:not(.ht_master .topSelectionHandle){z-index:9999}.handsontable .bottomSelectionHandle,.handsontable .bottomSelectionHandle-HitArea,.handsontable .topSelectionHandle,.handsontable .topSelectionHandle-HitArea{left:-10000px;right:auto;top:-10000px}[dir=rtl].handsontable .bottomSelectionHandle,[dir=rtl].handsontable .bottomSelectionHandle-HitArea,[dir=rtl].handsontable .topSelectionHandle,[dir=rtl].handsontable .topSelectionHandle-HitArea{left:auto;right:-10000px}.handsontable.hide-tween{animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}\n/*!\n * Pikaday\n * Copyright © 2014 David Bushell | BSD & MIT license | https://dbushell.com/\n */.pika-single{background:#fff;border:1px solid;border-color:#ccc #ccc #bbb;color:#333;display:block;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;position:relative;z-index:9999}.pika-single:after,.pika-single:before{content:" ";display:table}.pika-single:after{clear:both}.pika-single.is-hidden{display:none}.pika-single.is-bound{box-shadow:0 5px 15px -5px rgba(0,0,0,.5);position:absolute}.pika-lendar{float:left;margin:8px;width:240px}.pika-title{position:relative;text-align:center}.pika-label{background-color:#fff;display:inline-block;font-size:14px;font-weight:700;line-height:20px;margin:0;overflow:hidden;padding:5px 3px;position:relative;z-index:9999}.pika-title select{cursor:pointer;left:0;margin:0;opacity:0;position:absolute;top:5px;z-index:9998}.pika-next,.pika-prev{background-color:transparent;background-position:50%;background-repeat:no-repeat;background-size:75% 75%;border:0;cursor:pointer;display:block;height:30px;opacity:.5;outline:none;overflow:hidden;padding:0;position:relative;text-indent:20px;white-space:nowrap;width:20px}.pika-next:hover,.pika-prev:hover{opacity:1}.is-rtl .pika-next,.pika-prev{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==");float:left}.is-rtl .pika-prev,.pika-next{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=");float:right}.pika-next.is-disabled,.pika-prev.is-disabled{cursor:default;opacity:.2}.pika-select{display:inline-block}.pika-table{border:0;border-collapse:collapse;border-spacing:0;width:100%}.pika-table td,.pika-table th{padding:0;width:14.2857142857%}.pika-table th{color:#999;font-size:12px;font-weight:700;line-height:25px;text-align:center}.pika-button{background:#f5f5f5;border:0;box-sizing:border-box;-moz-box-sizing:border-box;color:#666;cursor:pointer;display:block;font-size:12px;height:auto;line-height:15px;margin:0;outline:none;padding:5px;text-align:right;width:100%}.pika-week{color:#999;font-size:11px}.is-today .pika-button{color:#3af;font-weight:700}.has-event .pika-button,.is-selected .pika-button{background:#3af;border-radius:3px;box-shadow:inset 0 1px 3px #178fe5;color:#fff;font-weight:700}.has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.is-disabled .pika-button,.is-inrange .pika-button{background:#d5e9f7}.is-startrange .pika-button{background:#6cb31d;border-radius:3px;box-shadow:none;color:#fff}.is-endrange .pika-button{background:#3af;border-radius:3px;box-shadow:none;color:#fff}.is-disabled .pika-button{color:#999;cursor:default;opacity:.3;pointer-events:none}.is-outside-current-month .pika-button{color:#999;opacity:.3}.is-selection-disabled{cursor:default;pointer-events:none}.pika-button:hover,.pika-row.pick-whole-week:hover .pika-button{background:#ff8000;border-radius:3px;box-shadow:none;color:#fff}.pika-table abbr{border-bottom:none;cursor:help}.handsontable .htAutocompleteArrow{color:#eee;cursor:default;float:right;font-size:10px;text-align:center;width:16px}[dir=rtl].handsontable .htAutocompleteArrow{float:left}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{cursor:pointer;display:inline-block;font-size:inherit;vertical-align:middle}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.handsontable .htCommentCell{position:relative}.handsontable .htCommentCell:after{border-left:6px solid transparent;border-right:none;border-top:6px solid #000;content:"";left:auto;position:absolute;right:0;top:0}[dir=rtl].handsontable .htCommentCell:after{border-left:none;border-right:6px solid transparent;left:0;right:auto}.htCommentsContainer .htComments{display:none;position:absolute;z-index:1059}.htCommentsContainer .htCommentTextArea{-webkit-appearance:none;background-color:#fff;border:none;border-left:3px solid #ccc;box-shadow:0 1px 3px rgba(0,0,0,.118),0 1px 2px rgba(0,0,0,.239);box-sizing:border-box;font-size:12px;height:90px;outline:0!important;padding:5px;width:215px}[dir=rtl].htCommentsContainer .htCommentTextArea{border-left:none;border-right:3px solid #ccc}.htCommentsContainer .htCommentTextArea:focus{border-left:3px solid #5292f7;border-right:none;box-shadow:0 1px 3px rgba(0,0,0,.118),0 1px 2px rgba(0,0,0,.239),inset 0 0 0 1px #5292f7}[dir=rtl].htCommentsContainer .htCommentTextArea:focus{border-left:none;border-right:3px solid #5292f7}\n/*!\n * Handsontable ContextMenu\n */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_bottom,.htContextMenu .ht_clone_bottom_inline_start_corner,.htContextMenu .ht_clone_inline_start,.htContextMenu .ht_clone_top,.htContextMenu .ht_clone_top_inline_start_corner{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htContextMenu .ht_master table.htCore{border-left-width:2px;border-right-width:1px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htContextMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htContextMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htContextMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}.htContextMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{opacity:0;outline:0 none!important;overflow:hidden;position:fixed!important;right:100%!important;top:0!important}\n/*!\n * Handsontable DropdownMenu\n */.handsontable .changeType{background:#eee;border:1px solid #bbb;border-radius:2px;color:#bbb;float:right;font-size:9px;line-height:9px;margin:3px 1px 0 5px;padding:2px}[dir=rtl].handsontable .changeType{float:left}.handsontable .changeType:before{content:"▼ "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_bottom,.htDropdownMenu .ht_clone_bottom_inline_start_corner,.htDropdownMenu .ht_clone_inline_start,.htDropdownMenu .ht_clone_top,.htDropdownMenu .ht_clone_top_inline_start_corner{display:none}.htDropdownMenu table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htDropdownMenu table.htCore{border-left-width:2px;border-right-width:1px}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htDropdownMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htDropdownMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htDropdownMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htDropdownMenu table tbody tr td.current,.htDropdownMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}\n/*!\n * Handsontable Filters\n */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_bottom,.htFiltersConditionsMenu .ht_clone_bottom_inline_start_corner,.htFiltersConditionsMenu .ht_clone_inline_start,.htFiltersConditionsMenu .ht_clone_top,.htFiltersConditionsMenu .ht_clone_top_inline_start_corner{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htFiltersConditionsMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htFiltersConditionsMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htFiltersConditionsMenu table tbody tr td.current,.htFiltersConditionsMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{padding-bottom:3px;padding-top:10px;text-align:center}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{box-sizing:border-box;font-family:inherit;font-size:.75em;padding:4px;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{background-color:#d2e0d9;border:1px solid #509272;color:#18804e}.handsontable .htUISelectAll{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUISelectAll{margin-left:10px;margin-right:0}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{font-size:.75em}.handsontable .htUISelectionControls{text-align:right}[dir=rtl].handsontable .htUISelectionControls{text-align:left}.handsontable .htCheckboxRendererInput{height:1em;margin:0 5px 0 0;vertical-align:middle}[dir=rtl].handsontable .htCheckboxRendererInput{margin-left:5px;margin-right:0}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border:1px solid #d2d1d1;border-radius:2px}.handsontable .htUIInput input:focus{outline:0}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.75em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUIInput.htUIButtonOK{margin-left:10px;margin-right:0}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border:1px solid #d2d1d1;border-radius:2px;font-family:inherit;font-size:.75em;font-weight:700;overflow:hidden;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"▲";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"▼";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border:1px solid #d2d1d1;border-radius:2px;padding:3px}.handsontable .htUIRadio{display:inline-block;height:100%;margin-left:0;margin-right:5px}[dir=rtl].handsontable .htUIRadio{margin-left:5px;margin-right:0}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-left:0;margin-right:.5ex}[dir=rtl].handsontable .htUIRadio>input[type=radio]{margin-left:.5ex;margin-right:0}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;font-size:5pt;position:absolute;top:50%;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable th.beforeHiddenColumn:after{content:"◀";right:1px}[dir=rtl].handsontable th.beforeHiddenColumn:after{content:"▶";left:1px;right:auto}.handsontable th.afterHiddenColumn:before{content:"▶";left:1px}[dir=rtl].handsontable th.afterHiddenColumn:before{content:"◀";left:auto;right:1px}\n/*!\n * Handsontable HiddenRows\n */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;left:2px;line-height:6pt;position:absolute}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{bottom:2px;content:"▲"}.handsontable th.afterHiddenRow:after{content:"▼";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_inline_start td:first-of-type,.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_top_inline_start_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{display:none;height:100%;position:absolute}.handsontable .ht__manualColumnMove--guideline{background:#757575;margin-left:-1px;margin-right:0;top:0;width:2px;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;pointer-events:none;z-index:205}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{display:none;position:absolute;width:100%}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;pointer-events:none;z-index:205}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable span.colHeader.columnSorting:after{font-size:8px;height:8px;left:auto;line-height:1.1;margin-top:-2px;padding-left:5px;padding-right:0;position:absolute;right:-15px;-webkit-text-decoration:underline;text-decoration:underline;top:50%}[dir=rtl].handsontable span.colHeader.columnSorting:after{left:-15px;padding-left:0;padding-right:5px;right:auto}.handsontable span.colHeader.columnSorting:after{-webkit-text-decoration:none;text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{padding-left:7px;text-align:left}[dir=rtl].handsontable th.ht_nestingLevels{padding-right:7px;text-align:right}.handsontable th div.ht_nestingLevels{display:inline-block;left:11px;position:absolute;right:auto}[dir=rtl].handsontable th div.ht_nestingLevels{left:auto;right:11px}.handsontable.innerBorderInlineStart th div.ht_nestingLevels,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:auto;right:10px}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingLevels,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:10px;right:auto}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;float:left;height:1px;width:10px}[dir=rtl].handsontable th span.ht_nestingLevel_empty{float:right}.handsontable th span.ht_nestingLevel:after{bottom:3px;content:"┐";display:inline-block;font-size:9px;position:relative}.handsontable th div.ht_nestingButton{cursor:pointer;display:inline-block;left:auto;position:absolute;right:-2px}[dir=rtl].handsontable th div.ht_nestingButton{left:-2px;right:auto}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"+"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"-"}.handsontable.innerBorderInlineStart th div.ht_nestingButton,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:auto;right:0}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingButton,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:0;right:auto}',""]),r.locals={},t.exports=r},947:function(t,e,n){!function(e,r){"use strict";var o;try{o=n(246)}catch(t){}t.exports=function(t){var e="function"==typeof t,n=!!window.addEventListener,r=window.document,o=window.setTimeout,l=function(t,e,r,o){n?t.addEventListener(e,r,!!o):t.attachEvent("on"+e,r)},c=function(t,e,r,o){n?t.removeEventListener(e,r,!!o):t.detachEvent("on"+e,r)},f=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},h=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},d=function(t,e){h(t,e)||(t.className=""===t.className?e:t.className+" "+e)},y=function(t,e){t.className=f((" "+t.className+" ").replace(" "+e+" "," "))},v=function(t){return/Array/.test(Object.prototype.toString.call(t))},m=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},w=function(t){var e=t.getDay();return 0===e||6===e},O=function(t){return t%4==0&&t%100!=0||t%400==0},S=function(t,e){return[31,O(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},C=function(t){m(t)&&t.setHours(0,0,0,0)},E=function(a,b){return a.getTime()===b.getTime()},R=function(t,e,n){var r,o;for(r in e)(o=void 0!==t[r])&&"object"==typeof e[r]&&null!==e[r]&&void 0===e[r].nodeName?m(e[r])?n&&(t[r]=new Date(e[r].getTime())):v(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=R({},e[r],n):!n&&o||(t[r]=e[r]);return t},k=function(t,e,data){var n;r.createEvent?((n=r.createEvent("HTMLEvents")).initEvent(e,!0,!1),n=R(n,data),t.dispatchEvent(n)):r.createEventObject&&(n=r.createEventObject(),n=R(n,data),t.fireEvent("on"+e,n))},j=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},T={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},P=function(t,e,abbr){for(e+=t.firstDay;e>=7;)e-=7;return abbr?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},A=function(t){var e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},M=function(t,e){t.setHours(0,0,0,0);var n=t.getDate(),r=t.getDay(),o=e,l=o-1,c=7,f=function(t){return(t+c-1)%c};t.setDate(n+l-f(r));var h=new Date(t.getFullYear(),0,o),d=864e5,y=(t.getTime()-h.getTime())/d;return 1+Math.round((y-l+f(h.getDay()))/c)},_=function(n,r,o,l){var c=new Date(o,r,n);return'<td class="pika-week">'+(e?t(c).isoWeek():M(c,l))+"</td>"},x=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},I=function(t){return"<tbody>"+t.join("")+"</tbody>"},N=function(t){var i,e=[];for(t.showWeekNumber&&e.push("<th></th>"),i=0;i<7;i++)e.push('<th scope="col"><abbr title="'+P(t,i)+'">'+P(t,i,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?e.reverse():e).join("")+"</tr></thead>"},H=function(t,e,n,r,o,l){var i,c,f,h,d,y=t._o,m=n===y.minYear,w=n===y.maxYear,html='<div id="'+l+'" class="pika-title" role="heading" aria-live="assertive">',O=!0,S=!0;for(f=[],i=0;i<12;i++)f.push('<option value="'+(n===o?i-e:12+i-e)+'"'+(i===r?' selected="selected"':"")+(m&&i<y.minMonth||w&&i>y.maxMonth?' disabled="disabled"':"")+">"+y.i18n.months[i]+"</option>");for(h='<div class="pika-label">'+y.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+f.join("")+"</select></div>",v(y.yearRange)?(i=y.yearRange[0],c=y.yearRange[1]+1):(i=n-y.yearRange,c=1+n+y.yearRange),f=[];i<c&&i<=y.maxYear;i++)i>=y.minYear&&f.push('<option value="'+i+'"'+(i===n?' selected="selected"':"")+">"+i+"</option>");return d='<div class="pika-label">'+n+y.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+f.join("")+"</select></div>",y.showMonthAfterYear?html+=d+h:html+=h+d,m&&(0===r||y.minMonth>=r)&&(O=!1),w&&(11===r||y.maxMonth<=r)&&(S=!1),0===e&&(html+='<button class="pika-prev'+(O?"":" is-disabled")+'" type="button">'+y.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(html+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+y.i18n.nextMonth+"</button>"),html+"</div>"},D=function(t,data,e){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+e+'">'+N(t)+I(data)+"</table>"},L=function(c){var f=this,d=f.config(c);f._onMouseDown=function(t){if(f._v){var e=(t=t||window.event).target||t.srcElement;if(e)if(h(e,"is-disabled")||(!h(e,"pika-button")||h(e,"is-empty")||h(e.parentNode,"is-disabled")?h(e,"pika-prev")?f.prevMonth():h(e,"pika-next")&&f.nextMonth():(f.setDate(new Date(e.getAttribute("data-pika-year"),e.getAttribute("data-pika-month"),e.getAttribute("data-pika-day"))),d.bound&&o((function(){f.hide(),d.blurFieldOnSelect&&d.field&&d.field.blur()}),100))),h(e,"pika-select"))f._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}},f._onChange=function(t){var e=(t=t||window.event).target||t.srcElement;e&&(h(e,"pika-select-month")?f.gotoMonth(e.value):h(e,"pika-select-year")&&f.gotoYear(e.value))},f._onKeyChange=function(t){if(t=t||window.event,f.isVisible())switch(t.keyCode){case 13:case 27:d.field&&d.field.blur();break;case 37:f.adjustDate("subtract",1);break;case 38:f.adjustDate("subtract",7);break;case 39:f.adjustDate("add",1);break;case 40:f.adjustDate("add",7);break;case 8:case 46:f.setDate(null)}},f._parseFieldValue=function(){if(d.parse)return d.parse(d.field.value,d.format);if(e){var n=t(d.field.value,d.format,d.formatStrict);return n&&n.isValid()?n.toDate():null}return new Date(Date.parse(d.field.value))},f._onInputChange=function(t){var e;t.firedBy!==f&&(e=f._parseFieldValue(),m(e)&&f.setDate(e),f._v||f.show())},f._onInputFocus=function(){f.show()},f._onInputClick=function(){f.show()},f._onInputBlur=function(){var t=r.activeElement;do{if(h(t,"pika-single"))return}while(t=t.parentNode);f._c||(f._b=o((function(){f.hide()}),50)),f._c=!1},f._onClick=function(t){var e=(t=t||window.event).target||t.srcElement,r=e;if(e){!n&&h(e,"pika-select")&&(e.onchange||(e.setAttribute("onchange","return;"),l(e,"change",f._onChange)));do{if(h(r,"pika-single")||r===d.trigger)return}while(r=r.parentNode);f._v&&e!==d.trigger&&r!==d.trigger&&f.hide()}},f.el=r.createElement("div"),f.el.className="pika-single"+(d.isRTL?" is-rtl":"")+(d.theme?" "+d.theme:""),l(f.el,"mousedown",f._onMouseDown,!0),l(f.el,"touchend",f._onMouseDown,!0),l(f.el,"change",f._onChange),d.keyboardInput&&l(r,"keydown",f._onKeyChange),d.field&&(d.container?d.container.appendChild(f.el):d.bound?r.body.appendChild(f.el):d.field.parentNode.insertBefore(f.el,d.field.nextSibling),l(d.field,"change",f._onInputChange),d.defaultDate||(d.defaultDate=f._parseFieldValue(),d.setDefaultDate=!0));var y=d.defaultDate;m(y)?d.setDefaultDate?f.setDate(y,!0):f.gotoDate(y):f.gotoDate(new Date),d.bound?(this.hide(),f.el.className+=" is-bound",l(d.trigger,"click",f._onInputClick),l(d.trigger,"focus",f._onInputFocus),l(d.trigger,"blur",f._onInputBlur)):this.show()};return L.prototype={config:function(t){this._o||(this._o=R({},T,!0));var e=R(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;var n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,m(e.minDate)||(e.minDate=!1),m(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),v(e.yearRange)){var r=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||T.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,m(this._d)?this._o.toString?this._o.toString(this._d,n):e?t(this._d).format(n):this._d.toDateString():""},getMoment:function(){return e?t(this._d):null},setMoment:function(n,r){e&&t.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return m(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",k(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),m(t)){var n=this._o.minDate,r=this._o.maxDate;m(n)&&t<n?t=n:m(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),C(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),k(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(t){var e=!0;if(m(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=o<n.getTime()||r.getTime()<o}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){var n,r=this.getDate()||new Date,o=24*parseInt(e)*60*60*1e3;"add"===t?n=new Date(r.valueOf()+o):"subtract"===t&&(n=new Date(r.valueOf()-o)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=j(this.calendars[0]);for(var t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=j({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(C(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=T.minDate,this._o.minYear=T.minYear,this._o.minMonth=T.minMonth,this._o.startRange=T.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(C(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=T.maxDate,this._o.maxYear=T.maxYear,this._o.maxMonth=T.maxMonth,this._o.endRange=T.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(this._v||t){var e,n=this._o,r=n.minYear,l=n.maxYear,c=n.minMonth,f=n.maxMonth,html="";this._y<=r&&(this._y=r,!isNaN(c)&&this._m<c&&(this._m=c)),this._y>=l&&(this._y=l,!isNaN(f)&&this._m>f&&(this._m=f));for(var h=0;h<n.numberOfMonths;h++)e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),html+='<div class="pika-lendar">'+H(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,e)+this.render(this.calendars[h].year,this.calendars[h].month,e)+"</div>";this.el.innerHTML=html,n.bound&&"hidden"!==n.field.type&&o((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var t,e,n,o,l,c,f,h,v,m,w,O;if(!this._o.container){if(this.el.style.position="absolute",e=t=this._o.trigger,n=this.el.offsetWidth,o=this.el.offsetHeight,l=window.innerWidth||r.documentElement.clientWidth,c=window.innerHeight||r.documentElement.clientHeight,f=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,w=!0,O=!0,"function"==typeof t.getBoundingClientRect)h=(m=t.getBoundingClientRect()).left+window.pageXOffset,v=m.bottom+window.pageYOffset;else for(h=e.offsetLeft,v=e.offsetTop+e.offsetHeight;e=e.offsetParent;)h+=e.offsetLeft,v+=e.offsetTop;(this._o.reposition&&h+n>l||this._o.position.indexOf("right")>-1&&h-n+t.offsetWidth>0)&&(h=h-n+t.offsetWidth,w=!1),(this._o.reposition&&v+o>c+f||this._o.position.indexOf("top")>-1&&v-o-t.offsetHeight>0)&&(v=v-o-t.offsetHeight,O=!1),this.el.style.left=h+"px",this.el.style.top=v+"px",d(this.el,w?"left-aligned":"right-aligned"),d(this.el,O?"bottom-aligned":"top-aligned"),y(this.el,w?"right-aligned":"left-aligned"),y(this.el,O?"top-aligned":"bottom-aligned")}},render:function(t,e,n){var r=this._o,o=new Date,l=S(t,e),c=new Date(t,e,1).getDay(),data=[],f=[];C(o),r.firstDay>0&&(c-=r.firstDay)<0&&(c+=7);for(var h=0===e?11:e-1,d=11===e?0:e+1,y=0===e?t-1:t,v=11===e?t+1:t,O=S(y,h),R=l+c,k=R;k>7;)k-=7;R+=7-k;for(var j=!1,i=0,T=0;i<R;i++){var P=new Date(t,e,i-c+1),M=!!m(this._d)&&E(P,this._d),I=E(P,o),N=-1!==r.events.indexOf(P.toDateString()),H=i<c||i>=l+c,L=i-c+1,B=e,F=t,V=r.startRange&&E(r.startRange,P),W=r.endRange&&E(r.endRange,P),U=r.startRange&&r.endRange&&r.startRange<P&&P<r.endRange;H&&(i<c?(L=O+L,B=h,F=y):(L-=l,B=d,F=v));var z={day:L,month:B,year:F,hasEvent:N,isSelected:M,isToday:I,isDisabled:r.minDate&&P<r.minDate||r.maxDate&&P>r.maxDate||r.disableWeekends&&w(P)||r.disableDayFn&&r.disableDayFn(P),isEmpty:H,isStartRange:V,isEndRange:W,isInRange:U,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&M&&(j=!0),f.push(A(z)),7==++T&&(r.showWeekNumber&&f.unshift(_(i-c,e,t,r.firstWeekOfYearMinDays)),data.push(x(f,r.isRTL,r.pickWholeWeek,j)),f=[],T=0,j=!1)}return D(r,data,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),y(this.el,"is-hidden"),this._o.bound&&(l(r,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var t=this._v;!1!==t&&(this._o.bound&&c(r,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var t=this._o;this.hide(),c(this.el,"mousedown",this._onMouseDown,!0),c(this.el,"touchend",this._onMouseDown,!0),c(this.el,"change",this._onChange),t.keyboardInput&&c(r,"keydown",this._onKeyChange),t.field&&(c(t.field,"change",this._onInputChange),t.bound&&(c(t.trigger,"click",this._onInputClick),c(t.trigger,"focus",this._onInputFocus),c(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},L}(o)}()},948:function(t,e,n){var r;t.exports=function a(t,u,e){function s(o,l){if(!u[o]){if(!t[o]){if(!l&&"function"==typeof r&&r)return r(o,!0);if(n)return n(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var i=u[o]={exports:{}};t[o][0].call(i.exports,(function(e){return s(t[o][1][e]||e)}),i,i.exports,a,t,u,e)}return u[o].exports}for(var n="function"==typeof r&&r,o=0;o<e.length;o++)s(e[o]);return s}({1:[function(t,e,n){!function(t){"use strict";var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,l=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,y=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,w=1e9;function O(t){var e=0|t;return 0<t||t===e?e:e-1}function S(t){for(var e,n,r=1,i=t.length,a=t[0]+"";r<i;){for(e=t[r++]+"",n=d-e.length;n--;e="0"+e);a+=e}for(i=a.length;48===a.charCodeAt(--i););return a.slice(0,i+1||1)}function q(t,e){var n,r,i=t.c,a=e.c,o=t.s,u=e.s,l=t.e,s=e.e;if(!o||!u)return null;if(n=i&&!i[0],r=a&&!a[0],n||r)return n?r?0:-u:o;if(o!=u)return o;if(n=o<0,r=l==s,!i||!a)return r?0:!i^n?1:-1;if(!r)return s<l^n?1:-1;for(u=(l=i.length)<(s=a.length)?l:s,o=0;o<u;o++)if(i[o]!=a[o])return i[o]>a[o]^n?1:-1;return l==s?0:s<l^n?1:-1}function C(t,e,n,r){if(t<e||n<t||t!==(t<0?o(t):l(t)))throw Error(c+(r||"Argument")+("number"==typeof t?t<e||n<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function E(t){var e=t.c.length-1;return O(t.e/d)==e&&t.c[e]%2!=0}function R(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function k(t,e,n){var r,i;if(e<0){for(i=n+".";++e;i+=n);t=i+t}else if(++e>(r=t.length)){for(i=n,e-=r;--e;i+=n);t+=i}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}(n=function t(e){var n,j,p,T,s,P,u,A,M,g,_=U.prototype={constructor:U,toString:null,valueOf:null},x=new U(1),b=20,I=4,N=-7,H=21,D=-1e7,L=1e7,B=!1,a=1,F=0,V={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz";function U(t,e){var n,o,i,a,c,u,h,s,v=this;if(!(v instanceof U))return new U(t,e);if(null==e){if(t instanceof U)return v.s=t.s,v.e=t.e,void(v.c=(t=t.c)?t.slice():t);if((u="number"==typeof t)&&0*t==0){if(v.s=1/t<0?(t=-t,-1):1,t===~~t){for(a=0,c=t;10<=c;c/=10,a++);return v.e=a,void(v.c=[t])}s=String(t)}else{if(s=String(t),!r.test(s))return p(v,s,u);v.s=45==s.charCodeAt(0)?(s=s.slice(1),-1):1}-1<(a=s.indexOf("."))&&(s=s.replace(".","")),0<(c=s.search(/e/i))?(a<0&&(a=c),a+=+s.slice(c+1),s=s.substring(0,c)):a<0&&(a=s.length)}else{if(C(e,2,W.length,"Base"),s=String(t),10==e)return Y(v=new U(t instanceof U?t:s),b+v.e+1,I);if(u="number"==typeof t){if(0*t!=0)return p(v,s,u,e);if(v.s=1/t<0?(s=s.slice(1),-1):1,U.DEBUG&&15<s.replace(/^0\.0*|\./,"").length)throw Error(f+t);u=!1}else v.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1;for(n=W.slice(0,e),a=c=0,h=s.length;c<h;c++)if(n.indexOf(o=s.charAt(c))<0){if("."==o){if(a<c){a=h;continue}}else if(!i&&(s==s.toUpperCase()&&(s=s.toLowerCase())||s==s.toLowerCase()&&(s=s.toUpperCase()))){i=!0,c=-1,a=0;continue}return p(v,String(t),u,e)}-1<(a=(s=j(s,e,10,v.s)).indexOf("."))?s=s.replace(".",""):a=s.length}for(c=0;48===s.charCodeAt(c);c++);for(h=s.length;48===s.charCodeAt(--h););if(s=s.slice(c,++h)){if(h-=c,u&&U.DEBUG&&15<h&&(y<t||t!==l(t)))throw Error(f+v.s*t);if(L<(a=a-c-1))v.c=v.e=null;else if(a<D)v.c=[v.e=0];else{if(v.e=a,v.c=[],c=(a+1)%d,a<0&&(c+=d),c<h){for(c&&v.c.push(+s.slice(0,c)),h-=d;c<h;)v.c.push(+s.slice(c,c+=d));s=s.slice(c),c=d-s.length}else c-=h;for(;c--;s+="0");v.c.push(+s)}}else v.c=[v.e=0]}function i(t,e,n,r){var i,a,o,u,l;if(null==n?n=I:C(n,0,8),!t.c)return t.toString();if(i=t.c[0],o=t.e,null==e)l=S(t.c),l=1==r||2==r&&(o<=N||H<=o)?R(l,o):k(l,o,"0");else if(a=(t=Y(new U(t),e,n)).e,u=(l=S(t.c)).length,1==r||2==r&&(e<=a||a<=N)){for(;u<e;l+="0",u++);l=R(l,a)}else if(e-=o,l=k(l,a,"0"),u<a+1){if(0<--e)for(l+=".";e--;l+="0");}else if(0<(e+=a-u))for(a+1==u&&(l+=".");e--;l+="0");return t.s<0&&i?"-"+l:l}function z(t,e){for(var n,r=1,i=new U(t[0]);r<t.length;r++){if(!(n=new U(t[r])).s){i=n;break}e.call(i,n)&&(i=n)}return i}function G(t,e,n){for(var r=1,i=e.length;!e[--i];e.pop());for(i=e[0];10<=i;i/=10,r++);return(n=r+n*d-1)>L?t.c=t.e=null:t.c=n<D?[t.e=0]:(t.e=n,e),t}function Y(t,e,n,r){var i,a,c,u,f,s,y,m=t.c,p=v;if(m){t:{for(i=1,u=m[0];10<=u;u/=10,i++);if((a=e-i)<0)a+=d,c=e,y=(f=m[s=0])/p[i-c-1]%10|0;else if((s=o((a+1)/d))>=m.length){if(!r)break t;for(;m.length<=s;m.push(0));f=y=0,c=(a%=d)-d+(i=1)}else{for(f=u=m[s],i=1;10<=u;u/=10,i++);y=(c=(a%=d)-d+i)<0?0:f/p[i-c-1]%10|0}if(r=r||e<0||null!=m[s+1]||(c<0?f:f%p[i-c-1]),r=n<4?(y||r)&&(0==n||n==(t.s<0?3:2)):5<y||5==y&&(4==n||r||6==n&&(0<a?0<c?f/p[i-c]:0:m[s-1])%10&1||n==(t.s<0?8:7)),e<1||!m[0])return m.length=0,r?(e-=t.e+1,m[0]=p[(d-e%d)%d],t.e=-e||0):m[0]=t.e=0,t;if(0==a?(m.length=s,u=1,s--):(m.length=s+1,u=p[d-a],m[s]=0<c?l(f/p[i-c]%p[c])*u:0),r)for(;;){if(0==s){for(a=1,c=m[0];10<=c;c/=10,a++);for(c=m[0]+=u,u=1;10<=c;c/=10,u++);a!=u&&(t.e++,m[0]==h&&(m[0]=1));break}if(m[s]+=u,m[s]!=h)break;m[s--]=0,u=1}for(a=m.length;0===m[--a];m.pop());}t.e>L?t.c=t.e=null:t.e<D&&(t.c=[t.e=0])}return t}function X(t){var e,n=t.e;return null===n?t.toString():(e=S(t.c),e=n<=N||H<=n?R(e,n):k(e,n,"0"),t.s<0?"-"+e:e)}return U.clone=t,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(c+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(C(n=t[e],0,w,e),b=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(C(n=t[e],0,8,e),I=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((n=t[e])&&n.pop?(C(n[0],-w,0,e),C(n[1],0,w,e),N=n[0],H=n[1]):(C(n,-w,w,e),N=-(H=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if((n=t[e])&&n.pop)C(n[0],-w,-1,e),C(n[1],1,w,e),D=n[0],L=n[1];else{if(C(n,-w,w,e),!n)throw Error(c+e+" cannot be zero: "+n);D=-(L=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(c+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw B=!n,Error(c+"crypto unavailable");B=n}else B=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(C(n=t[e],0,9,e),a=n),t.hasOwnProperty(e="POW_PRECISION")&&(C(n=t[e],0,w,e),F=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(c+e+" not an object: "+n);V=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(c+e+" invalid: "+n);W=n}}return{DECIMAL_PLACES:b,ROUNDING_MODE:I,EXPONENTIAL_AT:[N,H],RANGE:[D,L],CRYPTO:B,MODULO_MODE:a,POW_PRECISION:F,FORMAT:V,ALPHABET:W}},U.isBigNumber=function(t){return t instanceof U||t&&!0===t._isBigNumber||!1},U.maximum=U.max=function(){return z(arguments,_.lt)},U.minimum=U.min=function(){return z(arguments,_.gt)},U.random=(T=9007199254740992,s=Math.random()*T&2097151?function(){return l(Math.random()*T)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,n,r,i,a,f=0,u=[],h=new U(x);if(null==t?t=b:C(t,0,w),i=o(t/d),B)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(i*=2));f<i;)9e15<=(a=131072*e[f]+(e[f+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),e[f]=n[0],e[f+1]=n[1]):(u.push(a%1e14),f+=2);f=i/2}else{if(!crypto.randomBytes)throw B=!1,Error(c+"crypto unavailable");for(e=crypto.randomBytes(i*=7);f<i;)9e15<=(a=281474976710656*(31&e[f])+1099511627776*e[f+1]+4294967296*e[f+2]+16777216*e[f+3]+(e[f+4]<<16)+(e[f+5]<<8)+e[f+6])?crypto.randomBytes(7).copy(e,f):(u.push(a%1e14),f+=7);f=i/7}if(!B)for(;f<i;)(a=s())<9e15&&(u[f++]=a%1e14);for(i=u[--f],t%=d,i&&t&&(a=v[d-t],u[f]=l(i/a)*a);0===u[f];u.pop(),f--);if(f<0)u=[r=0];else{for(r=-1;0===u[0];u.splice(0,1),r-=d);for(f=1,a=u[0];10<=a;a/=10,f++);f<d&&(r-=d-f)}return h.e=r,h.c=u,h}),U.sum=function(){for(var t=1,e=arguments,n=new U(e[0]);t<e.length;)n=n.plus(e[t++]);return n},j=function(){var t="0123456789";function e(t,e,n,r){for(var i,a,o=[0],u=0,l=t.length;u<l;){for(a=o.length;a--;o[a]*=e);for(o[0]+=r.indexOf(t.charAt(u++)),i=0;i<o.length;i++)o[i]>n-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/n|0,o[i]%=n)}return o.reverse()}return function(r,o,l,c,i){var a,f,u,h,s,d,y,p,g=r.indexOf("."),v=b,m=I;for(0<=g&&(h=F,F=0,r=r.replace(".",""),d=(p=new U(o)).pow(r.length-g),F=h,p.c=e(k(S(d.c),d.e,"0"),10,l,t),p.e=p.c.length),u=h=(y=e(r,o,l,i?(a=W,t):(a=t,W))).length;0==y[--h];y.pop());if(!y[0])return a.charAt(0);if(g<0?--u:(d.c=y,d.e=u,d.s=c,y=(d=n(d,p,v,m,l)).c,s=d.r,u=d.e),g=y[f=u+v+1],h=l/2,s=s||f<0||null!=y[f+1],s=m<4?(null!=g||s)&&(0==m||m==(d.s<0?3:2)):h<g||g==h&&(4==m||s||6==m&&1&y[f-1]||m==(d.s<0?8:7)),f<1||!y[0])r=s?k(a.charAt(1),-v,a.charAt(0)):a.charAt(0);else{if(y.length=f,s)for(--l;++y[--f]>l;)y[f]=0,f||(++u,y=[1].concat(y));for(h=y.length;!y[--h];);for(g=0,r="";g<=h;r+=a.charAt(y[g++]));r=k(r,u,a.charAt(0))}return r}}(),n=function(){function t(t,e,n){var r,i,a,o,u=0,l=t.length,s=e%m,c=e/m|0;for(t=t.slice();l--;)u=((i=s*(a=t[l]%m)+(r=c*a+(o=t[l]/m|0)*s)%m*m+u)/n|0)+(r/m|0)+c*o,t[l]=i%n;return u&&(t=[u].concat(t)),t}function e(t,e,n,r){var i,a;if(n!=r)a=r<n?1:-1;else for(i=a=0;i<n;i++)if(t[i]!=e[i]){a=t[i]>e[i]?1:-1;break}return a}function n(t,e,n,r){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*r+t[n]-e[n];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(r,o,c,f,i){var a,y,u,v,s,m,w,p,g,S,C,E,R,k,b,j,T,P=r.s==o.s?1:-1,A=r.c,M=o.c;if(!(A&&A[0]&&M&&M[0]))return new U(r.s&&o.s&&(A?!M||A[0]!=M[0]:M)?A&&0==A[0]||!M?0*P:P/0:NaN);for(g=(p=new U(P)).c=[],P=c+(y=r.e-o.e)+1,i||(i=h,y=O(r.e/d)-O(o.e/d),P=P/d|0),u=0;M[u]==(A[u]||0);u++);if(M[u]>(A[u]||0)&&y--,P<0)g.push(1),v=!0;else{for(k=A.length,j=M.length,P+=2,1<(s=l(i/(M[u=0]+1)))&&(M=t(M,s,i),A=t(A,s,i),j=M.length,k=A.length),R=j,C=(S=A.slice(0,j)).length;C<j;S[C++]=0);T=M.slice(),T=[0].concat(T),b=M[0],M[1]>=i/2&&b++;do{if(s=0,(a=e(M,S,j,C))<0){if(E=S[0],j!=C&&(E=E*i+(S[1]||0)),1<(s=l(E/b)))for(i<=s&&(s=i-1),w=(m=t(M,s,i)).length,C=S.length;1==e(m,S,w,C);)s--,n(m,j<w?T:M,w,i),w=m.length,a=1;else 0==s&&(a=s=1),w=(m=M.slice()).length;if(w<C&&(m=[0].concat(m)),n(S,m,C,i),C=S.length,-1==a)for(;e(M,S,j,C)<1;)s++,n(S,j<C?T:M,C,i),C=S.length}else 0===a&&(s++,S=[0]);g[u++]=s,S[0]?S[C++]=A[R]||0:(S=[A[R]],C=1)}while((R++<k||null!=S[0])&&P--);v=null!=S[0],g[0]||g.splice(0,1)}if(i==h){for(u=1,P=g[0];10<=P;P/=10,u++);Y(p,c+(p.e=u+y*d-1)+1,f,v)}else p.e=y,p.r=+v;return p}}(),P=/^(-?)0([xbo])(?=\w[\w.]*$)/i,u=/^([^.]+)\.$/,A=/^\.([^.]+)$/,M=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,p=function(t,e,n,r){var i,a=n?e:e.replace(g,"");if(M.test(a))t.s=isNaN(a)?null:a<0?-1:1,t.c=t.e=null;else{if(!n&&(a=a.replace(P,(function(t,e,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?t:e})),r&&(i=r,a=a.replace(u,"$1").replace(A,"0.$1")),e!=a))return new U(a,i);if(U.DEBUG)throw Error(c+"Not a"+(r?" base "+r:"")+" number: "+e);t.c=t.e=t.s=null}},_.absoluteValue=_.abs=function(){var t=new U(this);return t.s<0&&(t.s=1),t},_.comparedTo=function(t,e){return q(this,new U(t,e))},_.decimalPlaces=_.dp=function(t,e){var n,r,i;if(null!=t)return C(t,0,w),null==e?e=I:C(e,0,8),Y(new U(this),t+this.e+1,e);if(!(n=this.c))return null;if(r=((i=n.length-1)-O(this.e/d))*d,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},_.dividedBy=_.div=function(t,e){return n(this,new U(t,e),b,I)},_.dividedToIntegerBy=_.idiv=function(t,e){return n(this,new U(t,e),0,1)},_.exponentiatedBy=_.pow=function(t,e){var n,r,i,a,f,u,h,s,y=this;if((t=new U(t)).c&&!t.isInteger())throw Error(c+"Exponent not an integer: "+X(t));if(null!=e&&(e=new U(e)),f=14<t.e,!y.c||!y.c[0]||1==y.c[0]&&!y.e&&1==y.c.length||!t.c||!t.c[0])return s=new U(Math.pow(+X(y),f?2-E(t):+X(t))),e?s.mod(e):s;if(u=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new U(NaN);(r=!u&&y.isInteger()&&e.isInteger())&&(y=y.mod(e))}else{if(9<t.e&&(0<y.e||y.e<-1||(0==y.e?1<y.c[0]||f&&24e7<=y.c[1]:y.c[0]<8e13||f&&y.c[0]<=9999975e7)))return a=y.s<0&&E(t)?-0:0,-1<y.e&&(a=1/a),new U(u?1/a:a);F&&(a=o(F/d+2))}for(h=f?(n=new U(.5),u&&(t.s=1),E(t)):(i=Math.abs(+X(t)))%2,s=new U(x);;){if(h){if(!(s=s.times(y)).c)break;a?s.c.length>a&&(s.c.length=a):r&&(s=s.mod(e))}if(i){if(0===(i=l(i/2)))break;h=i%2}else if(Y(t=t.times(n),t.e+1,1),14<t.e)h=E(t);else{if(0==(i=+X(t)))break;h=i%2}y=y.times(y),a?y.c&&y.c.length>a&&(y.c.length=a):r&&(y=y.mod(e))}return r?s:(u&&(s=x.div(s)),e?s.mod(e):a?Y(s,F,I,void 0):s)},_.integerValue=function(t){var e=new U(this);return null==t?t=I:C(t,0,8),Y(e,e.e+1,t)},_.isEqualTo=_.eq=function(t,e){return 0===q(this,new U(t,e))},_.isFinite=function(){return!!this.c},_.isGreaterThan=_.gt=function(t,e){return 0<q(this,new U(t,e))},_.isGreaterThanOrEqualTo=_.gte=function(t,e){return 1===(e=q(this,new U(t,e)))||0===e},_.isInteger=function(){return!!this.c&&O(this.e/d)>this.c.length-2},_.isLessThan=_.lt=function(t,e){return q(this,new U(t,e))<0},_.isLessThanOrEqualTo=_.lte=function(t,e){return-1===(e=q(this,new U(t,e)))||0===e},_.isNaN=function(){return!this.s},_.isNegative=function(){return this.s<0},_.isPositive=function(){return 0<this.s},_.isZero=function(){return!!this.c&&0==this.c[0]},_.minus=function(t,e){var n,r,i,a,o=this,u=o.s;if(e=(t=new U(t,e)).s,!u||!e)return new U(NaN);if(u!=e)return t.s=-e,o.plus(t);var l=o.e/d,s=t.e/d,c=o.c,f=t.c;if(!l||!s){if(!c||!f)return c?(t.s=-e,t):new U(f?o:NaN);if(!c[0]||!f[0])return f[0]?(t.s=-e,t):new U(c[0]?o:3==I?-0:0)}if(l=O(l),s=O(s),c=c.slice(),u=l-s){for((i=(a=u<0)?(u=-u,c):(s=l,f)).reverse(),e=u;e--;i.push(0));i.reverse()}else for(r=(a=(u=c.length)<(e=f.length))?u:e,u=e=0;e<r;e++)if(c[e]!=f[e]){a=c[e]<f[e];break}if(a&&(i=c,c=f,f=i,t.s=-t.s),0<(e=(r=f.length)-(n=c.length)))for(;e--;c[n++]=0);for(e=h-1;u<r;){if(c[--r]<f[r]){for(n=r;n&&!c[--n];c[n]=e);--c[n],c[r]+=h}c[r]-=f[r]}for(;0==c[0];c.splice(0,1),--s);return c[0]?G(t,c,s):(t.s=3==I?-1:1,t.c=[t.e=0],t)},_.modulo=_.mod=function(t,e){var r,o,i=this;return t=new U(t,e),!i.c||!t.s||t.c&&!t.c[0]?new U(NaN):!t.c||i.c&&!i.c[0]?new U(i):(9==a?(o=t.s,t.s=1,r=n(i,t,0,3),t.s=o,r.s*=o):r=n(i,t,0,a),(t=i.minus(r.times(t))).c[0]||1!=a||(t.s=i.s),t)},_.multipliedBy=_.times=function(t,e){var n,r,i,a,o,u,l,s,c,f,p,g,y,v,w,S=this,C=S.c,b=(t=new U(t,e)).c;if(!(C&&b&&C[0]&&b[0]))return!S.s||!t.s||C&&!C[0]&&!b||b&&!b[0]&&!C?t.c=t.e=t.s=null:(t.s*=S.s,C&&b?(t.c=[0],t.e=0):t.c=t.e=null),t;for(r=O(S.e/d)+O(t.e/d),t.s*=S.s,(l=C.length)<(f=b.length)&&(y=C,C=b,b=y,i=l,l=f,f=i),i=l+f,y=[];i--;y.push(0));for(v=h,w=m,i=f;0<=--i;){for(n=0,p=b[i]%w,g=b[i]/w|0,a=i+(o=l);i<a;)n=((s=p*(s=C[--o]%w)+(u=g*s+(c=C[o]/w|0)*p)%w*w+y[a]+n)/v|0)+(u/w|0)+g*c,y[a--]=s%v;y[a]=n}return n?++r:y.splice(0,1),G(t,y,r)},_.negated=function(){var t=new U(this);return t.s=-t.s||null,t},_.plus=function(t,e){var n,r=this,i=r.s;if(e=(t=new U(t,e)).s,!i||!e)return new U(NaN);if(i!=e)return t.s=-e,r.minus(t);var a=r.e/d,o=t.e/d,u=r.c,l=t.c;if(!a||!o){if(!u||!l)return new U(i/0);if(!u[0]||!l[0])return l[0]?t:new U(u[0]?r:0*i)}if(a=O(a),o=O(o),u=u.slice(),i=a-o){for((n=0<i?(o=a,l):(i=-i,u)).reverse();i--;n.push(0));n.reverse()}for((i=u.length)-(e=l.length)<0&&(n=l,l=u,u=n,e=i),i=0;e;)i=(u[--e]=u[e]+l[e]+i)/h|0,u[e]=h===u[e]?0:u[e]%h;return i&&(u=[i].concat(u),++o),G(t,u,o)},_.precision=_.sd=function(t,e){var n,r,i;if(null!=t&&t!==!!t)return C(t,1,w),null==e?e=I:C(e,0,8),Y(new U(this),t,e);if(!(n=this.c))return null;if(r=(i=n.length-1)*d+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];10<=i;i/=10,r++);}return t&&this.e+1>r&&(r=this.e+1),r},_.shiftedBy=function(t){return C(t,-y,y),this.times("1e"+t)},_.squareRoot=_.sqrt=function(){var t,e,r,o,i,a=this,l=a.c,u=a.s,c=a.e,s=b+4,f=new U("0.5");if(1!==u||!l||!l[0])return new U(!u||u<0&&(!l||l[0])?NaN:l?a:1/0);if((r=0==(u=Math.sqrt(+X(a)))||u==1/0?(((e=S(l)).length+c)%2==0&&(e+="0"),u=Math.sqrt(+e),c=O((c+1)/2)-(c<0||c%2),new U(e=u==1/0?"1e"+c:(e=u.toExponential()).slice(0,e.indexOf("e")+1)+c)):new U(u+"")).c[0])for((u=(c=r.e)+s)<3&&(u=0);;)if(i=r,r=f.times(i.plus(n(a,i,s,1))),S(i.c).slice(0,u)===(e=S(r.c)).slice(0,u)){if(r.e<c&&--u,"9999"!=(e=e.slice(u-3,u+1))&&(o||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(Y(r,r.e+b+2,1),t=!r.times(r).eq(a));break}if(!o&&(Y(i,i.e+b+2,0),i.times(i).eq(a))){r=i;break}s+=4,u+=4,o=1}return Y(r,r.e+b+1,I,t)},_.toExponential=function(t,e){return null!=t&&(C(t,0,w),t++),i(this,t,e,1)},_.toFixed=function(t,e){return null!=t&&(C(t,0,w),t=t+this.e+1),i(this,t,e)},_.toFormat=function(t,e,n){var r;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=V;else if("object"!=typeof n)throw Error(c+"Argument not an object: "+n);if(r=this.toFixed(t,e),this.c){var i,a=r.split("."),o=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",s=a[0],f=a[1],h=this.s<0,p=h?s.slice(1):s,g=p.length;if(u&&(i=o,o=u,g-=u=i),0<o&&0<g){for(i=g%o||o,s=p.substr(0,i);i<g;i+=o)s+=l+p.substr(i,o);0<u&&(s+=l+p.slice(i)),h&&(s="-"+s)}r=f?s+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?f.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):f):s}return(n.prefix||"")+r+(n.suffix||"")},_.toFraction=function(t){var e,r,o,i,a,l,u,f,s,h,y,p,g=this,m=g.c;if(null!=t&&(!(u=new U(t)).isInteger()&&(u.c||1!==u.s)||u.lt(x)))throw Error(c+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+X(u));if(!m)return new U(g);for(e=new U(x),s=r=new U(x),o=f=new U(x),p=S(m),a=e.e=p.length-g.e-1,e.c[0]=v[(l=a%d)<0?d+l:l],t=!t||0<u.comparedTo(e)?0<a?e:s:u,l=L,L=1/0,u=new U(p),f.c[0]=0;h=n(u,e,0,1),1!=(i=r.plus(h.times(o))).comparedTo(t);)r=o,o=i,s=f.plus(h.times(i=s)),f=i,e=u.minus(h.times(i=e)),u=i;return i=n(t.minus(r),o,0,1),f=f.plus(i.times(s)),r=r.plus(i.times(o)),f.s=s.s=g.s,y=n(s,o,a*=2,I).minus(g).abs().comparedTo(n(f,r,a,I).minus(g).abs())<1?[s,o]:[f,r],L=l,y},_.toNumber=function(){return+X(this)},_.toPrecision=function(t,e){return null!=t&&C(t,1,w),i(this,t,e,2)},_.toString=function(t){var e,n=this,r=n.s,i=n.e;return null===i?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(e=null==t?i<=N||H<=i?R(S(n.c),i):k(S(n.c),i,"0"):10===t?k(S((n=Y(new U(n),b+i+1,I)).c),n.e,"0"):(C(t,2,W.length,"Base"),j(k(S(n.c),i,"0"),10,t,r,!0)),r<0&&n.c[0]&&(e="-"+e)),e},_.valueOf=_.toJSON=function(){return X(this)},_._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(_[Symbol.toStringTag]="BigNumber",_[Symbol.for("nodejs.util.inspect.custom")]=_.valueOf),null!=e&&U.set(e),U}()).default=n.BigNumber=n,void 0!==e&&e.exports?e.exports=n:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=n)}(this)},{}],2:[function(t,e,n){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=t("./globalState"),l=t("./validating"),u=t("./parsing"),c=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:c,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:c,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function i(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=u.parseFormat(e)),!l.validateFormat(e))return"ERROR: invalid format";var r=e.prefix||"",i=e.postfix||"",a=function(t,e,n){switch(e.output){case"currency":return function(t,e,n){var r=n.currentCurrency(),i=Object.assign({},h,e),a=void 0,o="",u=!!i.totalLength||!!i.forceAverage||i.average,l=e.currencyPosition||r.position,s=e.currencySymbol||r.symbol;i.spaceSeparated&&(o=" "),"infix"===l&&(a=o+s+o);var c=v({instance:t,providedFormat:e,state:n,decimalSeparator:a});return"prefix"===l&&(c=t._value<0&&"sign"===i.negative?"-".concat(o).concat(s).concat(c.slice(1)):s+o+c),l&&"postfix"!==l||(c=c+(o=u?"":o)+s),c}(t,e=m(e,o.currentCurrencyDefaultFormat()),o);case"percent":return function(t,e,n,r){var i=e.prefixSymbol,a=v({instance:r(100*t._value),providedFormat:e,state:n}),o=Object.assign({},h,e);return i?"%".concat(o.spaceSeparated?" ":"").concat(a):"".concat(a).concat(o.spaceSeparated?" ":"","%")}(t,e=m(e,o.currentPercentageDefaultFormat()),o,n);case"byte":return e=m(e,o.currentByteDefaultFormat()),O=t,C=o,E=n,R=(S=e).base||"binary",b=f[R],j=(k=d(O._value,b.suffixes,b.scale)).value,T=k.suffix,P=v({instance:E(j),providedFormat:S,state:C,defaults:C.currentByteDefaultFormat()}),A=C.currentAbbreviations(),"".concat(P).concat(A.spaced?" ":"").concat(T);case"time":return e=m(e,o.currentTimeDefaultFormat()),y=t,w=Math.floor(y._value/60/60),p=Math.floor((y._value-60*w*60)/60),g=Math.round(y._value-60*w*60-60*p),"".concat(w,":").concat(p<10?"0":"").concat(p,":").concat(g<10?"0":"").concat(g);case"ordinal":return r=t,i=e=m(e,o.currentOrdinalDefaultFormat()),l=(a=o).currentOrdinal(),u=Object.assign({},h,i),c=v({instance:r,providedFormat:i,state:a}),s=l(r._value),"".concat(c).concat(u.spaceSeparated?" ":"").concat(s);default:return v({instance:t,providedFormat:e,numbro:n})}var r,i,a,l,u,c,s,y,w,p,g,O,S,C,E,R,b,k,j,T,P,A}(t,e,n);return(a=r+a)+i}function d(t,e,n){var r=e[0],i=Math.abs(t);if(n<=i){for(var a=1;a<e.length;++a){var o=Math.pow(n,a),u=Math.pow(n,a+1);if(o<=i&&i<u){r=e[a],t/=o;break}}r===e[0]&&(t/=Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function p(t){for(var e="",n=0;n<t;n++)e+="0";return e}function y(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var n=t.toString(),o=r(n.split("e"),2),i=o[0],a=o[1],l=r(i.split("."),2),u=l[0],c=l[1],s=void 0===c?"":c;if(0<+a)n=u+s+p(a-s.length);else{var f=".";f=+u<0?"-0".concat(f):"0".concat(f);var h=(p(-a-1)+Math.abs(u)+s).substr(0,e);h.length<e&&(h+=p(e-h.length)),n=f+h}return 0<+a&&0<e&&(n+=".".concat(p(e))),n}(t,e):(Math.round(+"".concat(t,"e+").concat(e))/Math.pow(10,e)).toFixed(e)}function v(t){var e=t.instance,n=t.providedFormat,l=t.state,i=void 0===l?o:l,a=t.decimalSeparator,c=t.defaults,u=void 0===c?i.currentDefaults():c,f=e._value;if(0===f&&i.hasZeroFormat())return i.getZeroFormat();if(!isFinite(f))return f.toString();var s,d,v,p,g,m,w,O,S=Object.assign({},h,u,n),C=S.totalLength,b=C?0:S.characteristic,E=S.optionalCharacteristic,R=S.forceAverage,k=!!C||!!R||S.average,j=C?-1:k&&void 0===n.mantissa?0:S.mantissa,T=!C&&(void 0===n.optionalMantissa?-1===j:S.optionalMantissa),P=S.trimMantissa,A=S.thousandSeparated,M=S.spaceSeparated,_=S.negative,x=S.forceSign,I=S.exponential,N="";if(k){var H=function(t){var e=t.value,n=t.forceAverage,r=t.abbreviations,i=t.spaceSeparated,a=void 0!==i&&i,o=t.totalLength,u=void 0===o?0:o,l="",s=Math.abs(e),c=-1;if(s>=Math.pow(10,12)&&!n||"trillion"===n?(l=r.trillion,e/=Math.pow(10,12)):s<Math.pow(10,12)&&s>=Math.pow(10,9)&&!n||"billion"===n?(l=r.billion,e/=Math.pow(10,9)):s<Math.pow(10,9)&&s>=Math.pow(10,6)&&!n||"million"===n?(l=r.million,e/=Math.pow(10,6)):(s<Math.pow(10,6)&&s>=Math.pow(10,3)&&!n||"thousand"===n)&&(l=r.thousand,e/=Math.pow(10,3)),l&&(l=(a?" ":"")+l),u){var f=e.toString().split(".")[0];c=Math.max(u-f.length,0)}return{value:e,abbreviation:l,mantissaPrecision:c}}({value:f,forceAverage:R,abbreviations:i.currentAbbreviations(),spaceSeparated:M,totalLength:C});f=H.value,N+=H.abbreviation,C&&(j=H.mantissaPrecision)}if(I){var D=(d=(s={value:f,characteristicPrecision:b}).value,p=void 0===(v=s.characteristicPrecision)?0:v,m=(g=r(d.toExponential().split("e"),2))[0],w=g[1],O=+m,p&&1<p&&(O*=Math.pow(10,p-1),w=0<=(w=+w-(p-1))?"+".concat(w):w),{value:O,abbreviation:"e".concat(w)});f=D.value,N=D.abbreviation+N}var L,B,F,V=function(t,e,n,o,i){if(-1===o)return t;var a=y(e,o),l=r(a.toString().split("."),2),u=l[0],c=l[1],s=void 0===c?"":c;if(s.match(/^0+$/)&&(n||i))return u;var f=s.match(/0+$/);return i&&f?"".concat(u,".").concat(s.toString().slice(0,f.index)):a.toString()}(f.toString(),f,T,j,P);return V=function(t,e,n,r,i){var a=r.currentDelimiters(),o=a.thousands;i=i||a.decimal;var u=a.thousandsSize||3,l=t.toString(),s=l.split(".")[0],c=l.split(".")[1];return n&&(e<0&&(s=s.slice(1)),function(t,e){for(var n=[],r=0,i=t;0<i;i--)r===e&&(n.unshift(i),r=0),r++;return n}(s.length,u).forEach((function(t,e){s=s.slice(0,t+e)+o+s.slice(t+e)})),e<0&&(s="-".concat(s))),c?s+i+c:s}(V=function(t,e,n,o){var i=t,a=r(i.toString().split("."),2),l=a[0],u=a[1];if(l.match(/^-?0$/)&&n)return u?"".concat(l.replace("0",""),".").concat(u):l.replace("0","");if(l.length<o)for(var c=o-l.length,s=0;s<c;s++)i="0".concat(i);return i.toString()}(V,0,E,b),f,A,i,a),(k||I)&&(V+=N),(x||f<0)&&(L=V,F=_,V=0===(B=f)?L:0==+L?L.replace("-",""):0<B?"+".concat(L):"sign"===F?L:"(".concat(L.replace("-",""),")")),V}function m(t,e){if(!t)return e;var n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return i.apply(void 0,n.concat([t]))},getByteUnit:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=f.general;return d(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=f.binary;return d(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=f.decimal;return d(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},formatOrDefault:m}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){"use strict";var i=t("./en-US"),r=t("./validating"),a=t("./parsing"),o={},u=void 0,l={},s=null,c={};function f(t){u=t}function p(){return l[u]}o.languages=function(){return Object.assign({},l)},o.currentLanguage=function(){return u},o.currentCurrency=function(){return p().currency},o.currentAbbreviations=function(){return p().abbreviations},o.currentDelimiters=function(){return p().delimiters},o.currentOrdinal=function(){return p().ordinal},o.currentDefaults=function(){return Object.assign({},p().defaults,c)},o.currentOrdinalDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().ordinalFormat)},o.currentByteDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().byteFormat)},o.currentPercentageDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().percentageFormat)},o.currentCurrencyDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().currencyFormat)},o.currentTimeDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().timeFormat)},o.setDefaults=function(t){t=a.parseFormat(t),r.validateFormat(t)&&(c=t)},o.getZeroFormat=function(){return s},o.setZeroFormat=function(t){return s="string"==typeof t?t:null},o.hasZeroFormat=function(){return null!==s},o.languageData=function(t){if(t){if(l[t])return l[t];throw new Error('Unknown tag "'.concat(t,'"'))}return p()},o.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!r.validateLanguage(t))throw new Error("Invalid language data");l[t.languageTag]=t,e&&f(t.languageTag)},o.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!l[t]){var n=t.split("-")[0],r=Object.keys(l).find((function(t){return t.split("-")[0]===n}));return l[r]?void f(r):void f(e)}f(t)},o.registerLanguage(i),u=i.languageTag,e.exports=o},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,n){"use strict";e.exports=function(e){return{loadLanguagesInNode:function(n){return r=e,void n.forEach((function(e){var n=void 0;try{n=t("../languages/".concat(e))}catch(n){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}n&&r.registerLanguage(n)}));var r}}}},{}],6:[function(t,e,n){"use strict";var r=t("bignumber.js");function a(t,e,n){var o=new r(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new r(i),t._value=o.minus(i).toNumber(),t}e.exports=function(u){return{add:function(t,e){return o=e,i=u,a=new r((n=t)._value),l=o,i.isNumbro(o)&&(l=o._value),l=new r(l),n._value=a.plus(l).toNumber(),n;var n,o,i,a,l},subtract:function(t,e){return a(t,e,u)},multiply:function(t,e){return o=e,i=u,a=new r((n=t)._value),l=o,i.isNumbro(o)&&(l=o._value),l=new r(l),n._value=a.times(l).toNumber(),n;var n,o,i,a,l},divide:function(t,e){return o=e,i=u,a=new r((n=t)._value),l=o,i.isNumbro(o)&&(l=o._value),l=new r(l),n._value=a.dividedBy(l).toNumber(),n;var n,o,i,a,l},set:function(t,e){return n=t,i=r=e,u.isNumbro(r)&&(i=r._value),n._value=i,n;var n,r,i},difference:function(t,e){return n=e,a(i=(r=u)(t._value),n,r),Math.abs(i._value);var n,r,i}}}},{"bignumber.js":1}],7:[function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("./globalState"),r=t("./validating"),o=t("./loading")(g),u=t("./unformatting"),l=t("./formatting")(g),s=t("./manipulating")(g),c=t("./parsing"),f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e}var e,n,r;return e=t,(n=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=c.parseFormat(t)),(t=l.formatOrDefault(t,a.currentCurrencyDefaultFormat())).output="currency",l.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",l.format(this,t)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(t){return s.difference(this,t)}},{key:"add",value:function(t){return s.add(this,t)}},{key:"subtract",value:function(t){return s.subtract(this,t)}},{key:"multiply",value:function(t){return s.multiply(this,t)}},{key:"divide",value:function(t){return s.divide(this,t)}},{key:"set",value:function(t){return s.set(this,p(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(e.prototype,n),r&&i(e,r),t}();function p(t){var e=t;return g.isNumbro(t)?e=t._value:"string"==typeof t?e=g.unformat(t):isNaN(t)&&(e=NaN),e}function g(t){return new f(p(t))}g.version="2.1.2",g.isNumbro=function(t){return t instanceof f},g.language=a.currentLanguage,g.registerLanguage=a.registerLanguage,g.setLanguage=a.setLanguage,g.languages=a.languages,g.languageData=a.languageData,g.zeroFormat=a.setZeroFormat,g.defaultFormat=a.currentDefaults,g.setDefaults=a.setDefaults,g.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,g.validate=r.validate,g.loadLanguagesInNode=o.loadLanguagesInNode,g.unformat=u.unformat,e.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){"use strict";e.exports={parseFormat:function(t){var e,n,r,i,a,o,u,l,s,c,f,p,g,h,d,y,v,m,b,w,O=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(n=O,a=O,function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(o=(i=t=(r=(e=t).match(/^{([^}]*)}/))?(n.prefix=r[1],e.slice(r[0].length)):e).match(/{([^}]*)}$/))?(a.postfix=o[1],i.slice(0,-o[0].length)):i,O),u=O,(l=t.match(/[1-9]+[0-9]*/))&&(u.totalLength=+l[0]),s=O,(c=t.split(".")[0].match(/0+/))&&(s.characteristic=c[0].length),function(t,e){if(-1!==t.indexOf(".")){var n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,O),f=O,-1!==t.indexOf("a")&&(f.average=!0),g=O,-1!==(p=t).indexOf("K")?g.forceAverage="thousand":-1!==p.indexOf("M")?g.forceAverage="million":-1!==p.indexOf("B")?g.forceAverage="billion":-1!==p.indexOf("T")&&(g.forceAverage="trillion"),function(t,e){var n=t.split(".")[1];if(n){var r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}(t,O),d=O,(h=t).match(/\[\.]/)?d.optionalMantissa=!0:h.match(/\./)&&(d.optionalMantissa=!1),y=O,-1!==t.indexOf(",")&&(y.thousandSeparated=!0),v=O,-1!==t.indexOf(" ")&&(v.spaceSeparated=!0),b=O,(m=t).match(/^\+?\([^)]*\)$/)&&(b.negative="parenthesis"),m.match(/^\+?-/)&&(b.negative="sign"),w=O,t.match(/^\+/)&&(w.forceSign=!0),O)}}},{}],9:[function(p,t,e){"use strict";var n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function r(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function g(t,e){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",l=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,c=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===i?0:function t(e,o){var l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,c=5<arguments.length?arguments[5]:void 0,u=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var f="",s=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(s!==e)return-1*t(s,o,l,i,a,c,u);for(var h=0;h<n.length;h++){var d=n[h];if((f=e.replace(d.key,""))!==e)return t(f,o,l,i,a,c,u)*d.factor}if((f=e.replace("%",""))!==e)return t(f,o,l,i,a,c,u)/100;var p=parseFloat(e);if(!isNaN(p)){var g=i(p);if(g&&"."!==g&&(f=e.replace(new RegExp("".concat(r(g),"$")),""))!==e)return t(f,o,l,i,a,c,u);var y={};Object.keys(c).forEach((function(t){y[c[t]]=t}));for(var v=Object.keys(y).sort().reverse(),m=v.length,w=0;w<m;w++){var O=v[w],b=y[O];if((f=e.replace(O,""))!==e){var S=void 0;switch(b){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return t(f,o,l,i,a,c,u)*S}}}}(function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=t.replace(n,"");return(o=o.replace(new RegExp("([0-9])".concat(r(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,o),e,o,l,i,a,c)}t.exports={unformat:function(t,e){var n,r,i,a=p("./globalState"),o=a.currentDelimiters(),u=a.currentCurrency().symbol,l=a.currentOrdinal(),s=a.getZeroFormat(),c=a.currentAbbreviations(),f=void 0;if("string"==typeof t)f=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var n=t.split(":");if(3!==n.length)return!1;var r=+n[0],i=+n[1],a=+n[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(a)}(t,o)?(r=+(n=t.split(":"))[0],i=+n[1],+n[2]+60*i+3600*r):g(t,o,u,l,s,c,e);else{if("number"!=typeof t)return;f=t}if(void 0!==f)return f}}},{"./globalState":4}],10:[function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=t("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,p={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function u(t){return!!i.unformat(t)}function g(t,s,e){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],l=Object.keys(t).map((function(n){if(!s[n])return console.error("".concat(e," Invalid key: ").concat(n)),!1;var r=t[n],l=s[n];if("string"==typeof l&&(l={type:l}),"format"===l.type){if(!g(r,p,"[Validate ".concat(n,"]"),!0))return!1}else if(o(r)!==l.type)return console.error("".concat(e," ").concat(n,' type mismatched: "').concat(l.type,'" expected, "').concat(o(r),'" provided')),!1;if(l.restrictions&&l.restrictions.length)for(var c=l.restrictions.length,i=0;i<c;i++){var a=l.restrictions[i],f=a.restriction,u=a.message;if(!f(r,t))return console.error("".concat(e," ").concat(n," invalid value: ").concat(u)),!1}return l.restriction&&!l.restriction(r,t)?(console.error("".concat(e," ").concat(n," invalid value: ").concat(l.message)),!1):l.validValues&&-1===l.validValues.indexOf(r)?(console.error("".concat(e," ").concat(n," invalid value: must be among ").concat(JSON.stringify(l.validValues),', "').concat(r,'" provided')),!1):!(l.children&&!g(r,l.children,"[Validate ".concat(n,"]")))}));return n||l.push.apply(l,r(Object.keys(s).map((function(n){var r=s[n];if("string"==typeof r&&(r={type:r}),r.mandatory){var o=r.mandatory;if("function"==typeof o&&(o=o(t)),o&&void 0===t[n])return console.error("".concat(e,' Missing mandatory key "').concat(n,'"')),!1}return!0})))),l.reduce((function(t,e){return t&&e}),!0)}function c(t){return g(t,p,"[Validate format]")}e.exports={validate:function(t,e){var n=u(t),r=c(e);return n&&r},validateFormat:c,validateInput:u,validateLanguage:function(t){return g(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},949:function(t,e,n){"use strict";n(313)("WeakSet",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(435))},950:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(239),n(242),n(6),n(40),n(44);var r=n(767),o=n(819),l=new Map([["indexesSequence",{getListWithInsertedItems:r.a,getListWithRemovedItems:r.b}],["physicallyIndexed",{getListWithInsertedItems:o.a,getListWithRemovedItems:o.b}]]),c=function(t){if(!1===l.has(t))throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return l.get(t)}}}]);